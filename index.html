<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Frota e Manutenção</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#4B4ACA',
                        'gray-750': '#2A2A2A',
                        'gray-850': '#1F1F1F',
                    },
                }
            }
        }
    </script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Estilos para transições e animações */
        .fade-enter {
            opacity: 0;
        }
        .fade-enter-active {
            opacity: 1;
            transition: opacity 300ms ease-in;
        }
        .fade-exit {
            opacity: 1;
        }
        .fade-exit-active {
            opacity: 0;
            transition: opacity 300ms ease-in;
        }
        
        /* Estilos para as notificações */
        .notification {
            position: relative;
            margin-bottom: 0.75rem;
            animation: slideIn 0.3s ease-out forwards;
        }
        
        @keyframes slideIn {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .fadeOut {
            animation: fadeOut 0.3s ease-out forwards;
        }
        
        @keyframes fadeOut {
            0% {
                transform: translateX(0);
                opacity: 1;
            }
            100% {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        /* Estilo para barras de disponibilidade */
        .availability-bar {
            height: 0.75rem;
            border-radius: 9999px;
            overflow: hidden;
            background-color: #E5E7EB;
        }
        
        .dark .availability-bar {
            background-color: #374151;
        }
        
        .availability-bar-inner {
            height: 100%;
            background-color: #5D5CDE;
            border-radius: 9999px;
            transition: width 1s ease-in-out;
        }
        
        /* Estilos para os badges de status */
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-weight: 500;
        }
        
        .status-badge-operational {
            background-color: #DEF7EC;
            color: #03543E;
        }
        
        .dark .status-badge-operational {
            background-color: rgba(6, 95, 70, 0.5);
            color: #10B981;
        }
        
        .status-badge-maintenance {
            background-color: #FEF3C7;
            color: #92400E;
        }
        
        .dark .status-badge-maintenance {
            background-color: rgba(146, 64, 14, 0.5);
            color: #F59E0B;
        }
        
        .status-badge-reform {
            background-color: #FEE2E2;
            color: #991B1B;
        }
        
        .dark .status-badge-reform {
            background-color: rgba(153, 27, 27, 0.5);
            color: #EF4444;
        }
        
        /* Estilos para as abas */
        .tab-button {
            border-bottom: 2px solid transparent;
            padding-bottom: 0.5rem;
            transition: all 0.2s ease-in-out;
        }
        
        .tab-button.active {
            border-color: #5D5CDE;
            color: #5D5CDE;
        }
        
        .dark .tab-button.active {
            border-color: #5D5CDE;
            color: #5D5CDE;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Estilos para o histórico */
        .history-item {
            position: relative;
            padding-left: 1.5rem;
            margin-left: 1.5rem;
        }
        
        .history-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -1px;
            height: 100%;
            width: 2px;
            background-color: #E5E7EB;
        }
        
        .dark .history-item::before {
            background-color: #4B5563;
        }
        
        /* Estilos para impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            
            #print-area, #print-area * {
                visibility: visible;
            }
            
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background-color: white !important;
                color: black !important;
            }
            
            .pdf-page-break {
                page-break-after: always;
            }
            
            button, .no-print {
                display: none !important;
            }
            
            a {
                text-decoration: none !important;
                color: black !important;
            }
            
            .dark .border-gray-700 {
                border-color: #e5e7eb !important;
            }
            
            .dark .bg-gray-800, .dark .bg-gray-750 {
                background-color: white !important;
            }
            
            .dark .text-gray-400, .dark .text-gray-300, .dark .text-gray-200, .dark .text-white {
                color: #374151 !important;
            }
        }
        
        /* Estilos para PDF */
        #pdf-report-area {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            color: #000;
        }
        
        #pdf-report-area h1 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        #pdf-report-area h2 {
            font-size: 20px;
            margin: 15px 0;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        
        #pdf-report-area h3 {
            font-size: 18px;
            margin: 10px 0;
            color: #444;
        }
        
        #pdf-report-area h4 {
            font-size: 16px;
            margin: 10px 0;
            color: #555;
        }
        
        #pdf-report-area p {
            margin: 5px 0;
            line-height: 1.5;
        }
        
        #pdf-report-area table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        #pdf-report-area th, #pdf-report-area td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        #pdf-report-area th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        #pdf-report-area .summary-box {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
        }
        
        #pdf-report-area .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }
        
        #pdf-report-area .grid-item {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            background-color: #fff;
        }
        
        #pdf-report-area .data-highlight {
            font-size: 18px;
            font-weight: bold;
            color: #5D5CDE;
        }
        
        #pdf-report-area .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        #pdf-report-area .status-operational {
            background-color: #10B981;
        }
        
        #pdf-report-area .status-maintenance {
            background-color: #F59E0B;
        }
        
        #pdf-report-area .status-reform {
            background-color: #EF4444;
        }
        
        #pdf-report-area .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 12px;
            color: #777;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <!-- Barra de navegação superior -->
    <nav class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm px-4 py-3">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center">
                <div class="text-primary text-2xl font-bold mr-2">
                    <i class="fas fa-truck"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold">Sistema de Gestão de Frota</h1>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Controle sua frota com eficiência</p>
                </div>
            </div>
            
            <div class="flex items-center space-x-3">
                <div class="relative">
                    <input type="text" id="global-search" placeholder="Buscar em todos os dados..." 
                           class="py-2 px-4 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-base focus:ring-primary focus:border-primary dark:bg-gray-700 dark:text-gray-200"
                           oninput="fleetManager.data.searchTerm = this.value; fleetManager.renderAllTables()">
                    <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                </div>
                
                <div class="flex space-x-2">
                    <button id="export-button" class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                        <i class="fas fa-file-export mr-2"></i>
                        Exportar
                    </button>
                    <button id="print-button" class="inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-650 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                        <i class="fas fa-print mr-2"></i>
                        Imprimir
                    </button>
                    <button id="report-button" class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-600">
                        <i class="fas fa-file-pdf mr-2"></i>
                        Relatório
                    </button>
                    <div class="relative" id="settings-dropdown-container">
                        <button id="settings-button" class="inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-650 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                            <i class="fas fa-cog mr-2"></i>
                            Config
                        </button>
                        <div id="settings-dropdown" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg z-10 hidden">
                            <div class="py-1">
                                <button id="export-backup-button" class="w-full text-left block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-download mr-2"></i>Exportar Backup
                                </button>
                                <button id="import-backup-button" class="w-full text-left block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-upload mr-2"></i>Importar Backup
                                </button>
                                <div class="border-t border-gray-200 dark:border-gray-700 my-1"></div>
                                <button id="clear-data-button" class="w-full text-left block px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900">
                                    <i class="fas fa-trash mr-2"></i>Limpar Todos os Dados
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Conteúdo principal -->
    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Abas de navegação -->
        <div class="border-b border-gray-200 dark:border-gray-700 mb-6">
            <ul class="flex flex-wrap -mb-px text-base font-medium text-center" id="main-tabs">
                <li class="mr-8">
                    <a href="#main-dashboard" class="tab-button active flex items-center py-2.5">
                        <i class="fas fa-tachometer-alt mr-2"></i>
                        Dashboard
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#detailed-dashboard" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-chart-line mr-2"></i>
                        Dashboard Detalhado
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#real-equipment-view" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-truck-moving mr-2"></i>
                        Visualização da Frota
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#reboques" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-trailer mr-2"></i>
                        Reboques
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#caminhoes-proprios" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-truck mr-2"></i>
                        Caminhões Próprios
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#caminhoes-terceiros" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-truck-loading mr-2"></i>
                        Caminhões Terceiros
                    </a>
                </li>
                <li class="mr-8">
                    <a href="#frente-4001" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-tractor mr-2"></i>
                        Frente 4001
                    </a>
                </li>
                <li>
                    <a href="#frente-4002" class="tab-button flex items-center py-2.5">
                        <i class="fas fa-tractor mr-2"></i>
                        Frente 4002
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Dashboard Principal -->
        <div id="main-dashboard" class="tab-content active">
            <div class="mb-8 flex items-center justify-between">
                <h2 class="text-2xl font-bold">Dashboard Principal</h2>
                <button id="add-equipment-button" class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                    <i class="fas fa-plus mr-2"></i>
                    Adicionar Equipamento
                </button>
            </div>
            
            <!-- Resumo dos dados -->
            <div class="grid grid-cols-1 lg:grid-cols-6 gap-6 mb-8">
                <div class="lg:col-span-3 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">Disponibilidade da Frota</h3>
                        <div class="text-3xl font-bold text-primary" id="dash-summary-availability">--%</div>
                    </div>
                    
                    <div class="availability-bar mb-2">
                        <div class="availability-bar-inner" id="dash-availability-bar" style="width: 0%;"></div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mt-6">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600 dark:text-green-500" id="dash-summary-operational">0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Operacionais</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-500" id="dash-summary-maintenance">0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-red-600 dark:text-red-500" id="dash-summary-reform">0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Em Reforma</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600 dark:text-blue-500" id="dash-summary-borrowed">0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Emprestados</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-600 dark:text-gray-400" id="dash-summary-other">0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Outros</div>
                        </div>
                    </div>
                </div>
                
                <div class="lg:col-span-3 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">Status por Categoria</h3>
                    </div>
                    
                    <div>
                        <canvas id="equipment-status-chart" width="400" height="250"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Status por tipo de equipamento -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Reboques -->
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium">Reboques</h3>
                        <div class="flex items-center">
                            <span class="font-bold mr-2" id="dash-reboques-count">0</span>
                            <span class="text-xs py-1 px-2 bg-gray-100 dark:bg-gray-700 rounded-full">Total</span>
                        </div>
                    </div>
                    
                    <div class="availability-bar mb-2">
                        <div class="availability-bar-inner" id="dash-reboques-bar" style="width: 0%;"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-600 dark:text-green-500" id="dash-reboques-operational">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Operacionais</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-600 dark:text-yellow-500" id="dash-reboques-maintenance">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Próprios -->
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium">Caminhões Próprios</h3>
                        <div class="flex items-center">
                            <span class="font-bold mr-2" id="dash-cp-count">0</span>
                            <span class="text-xs py-1 px-2 bg-gray-100 dark:bg-gray-700 rounded-full">Total</span>
                        </div>
                    </div>
                    
                    <div class="availability-bar mb-2">
                        <div class="availability-bar-inner" id="dash-cp-bar" style="width: 0%;"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-600 dark:text-green-500" id="dash-cp-operational">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Operacionais</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-600 dark:text-yellow-500" id="dash-cp-maintenance">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4001 -->
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium">Frente 4001</h3>
                        <div class="flex items-center">
                            <span class="font-bold mr-2" id="dash-f4001-count">0</span>
                            <span class="text-xs py-1 px-2 bg-gray-100 dark:bg-gray-700 rounded-full">Total</span>
                        </div>
                    </div>
                    
                    <div class="availability-bar mb-2">
                        <div class="availability-bar-inner" id="dash-f4001-bar" style="width: 0%;"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-600 dark:text-green-500" id="dash-f4001-operational">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Operacionais</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-600 dark:text-yellow-500" id="dash-f4001-maintenance">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4002 -->
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium">Frente 4002</h3>
                        <div class="flex items-center">
                            <span class="font-bold mr-2" id="dash-f4002-count">0</span>
                            <span class="text-xs py-1 px-2 bg-gray-100 dark:bg-gray-700 rounded-full">Total</span>
                        </div>
                    </div>
                    
                    <div class="availability-bar mb-2">
                        <div class="availability-bar-inner" id="dash-f4002-bar" style="width: 0%;"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-600 dark:text-green-500" id="dash-f4002-operational">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Operacionais</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-600 dark:text-yellow-500" id="dash-f4002-maintenance">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Lista de equipamentos em manutenção -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">Equipamentos em Manutenção</h3>
                    </div>
                    
                    <ul id="equipment-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-700">
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Carregando...</span>
                        </li>
                    </ul>
                </div>
                
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">Próximas Manutenções Agendadas</h3>
                    </div>
                    
                    <ul id="upcoming-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-700">
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Carregando...</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Dashboard Detalhado -->
        <div id="detailed-dashboard" class="tab-content">
            <div class="mb-8 flex items-center justify-between">
                <h2 class="text-2xl font-bold">Dashboard Detalhado</h2>
            </div>
            
            <!-- Visão Geral -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center mb-4">
                        <div class="text-primary text-2xl mr-3">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">Total de Equipamentos</h3>
                            <p class="text-3xl font-bold mt-2" id="detailed-total-equipment">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center mb-4">
                        <div class="text-green-500 text-2xl mr-3">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">Disponibilidade</h3>
                            <p class="text-3xl font-bold mt-2" id="detailed-operational-percentage">0%</p>
                        </div>
                    </div>
                    <div class="availability-bar mt-2">
                        <div class="availability-bar-inner" id="detailed-operational-bar" style="width: 0%;"></div>
                    </div>
                </div>
                
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center mb-4">
                        <div class="text-yellow-500 text-2xl mr-3">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold">Manutenções em Andamento</h3>
                            <p class="text-3xl font-bold mt-2" id="detailed-total-maintenances">0</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Análise por Categoria -->
            <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8">
                <h3 class="text-xl font-bold mb-6">Análise por Categoria</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-6">
                    <!-- Reboques -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-trailer text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-reboques-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Reboques</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-reboques-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-reboques-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-reboques-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Caminhões Próprios -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-truck text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-cp-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Caminhões Próprios</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-cp-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-cp-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-cp-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Caminhões Terceiros -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-truck-moving text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-ct-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Caminhões Terceiros</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-ct-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-ct-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-ct-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4001 - Colhedoras -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-tractor text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-f4001-colh-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Frente 4001 - Colhedoras</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-f4001-colh-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-f4001-colh-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-f4001-colh-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4001 - Trações -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-truck-monster text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-f4001-trac-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Frente 4001 - Trações</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-f4001-trac-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-f4001-trac-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-f4001-trac-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4002 - Colhedoras -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-tractor text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-f4002-colh-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Frente 4002 - Colhedoras</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-f4002-colh-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-f4002-colh-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-f4002-colh-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4002 - Trações -->
                    <div class="flex items-start">
                        <div class="text-center mr-4">
                            <div class="w-16 h-16 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mx-auto">
                                <i class="fas fa-truck-monster text-primary text-2xl"></i>
                            </div>
                            <div class="mt-2 font-medium" id="detailed-f4002-trac-count">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Total</div>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-3">Frente 4002 - Trações</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm font-medium">Disponibilidade</span>
                                <span class="text-sm font-medium" id="detailed-f4002-trac-availability">0%</span>
                            </div>
                            <div class="availability-bar mb-4">
                                <div class="availability-bar-inner" id="detailed-f4002-trac-avail-bar" style="width: 0%;"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-center text-sm">
                                <div class="rounded-md py-1 px-2 bg-green-100 dark:bg-green-900">
                                    <span class="text-green-800 dark:text-green-200" id="detailed-f4002-trac-avail-value">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Gráficos Detalhados -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <h3 class="text-xl font-bold mb-4">Tendência de Disponibilidade</h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="detailed-availability-trend-chart"></canvas>
                        <div id="detailed-trend-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90">
                            <div class="text-center">
                                <i class="fas fa-chart-line text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                <p class="text-gray-500 dark:text-gray-400">Dados históricos insuficientes</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <h3 class="text-xl font-bold mb-4">Causas de Manutenção</h3>
                    <div style="height: 300px;">
                        <canvas id="detailed-maintenance-causes-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Previsão e Indicadores -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <h3 class="text-xl font-bold mb-4">Previsão de Disponibilidade</h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="detailed-forecast-chart"></canvas>
                        <div id="detailed-forecast-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90">
                            <div class="text-center">
                                <i class="fas fa-chart-line text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                <p class="text-gray-500 dark:text-gray-400">Dados históricos insuficientes para previsão</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <h3 class="text-xl font-bold mb-6">Indicadores de Desempenho</h3>
                    
                    <div class="grid grid-cols-1 gap-6">
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300 text-xl mr-4">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">MTBF (Tempo Médio Entre Falhas)</div>
                                <div class="text-xl font-bold" id="detailed-mtbf">--</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center text-yellow-600 dark:text-yellow-300 text-xl mr-4">
                                <i class="fas fa-tools"></i>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">MTTR (Tempo Médio Para Reparo)</div>
                                <div class="text-xl font-bold" id="detailed-mttr">--</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div class="w-14 h-14 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center text-green-600 dark:text-green-300 text-xl mr-4">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">OEE (Eficácia Global do Equipamento)</div>
                                <div class="text-xl font-bold" id="detailed-oee">--</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Visualização Real da Frota -->
        <div id="real-equipment-view" class="tab-content">
            <div class="mb-6 flex flex-col md:flex-row md:items-center md:justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Visualização da Frota</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="real-equipment-count">0 equipamentos</span> encontrados</p>
                </div>
                
                <div class="mt-4 md:mt-0 flex flex-wrap gap-2">
                    <button data-filter="all" class="real-filter-btn px-3 py-1.5 bg-primary text-white rounded-md text-sm">
                        Todos
                    </button>
                    <button data-filter="operational" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                        Operacionais
                    </button>
                    <button data-filter="maintenance" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                        Em Manutenção
                    </button>
                    <button data-filter="reform" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                        Em Reforma
                    </button>
                </div>
            </div>
            
            <div class="mb-6 flex flex-wrap gap-2">
                <button data-filter="reboques" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    <i class="fas fa-trailer mr-1"></i> Reboques
                </button>
                <button data-filter="caminhoes" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    <i class="fas fa-truck mr-1"></i> Caminhões
                </button>
                <button data-filter="colhedoras" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    <i class="fas fa-tractor mr-1"></i> Colhedoras
                </button>
                <button data-filter="tracoes" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    <i class="fas fa-truck-monster mr-1"></i> Trações
                </button>
                <button data-filter="frente4001" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    Frente 4001
                </button>
                <button data-filter="frente4002" class="real-filter-btn px-3 py-1.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                    Frente 4002
                </button>
                
                <div class="ml-auto">
                    <button id="add-equipment-button-2" class="px-4 py-1.5 bg-primary text-white rounded-md text-sm">
                        <i class="fas fa-plus mr-1"></i> Adicionar Equipamento
                    </button>
                </div>
            </div>
            
            <!-- Container para cartões de equipamentos -->
            <div id="real-equipment-container" class="min-h-[200px]">
                <div class="flex items-center justify-center h-48">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
                        <p class="mt-4 text-gray-500 dark:text-gray-400">Carregando equipamentos...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tabela de Reboques -->
        <div id="reboques" class="tab-content">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Reboques</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-count">0 reboques</span> encontrados</p>
                </div>
                
                <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                    <i class="fas fa-plus mr-2"></i>
                    Adicionar Reboque
                </button>
            </div>
            
            <!-- Dashboard de reboques -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-4">
                        <i class="fas fa-check text-green-600 dark:text-green-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Operacionais</span>
                        <span id="reboques-operational" class="block text-2xl font-bold">0</span>
                        <span id="reboques-operational-percentage" class="text-xs text-green-600 dark:text-green-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                        <i class="fas fa-tools text-yellow-600 dark:text-yellow-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Manutenção</span>
                        <span id="reboques-maintenance" class="block text-2xl font-bold">0</span>
                        <span id="reboques-maintenance-percentage" class="text-xs text-yellow-600 dark:text-yellow-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-4">
                        <i class="fas fa-times text-red-600 dark:text-red-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Reforma/Inoperante</span>
                        <span id="reboques-reform" class="block text-2xl font-bold">0</span>
                        <span id="reboques-reform-percentage" class="text-xs text-red-600 dark:text-red-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-2">
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                        <span id="reboques-availability" class="block text-lg font-bold">0%</span>
                    </div>
                    <div class="availability-bar">
                        <div class="availability-bar-inner" id="reboques-availability-bar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
            
            <!-- Tabela de reboques -->
            <div class="bg-white dark:bg-gray-800 shadow-sm rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Frota</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tipo</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Acoplado</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="reboques-table-body">
                            <tr>
                                <td colspan="7" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tabela de Caminhões Próprios -->
        <div id="caminhoes-proprios" class="tab-content">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Caminhões Próprios</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="cp-table-count">0 caminhões</span> encontrados</p>
                </div>
                
                <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                    <i class="fas fa-plus mr-2"></i>
                    Adicionar Caminhão
                </button>
            </div>
            
            <!-- Dashboard de caminhões próprios -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-4">
                        <i class="fas fa-check text-green-600 dark:text-green-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Operacionais</span>
                        <span id="cp-operational" class="block text-2xl font-bold">0</span>
                        <span id="cp-operational-percentage" class="text-xs text-green-600 dark:text-green-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                        <i class="fas fa-tools text-yellow-600 dark:text-yellow-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Manutenção</span>
                        <span id="cp-maintenance" class="block text-2xl font-bold">0</span>
                        <span id="cp-maintenance-percentage" class="text-xs text-yellow-600 dark:text-yellow-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-4">
                        <i class="fas fa-times text-red-600 dark:text-red-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Reforma/Inoperante</span>
                        <span id="cp-reform" class="block text-2xl font-bold">0</span>
                        <span id="cp-reform-percentage" class="text-xs text-red-600 dark:text-red-400 font-medium">0%</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-2">
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                        <span id="cp-availability" class="block text-lg font-bold">0%</span>
                    </div>
                    <div class="availability-bar">
                        <div class="availability-bar-inner" id="cp-availability-bar" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
            
            <!-- Tabela de caminhões próprios -->
            <div class="bg-white dark:bg-gray-800 shadow-sm rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Caminhão</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="cp-table-body">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tabela de Caminhões Terceiros -->
        <div id="caminhoes-terceiros" class="tab-content">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Caminhões Terceiros</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="ct-table-count">0 caminhões</span> encontrados</p>
                </div>
                
                <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                    <i class="fas fa-plus mr-2"></i>
                    Adicionar Caminhão Terceiro
                </button>
            </div>
            
            <!-- Tabela de caminhões terceiros -->
            <div class="bg-white dark:bg-gray-800 shadow-sm rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Caminhão</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Proprietário</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Reboques</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="ct-table-body">
                            <tr>
                                <td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tabela da Frente 4001 -->
        <div id="frente-4001" class="tab-content">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Frente 4001</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="f4001-table-count">0 equipamentos</span> encontrados</p>
                </div>
                
                <div class="flex space-x-2">
                    <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" data-type="colhedora-4001">
                        <i class="fas fa-plus mr-2"></i>
                        Adicionar Colhedora
                    </button>
                    <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" data-type="tracao-4001">
                        <i class="fas fa-plus mr-2"></i>
                        Adicionar Tração
                    </button>
                </div>
            </div>
            
            <!-- Dashboard da frente 4001 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-2">
                        <span class="block text-lg font-medium">Total</span>
                        <span id="f4001-total" class="block text-lg font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-4">
                        <i class="fas fa-check text-green-600 dark:text-green-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Operacionais</span>
                        <span id="f4001-operational" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                        <i class="fas fa-tools text-yellow-600 dark:text-yellow-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Manutenção</span>
                        <span id="f4001-maintenance" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-4">
                        <i class="fas fa-times text-red-600 dark:text-red-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Reforma/Inoperante</span>
                        <span id="f4001-reform" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
            </div>
            
            <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6">
                <div class="flex items-center justify-between mb-2">
                    <span class="block text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                    <span id="f4001-availability" class="block text-lg font-bold">0%</span>
                </div>
                <div class="availability-bar">
                    <div class="availability-bar-inner" id="f4001-availability-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <!-- Abas para Colhedoras e Trações -->
            <div class="mb-6 flex space-x-2 border-b border-gray-200 dark:border-gray-700">
                <button id="f4001-colhedoras-tab" class="px-4 py-2 border-b-2 border-primary text-primary font-medium">
                    Colhedoras
                </button>
                <button id="f4001-tracoes-tab" class="px-4 py-2 border-b-2 border-transparent text-gray-500 dark:text-gray-400 font-medium hover:text-gray-700 dark:hover:text-gray-300">
                    Trações
                </button>
            </div>
            
            <!-- Tabela de Colhedoras 4001 -->
            <div id="f4001-colhedoras-table" class="bg-white dark:bg-gray-800 shadow-sm rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Código</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4001-colhedoras-body">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tabela de Trações 4001 -->
            <div id="f4001-tracoes-table" class="bg-white dark:bg-gray-800 shadow-sm rounded-lg hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Código</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4001-tracoes-body">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tabela da Frente 4002 -->
        <div id="frente-4002" class="tab-content">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold">Frente 4002</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-1"><span id="f4002-table-count">0 equipamentos</span> encontrados</p>
                </div>
                
                <div class="flex space-x-2">
                    <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" data-type="colhedora-4002">
                        <i class="fas fa-plus mr-2"></i>
                        Adicionar Colhedora
                    </button>
                    <button class="add-equipment-button inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" data-type="tracao-4002">
                        <i class="fas fa-plus mr-2"></i>
                        Adicionar Tração
                    </button>
                </div>
            </div>
            
            <!-- Dashboard da frente 4002 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex items-center justify-between mb-2">
                        <span class="block text-lg font-medium">Total</span>
                        <span id="f4002-total" class="block text-lg font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-4">
                        <i class="fas fa-check text-green-600 dark:text-green-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Operacionais</span>
                        <span id="f4002-operational" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                        <i class="fas fa-tools text-yellow-600 dark:text-yellow-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Manutenção</span>
                        <span id="f4002-maintenance" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
                
                <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex items-center">
                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-4">
                        <i class="fas fa-times text-red-600 dark:text-red-300 text-xl"></i>
                    </div>
                    <div>
                        <span class="block text-sm text-gray-500 dark:text-gray-400">Em Reforma/Inoperante</span>
                        <span id="f4002-reform" class="block text-2xl font-bold">0</span>
                    </div>
                </div>
            </div>
            
            <div class="p-5 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6">
                <div class="flex items-center justify-between mb-2">
                    <span class="block text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                    <span id="f4002-availability" class="block text-lg font-bold">0%</span>
                </div>
                <div class="availability-bar">
                    <div class="availability-bar-inner" id="f4002-availability-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <!-- Abas para Colhedoras e Trações -->
            <div class="mb-6 flex space-x-2 border-b border-gray-200 dark:border-gray-700">
                <button id="f4002-colhedoras-tab" class="px-4 py-2 border-b-2 border-primary text-primary font-medium">
                    Colhedoras
                </button>
                <button id="f4002-tracoes-tab" class="px-4 py-2 border-b-2 border-transparent text-gray-500 dark:text-gray-400 font-medium hover:text-gray-700 dark:hover:text-gray-300">
                    Trações
                </button>
            </div>
            
            <!-- Tabela de Colhedoras 4002 -->
            <div id="f4002-colhedoras-table" class="bg-white dark:bg-gray-800 shadow-sm rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Código</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4002-colhedoras-body">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tabela de Trações 4002 -->
            <div id="f4002-tracoes-table" class="bg-white dark:bg-gray-800 shadow-sm rounded-lg hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-750">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Código</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Data</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Motivo</th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4002-tracoes-body">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                    Carregando dados...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Container de notificações -->
    <div id="notification-container" class="fixed top-6 right-6 w-full max-w-md space-y-2 z-50"></div>
    
    <!-- Modal para importar backup -->
    <div id="import-backup-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-medium">Importar Backup</h3>
                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                        Selecione um arquivo de backup JSON para importar. Isso substituirá todos os dados atuais.
                    </p>
                    <input type="file" id="backup-file-input" accept=".json" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm">
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-import-button" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary">
                        Importar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmação para limpar dados -->
    <div id="clear-data-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="mb-4">
                    <div class="mx-auto flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900">
                        <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 text-xl"></i>
                    </div>
                </div>
                
                <div class="text-center">
                    <h3 class="text-lg font-medium mb-2">Limpar Todos os Dados</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                        Tem certeza que deseja limpar todos os dados? Essa ação removerá permanentemente todos os equipamentos, históricos e agendamentos.
                    </p>
                    <p class="text-sm text-red-500 mt-2">Esta ação não pode ser desfeita.</p>
                </div>
                
                <div class="flex justify-center space-x-3 mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('clear-data-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-clear-data-button" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                        Limpar Todos os Dados
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para adicionar equipamento -->
    <div id="add-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-medium">Adicionar Equipamento</h3>
                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none" onclick="document.getElementById('add-modal').classList.add('hidden')">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Equipamento</label>
                    <select id="equipment-type" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                        <option value="reboque">Reboque</option>
                        <option value="caminhao-proprio">Caminhão Próprio</option>
                        <option value="caminhao-terceiro">Caminhão Terceiro</option>
                        <option value="colhedora-4001">Colhedora - Frente 4001</option>
                        <option value="tracao-4001">Tração - Frente 4001</option>
                        <option value="colhedora-4002">Colhedora - Frente 4002</option>
                        <option value="tracao-4002">Tração - Frente 4002</option>
                    </select>
                </div>
                
                <div id="add-form-fields">
                    <!-- Campos dinâmicos do formulário serão inseridos aqui -->
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('add-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-equipment-button" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary">
                        Adicionar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de edição de equipamento -->
    <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-medium" id="modal-title">Editar Equipamento</h3>
                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div id="edit-form-fields">
                    <!-- Campos dinâmicos do formulário serão inseridos aqui -->
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-changes-button" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary">
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmação de exclusão -->
    <div id="delete-confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="mb-4">
                    <div class="mx-auto flex items-center justify-center w-12 h-12 rounded-full bg-red-100 dark:bg-red-900">
                        <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 text-xl"></i>
                    </div>
                </div>
                
                <div class="text-center">
                    <h3 class="text-lg font-medium mb-2">Confirmar Exclusão</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                        Tem certeza que deseja excluir este equipamento?<br>
                        <span id="delete-item-details" class="font-medium"></span>
                    </p>
                    <p class="text-sm text-red-500 mt-2">Esta ação não pode ser desfeita.</p>
                </div>
                
                <div class="flex justify-center space-x-3 mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-delete-button" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de histórico de equipamento -->
    <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mr-3">
                            <i id="history-icon" class="fas fa-history text-primary text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium" id="history-title">Histórico de Equipamento</h3>
                            <p class="text-sm text-gray-500 dark:text-gray-400" id="history-subtitle">0 registros</p>
                        </div>
                    </div>
                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none" onclick="document.getElementById('history-modal').classList.add('hidden')">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mt-4 relative">
                    <div class="absolute top-0 bottom-0 left-4 w-0.5 bg-gray-200 dark:bg-gray-700"></div>
                    <div id="history-timeline" class="mt-2">
                        <!-- Itens do histórico serão inseridos aqui -->
                    </div>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('history-modal').classList.add('hidden')">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de agendamento de manutenção -->
    <div id="schedule-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-medium">Agendar Manutenção</h3>
                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div id="schedule-equipment-info" class="mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
                    <!-- Informações do equipamento serão inseridas aqui -->
                </div>
                
                <div class="mb-4">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                    <input type="date" id="schedule-date" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                </div>
                
                <div class="mb-4">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Hora</label>
                    <input type="time" id="schedule-time" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                </div>
                
                <div class="mb-4">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Manutenção</label>
                    <select id="schedule-type" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                        <option value="preventiva">Preventiva</option>
                        <option value="corretiva">Corretiva</option>
                        <option value="revisao">Revisão</option>
                        <option value="troca-oleo">Troca de Óleo</option>
                        <option value="reforma">Reforma</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Descrição</label>
                    <textarea id="schedule-description" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva os detalhes da manutenção"></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Responsável</label>
                    <input type="text" id="schedule-responsible" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Nome do responsável">
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-schedule-button" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary">
                        Agendar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Área de impressão (normalmente oculta) -->
    <div id="print-area" class="hidden p-8 bg-white dark:bg-white">
        <div class="mb-6 pb-4 border-b border-gray-200">
            <h1 id="print-title" class="text-2xl font-bold mb-2 text-gray-900">Relatório</h1>
            <div class="flex justify-between text-sm text-gray-500">
                <div>
                    <p>Data: <span id="print-date">00/00/0000</span></p>
                </div>
                <div>
                    <p>Gerado em: <span id="print-timestamp">00/00/0000 00:00:00</span></p>
                </div>
            </div>
        </div>
        
        <div id="print-content" class="text-gray-900">
            <!-- Conteúdo para impressão será inserido aqui -->
        </div>
        
        <div class="mt-8 pt-4 border-t border-gray-200 text-sm text-gray-500 text-center">
            <p>Sistema de Gestão de Frota e Manutenção - Página <span class="page-number"></span></p>
        </div>
    </div>
    
    <!-- Área para geração de PDF (normalmente oculta) -->
    <div id="pdf-report-area" class="hidden p-8 bg-white">
        <div class="mb-6 pb-4 border-b border-gray-200">
            <h1 id="pdf-report-title" class="text-2xl font-bold mb-2 text-gray-900">Relatório Completo</h1>
            <div class="flex justify-between text-sm text-gray-500">
                <div>
                    <p>Data: <span id="pdf-report-date">00/00/0000</span></p>
                </div>
                <div>
                    <p>Gerado em: <span id="pdf-timestamp">00/00/0000 00:00:00</span></p>
                </div>
            </div>
        </div>
        
        <div id="pdf-report-content" class="text-gray-900">
            <!-- Conteúdo do relatório em PDF será inserido aqui -->
        </div>
        
        <div class="mt-8 pt-4 border-t border-gray-200 text-sm text-gray-500 text-center">
            <p>Sistema de Gestão de Frota e Manutenção - Página <span class="page-number"></span></p>
        </div>
    </div>
    
    <!-- Input para importar backup (escondido) -->
    <input type="file" id="hidden-file-input" accept=".json" style="display: none;">
    
    <script>
        // Objeto principal de gerenciamento de frota
        const fleetManager = {
            // Dados da aplicação
            data: {
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                history: {},
                schedules: [],
                searchTerm: '',
                charts: {},
                editingItem: null,
                editingType: null,
                deletingId: null,
                deletingType: null,
                deletingIndex: null,
                deletingArray: null,
                schedulingEquipment: null
            },
            
            // Configurar event listeners
            setupEventListeners() {
                console.log('Setting up event listeners...');
                
                // Navegação de abas
                const tabButtons = document.querySelectorAll('#main-tabs a');
                tabButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = button.getAttribute('href').substring(1);
                        this.changeTab(targetId);
                    });
                });
                
                // Alternar entre colhedoras e trações da frente 4001
                document.getElementById('f4001-colhedoras-tab').addEventListener('click', () => {
                    document.getElementById('f4001-colhedoras-table').classList.remove('hidden');
                    document.getElementById('f4001-tracoes-table').classList.add('hidden');
                    document.getElementById('f4001-colhedoras-tab').classList.add('border-primary', 'text-primary');
                    document.getElementById('f4001-tracoes-tab').classList.remove('border-primary', 'text-primary');
                });
                
                document.getElementById('f4001-tracoes-tab').addEventListener('click', () => {
                    document.getElementById('f4001-colhedoras-table').classList.add('hidden');
                    document.getElementById('f4001-tracoes-table').classList.remove('hidden');
                    document.getElementById('f4001-colhedoras-tab').classList.remove('border-primary', 'text-primary');
                    document.getElementById('f4001-tracoes-tab').classList.add('border-primary', 'text-primary');
                });
                
                // Alternar entre colhedoras e trações da frente 4002
                document.getElementById('f4002-colhedoras-tab').addEventListener('click', () => {
                    document.getElementById('f4002-colhedoras-table').classList.remove('hidden');
                    document.getElementById('f4002-tracoes-table').classList.add('hidden');
                    document.getElementById('f4002-colhedoras-tab').classList.add('border-primary', 'text-primary');
                    document.getElementById('f4002-tracoes-tab').classList.remove('border-primary', 'text-primary');
                });
                
                document.getElementById('f4002-tracoes-tab').addEventListener('click', () => {
                    document.getElementById('f4002-colhedoras-table').classList.add('hidden');
                    document.getElementById('f4002-tracoes-table').classList.remove('hidden');
                    document.getElementById('f4002-colhedoras-tab').classList.remove('border-primary', 'text-primary');
                    document.getElementById('f4002-tracoes-tab').classList.add('border-primary', 'text-primary');
                });
                
                // Filtrar equipamentos na visualização real
                const filterButtons = document.querySelectorAll('.real-filter-btn');
                filterButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        // Remover classe ativa de todos os botões
                        filterButtons.forEach(btn => {
                            btn.classList.remove('bg-primary', 'text-white');
                            btn.classList.add('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300', 'border', 'border-gray-300', 'dark:border-gray-600');
                        });
                        
                        // Adicionar classe ativa ao botão clicado
                        button.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300', 'border', 'border-gray-300', 'dark:border-gray-600');
                        button.classList.add('bg-primary', 'text-white');
                        
                        // Aplicar filtro
                        const filter = button.getAttribute('data-filter');
                        this.filterRealEquipment(filter);
                    });
                });
                
                // Botão de adicionar equipamento
                document.getElementById('add-equipment-button').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('add-equipment-button-2').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                // Botões de adicionar equipamento específicos
                const addButtons = document.querySelectorAll('.add-equipment-button');
                addButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        const type = e.currentTarget.getAttribute('data-type');
                        if (type) {
                            document.getElementById('equipment-type').value = type;
                        }
                        this.showAddEquipmentModal();
                    });
                });
                
                // Tipo de equipamento no formulário de adição
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Salvar novo equipamento
                document.getElementById('save-equipment-button').addEventListener('click', () => {
                    this.saveNewEquipment();
                });
                
                // Salvar alterações de equipamento
                document.getElementById('save-changes-button').addEventListener('click', () => {
                    this.saveEquipmentChanges();
                });
                
                // Confirmar exclusão de equipamento
                document.getElementById('confirm-delete-button').addEventListener('click', () => {
                    this.deleteEquipment();
                });
                
                // Salvar agendamento
                document.getElementById('save-schedule-button').addEventListener('click', () => {
                    this.saveSchedule();
                });
                
                // Exportar dados
                document.getElementById('export-button').addEventListener('click', () => {
                    this.exportToCSV();
                });
                
                // Imprimir dados
                document.getElementById('print-button').addEventListener('click', () => {
                    this.printActiveTable();
                });
                
                // Gerar relatório em PDF
                document.getElementById('report-button').addEventListener('click', () => {
                    this.generatePDFReport();
                });
                
                // Mostrar menu de configurações
                document.getElementById('settings-button').addEventListener('click', () => {
                    const dropdown = document.getElementById('settings-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Fechar menu de configurações quando clicar fora
                document.addEventListener('click', (e) => {
                    const settingsButton = document.getElementById('settings-button');
                    const dropdown = document.getElementById('settings-dropdown');
                    const container = document.getElementById('settings-dropdown-container');
                    
                    if (!container.contains(e.target) && !dropdown.classList.contains('hidden')) {
                        dropdown.classList.add('hidden');
                    }
                });
                
                // Botão de exportar backup
                document.getElementById('export-backup-button').addEventListener('click', () => {
                    this.exportBackup();
                    document.getElementById('settings-dropdown').classList.add('hidden');
                });
                
                // Botão de importar backup
                document.getElementById('import-backup-button').addEventListener('click', () => {
                    document.getElementById('import-backup-modal').classList.remove('hidden');
                    document.getElementById('settings-dropdown').classList.add('hidden');
                });
                
                // Confirmar importação de backup
                document.getElementById('confirm-import-button').addEventListener('click', () => {
                    this.importBackup();
                });
                
                // Botão de limpar dados
                document.getElementById('clear-data-button').addEventListener('click', () => {
                    document.getElementById('clear-data-modal').classList.remove('hidden');
                    document.getElementById('settings-dropdown').classList.add('hidden');
                });
                
                // Confirmar limpeza de dados
                document.getElementById('confirm-clear-data-button').addEventListener('click', () => {
                    this.clearAllData();
                });
            },
            
            // Exportar backup completo (JSON)
            exportBackup() {
                try {
                    const dataToExport = {
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules
                    };
                    
                    // Converter para JSON
                    const jsonData = JSON.stringify(dataToExport, null, 2);
                    
                    // Criar blob e link para download
                    const blob = new Blob([jsonData], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    
                    const link = document.createElement('a');
                    link.href = url;
                    
                    // Nome do arquivo com data atual
                    const now = new Date();
                    const dateStr = now.toISOString().split('T')[0];
                    link.download = `backup_frota_${dateStr}.json`;
                    
                    // Realizar download
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // Mostrar notificação
                    this.showNotification('success', 'Sucesso', 'Backup exportado com sucesso.');
                } catch (error) {
                    console.error('Erro ao exportar backup:', error);
                    this.showNotification('error', 'Erro', 'Falha ao exportar backup. Verifique o console para mais detalhes.');
                }
            },
            
            // Importar backup completo (JSON)
            importBackup() {
                const fileInput = document.getElementById('backup-file-input');
                const file = fileInput.files[0];
                
                if (!file) {
                    this.showNotification('error', 'Erro', 'Nenhum arquivo selecionado.');
                    return;
                }
                
                if (file.type !== 'application/json') {
                    this.showNotification('error', 'Erro', 'O arquivo deve ser do tipo JSON.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Verificar se o arquivo contém os dados necessários
                        if (!data.reboques || !data.caminhoesProps || !data.frente4001Colhedoras) {
                            this.showNotification('error', 'Erro', 'O arquivo de backup não contém dados válidos.');
                            return;
                        }
                        
                        // Atualizar dados
                        this.data.reboques = data.reboques || [];
                        this.data.caminhoesProps = data.caminhoesProps || [];
                        this.data.caminhoesTerc = data.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = data.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = data.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = data.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = data.frente4002Tracoes || [];
                        this.data.history = data.history || {};
                        this.data.schedules = data.schedules || [];
                        
                        // Salvar no localStorage
                        this.saveDataToLocalStorage();
                        
                        // Atualizar UI
                        this.renderAllTables();
                        this.updateAllDashboards();
                        this.updateAllCharts();
                        this.initializeRealEquipmentView();
                        
                        // Fechar modal
                        document.getElementById('import-backup-modal').classList.add('hidden');
                        
                        // Limpar input
                        fileInput.value = '';
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Sucesso', 'Backup importado com sucesso.');
                    } catch (error) {
                        console.error('Erro ao importar backup:', error);
                        this.showNotification('error', 'Erro', 'Falha ao importar backup. O arquivo pode estar corrompido.');
                    }
                };
                
                reader.onerror = () => {
                    this.showNotification('error', 'Erro', 'Falha ao ler o arquivo.');
                };
                
                reader.readAsText(file);
            },
            
            // Limpar todos os dados
            clearAllData() {
                // Limpar todos os arrays de dados
                this.data.reboques = [];
                this.data.caminhoesProps = [];
                this.data.caminhoesTerc = [];
                this.data.frente4001Colhedoras = [];
                this.data.frente4001Tracoes = [];
                this.data.frente4002Colhedoras = [];
                this.data.frente4002Tracoes = [];
                this.data.history = {};
                this.data.schedules = [];
                
                // Limpar localStorage
                localStorage.removeItem('fleetManagementData');
                
                // Atualizar UI
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('clear-data-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Todos os dados foram limpos com sucesso.');
            },
            
            // Mudar de aba
            changeTab(tabId) {
                // Ocultar todas as abas
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remover classe ativa de todos os botões de aba
                document.querySelectorAll('#main-tabs a').forEach(button => {
                    button.classList.remove('active');
                });
                
                // Mostrar a aba selecionada
                const tabContent = document.getElementById(tabId);
                if (tabContent) {
                    tabContent.classList.add('active');
                }
                
                // Adicionar classe ativa ao botão da aba selecionada
                const activeButton = document.querySelector(`#main-tabs a[href="#${tabId}"]`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
                
                // Atualizar charts se necessário
                if (tabId === 'detailed-dashboard') {
                    this.updateDetailedDashboard();
                }
            },
            
            // Carregar dados de exemplo
            loadSampleData() {
                console.log('Loading sample data...');
                
                // Reboques de exemplo
                this.data.reboques = [
                    { frota: "1101", tipo: "SEMI REBOQUE", acoplado: "7520", tipoAcoplado: "SEMI REBOQUE", status: "Operacional" },
                    { frota: "1102", tipo: "REBOQUE", acoplado: "", tipoAcoplado: "REBOQUE", status: "Operacional" },
                    { frota: "1103", tipo: "SEMI REBOQUE", acoplado: "", tipoAcoplado: "SEMI REBOQUE", status: "Em manutenção", dataParada: "2023-09-15", motivo: "Problema no sistema de freios" },
                    { frota: "1104", tipo: "DOLLY", acoplado: "", tipoAcoplado: "DOLLY", status: "Operacional" },
                    { frota: "1105", tipo: "REBOQUE", acoplado: "", tipoAcoplado: "REBOQUE", status: "Em reforma", dataParada: "2023-08-01", motivo: "Reforma geral da estrutura" },
                    { frota: "1106", tipo: "SEMI REBOQUE", acoplado: "7521", tipoAcoplado: "SEMI REBOQUE", status: "Operacional" },
                    { frota: "1107", tipo: "REBOQUE", acoplado: "", tipoAcoplado: "REBOQUE", status: "Operacional" },
                    { frota: "1108", tipo: "DOLLY", acoplado: "", tipoAcoplado: "DOLLY", status: "Em manutenção", dataParada: "2023-09-18", motivo: "Problema de suspensão" }
                ];
                
                // Caminhões próprios de exemplo
                this.data.caminhoesProps = [
                    { caminhao: "7520", status: "Operacional" },
                    { caminhao: "7521", status: "Operacional" },
                    { caminhao: "7522", status: "Em manutenção", data: "2023-09-17", motivo: "Manutenção preventiva" },
                    { caminhao: "7523", status: "Inoperante", data: "2023-08-10", motivo: "Problema no motor" },
                    { caminhao: "7524", status: "Operacional" },
                    { caminhao: "7525", status: "Operacional" }
                ];
                
                // Caminhões terceiros de exemplo
                this.data.caminhoesTerc = [
                    { caminhao: "T001", proprietario: "Transportes Silva", reboques: "1201-1202", status: "Operacional" },
                    { caminhao: "T002", proprietario: "LogTrans", reboques: "1203", status: "Em manutenção", motivo: "Manutenção no proprietário" },
                    { caminhao: "T003", proprietario: "FreteSeguro", reboques: "1204-1205", status: "Operacional" },
                    { caminhao: "T004", proprietario: "Transportes Silva", reboques: "1206", status: "Operacional" }
                ];
                
                // Frente 4001 - Colhedoras de exemplo
                this.data.frente4001Colhedoras = [
                    { codigo: "C101", status: "Operacional" },
                    { codigo: "C102", status: "Em manutenção", data: "2023-09-14", motivo: "Manutenção preventiva" },
                    { codigo: "C103", status: "Operacional" },
                    { codigo: "C104", status: "Inoperante", data: "2023-07-20", motivo: "Aguardando peças de reposição" }
                ];
                
                // Frente 4001 - Trações de exemplo
                this.data.frente4001Tracoes = [
                    { codigo: "T101", status: "Operacional" },
                    { codigo: "T102", status: "Operacional" },
                    { codigo: "T103", status: "Em manutenção", data: "2023-09-16", motivo: "Problema hidráulico" },
                    { codigo: "T104", status: "Operacional" }
                ];
                
                // Frente 4002 - Colhedoras de exemplo
                this.data.frente4002Colhedoras = [
                    { codigo: "C201", status: "Operacional" },
                    { codigo: "C202", status: "Operacional" },
                    { codigo: "C203", status: "Em reforma", data: "2023-08-15", motivo: "Reforma completa" },
                    { codigo: "C204", status: "Em manutenção", data: "2023-09-12", motivo: "Substituição de peças" }
                ];
                
                // Frente 4002 - Trações de exemplo
                this.data.frente4002Tracoes = [
                    { codigo: "T201", status: "Operacional" },
                    { codigo: "T202", status: "Em manutenção", data: "2023-09-13", motivo: "Manutenção preventiva" },
                    { codigo: "T203", status: "Operacional" },
                    { codigo: "T204", status: "Operacional" }
                ];
                
                // Histórico de exemplo
                this.data.history = {
                    "1103": [
                        {
                            date: "2023-09-15T10:30:00.000Z",
                            status: "Em manutenção",
                            description: "Status alterado para Em manutenção - Motivo: Problema no sistema de freios",
                            user: "João Silva"
                        },
                        {
                            date: "2023-09-01T08:15:00.000Z",
                            status: "Operacional",
                            description: "Status alterado para Operacional após manutenção preventiva",
                            user: "Maria Oliveira"
                        }
                    ],
                    "7522": [
                        {
                            date: "2023-09-17T14:20:00.000Z",
                            status: "Em manutenção",
                            description: "Status alterado para Em manutenção - Motivo: Manutenção preventiva",
                            user: "Carlos Santos"
                        },
                        {
                            date: "2023-08-25T11:45:00.000Z",
                            status: "Operacional",
                            description: "Status alterado para Operacional",
                            user: "Ana Pereira"
                        }
                    ]
                };
                
                // Agendamentos de manutenção de exemplo
                this.data.schedules = [
                    {
                        equipment: "1104",
                        equipmentType: "Reboque",
                        date: "2023-10-10",
                        time: "08:00",
                        type: "preventiva",
                        description: "Manutenção preventiva de rotina",
                        responsible: "Carlos Santos",
                        created: "2023-09-15T10:30:00.000Z",
                        status: "Agendado"
                    },
                    {
                        equipment: "7520",
                        equipmentType: "Caminhão Próprio",
                        date: "2023-10-12",
                        time: "09:30",
                        type: "troca-oleo",
                        description: "Troca de óleo e filtros",
                        responsible: "João Silva",
                        created: "2023-09-16T14:20:00.000Z",
                        status: "Agendado"
                    },
                    {
                        equipment: "C102",
                        equipmentType: "Colhedora Frente 4001",
                        date: "2023-10-15",
                        time: "13:00",
                        type: "corretiva",
                        description: "Reparo no sistema hidráulico",
                        responsible: "Ana Pereira",
                        created: "2023-09-17T09:15:00.000Z",
                        status: "Agendado"
                    }
                ];
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Configurar gráficos
            setupCharts() {
                console.log('Setting up charts...');
                
                // Definir cores
                const chartColors = {
                    operational: '#10B981', // Verde
                    maintenance: '#F59E0B', // Amarelo
                    reform: '#EF4444',      // Vermelho
                    borrowed: '#3B82F6',    // Azul
                    other: '#6B7280',       // Cinza
                    primary: '#5D5CDE',     // Cor primária
                    backgroundColor: window.matchMedia('(prefers-color-scheme: dark)').matches ? '#1F1F1F' : '#FFFFFF',
                    textColor: window.matchMedia('(prefers-color-scheme: dark)').matches ? '#E5E7EB' : '#374151'
                };
                
                // Configurações globais dos gráficos
                Chart.defaults.color = chartColors.textColor;
                Chart.defaults.font.family = "'Inter', 'Helvetica', 'Arial', sans-serif";
                
                // 1. Gráfico de status dos equipamentos
                const equipmentStatusCtx = document.getElementById('equipment-status-chart').getContext('2d');
                this.data.charts.equipmentStatusChart = new Chart(equipmentStatusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Operacionais', 'Em Manutenção', 'Em Reforma/Inoperantes', 'Emprestados', 'Outros'],
                        datasets: [{
                            data: [0, 0, 0, 0, 0],
                            backgroundColor: [
                                chartColors.operational,
                                chartColors.maintenance,
                                chartColors.reform,
                                chartColors.borrowed,
                                chartColors.other
                            ],
                            borderWidth: 0,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true,
                                    pointStyle: 'circle'
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        let value = context.raw || 0;
                                        let total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        let percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        cutout: '65%'
                    }
                });
                
                // 2. Gráfico de tendência de disponibilidade
                const availabilityTrendCtx = document.getElementById('detailed-availability-trend-chart').getContext('2d');
                this.data.charts.detailedAvailabilityTrendChart = new Chart(availabilityTrendCtx, {
                    type: 'line',
                    data: {
                        labels: ['3 meses atrás', '2 meses atrás', 'Atual'],
                        datasets: [{
                            label: 'Disponibilidade (%)',
                            data: [0, 0, 0],
                            backgroundColor: 'rgba(93, 92, 222, 0.2)',
                            borderColor: chartColors.primary,
                            borderWidth: 2,
                            pointBackgroundColor: chartColors.primary,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            fill: true,
                            tension: 0.3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `Disponibilidade: ${context.raw}%`;
                                    }
                                }
                            }
                        }
                    }
                });
                
                // 3. Gráfico de causas de manutenção
                const maintenanceCausesCtx = document.getElementById('detailed-maintenance-causes-chart').getContext('2d');
                this.data.charts.detailedMaintenanceCausesChart = new Chart(maintenanceCausesCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Desgaste Normal', 'Falha Mecânica', 'Problemas Elétricos', 'Manutenção Preventiva', 'Outros'],
                        datasets: [{
                            label: 'Quantidade',
                            data: [0, 0, 0, 0, 0],
                            backgroundColor: [
                                'rgba(93, 92, 222, 0.8)',
                                'rgba(93, 92, 222, 0.6)',
                                'rgba(93, 92, 222, 0.4)',
                                'rgba(93, 92, 222, 0.3)',
                                'rgba(93, 92, 222, 0.2)'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
                
                // 4. Gráfico de previsão
                const forecastCtx = document.getElementById('detailed-forecast-chart').getContext('2d');
                this.data.charts.detailedForecastChart = new Chart(forecastCtx, {
                    type: 'line',
                    data: {
                        labels: ['3 meses atrás', '2 meses atrás', 'Atual', '+1 mês', '+2 meses', '+3 meses'],
                        datasets: [
                            {
                                label: 'Histórico',
                                data: [0, 0, 0, null, null, null],
                                borderColor: chartColors.primary,
                                backgroundColor: 'rgba(93, 92, 222, 0.2)',
                                fill: true,
                                tension: 0.3,
                                pointRadius: 4,
                                pointHoverRadius: 6
                            },
                            {
                                label: 'Previsão',
                                data: [null, null, null, 0, 0, 0],
                                borderColor: 'rgba(93, 92, 222, 0.5)',
                                borderDash: [5, 5],
                                backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                fill: true,
                                tension: 0.3,
                                pointRadius: 4,
                                pointHoverRadius: 6
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        if (context.raw === null) return null;
                                        return `${context.dataset.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        }
                    }
                });
                
                // Atualizar gráficos quando a preferência de cores mudar
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    const newTextColor = event.matches ? '#E5E7EB' : '#374151';
                    Chart.defaults.color = newTextColor;
                    
                    this.updateAllCharts();
                });
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                this.updateEquipmentStatusChart();
                if (document.getElementById('detailed-dashboard').classList.contains('active')) {
                    this.updateDetailedDashboard();
                }
            },
            
            // Atualizar gráfico de status dos equipamentos
            updateEquipmentStatusChart() {
                if (!this.data.charts.equipmentStatusChart) return;
                
                // Calcular totais
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                const borrowed = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Emprestado').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Emprestado').length;
                
                const other = 
                    this.data.reboques.filter(r => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(r.status)
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)
                    ).length;
                
                // Atualizar dados do gráfico
                this.data.charts.equipmentStatusChart.data.datasets[0].data = [
                    operational, maintenance, reform, borrowed, other
                ];
                
                // Atualizar o gráfico
                this.data.charts.equipmentStatusChart.update();
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateMainDashboard();
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
                this.updateDetailedDashboard();
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCPTable();
                this.renderCTTable();
                this.renderF4001Tables();
                this.renderF4002Tables();
            },
            
            // Renderizar tabela de reboques
            renderReboquesTable() {
                const tableBody = document.getElementById('reboques-table-body');
                if (!tableBody) return;
                
                // Filtrar dados com base no termo de pesquisa
                const filteredData = this.filterData(this.data.reboques);
                
                // Atualizar contador
                document.getElementById('reboques-count').textContent = `${filteredData.length} reboques`;
                
                // Gerar HTML para a tabela
                let html = '';
                
                if (filteredData.length === 0) {
                    html = `
                        <tr>
                            <td colspan="7" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhum reboque encontrado.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredData.forEach((reboque, index) => {
                        const dataFormatada = reboque.dataParada ? new Date(reboque.dataParada).toLocaleDateString('pt-BR') : '';
                        
                        html += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${reboque.frota}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${reboque.tipo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${reboque.acoplado || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        reboque.status === 'Operacional' ? 'status-badge-operational' :
                                        reboque.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${reboque.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${reboque.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Reboque', '${reboque.frota}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Reboque', '${reboque.frota}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Reboque', '${reboque.frota}', ${index}, 'reboques')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                tableBody.innerHTML = html;
            },
            
            // Renderizar tabela de caminhões próprios
            renderCPTable() {
                const tableBody = document.getElementById('cp-table-body');
                if (!tableBody) return;
                
                // Filtrar dados com base no termo de pesquisa
                const filteredData = this.filterData(this.data.caminhoesProps);
                
                // Atualizar contador
                document.getElementById('cp-table-count').textContent = `${filteredData.length} caminhões`;
                
                // Gerar HTML para a tabela
                let html = '';
                
                if (filteredData.length === 0) {
                    html = `
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhum caminhão próprio encontrado.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredData.forEach((caminhao, index) => {
                        const dataFormatada = caminhao.data ? new Date(caminhao.data).toLocaleDateString('pt-BR') : '';
                        
                        html += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${caminhao.caminhao}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        caminhao.status === 'Operacional' ? 'status-badge-operational' :
                                        caminhao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${caminhao.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${caminhao.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Caminhão Próprio', '${caminhao.caminhao}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Caminhão Próprio', '${caminhao.caminhao}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Caminhão Próprio', '${caminhao.caminhao}', ${index}, 'caminhoesProps')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                tableBody.innerHTML = html;
            },
            
            // Renderizar tabela de caminhões terceiros
            renderCTTable() {
                const tableBody = document.getElementById('ct-table-body');
                if (!tableBody) return;
                
                // Filtrar dados com base no termo de pesquisa
                const filteredData = this.filterData(this.data.caminhoesTerc);
                
                // Atualizar contador
                document.getElementById('ct-table-count').textContent = `${filteredData.length} caminhões`;
                
                // Gerar HTML para a tabela
                let html = '';
                
                if (filteredData.length === 0) {
                    html = `
                        <tr>
                            <td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhum caminhão terceiro encontrado.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredData.forEach((caminhao, index) => {
                        html += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${caminhao.caminhao}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${caminhao.proprietario || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${caminhao.reboques || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        caminhao.status === 'Operacional' ? 'status-badge-operational' :
                                        caminhao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${caminhao.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${caminhao.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Caminhão Terceiro', '${caminhao.caminhao}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Caminhão Terceiro', '${caminhao.caminhao}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Caminhão Terceiro', '${caminhao.caminhao}', ${index}, 'caminhoesTerc')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                tableBody.innerHTML = html;
            },
            
            // Renderizar tabelas da frente 4001
            renderF4001Tables() {
                // Tabela de colhedoras
                const colhedorasBody = document.getElementById('f4001-colhedoras-body');
                if (!colhedorasBody) return;
                
                // Filtrar dados com base no termo de pesquisa
                const filteredColhedoras = this.filterData(this.data.frente4001Colhedoras);
                const filteredTracoes = this.filterData(this.data.frente4001Tracoes);
                
                // Atualizar contador
                document.getElementById('f4001-table-count').textContent = `${filteredColhedoras.length + filteredTracoes.length} equipamentos`;
                
                // Gerar HTML para a tabela de colhedoras
                let colhedorasHtml = '';
                
                if (filteredColhedoras.length === 0) {
                    colhedorasHtml = `
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhuma colhedora encontrada.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredColhedoras.forEach((colhedora, index) => {
                        const dataFormatada = colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '';
                        
                        colhedorasHtml += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${colhedora.codigo}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        colhedora.status === 'Operacional' ? 'status-badge-operational' :
                                        colhedora.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${colhedora.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${colhedora.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Colhedora Frente 4001', '${colhedora.codigo}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Colhedora Frente 4001', '${colhedora.codigo}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Colhedora Frente 4001', '${colhedora.codigo}', ${index}, 'frente4001Colhedoras')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                colhedorasBody.innerHTML = colhedorasHtml;
                
                // Tabela de trações
                const tracoesBody = document.getElementById('f4001-tracoes-body');
                if (!tracoesBody) return;
                
                // Gerar HTML para a tabela de trações
                let tracoesHtml = '';
                
                if (filteredTracoes.length === 0) {
                    tracoesHtml = `
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhuma tração encontrada.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredTracoes.forEach((tracao, index) => {
                        const dataFormatada = tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '';
                        
                        tracoesHtml += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${tracao.codigo}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        tracao.status === 'Operacional' ? 'status-badge-operational' :
                                        tracao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${tracao.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${tracao.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Tração Frente 4001', '${tracao.codigo}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Tração Frente 4001', '${tracao.codigo}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Tração Frente 4001', '${tracao.codigo}', ${index}, 'frente4001Tracoes')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                tracoesBody.innerHTML = tracoesHtml;
            },
            
            // Renderizar tabelas da frente 4002
            renderF4002Tables() {
                // Tabela de colhedoras
                const colhedorasBody = document.getElementById('f4002-colhedoras-body');
                if (!colhedorasBody) return;
                
                // Filtrar dados com base no termo de pesquisa
                const filteredColhedoras = this.filterData(this.data.frente4002Colhedoras);
                const filteredTracoes = this.filterData(this.data.frente4002Tracoes);
                
                // Atualizar contador
                document.getElementById('f4002-table-count').textContent = `${filteredColhedoras.length + filteredTracoes.length} equipamentos`;
                
                // Gerar HTML para a tabela de colhedoras
                let colhedorasHtml = '';
                
                if (filteredColhedoras.length === 0) {
                    colhedorasHtml = `
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhuma colhedora encontrada.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredColhedoras.forEach((colhedora, index) => {
                        const dataFormatada = colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '';
                        
                        colhedorasHtml += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${colhedora.codigo}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        colhedora.status === 'Operacional' ? 'status-badge-operational' :
                                        colhedora.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${colhedora.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${colhedora.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Colhedora Frente 4002', '${colhedora.codigo}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Colhedora Frente 4002', '${colhedora.codigo}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Colhedora Frente 4002', '${colhedora.codigo}', ${index}, 'frente4002Colhedoras')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                colhedorasBody.innerHTML = colhedorasHtml;
                
                // Tabela de trações
                const tracoesBody = document.getElementById('f4002-tracoes-body');
                if (!tracoesBody) return;
                
                // Gerar HTML para a tabela de trações
                let tracoesHtml = '';
                
                if (filteredTracoes.length === 0) {
                    tracoesHtml = `
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400">
                                Nenhuma tração encontrada.
                            </td>
                        </tr>
                    `;
                } else {
                    filteredTracoes.forEach((tracao, index) => {
                        const dataFormatada = tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '';
                        
                        tracoesHtml += `
                            <tr class="${index % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-750'}">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200">${tracao.codigo}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span class="status-badge ${
                                        tracao.status === 'Operacional' ? 'status-badge-operational' :
                                        tracao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                        'status-badge-reform'
                                    }">
                                        ${tracao.status}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">${dataFormatada}</td>
                                <td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">${tracao.motivo || '-'}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.editEquipment('Tração Frente 4002', '${tracao.codigo}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="text-primary hover:text-secondary mr-3" onclick="fleetManager.viewEquipmentHistory('Tração Frente 4002', '${tracao.codigo}')">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400" onclick="fleetManager.confirmDeleteEquipment('Tração Frente 4002', '${tracao.codigo}', ${index}, 'frente4002Tracoes')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                }
                
                tracoesBody.innerHTML = tracoesHtml;
            },
            
            // Atualizar dashboard principal
            updateMainDashboard() {
                // Contar todos os equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Calcular operacionais
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                // Calcular em manutenção
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                // Calcular em reforma ou inoperante
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular emprestados
                const borrowed = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Emprestado').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Emprestado').length;
                
                const other = 
                    this.data.reboques.filter(r => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(r.status)
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)
                    ).length;
                
                // Atualizar elementos do dashboard
                document.getElementById('dash-summary-operational').textContent = operational;
                document.getElementById('dash-summary-maintenance').textContent = maintenance;
                document.getElementById('dash-summary-reform').textContent = reform;
                document.getElementById('dash-summary-borrowed').textContent = borrowed;
                document.getElementById('dash-summary-other').textContent = other;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round(operational / totalEquipments * 100) : 0;
                document.getElementById('dash-summary-availability').textContent = `${availability}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('dash-availability-bar').style.width = `${availability}%`;
                
                // Atualizar contagens por tipo
                // - Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesManutencao = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                document.getElementById('dash-reboques-count').textContent = reboquesTotal;
                document.getElementById('dash-reboques-operational').textContent = reboquesOperacional;
                document.getElementById('dash-reboques-maintenance').textContent = reboquesManutencao;
                
                // Atualizar barra de disponibilidade de reboques
                const reboquesAvailability = reboquesTotal > 0 ? Math.round(reboquesOperacional / reboquesTotal * 100) : 0;
                document.getElementById('dash-reboques-bar').style.width = `${reboquesAvailability}%`;
                
                // - Caminhões
                const cpTotal = this.data.caminhoesProps.length;
                const cpOperacional = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpManutencao = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                document.getElementById('dash-cp-count').textContent = cpTotal;
                document.getElementById('dash-cp-operational').textContent = cpOperacional;
                document.getElementById('dash-cp-maintenance').textContent = cpManutencao;
                
                // Atualizar barra de disponibilidade de caminhões próprios
                const cpAvailability = cpTotal > 0 ? Math.round(cpOperacional / cpTotal * 100) : 0;
                document.getElementById('dash-cp-bar').style.width = `${cpAvailability}%`;
                
                // - Frente 4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                document.getElementById('dash-f4001-count').textContent = f4001Total;
                document.getElementById('dash-f4001-operational').textContent = f4001Operacional;
                document.getElementById('dash-f4001-maintenance').textContent = f4001Manutencao;
                
                // Atualizar barra de disponibilidade da frente 4001
                const f4001Availability = f4001Total > 0 ? Math.round(f4001Operacional / f4001Total * 100) : 0;
                document.getElementById('dash-f4001-bar').style.width = `${f4001Availability}%`;
                
                // - Frente 4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                document.getElementById('dash-f4002-count').textContent = f4002Total;
                document.getElementById('dash-f4002-operational').textContent = f4002Operacional;
                document.getElementById('dash-f4002-maintenance').textContent = f4002Manutencao;
                
                // Atualizar barra de disponibilidade da frente 4002
                const f4002Availability = f4002Total > 0 ? Math.round(f4002Operacional / f4002Total * 100) : 0;
                document.getElementById('dash-f4002-bar').style.width = `${f4002Availability}%`;
                
                // Atualizar lista de equipamentos em manutenção
                this.updateMaintenanceList();
                
                // Atualizar lista de manutenções agendadas
                this.updateUpcomingMaintenanceList();
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                // Atualizar contagens
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-reform').textContent = reform;
                
                // Calcular percentuais
                const operationalPercent = total > 0 ? Math.round(operational / total * 100) : 0;
                const maintenancePercent = total > 0 ? Math.round(maintenance / total * 100) : 0;
                const reformPercent = total > 0 ? Math.round(reform / total * 100) : 0;
                
                document.getElementById('reboques-operational-percentage').textContent = `${operationalPercent}%`;
                document.getElementById('reboques-maintenance-percentage').textContent = `${maintenancePercent}%`;
                document.getElementById('reboques-reform-percentage').textContent = `${reformPercent}%`;
                
                // Atualizar disponibilidade
                document.getElementById('reboques-availability').textContent = `${operationalPercent}%`;
                document.getElementById('reboques-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                const total = this.data.caminhoesProps.length;
                const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const reform = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                // Atualizar contagens
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-reform').textContent = reform;
                
                // Calcular percentuais
                const operationalPercent = total > 0 ? Math.round(operational / total * 100) : 0;
                const maintenancePercent = total > 0 ? Math.round(maintenance / total * 100) : 0;
                const reformPercent = total > 0 ? Math.round(reform / total * 100) : 0;
                
                document.getElementById('cp-operational-percentage').textContent = `${operationalPercent}%`;
                document.getElementById('cp-maintenance-percentage').textContent = `${maintenancePercent}%`;
                document.getElementById('cp-reform-percentage').textContent = `${reformPercent}%`;
                
                // Atualizar disponibilidade
                document.getElementById('cp-availability').textContent = `${operationalPercent}%`;
                document.getElementById('cp-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                const total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const operational = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const maintenance = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                const reform = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Atualizar contagens
                document.getElementById('f4001-total').textContent = total;
                document.getElementById('f4001-operational').textContent = operational;
                document.getElementById('f4001-maintenance').textContent = maintenance;
                document.getElementById('f4001-reform').textContent = reform;
                
                // Atualizar disponibilidade
                const availability = total > 0 ? Math.round(operational / total * 100) : 0;
                document.getElementById('f4001-availability').textContent = `${availability}%`;
                document.getElementById('f4001-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                const total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const operational = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const maintenance = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                const reform = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Atualizar contagens
                document.getElementById('f4002-total').textContent = total;
                document.getElementById('f4002-operational').textContent = operational;
                document.getElementById('f4002-maintenance').textContent = maintenance;
                document.getElementById('f4002-reform').textContent = reform;
                
                // Atualizar disponibilidade
                const availability = total > 0 ? Math.round(operational / total * 100) : 0;
                document.getElementById('f4002-availability').textContent = `${availability}%`;
                document.getElementById('f4002-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard detalhado
            updateDetailedDashboard() {
                // Contar todos os equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                document.getElementById('detailed-total-equipment').textContent = totalEquipments;
                
                // Calcular operacionais
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const operationalPercentage = totalEquipments > 0 ? Math.round(operational / totalEquipments * 100) : 0;
                document.getElementById('detailed-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('detailed-operational-bar').style.width = `${operationalPercentage}%`;
                
                // Calcular total em manutenção
                const totalMaintenances = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('detailed-total-maintenances').textContent = totalMaintenances;
                
                // Atualizar análise por categoria
                
                // 1. Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesAvailability = reboquesTotal > 0 ? Math.round(reboquesOperational / reboquesTotal * 100) : 0;
                
                document.getElementById('detailed-reboques-count').textContent = reboquesTotal;
                document.getElementById('detailed-reboques-availability').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-value').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-bar').style.width = `${reboquesAvailability}%`;
                
                // 2. Caminhões Próprios
                const cpTotal = this.data.caminhoesProps.length;
                const cpOperational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpAvailability = cpTotal > 0 ? Math.round(cpOperational / cpTotal * 100) : 0;
                
                document.getElementById('detailed-cp-count').textContent = cpTotal;
                document.getElementById('detailed-cp-availability').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-value').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-bar').style.width = `${cpAvailability}%`;
                
                // 3. Caminhões Terceiros
                const ctTotal = this.data.caminhoesTerc.length;
                const ctOperational = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctAvailability = ctTotal > 0 ? Math.round(ctOperational / ctTotal * 100) : 0;
                
                document.getElementById('detailed-ct-count').textContent = ctTotal;
                document.getElementById('detailed-ct-availability').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-value').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-bar').style.width = `${ctAvailability}%`;
                
                // 4. Frente 4001 - Colhedoras
                const f4001ColhTotal = this.data.frente4001Colhedoras.length;
                const f4001ColhOperational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                const f4001ColhAvailability = f4001ColhTotal > 0 ? Math.round(f4001ColhOperational / f4001ColhTotal * 100) : 0;
                
                document.getElementById('detailed-f4001-colh-count').textContent = f4001ColhTotal;
                document.getElementById('detailed-f4001-colh-availability').textContent = `${f4001ColhAvailability}%`;
                document.getElementById('detailed-f4001-colh-avail-value').textContent = `${f4001ColhAvailability}%`;
                document.getElementById('detailed-f4001-colh-avail-bar').style.width = `${f4001ColhAvailability}%`;
                
                // 5. Frente 4001 - Trações
                const f4001TracTotal = this.data.frente4001Tracoes.length;
                const f4001TracOperational = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001TracAvailability = f4001TracTotal > 0 ? Math.round(f4001TracOperational / f4001TracTotal * 100) : 0;
                
                document.getElementById('detailed-f4001-trac-count').textContent = f4001TracTotal;
                document.getElementById('detailed-f4001-trac-availability').textContent = `${f4001TracAvailability}%`;
                document.getElementById('detailed-f4001-trac-avail-value').textContent = `${f4001TracAvailability}%`;
                document.getElementById('detailed-f4001-trac-avail-bar').style.width = `${f4001TracAvailability}%`;
                
                // 6. Frente 4002 - Colhedoras
                const f4002ColhTotal = this.data.frente4002Colhedoras.length;
                const f4002ColhOperational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                const f4002ColhAvailability = f4002ColhTotal > 0 ? Math.round(f4002ColhOperational / f4002ColhTotal * 100) : 0;
                
                document.getElementById('detailed-f4002-colh-count').textContent = f4002ColhTotal;
                document.getElementById('detailed-f4002-colh-availability').textContent = `${f4002ColhAvailability}%`;
                document.getElementById('detailed-f4002-colh-avail-value').textContent = `${f4002ColhAvailability}%`;
                document.getElementById('detailed-f4002-colh-avail-bar').style.width = `${f4002ColhAvailability}%`;
                
                // 7. Frente 4002 - Trações
                const f4002TracTotal = this.data.frente4002Tracoes.length;
                const f4002TracOperational = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002TracAvailability = f4002TracTotal > 0 ? Math.round(f4002TracOperational / f4002TracTotal * 100) : 0;
                
                document.getElementById('detailed-f4002-trac-count').textContent = f4002TracTotal;
                document.getElementById('detailed-f4002-trac-availability').textContent = `${f4002TracAvailability}%`;
                document.getElementById('detailed-f4002-trac-avail-value').textContent = `${f4002TracAvailability}%`;
                document.getElementById('detailed-f4002-trac-avail-bar').style.width = `${f4002TracAvailability}%`;
                
                // Atualizar dados do gráfico de tendência
                if (this.data.charts.detailedAvailabilityTrendChart) {
                    // Simular dados históricos com variações para o gráfico
                    const currentAvailability = operationalPercentage;
                    
                    // Criar dados simulados com variação para os últimos 3 meses (histórico)
                    const historicalData = [
                        Math.min(100, Math.max(60, currentAvailability - 5 + Math.floor(Math.random() * 10))),
                        Math.min(100, Math.max(60, currentAvailability - 2 + Math.floor(Math.random() * 6))),
                        currentAvailability
                    ];
                    
                    this.data.charts.detailedAvailabilityTrendChart.data.datasets[0].data = historicalData;
                    this.data.charts.detailedAvailabilityTrendChart.update();
                    
                    // Esconder a mensagem de "sem dados"
                    document.getElementById('detailed-trend-no-data').classList.add('hidden');
                }
                
                // Atualizar dados do gráfico de causas de manutenção
                if (this.data.charts.detailedMaintenanceCausesChart) {
                    // Criar dados simulados de causas de manutenção
                    const causesData = [
                        Math.floor(Math.random() * 20) + 10, // Desgaste normal
                        Math.floor(Math.random() * 15) + 5,  // Falha mecânica
                        Math.floor(Math.random() * 12) + 3,  // Problemas elétricos
                        Math.floor(Math.random() * 25) + 15, // Manutenção preventiva
                        Math.floor(Math.random() * 10) + 2   // Outros
                    ];
                    
                    this.data.charts.detailedMaintenanceCausesChart.data.datasets[0].data = causesData;
                    this.data.charts.detailedMaintenanceCausesChart.update();
                }
                
                // Atualizar dados do gráfico de previsão
                if (this.data.charts.detailedForecastChart) {
                    // Usar dados históricos simulados para mostrar tendência
                    const currentAvailability = operationalPercentage;
                    
                    // Histórico
                    const historicalData = [
                        Math.min(100, Math.max(60, currentAvailability - 5 + Math.floor(Math.random() * 10))),
                        Math.min(100, Math.max(60, currentAvailability - 2 + Math.floor(Math.random() * 6))),
                        currentAvailability,
                        null, null, null // Valores nulos para a parte de previsão
                    ];
                    
                    // Previsão (projeção baseada na tendência atual)
                    const forecastData = [
                        null, null, null, // Valores nulos para a parte histórica
                        Math.min(100, Math.max(60, currentAvailability + Math.floor(Math.random() * 4) - 1)), // +1 mês
                        Math.min(100, Math.max(60, currentAvailability + Math.floor(Math.random() * 6) - 2)), // +2 meses
                        Math.min(100, Math.max(60, currentAvailability + Math.floor(Math.random() * 8) - 3))  // +3 meses
                    ];
                    
                    this.data.charts.detailedForecastChart.data.datasets[0].data = historicalData;
                    this.data.charts.detailedForecastChart.data.datasets[1].data = forecastData;
                    this.data.charts.detailedForecastChart.update();
                    
                    // Esconder a mensagem de "sem dados"
                    document.getElementById('detailed-forecast-no-data').classList.add('hidden');
                }
                
                // Indicadores de desempenho (dados simulados)
                document.getElementById('detailed-mtbf').textContent = `${Math.floor(Math.random() * 150) + 200} horas`;
                document.getElementById('detailed-mttr').textContent = `${Math.floor(Math.random() * 8) + 4} horas`;
                document.getElementById('detailed-oee').textContent = `${Math.floor(Math.random() * 15) + 75}%`;
            },
            
            // Atualizar lista de equipamentos em manutenção
            updateMaintenanceList() {
                const container = document.getElementById('equipment-maintenance-list');
                if (!container) return;
                
                // Coletar todos os equipamentos em manutenção
                const reboques = this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                    id: r.frota,
                    type: 'Reboque',
                    date: r.dataParada || '',
                    reason: r.motivo || ''
                }));
                
                const caminhoesProps = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                    id: c.caminhao,
                    type: 'Caminhão Próprio',
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const caminhoesTerc = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                    id: c.caminhao,
                    type: 'Caminhão Terceiro',
                    date: '',
                    reason: c.motivo || ''
                }));
                
                const frente4001Colhedoras = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                    id: c.codigo,
                    type: 'Colhedora - Frente 4001',
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const frente4001Tracoes = this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                    id: t.codigo,
                    type: 'Tração - Frente 4001',
                    date: t.data || '',
                    reason: t.motivo || ''
                }));
                
                const frente4002Colhedoras = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                    id: c.codigo,
                    type: 'Colhedora - Frente 4002',
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const frente4002Tracoes = this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                    id: t.codigo,
                    type: 'Tração - Frente 4002',
                    date: t.data || '',
                    reason: t.motivo || ''
                }));
                
                // Combinar todos os equipamentos em manutenção
                const allMaintenances = [
                    ...reboques,
                    ...caminhoesProps,
                    ...caminhoesTerc,
                    ...frente4001Colhedoras,
                    ...frente4001Tracoes,
                    ...frente4002Colhedoras,
                    ...frente4002Tracoes
                ];
                
                // Ordenar por data (mais recente primeiro)
                allMaintenances.sort((a, b) => {
                    if (!a.date && !b.date) return 0;
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                // Limitar para mostrar apenas os 5 mais recentes
                const recentMaintenances = allMaintenances.slice(0, 5);
                
                if (recentMaintenances.length === 0) {
                    container.innerHTML = `
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                        </li>
                    `;
                    return;
                }
                
                // Gerar HTML
                let html = '';
                
                recentMaintenances.forEach(item => {
                    // Formatar data
                    let dataFormatada = '';
                    if (item.date) {
                        const data = new Date(item.date);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <li class="py-3">
                            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                                <div>
                                    <p class="text-base font-medium">${item.type} - ${item.id}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${item.reason || 'Sem motivo especificado'}</p>
                                </div>
                                <div class="mt-2 md:mt-0">
                                    <span class="text-sm py-1 px-2 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300 rounded-md">
                                        ${dataFormatada || 'Data não especificada'}
                                    </span>
                                </div>
                            </div>
                        </li>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            // Atualizar lista de manutenções agendadas
            updateUpcomingMaintenanceList() {
                const container = document.getElementById('upcoming-maintenance-list');
                if (!container) return;
                
                // Filtrar manutenções futuras (data maior que a atual)
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingSchedules = this.data.schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    return scheduleDate >= today;
                });
                
                // Ordenar por data (mais próxima primeiro)
                upcomingSchedules.sort((a, b) => {
                    return new Date(a.date) - new Date(b.date);
                });
                
                // Limitar para mostrar apenas as 5 mais próximas
                const nextSchedules = upcomingSchedules.slice(0, 5);
                
                if (nextSchedules.length === 0) {
                    container.innerHTML = `
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                        </li>
                    `;
                    return;
                }
                
                // Gerar HTML
                let html = '';
                
                nextSchedules.forEach(schedule => {
                    // Formatar data
                    const scheduleDate = new Date(schedule.date);
                    const dateFormatted = scheduleDate.toLocaleDateString('pt-BR');
                    
                    // Determinar tipo de manutenção
                    let maintenanceType = '';
                    let badgeClass = '';
                    
                    switch(schedule.type) {
                        case 'preventiva':
                            maintenanceType = 'Preventiva';
                            badgeClass = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300';
                            break;
                        case 'corretiva':
                            maintenanceType = 'Corretiva';
                            badgeClass = 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300';
                            break;
                        case 'revisao':
                            maintenanceType = 'Revisão';
                            badgeClass = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300';
                            break;
                        case 'troca-oleo':
                            maintenanceType = 'Troca de Óleo';
                            badgeClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300';
                            break;
                        case 'reforma':
                            maintenanceType = 'Reforma';
                            badgeClass = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300';
                            break;
                        default:
                            maintenanceType = 'Outro';
                            badgeClass = 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';
                    }
                    
                    html += `
                        <li class="py-3">
                            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                                <div>
                                    <p class="text-base font-medium">${schedule.equipmentType} - ${schedule.equipment}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">${schedule.description}</p>
                                </div>
                                <div class="mt-2 md:mt-0 flex flex-col md:flex-row md:items-center space-y-1 md:space-y-0 md:space-x-2">
                                    <span class="text-sm ${badgeClass} py-1 px-2 rounded-md">
                                        ${maintenanceType}
                                    </span>
                                    <span class="text-sm bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 py-1 px-2 rounded-md">
                                        ${dateFormatted} ${schedule.time}
                                    </span>
                                </div>
                            </div>
                        </li>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            // Inicializar visualização real da frota
            initializeRealEquipmentView() {
                const container = document.getElementById('real-equipment-container');
                if (!container) return;
                
                // Limpar container
                container.innerHTML = '';
                
                // Atualizar contador de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                document.getElementById('real-equipment-count').textContent = 
                    `${totalEquipments} equipamento${totalEquipments !== 1 ? 's' : ''}`;
                
                // Criar e adicionar cartões para todos os equipamentos
                this.createRealEquipmentCards(container);
            },
            
            // Criar cartões para a visualização real
            createRealEquipmentCards(container) {
                // Criar grid para cartões
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5';
                
                // Adicionar cartões para cada tipo de equipamento
                this.createReboquesCards(grid);
                this.createCaminhoesPropriosCards(grid);
                this.createCaminhoesTerceirosCards(grid);
                this.createF4001Cards(grid);
                this.createF4002Cards(grid);
                
                // Adicionar grid ao container
                container.appendChild(grid);
            },
            
            // Criar cartões para reboques
            createReboquesCards(container) {
                this.data.reboques.forEach(reboque => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(reboque.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card reboque-card';
                    card.dataset.id = reboque.frota;
                    card.dataset.type = 'reboque';
                    card.dataset.status = reboque.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-trailer ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Reboque ${reboque.frota}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">${reboque.tipo || 'Sem tipo'}</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    reboque.status === 'Operacional' ? 'status-badge-operational' :
                                    reboque.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${reboque.status}
                                </span>
                            </div>
                            
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Acoplado:</span>
                                    <span>${reboque.acoplado || 'Não'}</span>
                                </div>
                                ${reboque.status !== 'Operacional' ? `
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${reboque.dataParada ? new Date(reboque.dataParada).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${reboque.motivo || '-'}</span>
                                </div>
                                ` : ''}
                            </div>
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${reboque.frota}" data-type="Reboque">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${reboque.frota}" data-type="Reboque">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Reboque', reboque.frota);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Reboque', reboque.frota);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
            },
            
            // Criar cartões para caminhões próprios
            createCaminhoesPropriosCards(container) {
                this.data.caminhoesProps.forEach(caminhao => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card caminhao-card';
                    card.dataset.id = caminhao.caminhao;
                    card.dataset.type = 'caminhao';
                    card.dataset.status = caminhao.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-truck ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Caminhão ${caminhao.caminhao}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Próprio</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    caminhao.status === 'Operacional' ? 'status-badge-operational' :
                                    caminhao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${caminhao.status}
                                </span>
                            </div>
                            
                            ${caminhao.status !== 'Operacional' ? `
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${caminhao.data ? new Date(caminhao.data).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${caminhao.motivo || '-'}</span>
                                </div>
                            </div>
                            ` : '<div class="mt-3"></div>'}
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Caminhão Próprio', caminhao.caminhao);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Caminhão Próprio', caminhao.caminhao);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
            },
            
            // Criar cartões para caminhões terceiros
            createCaminhoesTerceirosCards(container) {
                this.data.caminhoesTerc.forEach(caminhao => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Inoperante':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card caminhao-card';
                    card.dataset.id = caminhao.caminhao;
                    card.dataset.type = 'caminhao';
                    card.dataset.status = caminhao.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-truck-moving ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Caminhão ${caminhao.caminhao}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">${caminhao.proprietario || 'Terceiro'}</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    caminhao.status === 'Operacional' ? 'status-badge-operational' :
                                    caminhao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${caminhao.status}
                                </span>
                            </div>
                            
                            <div class="mt-3 text-sm">
                                ${caminhao.reboques ? `<div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Reboques:</span>
                                    <span>${caminhao.reboques}</span>
                                </div>` : ''}
                                ${caminhao.status !== 'Operacional' ? `
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${caminhao.motivo || '-'}</span>
                                </div>` : ''}
                            </div>
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Caminhão Terceiro', caminhao.caminhao);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Caminhão Terceiro', caminhao.caminhao);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
            },
            
            // Criar cartões para equipamentos da frente 4001
            createF4001Cards(container) {
                // Colhedoras
                this.data.frente4001Colhedoras.forEach(colhedora => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(colhedora.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card colhedora-card frente4001-card';
                    card.dataset.id = colhedora.codigo;
                    card.dataset.type = 'colhedora';
                    card.dataset.status = colhedora.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-tractor ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Colhedora ${colhedora.codigo}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Frente 4001</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    colhedora.status === 'Operacional' ? 'status-badge-operational' :
                                    colhedora.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${colhedora.status}
                                </span>
                            </div>
                            
                            ${colhedora.status !== 'Operacional' ? `
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${colhedora.motivo || '-'}</span>
                                </div>
                            </div>
                            ` : '<div class="mt-3"></div>'}
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${colhedora.codigo}" data-type="Colhedora Frente 4001">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${colhedora.codigo}" data-type="Colhedora Frente 4001">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Colhedora Frente 4001', colhedora.codigo);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Colhedora Frente 4001', colhedora.codigo);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
                
                // Trações
                this.data.frente4001Tracoes.forEach(tracao => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(tracao.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card tracao-card frente4001-card';
                    card.dataset.id = tracao.codigo;
                    card.dataset.type = 'tracao';
                    card.dataset.status = tracao.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-truck-monster ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Tração ${tracao.codigo}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Frente 4001</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    tracao.status === 'Operacional' ? 'status-badge-operational' :
                                    tracao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${tracao.status}
                                </span>
                            </div>
                            
                            ${tracao.status !== 'Operacional' ? `
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${tracao.motivo || '-'}</span>
                                </div>
                            </div>
                            ` : '<div class="mt-3"></div>'}
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${tracao.codigo}" data-type="Tração Frente 4001">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${tracao.codigo}" data-type="Tração Frente 4001">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Tração Frente 4001', tracao.codigo);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Tração Frente 4001', tracao.codigo);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
            },
            
            // Criar cartões para equipamentos da frente 4002
            createF4002Cards(container) {
                // Colhedoras
                this.data.frente4002Colhedoras.forEach(colhedora => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(colhedora.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card colhedora-card frente4002-card';
                    card.dataset.id = colhedora.codigo;
                    card.dataset.type = 'colhedora';
                    card.dataset.status = colhedora.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-tractor ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Colhedora ${colhedora.codigo}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Frente 4002</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    colhedora.status === 'Operacional' ? 'status-badge-operational' :
                                    colhedora.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${colhedora.status}
                                </span>
                            </div>
                            
                            ${colhedora.status !== 'Operacional' ? `
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${colhedora.motivo || '-'}</span>
                                </div>
                            </div>
                            ` : '<div class="mt-3"></div>'}
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${colhedora.codigo}" data-type="Colhedora Frente 4002">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${colhedora.codigo}" data-type="Colhedora Frente 4002">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Colhedora Frente 4002', colhedora.codigo);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Colhedora Frente 4002', colhedora.codigo);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
                
                // Trações
                this.data.frente4002Tracoes.forEach(tracao => {
                    // Determinar cor baseada no status
                    let statusColor = '';
                    let statusBgColor = '';
                    
                    switch(tracao.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBgColor = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBgColor = 'bg-red-100 dark:bg-red-900';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBgColor = 'bg-gray-100 dark:bg-gray-700';
                    }
                    
                    // Criar cartão
                    const card = document.createElement('div');
                    card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden equipment-card tracao-card frente4002-card';
                    card.dataset.id = tracao.codigo;
                    card.dataset.type = 'tracao';
                    card.dataset.status = tracao.status.toLowerCase().replace(/\s+/g, '-');
                    
                    card.innerHTML = `
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full ${statusBgColor} flex items-center justify-center">
                                        <i class="fas fa-truck-monster ${statusColor} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-medium">Tração ${tracao.codigo}</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Frente 4002</p>
                                    </div>
                                </div>
                                <span class="status-badge ${
                                    tracao.status === 'Operacional' ? 'status-badge-operational' :
                                    tracao.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                    'status-badge-reform'
                                }">
                                    ${tracao.status}
                                </span>
                            </div>
                            
                            ${tracao.status !== 'Operacional' ? `
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Data:</span>
                                    <span>${tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '-'}</span>
                                </div>
                                <div class="flex justify-between py-1">
                                    <span class="text-gray-500 dark:text-gray-400">Motivo:</span>
                                    <span>${tracao.motivo || '-'}</span>
                                </div>
                            </div>
                            ` : '<div class="mt-3"></div>'}
                            
                            <div class="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-2">
                                <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm" data-id="${tracao.codigo}" data-type="Tração Frente 4002">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                                <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-sm" data-id="${tracao.codigo}" data-type="Tração Frente 4002">
                                    <i class="fas fa-calendar-plus mr-1"></i> Agendar
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Adicionar event listeners
                    card.querySelector('.view-history-btn').addEventListener('click', () => {
                        this.viewEquipmentHistory('Tração Frente 4002', tracao.codigo);
                    });
                    
                    card.querySelector('.schedule-btn').addEventListener('click', () => {
                        this.scheduleEquipmentMaintenance('Tração Frente 4002', tracao.codigo);
                    });
                    
                    // Adicionar cartão ao container
                    container.appendChild(card);
                });
            },
            
            // Filtrar equipamentos na visualização real
            filterRealEquipment(filter) {
                const cards = document.querySelectorAll('.equipment-card');
                
                cards.forEach(card => {
                    // Remover classe de destaque
                    card.classList.remove('ring-4', 'ring-primary', 'ring-offset-4');
                    
                    // Aplicar filtro
                    switch(filter) {
                        case 'all':
                            card.classList.remove('hidden');
                            break;
                        case 'operational':
                            card.classList.toggle('hidden', card.dataset.status !== 'operacional');
                            break;
                        case 'maintenance':
                            card.classList.toggle('hidden', card.dataset.status !== 'em-manutenção');
                            break;
                        case 'reform':
                            card.classList.toggle('hidden', !['em-reforma', 'inoperante', 'aguardando-reforma'].includes(card.dataset.status));
                            break;
                        case 'reboques':
                            card.classList.toggle('hidden', !card.classList.contains('reboque-card'));
                            break;
                        case 'caminhoes':
                            card.classList.toggle('hidden', !card.classList.contains('caminhao-card'));
                            break;
                        case 'colhedoras':
                            card.classList.toggle('hidden', !card.classList.contains('colhedora-card'));
                            break;
                        case 'tracoes':
                            card.classList.toggle('hidden', !card.classList.contains('tracao-card'));
                            break;
                        case 'frente4001':
                            card.classList.toggle('hidden', !card.classList.contains('frente4001-card'));
                            break;
                        case 'frente4002':
                            card.classList.toggle('hidden', !card.classList.contains('frente4002-card'));
                            break;
                    }
                });
                
                // Contar equipamentos visíveis
                const visibleCount = document.querySelectorAll('.equipment-card:not(.hidden)').length;
                document.getElementById('real-equipment-count').textContent = 
                    `${visibleCount} equipamento${visibleCount !== 1 ? 's' : ''}`;
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                // Limpar qualquer formulário anterior
                this.updateAddFormFields();
                
                // Mostrar modal
                document.getElementById('add-modal').classList.remove('hidden');
            },
            
            // Atualizar os campos do formulário de adição baseado no tipo selecionado
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const formContainer = document.getElementById('add-form-fields');
                
                let html = '';
                
                switch(type) {
                    case 'reboque':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número da Frota</label>
                                <input type="text" id="add-frota" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 1101" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Reboque</label>
                                <select id="add-tipo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="SEMI REBOQUE">SEMI REBOQUE</option>
                                    <option value="REBOQUE">REBOQUE</option>
                                    <option value="DOLLY">DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Acoplado a (opcional)</label>
                                <input type="text" id="add-acoplado" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 7520">
                            </div>
                            <div id="reason-fields" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="add-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="add-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'caminhao-proprio':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número do Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 7520" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Emprestado">Emprestado</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="add-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="add-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'caminhao-terceiro':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número/Código do Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: T001" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Proprietário</label>
                                <input type="text" id="add-proprietario" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: Transportes Silva">
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Reboques (opcional)</label>
                                <input type="text" id="add-reboques" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 1201-1202">
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="add-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'colhedora-4001':
                    case 'colhedora-4002':
                        const frente = type === 'colhedora-4001' ? '4001' : '4002';
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da Colhedora</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: C101" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="add-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="add-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'tracao-4001':
                    case 'tracao-4002':
                        const frenteTraca = type === 'tracao-4001' ? '4001' : '4002';
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da Tração</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: T101" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="add-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="add-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                                </div>
                            </div>
                        `;
                        break;
                }
                
                formContainer.innerHTML = html;
                
                // Configurar visibilidade do campo de motivo baseado no status
                const statusField = document.getElementById('add-status');
                if (statusField) {
                    statusField.addEventListener('change', () => {
                        const reasonFields = document.getElementById('reason-fields');
                        if (statusField.value === 'Operacional') {
                            reasonFields.classList.add('hidden');
                        } else {
                            reasonFields.classList.remove('hidden');
                        }
                    });
                }
            },
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                
                try {
                    switch(type) {
                        case 'reboque':
                            this.saveNewReboque();
                            break;
                        case 'caminhao-proprio':
                            this.saveNewCaminhaoProprio();
                            break;
                        case 'caminhao-terceiro':
                            this.saveNewCaminhaoTerceiro();
                            break;
                        case 'colhedora-4001':
                            this.saveNewColhedora4001();
                            break;
                        case 'tracao-4001':
                            this.saveNewTracao4001();
                            break;
                        case 'colhedora-4002':
                            this.saveNewColhedora4002();
                            break;
                        case 'tracao-4002':
                            this.saveNewTracao4002();
                            break;
                    }
                    
                    // Fechar modal
                    document.getElementById('add-modal').classList.add('hidden');
                    
                    // Atualizar visualizações
                    this.renderAllTables();
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.initializeRealEquipmentView();
                    
                    // Mostrar notificação
                    this.showNotification('success', 'Sucesso', 'Equipamento adicionado com sucesso!');
                    
                } catch (error) {
                    this.showNotification('error', 'Erro', error.message);
                }
            },
            
            // Salvar novo reboque
            saveNewReboque() {
                const frota = document.getElementById('add-frota').value.trim();
                if (!frota) {
                    throw new Error('O número da frota é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.reboques.some(r => r.frota === frota)) {
                    throw new Error(`Já existe um reboque com o número de frota ${frota}`);
                }
                
                const tipo = document.getElementById('add-tipo').value;
                const status = document.getElementById('add-status').value;
                const acoplado = document.getElementById('add-acoplado').value.trim();
                
                // Criar objeto do reboque
                const reboque = {
                    frota,
                    tipo,
                    status,
                    acoplado,
                    tipoAcoplado: tipo
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    reboque.dataParada = data;
                    reboque.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(frota, status, motivo);
                }
                
                // Adicionar ao array de reboques
                this.data.reboques.push(reboque);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar novo caminhão próprio
            saveNewCaminhaoProprio() {
                const caminhao = document.getElementById('add-caminhao').value.trim();
                if (!caminhao) {
                    throw new Error('O número do caminhão é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.caminhoesProps.some(c => c.caminhao === caminhao)) {
                    throw new Error(`Já existe um caminhão próprio com o número ${caminhao}`);
                }
                
                const status = document.getElementById('add-status').value;
                
                // Criar objeto do caminhão
                const novoCaminhao = {
                    caminhao,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novoCaminhao.data = data;
                    novoCaminhao.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(caminhao, status, motivo);
                }
                
                // Adicionar ao array
                this.data.caminhoesProps.push(novoCaminhao);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar novo caminhão terceiro
            saveNewCaminhaoTerceiro() {
                const caminhao = document.getElementById('add-caminhao').value.trim();
                if (!caminhao) {
                    throw new Error('O código do caminhão é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.caminhoesTerc.some(c => c.caminhao === caminhao)) {
                    throw new Error(`Já existe um caminhão terceiro com o código ${caminhao}`);
                }
                
                const proprietario = document.getElementById('add-proprietario').value.trim();
                const reboques = document.getElementById('add-reboques').value.trim();
                const status = document.getElementById('add-status').value;
                
                // Criar objeto do caminhão
                const novoCaminhao = {
                    caminhao,
                    proprietario,
                    reboques,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novoCaminhao.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(caminhao, status, motivo);
                }
                
                // Adicionar ao array
                this.data.caminhoesTerc.push(novoCaminhao);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar nova colhedora frente 4001
            saveNewColhedora4001() {
                const codigo = document.getElementById('add-codigo').value.trim();
                if (!codigo) {
                    throw new Error('O código da colhedora é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.frente4001Colhedoras.some(c => c.codigo === codigo)) {
                    throw new Error(`Já existe uma colhedora da frente 4001 com o código ${codigo}`);
                }
                
                const status = document.getElementById('add-status').value;
                
                // Criar objeto da colhedora
                const novaColhedora = {
                    codigo,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novaColhedora.data = data;
                    novaColhedora.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(codigo, status, motivo);
                }
                
                // Adicionar ao array
                this.data.frente4001Colhedoras.push(novaColhedora);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar nova tração frente 4001
            saveNewTracao4001() {
                const codigo = document.getElementById('add-codigo').value.trim();
                if (!codigo) {
                    throw new Error('O código da tração é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.frente4001Tracoes.some(t => t.codigo === codigo)) {
                    throw new Error(`Já existe uma tração da frente 4001 com o código ${codigo}`);
                }
                
                const status = document.getElementById('add-status').value;
                
                // Criar objeto da tração
                const novaTracao = {
                    codigo,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novaTracao.data = data;
                    novaTracao.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(codigo, status, motivo);
                }
                
                // Adicionar ao array
                this.data.frente4001Tracoes.push(novaTracao);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar nova colhedora frente 4002
            saveNewColhedora4002() {
                const codigo = document.getElementById('add-codigo').value.trim();
                if (!codigo) {
                    throw new Error('O código da colhedora é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.frente4002Colhedoras.some(c => c.codigo === codigo)) {
                    throw new Error(`Já existe uma colhedora da frente 4002 com o código ${codigo}`);
                }
                
                const status = document.getElementById('add-status').value;
                
                // Criar objeto da colhedora
                const novaColhedora = {
                    codigo,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novaColhedora.data = data;
                    novaColhedora.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(codigo, status, motivo);
                }
                
                // Adicionar ao array
                this.data.frente4002Colhedoras.push(novaColhedora);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar nova tração frente 4002
            saveNewTracao4002() {
                const codigo = document.getElementById('add-codigo').value.trim();
                if (!codigo) {
                    throw new Error('O código da tração é obrigatório');
                }
                
                // Verificar se já existe
                if (this.data.frente4002Tracoes.some(t => t.codigo === codigo)) {
                    throw new Error(`Já existe uma tração da frente 4002 com o código ${codigo}`);
                }
                
                const status = document.getElementById('add-status').value;
                
                // Criar objeto da tração
                const novaTracao = {
                    codigo,
                    status
                };
                
                // Adicionar campos adicionais caso não seja operacional
                if (status !== 'Operacional') {
                    const dataElement = document.getElementById('add-data');
                    const data = dataElement ? dataElement.value : '';
                    
                    const motivoElement = document.getElementById('add-motivo');
                    const motivo = motivoElement ? motivoElement.value.trim() : '';
                    
                    novaTracao.data = data;
                    novaTracao.motivo = motivo;
                    
                    // Adicionar ao histórico
                    this.addToHistory(codigo, status, motivo);
                }
                
                // Adicionar ao array
                this.data.frente4002Tracoes.push(novaTracao);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Adicionar registro ao histórico
            addToHistory(id, status, motivo) {
                // Inicializar array de histórico para o equipamento se não existir
                if (!this.data.history[id]) {
                    this.data.history[id] = [];
                }
                
                // Criar entrada no histórico
                const historyEntry = {
                    date: new Date().toISOString(),
                    status: status,
                    description: `Status alterado para ${status}${motivo ? ` - Motivo: ${motivo}` : ''}`,
                    user: 'Administrador'
                };
                
                // Adicionar ao início do array (ordem cronológica inversa)
                this.data.history[id].unshift(historyEntry);
            },
            
            // Editar equipamento
            editEquipment(type, id) {
                if (!type || !id) {
                    this.showNotification('error', 'Erro', 'Informações do equipamento incompletas.');
                    return;
                }
                
                let item = null;
                let originalStatus = null;
                
                // Encontrar o equipamento específico
                switch(type) {
                    case 'Reboque':
                        item = this.data.reboques.find(r => r.frota === id);
                        break;
                    case 'Caminhão Próprio':
                        item = this.data.caminhoesProps.find(c => c.caminhao === id);
                        break;
                    case 'Caminhão Terceiro':
                        item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                        break;
                    case 'Colhedora Frente 4001':
                        item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                        break;
                    case 'Tração Frente 4001':
                        item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                        break;
                    case 'Colhedora Frente 4002':
                        item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                        break;
                    case 'Tração Frente 4002':
                        item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                        break;
                }
                
                if (!item) {
                    this.showNotification('error', 'Erro', 'Equipamento não encontrado.');
                    return;
                }
                
                // Salvar referências para edição
                this.data.editingItem = item;
                this.data.editingType = type;
                originalStatus = item.status;
                
                // Gerar formulário de edição
                const formContainer = document.getElementById('edit-form-fields');
                let html = '';
                
                // Definir título do modal
                document.getElementById('modal-title').textContent = `Editar ${type} - ${id}`;
                
                switch(type) {
                    case 'Reboque':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número da Frota</label>
                                <input type="text" id="edit-frota" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.frota}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Reboque</label>
                                <select id="edit-tipo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="SEMI REBOQUE" ${item.tipo === 'SEMI REBOQUE' ? 'selected' : ''}>SEMI REBOQUE</option>
                                    <option value="REBOQUE" ${item.tipo === 'REBOQUE' ? 'selected' : ''}>REBOQUE</option>
                                    <option value="DOLLY" ${item.tipo === 'DOLLY' ? 'selected' : ''}>DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Acoplado a (opcional)</label>
                                <input type="text" id="edit-acoplado" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.acoplado || ''}">
                            </div>
                            <div id="reason-fields" class="${item.status === 'Operacional' ? 'hidden' : ''}">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="edit-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.dataParada || ''}">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="edit-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'Caminhão Próprio':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número do Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.caminhao}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="${item.status === 'Operacional' ? 'hidden' : ''}">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="edit-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.data || ''}">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="edit-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'Caminhão Terceiro':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número/Código do Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.caminhao}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Proprietário</label>
                                <input type="text" id="edit-proprietario" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.proprietario || ''}">
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Reboques (opcional)</label>
                                <input type="text" id="edit-reboques" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.reboques || ''}">
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="${item.status === 'Operacional' ? 'hidden' : ''}">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="edit-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'Colhedora Frente 4001':
                    case 'Colhedora Frente 4002':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da Colhedora</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="${item.status === 'Operacional' ? 'hidden' : ''}">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="edit-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.data || ''}">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="edit-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'Tração Frente 4001':
                    case 'Tração Frente 4002':
                        html = `
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da Tração</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="reason-fields" class="${item.status === 'Operacional' ? 'hidden' : ''}">
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                    <input type="date" id="edit-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${item.data || ''}">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                    <textarea id="edit-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                                </div>
                            </div>
                        `;
                        break;
                }
                
                formContainer.innerHTML = html;
                
                // Configurar visibilidade do campo de motivo baseado no status
                const statusField = document.getElementById('edit-status');
                if (statusField) {
                    statusField.addEventListener('change', () => {
                        const reasonFields = document.getElementById('reason-fields');
                        if (statusField.value === 'Operacional') {
                            reasonFields.classList.add('hidden');
                        } else {
                            reasonFields.classList.remove('hidden');
                        }
                    });
                }
                
                // Mostrar modal
                document.getElementById('edit-modal').classList.remove('hidden');
            },
            
            // Salvar alterações de um equipamento
            saveEquipmentChanges() {
                if (!this.data.editingItem || !this.data.editingType) {
                    this.showNotification('error', 'Erro', 'Dados de edição incompletos');
                    return;
                }
                
                const item = this.data.editingItem;
                const type = this.data.editingType;
                
                try {
                    // Salvar o status atual para verificar se foi alterado
                    const oldStatus = item.status;
                    
                    switch(type) {
                        case 'Reboque':
                            this.updateReboque(item);
                            break;
                        case 'Caminhão Próprio':
                            this.updateCaminhaoProprio(item);
                            break;
                        case 'Caminhão Terceiro':
                            this.updateCaminhaoTerceiro(item);
                            break;
                        case 'Colhedora Frente 4001':
                        case 'Colhedora Frente 4002':
                            this.updateColhedora(item);
                            break;
                        case 'Tração Frente 4001':
                        case 'Tração Frente 4002':
                            this.updateTracao(item);
                            break;
                    }
                    
                    // Fechar modal
                    document.getElementById('edit-modal').classList.add('hidden');
                    
                    // Salvar no localStorage
                    this.saveDataToLocalStorage();
                    
                    // Atualizar visualizações
                    this.renderAllTables();
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.initializeRealEquipmentView();
                    
                    // Mostrar notificação
                    this.showNotification('success', 'Sucesso', 'Alterações salvas com sucesso!');
                    
                } catch (error) {
                    this.showNotification('error', 'Erro', error.message);
                } finally {
                    // Limpar dados de edição
                    this.data.editingItem = null;
                    this.data.editingType = null;
                }
            },
            
            // Atualizar reboque
            updateReboque(reboque) {
                const oldStatus = reboque.status;
                const newStatus = document.getElementById('edit-status').value;
                const newTipo = document.getElementById('edit-tipo').value;
                const newAcoplado = document.getElementById('edit-acoplado').value.trim();
                
                // Atualizar campos
                reboque.tipo = newTipo;
                reboque.status = newStatus;
                reboque.acoplado = newAcoplado;
                reboque.tipoAcoplado = newTipo;
                
                // Gerenciar campos de motivo com base no status
                if (newStatus !== 'Operacional') {
                    const data = document.getElementById('edit-data').value;
                    const motivo = document.getElementById('edit-motivo').value.trim();
                    
                    reboque.dataParada = data;
                    reboque.motivo = motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(reboque.frota, newStatus, motivo);
                    }
                } else {
                    // Se mudou para operacional, remover campos de parada
                    delete reboque.dataParada;
                    delete reboque.motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(reboque.frota, newStatus, '');
                    }
                }
            },
            
            // Atualizar caminhão próprio
            updateCaminhaoProprio(caminhao) {
                const oldStatus = caminhao.status;
                const newStatus = document.getElementById('edit-status').value;
                
                // Atualizar status
                caminhao.status = newStatus;
                
                // Gerenciar campos de motivo com base no status
                if (newStatus !== 'Operacional') {
                    const data = document.getElementById('edit-data').value;
                    const motivo = document.getElementById('edit-motivo').value.trim();
                    
                    caminhao.data = data;
                    caminhao.motivo = motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(caminhao.caminhao, newStatus, motivo);
                    }
                } else {
                    // Se mudou para operacional, remover campos de parada
                    delete caminhao.data;
                    delete caminhao.motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(caminhao.caminhao, newStatus, '');
                    }
                }
            },
            
            // Atualizar caminhão terceiro
            updateCaminhaoTerceiro(caminhao) {
                const oldStatus = caminhao.status;
                const newStatus = document.getElementById('edit-status').value;
                const newProprietario = document.getElementById('edit-proprietario').value.trim();
                const newReboques = document.getElementById('edit-reboques').value.trim();
                
                // Atualizar campos
                caminhao.status = newStatus;
                caminhao.proprietario = newProprietario;
                caminhao.reboques = newReboques;
                
                // Gerenciar campos de motivo com base no status
                if (newStatus !== 'Operacional') {
                    const motivo = document.getElementById('edit-motivo').value.trim();
                    caminhao.motivo = motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(caminhao.caminhao, newStatus, motivo);
                    }
                } else {
                    // Se mudou para operacional, remover campo de motivo
                    delete caminhao.motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(caminhao.caminhao, newStatus, '');
                    }
                }
            },
            
            // Atualizar colhedora
            updateColhedora(colhedora) {
                const oldStatus = colhedora.status;
                const newStatus = document.getElementById('edit-status').value;
                
                // Atualizar status
                colhedora.status = newStatus;
                
                // Gerenciar campos de motivo com base no status
                if (newStatus !== 'Operacional') {
                    const data = document.getElementById('edit-data').value;
                    const motivo = document.getElementById('edit-motivo').value.trim();
                    
                    colhedora.data = data;
                    colhedora.motivo = motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(colhedora.codigo, newStatus, motivo);
                    }
                } else {
                    // Se mudou para operacional, remover campos de parada
                    delete colhedora.data;
                    delete colhedora.motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(colhedora.codigo, newStatus, '');
                    }
                }
            },
            
            // Atualizar tração
            updateTracao(tracao) {
                const oldStatus = tracao.status;
                const newStatus = document.getElementById('edit-status').value;
                
                // Atualizar status
                tracao.status = newStatus;
                
                // Gerenciar campos de motivo com base no status
                if (newStatus !== 'Operacional') {
                    const data = document.getElementById('edit-data').value;
                    const motivo = document.getElementById('edit-motivo').value.trim();
                    
                    tracao.data = data;
                    tracao.motivo = motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(tracao.codigo, newStatus, motivo);
                    }
                } else {
                    // Se mudou para operacional, remover campos de parada
                    delete tracao.data;
                    delete tracao.motivo;
                    
                    // Adicionar ao histórico se o status mudou
                    if (newStatus !== oldStatus) {
                        this.addToHistory(tracao.codigo, newStatus, '');
                    }
                }
            },
            
            // Confirmar exclusão de equipamento
            confirmDeleteEquipment(type, id, index, arrayName) {
                this.data.deletingId = id;
                this.data.deletingType = type;
                this.data.deletingIndex = index;
                this.data.deletingArray = arrayName;
                
                // Atualizar mensagem de confirmação
                document.getElementById('delete-item-details').textContent = `${type} - ${id}`;
                
                // Mostrar modal de confirmação
                document.getElementById('delete-confirm-modal').classList.remove('hidden');
            },
            
            // Excluir equipamento
            deleteEquipment() {
                if (!this.data.deletingId || !this.data.deletingType || this.data.deletingIndex === null || !this.data.deletingArray) {
                    this.showNotification('error', 'Erro', 'Dados de exclusão incompletos.');
                    return;
                }
                
                try {
                    // Verificar se o array existe e é um array
                    if (!Array.isArray(this.data[this.data.deletingArray])) {
                        this.showNotification('error', 'Erro', `Array de dados '${this.data.deletingArray}' não encontrado.`);
                        return;
                    }
                    
                    // Encontrar o item no array correto (em caso de erros no índice)
                    const array = this.data[this.data.deletingArray];
                    let indexToRemove = this.data.deletingIndex;
                    
                    // Verificação extra para encontrar o item pelo ID caso o índice não corresponda
                    const idFieldMap = {
                        'reboques': 'frota',
                        'caminhoesProps': 'caminhao',
                        'caminhoesTerc': 'caminhao',
                        'frente4001Colhedoras': 'codigo',
                        'frente4001Tracoes': 'codigo',
                        'frente4002Colhedoras': 'codigo',
                        'frente4002Tracoes': 'codigo'
                    };
                    
                    const idField = idFieldMap[this.data.deletingArray];
                    if (idField && array[indexToRemove]?.[idField] !== this.data.deletingId) {
                        // O índice não corresponde ao ID, buscar pelo ID correto
                        indexToRemove = array.findIndex(item => item[idField] === this.data.deletingId);
                    }
                    
                    if (indexToRemove === -1 || indexToRemove >= array.length) {
                        this.showNotification('error', 'Erro', `Equipamento com ID ${this.data.deletingId} não encontrado no array.`);
                        return;
                    }
                    
                    // Remover o item do array
                    array.splice(indexToRemove, 1);
                    
                    // Excluir histórico do equipamento
                    if (this.data.history[this.data.deletingId]) {
                        delete this.data.history[this.data.deletingId];
                    }
                    
                    // Excluir agendamentos associados ao equipamento
                    this.data.schedules = this.data.schedules.filter(schedule => 
                        schedule.equipment !== this.data.deletingId
                    );
                    
                    // Salvar no localStorage
                    this.saveDataToLocalStorage();
                    
                    // Atualizar visualizações
                    this.renderAllTables();
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.initializeRealEquipmentView();
                    
                    // Fechar o modal
                    document.getElementById('delete-confirm-modal').classList.add('hidden');
                    
                    // Mostrar notificação
                    this.showNotification('success', 'Sucesso', 'Equipamento excluído com sucesso.');
                } catch (error) {
                    console.error("Erro ao excluir equipamento:", error);
                    this.showNotification('error', 'Erro', 'Ocorreu um erro ao excluir o equipamento.');
                } finally {
                    // Limpar referências
                    this.data.deletingId = null;
                    this.data.deletingType = null;
                    this.data.deletingIndex = null;
                    this.data.deletingArray = null;
                }
            },
            
            // Visualizar histórico de um equipamento
            viewEquipmentHistory(type, id) {
                // Verificar se existe histórico para este equipamento
                const history = this.data.history[id] || [];
                
                // Atualizar título e subtítulo do modal
                document.getElementById('history-title').textContent = `Histórico - ${type} ${id}`;
                document.getElementById('history-subtitle').textContent = `Total de registros: ${history.length}`;
                
                // Escolher o ícone adequado para o tipo de equipamento
                let icon = '';
                if (type.includes('Reboque')) {
                    icon = 'fa-trailer';
                } else if (type.includes('Caminhão')) {
                    icon = 'fa-truck';
                } else if (type.includes('Colhedora')) {
                    icon = 'fa-tractor';
                } else if (type.includes('Tração')) {
                    icon = 'fa-truck-monster';
                } else {
                    icon = 'fa-truck-moving';
                }
                document.getElementById('history-icon').className = `fas ${icon} text-xl`;
                
                // Gerar HTML para o histórico
                const container = document.getElementById('history-timeline');
                
                if (history.length === 0) {
                    container.innerHTML = `
                        <div class="flex flex-col items-center justify-center py-8">
                            <i class="fas fa-history text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                            <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum registro de histórico encontrado</p>
                        </div>
                    `;
                } else {
                    let html = '';
                    
                    history.forEach((entry, index) => {
                        // Formatar data
                        const date = new Date(entry.date);
                        const dateFormatted = date.toLocaleDateString('pt-BR');
                        const timeFormatted = date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                        
                        // Determinar cor com base no status
                        let statusClass = '';
                        switch(entry.status) {
                            case 'Operacional':
                                statusClass = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300';
                                break;
                            case 'Em manutenção':
                                statusClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300';
                                break;
                            case 'Em reforma':
                            case 'Inoperante':
                            case 'Aguardando reforma':
                                statusClass = 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300';
                                break;
                            default:
                                statusClass = 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';
                        }
                        
                        html += `
                            <div class="history-item mb-6">
                                <div class="absolute -left-6 bg-white dark:bg-gray-800 w-10 h-10 rounded-full border-4 border-gray-200 dark:border-gray-700 flex items-center justify-center">
                                    <i class="${index === 0 ? 'fas fa-clock text-primary' : 'fas fa-history text-gray-400'}"></i>
                                </div>
                                <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4">
                                    <div class="flex justify-between items-center mb-2">
                                        <div>
                                            <span class="inline-block px-2 py-1 text-sm rounded-md ${statusClass}">
                                                ${entry.status}
                                            </span>
                                        </div>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">
                                            ${dateFormatted} às ${timeFormatted}
                                        </div>
                                    </div>
                                    <p class="text-base my-2">${entry.description}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">
                                        <i class="fas fa-user mr-2"></i> ${entry.user || 'Usuário não especificado'}
                                    </p>
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                }
                
                // Mostrar modal
                document.getElementById('history-modal').classList.remove('hidden');
            },
            
            // Agendar manutenção para um equipamento
            scheduleEquipmentMaintenance(type, id) {
                // Salvar referência do equipamento
                this.data.schedulingEquipment = {
                    type: type,
                    id: id
                };
                
                // Atualizar informações do equipamento no modal
                document.getElementById('schedule-equipment-info').innerHTML = `
                    <div class="flex items-center">
                        <div class="w-12 h-12 rounded-full bg-primary bg-opacity-10 text-primary flex items-center justify-center mr-3">
                            <i class="fas ${
                                type.includes('Reboque') ? 'fa-trailer' :
                                type.includes('Caminhão') ? 'fa-truck' :
                                type.includes('Colhedora') ? 'fa-tractor' :
                                type.includes('Tração') ? 'fa-truck-monster' : 
                                'fa-truck-moving'
                            } text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium">${type} - ${id}</h3>
                        </div>
                    </div>
                `;
                
                // Limpar campos do formulário
                document.getElementById('schedule-date').value = '';
                document.getElementById('schedule-time').value = '';
                document.getElementById('schedule-type').value = 'preventiva';
                document.getElementById('schedule-description').value = '';
                document.getElementById('schedule-responsible').value = '';
                
                // Mostrar modal
                document.getElementById('schedule-modal').classList.remove('hidden');
            },
            
            // Salvar agendamento de manutenção
            saveSchedule() {
                if (!this.data.schedulingEquipment) {
                    this.showNotification('error', 'Erro', 'Equipamento para agendamento não especificado');
                    return;
                }
                
                const { type, id } = this.data.schedulingEquipment;
                
                // Obter valores do formulário
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const scheduleType = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value.trim();
                const responsible = document.getElementById('schedule-responsible').value.trim();
                
                // Validar campos obrigatórios
                if (!date || !time || !description || !responsible) {
                    this.showNotification('error', 'Erro', 'Todos os campos são obrigatórios');
                    return;
                }
                
                // Criar objeto de agendamento
                const schedule = {
                    equipment: id,
                    equipmentType: type,
                    date: date,
                    time: time,
                    type: scheduleType,
                    description: description,
                    responsible: responsible,
                    created: new Date().toISOString(),
                    status: 'Agendado'
                };
                
                // Adicionar ao array de agendamentos
                this.data.schedules.push(schedule);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar lista de manutenções agendadas
                this.updateUpcomingMaintenanceList();
                
                // Fechar modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Limpar referência
                this.data.schedulingEquipment = null;
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Manutenção agendada com sucesso!');
            },
            
            // Exportar dados para CSV
            exportToCSV() {
                // Determinar a guia ativa para exportar os dados apropriados
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) {
                    this.showNotification('error', 'Erro', 'Nenhuma tabela ativa para exportar');
                    return;
                }
                
                const tabId = activeTab.id;
                let data = [];
                let headers = [];
                let filename = '';
                
                // Determinar quais dados exportar com base na guia ativa
                switch(tabId) {
                    case 'main-dashboard':
                    case 'detailed-dashboard':
                    case 'real-equipment-view':
                        // Exportar todos os dados
                        data = [
                            ...this.data.reboques.map(r => ({ Tipo: 'Reboque', ID: r.frota, Status: r.status, ...r })),
                            ...this.data.caminhoesProps.map(c => ({ Tipo: 'Caminhão Próprio', ID: c.caminhao, Status: c.status, ...c })),
                            ...this.data.caminhoesTerc.map(c => ({ Tipo: 'Caminhão Terceiro', ID: c.caminhao, Status: c.status, ...c })),
                            ...this.data.frente4001Colhedoras.map(c => ({ Tipo: 'Colhedora Frente 4001', ID: c.codigo, Status: c.status, ...c })),
                            ...this.data.frente4001Tracoes.map(t => ({ Tipo: 'Tração Frente 4001', ID: t.codigo, Status: t.status, ...t })),
                            ...this.data.frente4002Colhedoras.map(c => ({ Tipo: 'Colhedora Frente 4002', ID: c.codigo, Status: c.status, ...c })),
                            ...this.data.frente4002Tracoes.map(t => ({ Tipo: 'Tração Frente 4002', ID: t.codigo, Status: t.status, ...t }))
                        ];
                        headers = ['Tipo', 'ID', 'Status', 'Data', 'Motivo'];
                        filename = 'todos_equipamentos';
                        break;
                    case 'reboques':
                        data = this.filterData(this.data.reboques);
                        headers = ['frota', 'tipo', 'acoplado', 'status', 'dataParada', 'motivo'];
                        filename = 'reboques';
                        break;
                    case 'caminhoes-proprios':
                        data = this.filterData(this.data.caminhoesProps);
                        headers = ['caminhao', 'status', 'data', 'motivo'];
                        filename = 'caminhoes_proprios';
                        break;
                    case 'caminhoes-terceiros':
                        data = this.filterData(this.data.caminhoesTerc);
                        headers = ['caminhao', 'proprietario', 'reboques', 'status', 'motivo'];
                        filename = 'caminhoes_terceiros';
                        break;
                    case 'frente-4001':
                        data = [
                            ...this.data.frente4001Colhedoras.map(c => ({ type: 'Colhedora', ...c })),
                            ...this.data.frente4001Tracoes.map(t => ({ type: 'Tração', ...t }))
                        ];
                        headers = ['type', 'codigo', 'status', 'data', 'motivo'];
                        filename = 'frente_4001';
                        break;
                    case 'frente-4002':
                        data = [
                            ...this.data.frente4002Colhedoras.map(c => ({ type: 'Colhedora', ...c })),
                            ...this.data.frente4002Tracoes.map(t => ({ type: 'Tração', ...t }))
                        ];
                        headers = ['type', 'codigo', 'status', 'data', 'motivo'];
                        filename = 'frente_4002';
                        break;
                    default:
                        this.showNotification('error', 'Erro', 'Tipo de exportação não suportado');
                        return;
                }
                
                if (data.length === 0) {
                    this.showNotification('info', 'Informação', 'Não há dados para exportar');
                    return;
                }
                
                // Criar string CSV
                let csvContent = headers.join(',') + '\r\n';
                
                data.forEach(item => {
                    let row = headers.map(header => {
                        // Obter o valor e garantir que seja uma string
                        let val = item[header] !== undefined ? item[header] : '';
                        val = String(val);
                        
                        // Escapar aspas e adicionar aspas se necessário
                        if (val.includes(',') || val.includes('"') || val.includes('\n')) {
                            val = '"' + val.replace(/"/g, '""') + '"';
                        }
                        
                        return val;
                    }).join(',');
                    
                    csvContent += row + '\r\n';
                });
                
                // Criar blob e link para download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                
                // Nome do arquivo com data atual
                const date = new Date();
                const dateStr = date.toISOString().split('T')[0];
                link.download = `${filename}_${dateStr}.csv`;
                
                // Realizar download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Dados exportados com sucesso!');
            },
            // Imprimir a tabela ativa
            printActiveTable() {
                // Determinar a guia ativa para imprimir
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) {
                    this.showNotification('error', 'Erro', 'Nenhuma tabela ativa para imprimir');
                    return;
                }
                
                const tabId = activeTab.id;
                const printArea = document.getElementById('print-area');
                const printContent = document.getElementById('print-content');
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                const printTimestamp = document.getElementById('print-timestamp');
                
                // Configurar data e hora
                const now = new Date();
                const dateStr = now.toLocaleDateString('pt-BR');
                const timeStr = now.toLocaleTimeString('pt-BR');
                
                printDate.textContent = dateStr;
                printTimestamp.textContent = `${dateStr} ${timeStr}`;
                
                // Preparar conteúdo com base na guia ativa
                switch(tabId) {
                    case 'main-dashboard':
                        printTitle.textContent = 'Relatório do Dashboard Principal';
                        this.printMainDashboard(printContent);
                        break;
                    case 'detailed-dashboard':
                        printTitle.textContent = 'Relatório do Dashboard Detalhado';
                        this.printDetailedDashboard(printContent);
                        break;
                    case 'real-equipment-view':
                        printTitle.textContent = 'Visualização da Frota';
                        this.printRealEquipmentView(printContent);
                        break;
                    case 'reboques':
                        printTitle.textContent = 'Relatório de Reboques';
                        this.printReboques(printContent);
                        break;
                    case 'caminhoes-proprios':
                        printTitle.textContent = 'Relatório de Caminhões Próprios';
                        this.printCaminhoesProps(printContent);
                        break;
                    case 'caminhoes-terceiros':
                        printTitle.textContent = 'Relatório de Caminhões Terceiros';
                        this.printCaminhoesTerc(printContent);
                        break;
                    case 'frente-4001':
                        printTitle.textContent = 'Relatório da Frente 4001';
                        this.printFrente4001(printContent);
                        break;
                    case 'frente-4002':
                        printTitle.textContent = 'Relatório da Frente 4002';
                        this.printFrente4002(printContent);
                        break;
                    default:
                        this.showNotification('error', 'Erro', 'Tipo de impressão não suportado');
                        return;
                }
                
                // Executar impressão
                window.print();
            },
            
            // Imprimir dashboard principal
            printMainDashboard(container) {
                // Calcular totais
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round(operational / totalEquipments * 100) : 0;
                
                // Criar conteúdo
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Resumo da Frota</h2>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Total de Equipamentos:</p>
                                <p class="text-xl font-bold">${totalEquipments}</p>
                            </div>
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Disponibilidade:</p>
                                <p class="text-xl font-bold">${availability}%</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4">
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Operacionais:</p>
                                <p class="text-xl font-bold">${operational}</p>
                            </div>
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Em Manutenção:</p>
                                <p class="text-xl font-bold">${maintenance}</p>
                            </div>
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Em Reforma/Inoperantes:</p>
                                <p class="text-xl font-bold">${reform}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pdf-page-break"></div>
                    
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Equipamentos em Manutenção</h2>
                        
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">ID</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.getMaintenanceEquipmentHTML()}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="pdf-page-break"></div>
                    
                    <div>
                        <h2 class="text-xl font-bold mb-3">Próximas Manutenções Agendadas</h2>
                        
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Equipamento</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Responsável</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.getUpcomingMaintenanceHTML()}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            // Obter HTML para equipamentos em manutenção
            getMaintenanceEquipmentHTML() {
                // Coletar todos os equipamentos em manutenção
                const reboques = this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                    type: 'Reboque',
                    id: r.frota,
                    date: r.dataParada || '',
                    reason: r.motivo || ''
                }));
                
                const caminhoesProps = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                    type: 'Caminhão Próprio',
                    id: c.caminhao,
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const caminhoesTerc = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                    type: 'Caminhão Terceiro',
                    id: c.caminhao,
                    date: '',
                    reason: c.motivo || ''
                }));
                
                const frente4001Colhedoras = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                    type: 'Colhedora F4001',
                    id: c.codigo,
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const frente4001Tracoes = this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                    type: 'Tração F4001',
                    id: t.codigo,
                    date: t.data || '',
                    reason: t.motivo || ''
                }));
                
                const frente4002Colhedoras = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                    type: 'Colhedora F4002',
                    id: c.codigo,
                    date: c.data || '',
                    reason: c.motivo || ''
                }));
                
                const frente4002Tracoes = this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                    type: 'Tração F4002',
                    id: t.codigo,
                    date: t.data || '',
                    reason: t.motivo || ''
                }));
                
                // Combinar todos os equipamentos em manutenção
                const allMaintenances = [
                    ...reboques,
                    ...caminhoesProps,
                    ...caminhoesTerc,
                    ...frente4001Colhedoras,
                    ...frente4001Tracoes,
                    ...frente4002Colhedoras,
                    ...frente4002Tracoes
                ];
                
                // Ordenar por data (mais recente primeiro)
                allMaintenances.sort((a, b) => {
                    if (!a.date && !b.date) return 0;
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                if (allMaintenances.length === 0) {
                    return `
                        <tr>
                            <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhum equipamento em manutenção no momento</td>
                        </tr>
                    `;
                }
                
                // Gerar HTML
                let html = '';
                
                allMaintenances.forEach(item => {
                    // Formatar data
                    let dataFormatada = '';
                    if (item.date) {
                        const data = new Date(item.date);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr>
                            <td class="border border-gray-300 px-3 py-2">${item.type}</td>
                            <td class="border border-gray-300 px-3 py-2">${item.id}</td>
                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                            <td class="border border-gray-300 px-3 py-2">${item.reason || '-'}</td>
                        </tr>
                    `;
                });
                
                return html;
            },
            
            // Obter HTML para manutenções agendadas
            getUpcomingMaintenanceHTML() {
                // Filtrar manutenções futuras (data maior que a atual)
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingSchedules = this.data.schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    return scheduleDate >= today;
                });
                
                // Ordenar por data (mais próxima primeiro)
                upcomingSchedules.sort((a, b) => {
                    return new Date(a.date) - new Date(b.date);
                });
                
                if (upcomingSchedules.length === 0) {
                    return `
                        <tr>
                            <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhuma manutenção agendada</td>
                        </tr>
                    `;
                }
                
                // Gerar HTML
                let html = '';
                
                upcomingSchedules.forEach(schedule => {
                    // Formatar data
                    const scheduleDate = new Date(schedule.date);
                    const dateFormatted = scheduleDate.toLocaleDateString('pt-BR');
                    
                    html += `
                        <tr>
                            <td class="border border-gray-300 px-3 py-2">${schedule.equipment}</td>
                            <td class="border border-gray-300 px-3 py-2">${schedule.equipmentType}</td>
                            <td class="border border-gray-300 px-3 py-2">${dateFormatted} ${schedule.time}</td>
                            <td class="border border-gray-300 px-3 py-2">${schedule.responsible}</td>
                        </tr>
                    `;
                });
                
                return html;
            },
            
            // Imprimir tabela de reboques
            printReboques(container) {
                // Filtrar dados com base no termo de pesquisa
                const filteredData = this.filterData(this.data.reboques);
                
                // Criar conteúdo
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Relatório de Reboques</h2>
                        <p class="mb-2">Total: ${filteredData.length} reboques</p>
                        
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Frota</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Acoplado</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredData.length === 0 ? `
                                    <tr>
                                        <td colspan="6" class="border border-gray-300 px-3 py-2 text-center">Nenhum reboque encontrado</td>
                                    </tr>
                                ` : filteredData.map(reboque => {
                                    const dataFormatada = reboque.dataParada ? new Date(reboque.dataParada).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${reboque.frota}</td>
                                            <td class="border border-gray-300 px-3 py-2">${reboque.tipo || '-'}</td>
                                            <td class="border border-gray-300 px-3 py-2">${reboque.acoplado || '-'}</td>
                                            <td class="border border-gray-300 px-3 py-2">${reboque.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${reboque.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            // Imprimir outras tabelas (implementações similares)
            printCaminhoesProps(container) {
                // Similar à função printReboques
                const filteredData = this.filterData(this.data.caminhoesProps);
                
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Relatório de Caminhões Próprios</h2>
                        <p class="mb-2">Total: ${filteredData.length} caminhões</p>
                        
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Caminhão</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredData.length === 0 ? `
                                    <tr>
                                        <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhum caminhão próprio encontrado</td>
                                    </tr>
                                ` : filteredData.map(caminhao => {
                                    const dataFormatada = caminhao.data ? new Date(caminhao.data).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.caminhao}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            printCaminhoesTerc(container) {
                // Similar às funções anteriores
                const filteredData = this.filterData(this.data.caminhoesTerc);
                
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Relatório de Caminhões Terceiros</h2>
                        <p class="mb-2">Total: ${filteredData.length} caminhões</p>
                        
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Caminhão</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Proprietário</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Reboques</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredData.length === 0 ? `
                                    <tr>
                                        <td colspan="5" class="border border-gray-300 px-3 py-2 text-center">Nenhum caminhão terceiro encontrado</td>
                                    </tr>
                                ` : filteredData.map(caminhao => {
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.caminhao}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.proprietario || '-'}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.reboques || '-'}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${caminhao.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            // Demais funções de impressão (implementações similares)
            printFrente4001(container) {
                const colhedorasData = this.filterData(this.data.frente4001Colhedoras);
                const tracoesData = this.filterData(this.data.frente4001Tracoes);
                
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Relatório da Frente 4001</h2>
                        <p class="mb-2">Total: ${colhedorasData.length + tracoesData.length} equipamentos</p>
                        
                        <h3 class="text-lg font-bold mt-4 mb-2">Colhedoras</h3>
                        <table class="w-full border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Código</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${colhedorasData.length === 0 ? `
                                    <tr>
                                        <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhuma colhedora encontrada</td>
                                    </tr>
                                ` : colhedorasData.map(colhedora => {
                                    const dataFormatada = colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.codigo}</td>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                        
                        <h3 class="text-lg font-bold mt-4 mb-2">Trações</h3>
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Código</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tracoesData.length === 0 ? `
                                    <tr>
                                        <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhuma tração encontrada</td>
                                    </tr>
                                ` : tracoesData.map(tracao => {
                                    const dataFormatada = tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.codigo}</td>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            printFrente4002(container) {
                // Similar à função printFrente4001
                const colhedorasData = this.filterData(this.data.frente4002Colhedoras);
                const tracoesData = this.filterData(this.data.frente4002Tracoes);
                
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Relatório da Frente 4002</h2>
                        <p class="mb-2">Total: ${colhedorasData.length + tracoesData.length} equipamentos</p>
                        
                        <h3 class="text-lg font-bold mt-4 mb-2">Colhedoras</h3>
                        <table class="w-full border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Código</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${colhedorasData.length === 0 ? `
                                    <tr>
                                        <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhuma colhedora encontrada</td>
                                    </tr>
                                ` : colhedorasData.map(colhedora => {
                                    const dataFormatada = colhedora.data ? new Date(colhedora.data).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.codigo}</td>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${colhedora.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                        
                        <h3 class="text-lg font-bold mt-4 mb-2">Trações</h3>
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Código</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Data</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tracoesData.length === 0 ? `
                                    <tr>
                                        <td colspan="4" class="border border-gray-300 px-3 py-2 text-center">Nenhuma tração encontrada</td>
                                    </tr>
                                ` : tracoesData.map(tracao => {
                                    const dataFormatada = tracao.data ? new Date(tracao.data).toLocaleDateString('pt-BR') : '';
                                    
                                    return `
                                        <tr>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.codigo}</td>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.status}</td>
                                            <td class="border border-gray-300 px-3 py-2">${dataFormatada}</td>
                                            <td class="border border-gray-300 px-3 py-2">${tracao.motivo || '-'}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            printDetailedDashboard(container) {
                // Conteúdo básico para impressão do dashboard detalhado
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Dashboard Detalhado</h2>
                        <p class="mb-2">Dados de disponibilidade e estatísticas da frota</p>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Total de Equipamentos:</p>
                                <p class="text-xl font-bold">${document.getElementById('detailed-total-equipment').textContent}</p>
                            </div>
                            <div class="p-3 border border-gray-300 rounded-md">
                                <p class="font-medium">Disponibilidade Geral:</p>
                                <p class="text-xl font-bold">${document.getElementById('detailed-operational-percentage').textContent}</p>
                            </div>
                        </div>
                        
                        <h3 class="text-lg font-bold mt-6 mb-2">Disponibilidade por Categoria</h3>
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Categoria</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Total</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Disponibilidade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Reboques</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-reboques-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-reboques-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Caminhões Próprios</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-cp-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-cp-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Caminhões Terceiros</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-ct-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-ct-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Frente 4001 - Colhedoras</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4001-colh-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4001-colh-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Frente 4001 - Trações</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4001-trac-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4001-trac-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Frente 4002 - Colhedoras</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4002-colh-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4002-colh-availability').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2">Frente 4002 - Trações</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4002-trac-count').textContent}</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-f4002-trac-availability').textContent}</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <h3 class="text-lg font-bold mt-6 mb-2">Indicadores de Desempenho</h3>
                        <table class="w-full border-collapse">
                            <tbody>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2 font-medium">MTBF (Tempo Médio Entre Falhas)</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-mtbf').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2 font-medium">MTTR (Tempo Médio Para Reparo)</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-mttr').textContent}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-3 py-2 font-medium">OEE (Eficácia Global do Equipamento)</td>
                                    <td class="border border-gray-300 px-3 py-2">${document.getElementById('detailed-oee').textContent}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            printRealEquipmentView(container) {
                // Contar por categorias e status
                const allEquipments = [
                    ...this.data.reboques.map(r => ({ type: 'Reboque', id: r.frota, status: r.status })),
                    ...this.data.caminhoesProps.map(c => ({ type: 'Caminhão Próprio', id: c.caminhao, status: c.status })),
                    ...this.data.caminhoesTerc.map(c => ({ type: 'Caminhão Terceiro', id: c.caminhao, status: c.status })),
                    ...this.data.frente4001Colhedoras.map(c => ({ type: 'Colhedora F4001', id: c.codigo, status: c.status })),
                    ...this.data.frente4001Tracoes.map(t => ({ type: 'Tração F4001', id: t.codigo, status: t.status })),
                    ...this.data.frente4002Colhedoras.map(c => ({ type: 'Colhedora F4002', id: c.codigo, status: c.status })),
                    ...this.data.frente4002Tracoes.map(t => ({ type: 'Tração F4002', id: t.codigo, status: t.status }))
                ];
                
                // Contagem por tipo
                const typeCounts = {};
                allEquipments.forEach(equipment => {
                    typeCounts[equipment.type] = (typeCounts[equipment.type] || 0) + 1;
                });
                
                // Contagem por status
                const statusCounts = {};
                allEquipments.forEach(equipment => {
                    statusCounts[equipment.status] = (statusCounts[equipment.status] || 0) + 1;
                });
                
                // Gerar HTML
                container.innerHTML = `
                    <div class="mb-5">
                        <h2 class="text-xl font-bold mb-3">Visualização da Frota</h2>
                        <p class="mb-2">Total: ${allEquipments.length} equipamentos</p>
                        
                        <h3 class="text-lg font-bold mt-6 mb-2">Distribuição por Tipo</h3>
                        <table class="w-full border-collapse mb-6">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Quantidade</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Object.entries(typeCounts).map(([type, count]) => `
                                    <tr>
                                        <td class="border border-gray-300 px-3 py-2">${type}</td>
                                        <td class="border border-gray-300 px-3 py-2">${count}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        
                        <h3 class="text-lg font-bold mt-6 mb-2">Distribuição por Status</h3>
                        <table class="w-full border-collapse">
                            <thead>
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Status</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left">Quantidade</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Object.entries(statusCounts).map(([status, count]) => `
                                    <tr>
                                        <td class="border border-gray-300 px-3 py-2">${status}</td>
                                        <td class="border border-gray-300 px-3 py-2">${count}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },
            
            // Gerar relatório em PDF completo
            generatePDFReport() {
                // Preparar área de relatório em PDF
                const reportTitle = document.getElementById('pdf-report-title');
                const reportDate = document.getElementById('pdf-report-date');
                const timestamp = document.getElementById('pdf-timestamp');
                const reportContent = document.getElementById('pdf-report-content');
                
                // Configurar data e hora
                const now = new Date();
                const dateStr = now.toLocaleDateString('pt-BR');
                const timeStr = now.toLocaleTimeString('pt-BR');
                
                reportDate.textContent = dateStr;
                timestamp.textContent = `${dateStr} ${timeStr}`;
                
                // Limpar conteúdo anterior
                reportContent.innerHTML = '';
                
                // Resumo da Frota
                this.addPDFReportSection(reportContent, 'Resumo da Frota');
                
                // Adicionar dados gerais
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round(operational / totalEquipments * 100) : 0;
                
                // Criar seção de resumo
                const summaryBox = document.createElement('div');
                summaryBox.className = 'summary-box';
                summaryBox.innerHTML = `
                    <h3>Dados Gerais da Frota</h3>
                    <div class="grid-container">
                        <div class="grid-item">
                            <p>Total de Equipamentos</p>
                            <p class="data-highlight">${totalEquipments}</p>
                        </div>
                        <div class="grid-item">
                            <p>Disponibilidade Geral</p>
                            <p class="data-highlight">${availability}%</p>
                        </div>
                        <div class="grid-item">
                            <p>Operacionais</p>
                            <p class="data-highlight">${operational}</p>
                        </div>
                        <div class="grid-item">
                            <p>Em Manutenção</p>
                            <p class="data-highlight">${maintenance}</p>
                        </div>
                        <div class="grid-item">
                            <p>Em Reforma/Inoperantes</p>
                            <p class="data-highlight">${reform}</p>
                        </div>
                    </div>
                `;
                reportContent.appendChild(summaryBox);
                
                // Adicionar quebra de página
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Reboques
                this.addPDFSectionForEquipmentType(
                    reportContent, 
                    'Reboques', 
                    this.data.reboques, 
                    ['frota', 'tipo', 'acoplado', 'status'],
                    ['Frota', 'Tipo', 'Acoplado', 'Status']
                );
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Caminhões Próprios
                this.addPDFSectionForEquipmentType(
                    reportContent, 
                    'Caminhões Próprios', 
                    this.data.caminhoesProps, 
                    ['caminhao', 'status', 'data', 'motivo'],
                    ['Caminhão', 'Status', 'Data', 'Motivo']
                );
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Caminhões Terceiros
                this.addPDFSectionForEquipmentType(
                    reportContent, 
                    'Caminhões Terceiros', 
                    this.data.caminhoesTerc, 
                    ['caminhao', 'proprietario', 'reboques', 'status'],
                    ['Caminhão', 'Proprietário', 'Reboques', 'Status']
                );
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Frente 4001
                this.addPDFReportSection(reportContent, 'Frente 4001');
                
                // Colhedoras
                const colhedorasSection = document.createElement('div');
                colhedorasSection.innerHTML = `<h3>Colhedoras</h3>`;
                reportContent.appendChild(colhedorasSection);
                
                this.addPDFTableForEquipment(
                    reportContent,
                    this.data.frente4001Colhedoras, 
                    ['codigo', 'status', 'data', 'motivo'],
                    ['Código', 'Status', 'Data', 'Motivo']
                );
                
                // Trações
                const tracoesSection = document.createElement('div');
                tracoesSection.innerHTML = `<h3>Trações</h3>`;
                reportContent.appendChild(tracoesSection);
                
                this.addPDFTableForEquipment(
                    reportContent,
                    this.data.frente4001Tracoes, 
                    ['codigo', 'status', 'data', 'motivo'],
                    ['Código', 'Status', 'Data', 'Motivo']
                );
                
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Frente 4002
                this.addPDFReportSection(reportContent, 'Frente 4002');
                
                // Colhedoras
                const colhedorasSection2 = document.createElement('div');
                colhedorasSection2.innerHTML = `<h3>Colhedoras</h3>`;
                reportContent.appendChild(colhedorasSection2);
                
                this.addPDFTableForEquipment(
                    reportContent,
                    this.data.frente4002Colhedoras, 
                    ['codigo', 'status', 'data', 'motivo'],
                    ['Código', 'Status', 'Data', 'Motivo']
                );
                
                // Trações
                const tracoesSection2 = document.createElement('div');
                tracoesSection2.innerHTML = `<h3>Trações</h3>`;
                reportContent.appendChild(tracoesSection2);
                
                this.addPDFTableForEquipment(
                    reportContent,
                    this.data.frente4002Tracoes, 
                    ['codigo', 'status', 'data', 'motivo'],
                    ['Código', 'Status', 'Data', 'Motivo']
                );
                
                reportContent.appendChild(this.createPDFPageBreak());
                
                // Seção Manutenção
                this.addPDFReportSection(reportContent, 'Equipamentos em Manutenção');
                
                // Adicionar tabela de equipamentos em manutenção
                const maintenanceEquipments = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                        tipo: 'Reboque',
                        id: r.frota,
                        data: r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-',
                        motivo: r.motivo || '-'
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                        tipo: 'Caminhão Próprio',
                        id: c.caminhao,
                        data: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                        motivo: c.motivo || '-'
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                        tipo: 'Caminhão Terceiro',
                        id: c.caminhao,
                        data: '-',
                        motivo: c.motivo || '-'
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        tipo: 'Colhedora F4001',
                        id: c.codigo,
                        data: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                        motivo: c.motivo || '-'
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        tipo: 'Tração F4001',
                        id: t.codigo,
                        data: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                        motivo: t.motivo || '-'
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        tipo: 'Colhedora F4002',
                        id: c.codigo,
                        data: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                        motivo: c.motivo || '-'
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        tipo: 'Tração F4002',
                        id: t.codigo,
                        data: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                        motivo: t.motivo || '-'
                    }))
                ];
                
                if (maintenanceEquipments.length === 0) {
                    const noMaintenanceMsg = document.createElement('p');
                    noMaintenanceMsg.textContent = 'Não há equipamentos em manutenção no momento.';
                    reportContent.appendChild(noMaintenanceMsg);
                } else {
                    // Adicionar tabela
                    const maintenanceTable = document.createElement('table');
                    
                    // Cabeçalho
                    const tableHeader = document.createElement('thead');
                    tableHeader.innerHTML = `
                        <tr>
                            <th>Tipo</th>
                            <th>ID</th>
                            <th>Data</th>
                            <th>Motivo</th>
                        </tr>
                    `;
                    maintenanceTable.appendChild(tableHeader);
                    
                    // Corpo da tabela
                    const tableBody = document.createElement('tbody');
                    maintenanceEquipments.forEach(equipment => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${equipment.tipo}</td>
                            <td>${equipment.id}</td>
                            <td>${equipment.data}</td>
                            <td>${equipment.motivo}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                    maintenanceTable.appendChild(tableBody);
                    
                    reportContent.appendChild(maintenanceTable);
                }
                
                // Adicionar rodapé
                const footer = document.createElement('div');
                footer.className = 'footer';
                footer.innerHTML = `
                    <p>Sistema de Gestão de Frota e Manutenção - Relatório Gerado em ${dateStr} ${timeStr}</p>
                `;
                reportContent.appendChild(footer);
                
                // Executar impressão
                window.print();
            },
            
            // Utilitários para relatório em PDF
            addPDFReportSection(container, title) {
                const section = document.createElement('h2');
                section.textContent = title;
                container.appendChild(section);
            },
            
            createPDFPageBreak() {
                const pageBreak = document.createElement('div');
                pageBreak.className = 'pdf-page-break';
                return pageBreak;
            },
            
            addPDFSectionForEquipmentType(container, title, data, fields, headers) {
                this.addPDFReportSection(container, title);
                
                // Adicionar contadores de status
                const operational = data.filter(item => item.status === 'Operacional').length;
                const maintenance = data.filter(item => item.status === 'Em manutenção').length;
                const reform = data.filter(item => 
                    item.status === 'Em reforma' || item.status === 'Inoperante' || item.status === 'Aguardando reforma'
                ).length;
                
                // Disponibilidade
                const availability = data.length > 0 ? Math.round(operational / data.length * 100) : 0;
                
                // Adicionar resumo
                const summaryBox = document.createElement('div');
                summaryBox.className = 'summary-box';
                summaryBox.innerHTML = `
                    <h3>Resumo - ${title}</h3>
                    <div class="grid-container">
                        <div class="grid-item">
                            <p>Total</p>
                            <p class="data-highlight">${data.length}</p>
                        </div>
                        <div class="grid-item">
                            <p>Disponibilidade</p>
                            <p class="data-highlight">${availability}%</p>
                        </div>
                        <div class="grid-item">
                            <p>Operacionais</p>
                            <p class="data-highlight">${operational}</p>
                        </div>
                        <div class="grid-item">
                            <p>Em Manutenção</p>
                            <p class="data-highlight">${maintenance}</p>
                        </div>
                    </div>
                `;
                container.appendChild(summaryBox);
                
                // Adicionar tabela
                this.addPDFTableForEquipment(container, data, fields, headers);
            },
            
            addPDFTableForEquipment(container, data, fields, headers) {
                if (data.length === 0) {
                    const noDataMsg = document.createElement('p');
                    noDataMsg.textContent = 'Não há dados para exibir.';
                    container.appendChild(noDataMsg);
                    return;
                }
                
                const table = document.createElement('table');
                
                // Cabeçalho
                const tableHeader = document.createElement('thead');
                const headerRow = document.createElement('tr');
                
                headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    headerRow.appendChild(th);
                });
                
                tableHeader.appendChild(headerRow);
                table.appendChild(tableHeader);
                
                // Corpo da tabela
                const tableBody = document.createElement('tbody');
                
                data.forEach(item => {
                    const row = document.createElement('tr');
                    
                    fields.forEach(field => {
                        const td = document.createElement('td');
                        
                        // Formatar data se necessário
                        if ((field === 'data' || field === 'dataParada') && item[field]) {
                            const date = new Date(item[field]);
                            td.textContent = date.toLocaleDateString('pt-BR');
                        } else {
                            td.textContent = item[field] || '-';
                        }
                        
                        row.appendChild(td);
                    });
                    
                    tableBody.appendChild(row);
                });
                
                table.appendChild(tableBody);
                container.appendChild(table);
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                // Criar container se não existir
                const container = document.getElementById('notification-container');
                
                const notification = document.createElement('div');
                notification.className = `notification p-4 rounded-md shadow-md ${
                    type === 'success' ? 'bg-green-50 dark:bg-green-900 border-l-4 border-green-500' :
                    type === 'error' ? 'bg-red-50 dark:bg-red-900 border-l-4 border-red-500' :
                    type === 'info' ? 'bg-blue-50 dark:bg-blue-900 border-l-4 border-blue-500' :
                    'bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-500'
                }`;
                
                notification.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas ${
                                    type === 'success' ? 'fa-check-circle text-green-600 dark:text-green-400' :
                                    type === 'error' ? 'fa-exclamation-circle text-red-600 dark:text-red-400' :
                                    type === 'info' ? 'fa-info-circle text-blue-600 dark:text-blue-400' :
                                    'fa-exclamation-triangle text-yellow-600 dark:text-yellow-400'
                                } text-lg"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium ${
                                    type === 'success' ? 'text-green-800 dark:text-green-200' :
                                    type === 'error' ? 'text-red-800 dark:text-red-200' :
                                    type === 'info' ? 'text-blue-800 dark:text-blue-200' :
                                    'text-yellow-800 dark:text-yellow-200'
                                }">${title}</h3>
                                <div class="mt-1 text-sm ${
                                    type === 'success' ? 'text-green-700 dark:text-green-300' :
                                    type === 'error' ? 'text-red-700 dark:text-red-300' :
                                    type === 'info' ? 'text-blue-700 dark:text-blue-300' :
                                    'text-yellow-700 dark:text-yellow-300'
                                }">
                                    ${message}
                                </div>
                            </div>
                        </div>
                        <button class="notification-close ml-4 text-gray-400 hover:text-gray-500 dark:text-gray-400 dark:hover:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                // Adicionar ao container
                container.appendChild(notification);
                
                // Adicionar event listener para fechar
                const closeButton = notification.querySelector('.notification-close');
                closeButton.addEventListener('click', () => {
                    notification.classList.add('fadeOut');
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                });
                
                // Auto-close após 5 segundos
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.classList.add('fadeOut');
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }
                }, 5000);
            },
            
            // Filtrar dados com base no termo de pesquisa
            filterData(dataArray) {
                if (!this.data.searchTerm || this.data.searchTerm.trim() === '') {
                    return dataArray;
                }
                
                const searchTerm = this.data.searchTerm.toLowerCase();
                
                return dataArray.filter(item => {
                    // Verificar em todos os campos do objeto
                    return Object.values(item).some(value => {
                        if (value === null || value === undefined) return false;
                        return String(value).toLowerCase().includes(searchTerm);
                    });
                });
            },
            
            // Salvar dados no localStorage
            saveDataToLocalStorage() {
                try {
                    const dataToSave = {
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules
                    };
                    
                    localStorage.setItem('fleetManagementData', JSON.stringify(dataToSave));
                } catch (error) {
                    console.error('Erro ao salvar dados no localStorage:', error);
                }
            },
            
            // Carregar dados do localStorage
            loadDataFromLocalStorage() {
                try {
                    const savedData = localStorage.getItem('fleetManagementData');
                    
                    if (savedData) {
                        const parsedData = JSON.parse(savedData);
                        
                        // Atualizar dados
                        this.data.reboques = parsedData.reboques || [];
                        this.data.caminhoesProps = parsedData.caminhoesProps || [];
                        this.data.caminhoesTerc = parsedData.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = parsedData.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = parsedData.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = parsedData.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = parsedData.frente4002Tracoes || [];
                        this.data.history = parsedData.history || {};
                        this.data.schedules = parsedData.schedules || [];
                        
                        return true;
                    }
                    
                    return false;
                } catch (error) {
                    console.error('Erro ao carregar dados do localStorage:', error);
                    return false;
                }
            },
            
            // Inicializar o aplicativo
            initialize() {
                console.log('Initializing fleet management application...');
                
                // Carregar dados do localStorage ou carregar dados de exemplo
                const dataLoaded = this.loadDataFromLocalStorage();
                if (!dataLoaded) {
                    this.loadSampleData();
                }
                
                // Configurar event listeners
                this.setupEventListeners();
                
                // Configurar gráficos
                this.setupCharts();
                
                // Renderizar tabelas
                this.renderAllTables();
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Atualizar gráficos
                this.updateAllCharts();
                
                // Inicializar visualização real
                this.initializeRealEquipmentView();
                
                // Detectar modo escuro
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                // Mostrar notificação de boas-vindas
                this.showNotification('info', 'Bem-vindo', 'Sistema de Gestão de Frota inicializado com sucesso!');
            }
        };
        
        // Inicializar o gerenciador de frota quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', () => {
            fleetManager.initialize();
        });
    </script>
</body>
</html>
