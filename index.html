<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Frota e Manutenção</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#5D5CDE',
                            dark: '#4B4ACB'
                        },
                        gray: {
                            750: '#2B3544'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    },
                    fontSize: {
                        'base': '1rem',
                        'lg': '1.125rem',
                        'xl': '1.375rem',
                        '2xl': '1.625rem',
                        '3xl': '2rem',
                        '4xl': '2.375rem',
                        '5xl': '3rem',
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Estilos personalizados */
        body {
            font-size: 16px;
        }
        
        .sidebar-link {
            transition: all 0.2s;
            font-size: 1.05rem;
        }
        
        .sidebar-link:hover {
            background-color: rgba(93, 92, 222, 0.1);
        }
        
        .sidebar-link.active {
            background-color: rgba(93, 92, 222, 0.1);
            border-left: 3px solid #5D5CDE;
        }
        
        .status-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 999px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-badge-operational {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }
        
        .status-badge-maintenance {
            background-color: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }
        
        .status-badge-reform {
            background-color: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }
        
        .status-badge-other {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6B7280;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
        }
        
        /* Estilos para impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            
            body {
                font-size: 14pt;
            }
            
            #print-area, #print-area * {
                visibility: visible;
            }
            
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            #print-area h1 {
                font-size: 24pt;
            }
            
            #print-area h2 {
                font-size: 20pt;
            }
            
            #print-area h3 {
                font-size: 16pt;
            }
            
            #print-area p, #print-area td, #print-area th {
                font-size: 12pt;
            }
            
            #print-area .text-xl, #print-area .text-2xl {
                font-size: 16pt;
            }
            
            #print-area table {
                page-break-inside: avoid;
            }
            
            .pdf-page-break {
                page-break-after: always;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        /* Animação para notificações */
        .notification {
            animation: slide-in 0.3s ease-out;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        @keyframes slide-in {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        /* Estilos para melhor visualização em prints */
        .dashboard-value {
            font-size: 1.75rem;
            font-weight: 700;
        }
        
        .dashboard-label {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .table-content td, .table-content th {
            font-size: 1.05rem;
            padding: 0.75rem 1rem;
        }
        
        .table-content th {
            font-weight: 600;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .card-subtitle {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .data-value {
            font-size: 1.75rem;
            font-weight: 700;
        }
        
        .data-label {
            font-size: 1.1rem;
        }
        
        /* Melhorias para barras de progresso */
        .progress-bar {
            height: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white min-h-screen">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside class="sidebar w-72 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 fixed h-full z-30 shadow-sm">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-truck-moving text-primary text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold truncate">Gestão de Frota</h1>
                </div>
                <button id="close-sidebar" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="py-4">
                <p class="px-4 text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Dashboard</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white active" data-target="main-dashboard">
                    <i class="fas fa-tachometer-alt w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Dashboard Principal</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="detailed-dashboard">
                    <i class="fas fa-chart-line w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Dashboard Detalhado</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="real-equipment-view">
                    <i class="fas fa-eye w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Visualização Real</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Equipamentos</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="reboques">
                    <i class="fas fa-trailer w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Reboques</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-proprios">
                    <i class="fas fa-truck w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Caminhões Próprios</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-terceiros">
                    <i class="fas fa-truck-moving w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Caminhões Terceiros</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4001">
                    <i class="fas fa-tractor w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Frente 4001</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4002">
                    <i class="fas fa-tractor w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Frente 4002</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Sistema</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-cog w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Configurações</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-question-circle w-6 text-gray-500 dark:text-gray-400 text-lg"></i>
                    <span class="ml-3">Ajuda</span>
                </a>
            </div>
            
            <div class="mt-auto p-4 border-t border-gray-200 dark:border-gray-700">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center">
                        <i class="fas fa-user text-lg"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-base font-medium">Administrador</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">admin@exemplo.com</p>
                    </div>
                    <button class="ml-auto text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                        <i class="fas fa-sign-out-alt text-lg"></i>
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden ml-0 md:ml-72">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm p-5 flex items-center">
                <button id="sidebar-toggle" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white mr-3 text-xl">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav class="hidden md:flex flex-1">
                    <ol class="flex items-center text-base">
                        <li><a href="#" class="text-primary hover:text-primary-dark font-medium">Início</a></li>
                        <li class="mx-2 text-gray-500 dark:text-gray-400">/</li>
                        <li class="text-gray-500 dark:text-gray-400 font-medium" id="current-page">Dashboard</li>
                    </ol>
                </nav>
                
                <div class="flex items-center ml-auto">
                    <button id="theme-toggle" class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2 text-xl">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                    
                    <button class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2 relative text-xl">
                        <i class="fas fa-bell"></i>
                        <span class="absolute top-1 right-1 w-3 h-3 bg-primary rounded-full"></span>
                    </button>
                    
                    <div class="relative ml-2">
                        <button id="action-menu-btn" class="flex items-center text-base font-medium text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                            <span class="mr-1">Ações</span>
                            <i class="fas fa-chevron-down text-sm"></i>
                        </button>
                        
                        <div id="action-menu" class="absolute right-0 mt-2 w-52 bg-white dark:bg-gray-750 rounded-md shadow-lg z-10 border border-gray-200 dark:border-gray-700 hidden">
                            <div class="py-1">
                                <button id="add-equipment-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-plus text-gray-500 dark:text-gray-400 mr-2"></i> Adicionar Equipamento
                                </button>
                                <button id="export-csv-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-file-csv text-gray-500 dark:text-gray-400 mr-2"></i> Exportar para CSV
                                </button>
                                <button id="export-json-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-file-code text-gray-500 dark:text-gray-400 mr-2"></i> Exportar Backup (JSON)
                                </button>
                                <button id="print-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-print text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Tabela
                                </button>
                                <button id="print-dashboard-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-chart-bar text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Dashboard
                                </button>
                                <button id="pdf-report-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-file-pdf text-gray-500 dark:text-gray-400 mr-2"></i> Gerar Relatório PDF
                                </button>
                                <button id="import-backup-btn" class="w-full text-left px-4 py-2 text-base text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-upload text-gray-500 dark:text-gray-400 mr-2"></i> Importar Backup
                                </button>
                                <button id="clear-data-btn" class="w-full text-left px-4 py-2 text-base text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900">
                                    <i class="fas fa-trash-alt text-red-500 dark:text-red-400 mr-2"></i> Excluir Todos os Registros
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Área de conteúdo principal -->
            <main class="flex-1 overflow-y-auto p-6">
                <!-- Conteúdo das tabs -->
                
                <!-- Dashboard principal -->
                <div id="main-dashboard" class="tab-content active">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Dashboard</h2>
                        
                        <!-- Resumo -->
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-5 mb-8">
                            <div class="col-span-1 md:col-span-3 lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <h3 class="text-xl font-medium mb-4">Resumo da Frota</h3>
                                <div class="grid grid-cols-2 gap-5">
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Operacionais</p>
                                        <p class="text-3xl font-bold text-green-500 mt-1" id="dash-summary-operational">0</p>
                                    </div>
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Em Manutenção</p>
                                        <p class="text-3xl font-bold text-yellow-500 mt-1" id="dash-summary-maintenance">0</p>
                                    </div>
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Em Reforma</p>
                                        <p class="text-3xl font-bold text-red-500 mt-1" id="dash-summary-reform">0</p>
                                    </div>
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Emprestados</p>
                                        <p class="text-3xl font-bold text-blue-500 mt-1" id="dash-summary-borrowed">0</p>
                                    </div>
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Outros</p>
                                        <p class="text-3xl font-bold text-gray-500 mt-1" id="dash-summary-other">0</p>
                                    </div>
                                    <div>
                                        <p class="text-base text-gray-500 dark:text-gray-400 font-medium">Disponibilidade</p>
                                        <p class="text-3xl font-bold text-primary mt-1" id="dash-summary-availability">0%</p>
                                    </div>
                                </div>
                                <div class="mt-5">
                                    <div class="h-3 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-primary rounded-full" id="dash-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Disponibilidade global -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="text-lg font-medium">Frota Total</h3>
                                    <div class="flex items-center text-base text-gray-500 dark:text-gray-400">
                                        <span class="w-4 h-4 rounded-full bg-green-500 mr-2"></span>
                                        <span id="dash-global-operational-percent" class="font-medium">0%</span>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <p class="text-3xl font-bold mb-1" id="dash-global-total">0</p>
                                    <p class="text-base text-gray-500 dark:text-gray-400">Equipamentos</p>
                                </div>
                                <div class="flex items-center justify-between text-base">
                                    <div>
                                        <span class="text-green-500 font-medium text-lg" id="dash-global-operational">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Operacionais</span>
                                    </div>
                                    <div>
                                        <span class="text-yellow-500 font-medium text-lg" id="dash-global-maintenance">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Em Manutenção</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Cards -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                                        <i class="fas fa-trailer text-blue-500 text-lg"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium">Reboques</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-2" id="dash-reboques-count">0</p>
                                    <div class="flex justify-between items-center text-base mb-2">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-reboques-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-reboques-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="dash-reboques-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                                        <i class="fas fa-truck text-green-500 text-lg"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium">Caminhões</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-2" id="dash-cp-count">0</p>
                                    <div class="flex justify-between items-center text-base mb-2">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-cp-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-cp-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="dash-cp-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-orange-500 text-lg"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium">Frente 4001</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-2" id="dash-f4001-count">0</p>
                                    <div class="flex justify-between items-center text-base mb-2">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4001-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4001-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="dash-f4001-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-red-500 text-lg"></i>
                                    </div>
                                    <h3 class="ml-3 text-lg font-medium">Frente 4002</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-2" id="dash-f4002-count">0</p>
                                    <div class="flex justify-between items-center text-base mb-2">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4002-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4002-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="dash-f4002-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos e tabelas -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-5 mb-8">
                            <!-- Gráfico principal -->
                            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-medium">Status por Categoria</h3>
                                </div>
                                <div class="relative h-72">
                                    <canvas id="status-by-category-chart"></canvas>
                                    <div id="status-category-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400 text-lg">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Gráfico de disponibilidade -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-medium">Disponibilidade</h3>
                                </div>
                                <div class="relative h-72">
                                    <canvas id="availability-chart"></canvas>
                                    <div id="availability-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400 text-lg">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Listas de informações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <!-- Equipamentos em manutenção -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-medium">Equipamentos em Manutenção</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="equipment-maintenance-list">
                                    <li class="py-3">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Manutenções agendadas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-medium">Próximas Manutenções Agendadas</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="upcoming-maintenance-list">
                                    <li class="py-3">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard detalhado -->
                <div id="detailed-dashboard" class="tab-content bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white">Dashboard Detalhado</h2>
                        <button id="detailed-refresh-btn" class="btn-primary-outline bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                            <i class="fas fa-sync-alt mr-2"></i>Atualizar
                        </button>
                    </div>
                    
                    <!-- Resumo geral -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-8">
                        <!-- Total de equipamentos -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-14 h-14 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mr-4">
                                    <i class="fas fa-truck-moving text-primary text-2xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-base font-medium text-gray-500 dark:text-gray-400">Total de Equipamentos</h3>
                                    <p class="text-3xl font-bold text-gray-800 dark:text-white mt-1" id="detailed-total-equipment">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Disponibilidade geral -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-500 dark:text-gray-400 mb-2">Disponibilidade Geral</h3>
                            <p class="text-3xl font-bold text-gray-800 dark:text-white mb-3" id="detailed-operational-percentage">0%</p>
                            <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500 rounded-full" id="detailed-operational-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <!-- Total em manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-14 h-14 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                                    <i class="fas fa-tools text-yellow-500 text-2xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-base font-medium text-gray-500 dark:text-gray-400">Em Manutenção</h3>
                                    <p class="text-3xl font-bold text-gray-800 dark:text-white mt-1" id="detailed-total-maintenances">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Painel com gráficos -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <!-- Distribuição de status -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Distribuição de Status por Categoria</h3>
                            <div class="relative h-72">
                                <canvas id="detailed-status-distribution-chart"></canvas>
                                <div id="detailed-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tendência de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Tendência de Disponibilidade</h3>
                            <div class="relative h-72">
                                <canvas id="detailed-availability-trend-chart"></canvas>
                                <div id="detailed-trend-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Análise por categoria -->
                    <div class="mb-8">
                        <h3 class="text-xl font-medium text-gray-800 dark:text-white mb-5">Análise por Categoria</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mb-8">
                            <!-- Reboques -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-trailer text-blue-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Reboques</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-reboques-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-reboques-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-reboques-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="detailed-reboques-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Próprios -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck text-green-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Caminhões Próprios</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-cp-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-cp-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-cp-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="detailed-cp-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Terceiros -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-moving text-purple-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Caminhões Terceiros</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-ct-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-ct-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-ct-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-purple-500 rounded-full" id="detailed-ct-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4001 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-8">
                            <!-- Frente 4001 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-orange-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Frente 4001 - Colhedoras</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-colh-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-f4001-colh-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-f4001-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4001 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-orange-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Frente 4001 - Trações</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-trac-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-f4001-trac-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-f4001-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4002 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-8">
                            <!-- Frente 4002 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-red-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Frente 4002 - Colhedoras</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-colh-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-f4002-colh-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-f4002-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4002 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-red-500 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-medium">Frente 4002 - Trações</h4>
                                        <p class="text-base text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-trac-count" class="font-medium">0</span></p>
                                    </div>
                                    <p class="ml-auto text-xl font-bold" id="detailed-f4002-trac-availability">0%</p>
                                </div>
                                <div class="mt-3">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-base text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-base font-medium" id="detailed-f4002-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs -->
                    <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-8">
                        <h3 class="text-xl font-medium text-gray-800 dark:text-white mb-5">Indicadores de Desempenho</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
                            <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-base font-medium text-gray-500 dark:text-gray-400">MTBF (Tempo Médio Entre Falhas)</h4>
                                <p class="text-2xl font-bold mt-2" id="detailed-mtbf">-</p>
                            </div>
                            <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-base font-medium text-gray-500 dark:text-gray-400">MTTR (Tempo Médio Para Reparo)</h4>
                                <p class="text-2xl font-bold mt-2" id="detailed-mttr">-</p>
                            </div>
                            <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-base font-medium text-gray-500 dark:text-gray-400">OEE (Eficácia Global do Equipamento)</h4>
                                <p class="text-2xl font-bold mt-2" id="detailed-oee">-</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos adicionais -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Causas de manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Causas de Manutenção</h3>
                            <div class="relative h-72">
                                <canvas id="detailed-maintenance-causes-chart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Previsão de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Previsão de Disponibilidade</h3>
                            <div class="relative h-72">
                                <canvas id="detailed-forecast-chart"></canvas>
                                <div id="detailed-forecast-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Dados insuficientes para previsão</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Visualização Real da Frota -->
                <div id="real-equipment-view" class="tab-content hidden">
                    <div class="mb-8">
                        <div class="flex flex-wrap justify-between items-center mb-6">
                            <h2 class="text-2xl font-semibold text-gray-800 dark:text-white">Visualização Real da Frota</h2>
                            <p class="mt-2 md:mt-0 text-lg text-gray-500 dark:text-gray-400" id="real-equipment-count">0 equipamentos</p>
                        </div>
                        
                        <!-- Filtros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <h3 class="text-lg font-medium mb-4">Filtros</h3>
                            <div class="flex flex-wrap gap-3">
                                <button onclick="APP.filterRealEquipment('all')" class="px-4 py-2 bg-primary text-white rounded-md text-base hover:bg-primary-dark transition">
                                    Todos
                                </button>
                                <button onclick="APP.filterRealEquipment('operational')" class="px-4 py-2 bg-green-500 text-white rounded-md text-base hover:bg-green-600 transition">
                                    Operacionais
                                </button>
                                <button onclick="APP.filterRealEquipment('maintenance')" class="px-4 py-2 bg-yellow-500 text-white rounded-md text-base hover:bg-yellow-600 transition">
                                    Em Manutenção
                                </button>
                                <button onclick="APP.filterRealEquipment('reform')" class="px-4 py-2 bg-red-500 text-white rounded-md text-base hover:bg-red-600 transition">
                                    Em Reforma
                                </button>
                                <button onclick="APP.filterRealEquipment('reboques')" class="px-4 py-2 bg-blue-500 text-white rounded-md text-base hover:bg-blue-600 transition">
                                    Reboques
                                </button>
                                <button onclick="APP.filterRealEquipment('caminhoes')" class="px-4 py-2 bg-gray-500 text-white rounded-md text-base hover:bg-gray-600 transition">
                                    Caminhões
                                </button>
                                <button onclick="APP.filterRealEquipment('colhedoras')" class="px-4 py-2 bg-orange-500 text-white rounded-md text-base hover:bg-orange-600 transition">
                                    Colhedoras
                                </button>
                                <button onclick="APP.filterRealEquipment('tracoes')" class="px-4 py-2 bg-purple-500 text-white rounded-md text-base hover:bg-purple-600 transition">
                                    Trações
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4001')" class="px-4 py-2 bg-orange-400 text-white rounded-md text-base hover:bg-orange-500 transition">
                                    Frente 4001
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4002')" class="px-4 py-2 bg-red-400 text-white rounded-md text-base hover:bg-red-500 transition">
                                    Frente 4002
                                </button>
                            </div>
                        </div>
                        
                        <!-- Visualização real -->
                        <div id="real-equipment-container" class="mt-8">
                            <!-- Equipamentos serão renderizados via JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Reboques -->
                <div id="reboques" class="tab-content hidden">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Reboques</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Operacionais</p>
                                    <p class="text-2xl font-bold text-green-500" id="reboques-operational">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-operational-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Manutenção</p>
                                    <p class="text-2xl font-bold text-yellow-500" id="reboques-maintenance">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-maintenance-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Reforma</p>
                                    <p class="text-2xl font-bold text-red-500" id="reboques-reform">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-reform-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Disponibilidade</p>
                                    <p class="text-2xl font-bold text-blue-500" id="reboques-availability">0%</p>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-blue-500 rounded-full" id="reboques-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <h3 class="text-xl font-medium mb-4">Status dos Reboques</h3>
                            <div class="relative h-72">
                                <canvas id="reboques-status-chart"></canvas>
                                <div id="reboques-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-5 py-4 border border-gray-200 dark:border-gray-700 mb-6 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="reboques-search" placeholder="Buscar..." class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <select id="reboques-status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Aguardando reforma">Aguardando reforma</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="reboques-add-btn" class="bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de reboques -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-content">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="frota">
                                                <button class="flex items-center">
                                                    Frota
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="tipo">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="acoplado">
                                                <button class="flex items-center">
                                                    Acoplado
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="dataParada">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-5 py-4 text-right text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="reboques-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Próprios -->
                <div id="caminhoes-proprios" class="tab-content hidden">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Caminhões Próprios</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Operacionais</p>
                                    <p class="text-2xl font-bold text-green-500" id="cp-operational">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="cp-operational-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Manutenção</p>
                                    <p class="text-2xl font-bold text-yellow-500" id="cp-maintenance">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="cp-maintenance-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Reforma</p>
                                    <p class="text-2xl font-bold text-red-500" id="cp-reform">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1"><span id="cp-reform-percentage" class="font-medium">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Disponibilidade</p>
                                    <p class="text-2xl font-bold text-green-500" id="cp-availability">0%</p>
                                    <div class="h-2.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-green-500 rounded-full" id="cp-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-5 py-4 border border-gray-200 dark:border-gray-700 mb-6 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="cp-search" placeholder="Buscar..." class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <select id="cp-status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Emprestado">Emprestado</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="cp-add-btn" class="bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões próprios -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-content">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-5 py-4 text-right text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="cp-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Terceiros -->
                <div id="caminhoes-terceiros" class="tab-content hidden">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Caminhões Terceiros</h2>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-5 py-4 border border-gray-200 dark:border-gray-700 mb-6 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="ct-search" placeholder="Buscar..." class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <select id="ct-status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="ct-add-btn" class="bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões terceiros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-content">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="proprietario">
                                                <button class="flex items-center">
                                                    Proprietário
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Reboques
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-5 py-4 text-right text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="ct-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4001 -->
                <div id="frente-4001" class="tab-content hidden">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Frente 4001</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Total de Equipamentos</p>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="f4001-total">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Operacionais</p>
                                    <p class="text-2xl font-bold text-green-500" id="f4001-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Manutenção</p>
                                    <p class="text-2xl font-bold text-yellow-500" id="f4001-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Reforma</p>
                                    <p class="text-2xl font-bold text-red-500" id="f4001-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-5">
                                <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-3 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-orange-500 rounded-full" id="f4001-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-4 font-bold text-xl" id="f4001-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-5 py-4 border border-gray-200 dark:border-gray-700 mb-6 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4001-search" placeholder="Buscar..." class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <select id="f4001-type-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-4">
                                    <select id="f4001-status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-4">
                                    <select id="f4001-add-type" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4001">Colhedora</option>
                                        <option value="tracao-4001">Tração</option>
                                    </select>
                                </div>
                                <button id="f4001-add-btn" class="bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4001 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-content">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-5 py-4 text-right text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4001-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4002 -->
                <div id="frente-4002" class="tab-content hidden">
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-6">Frente 4002</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 border border-gray-200 dark:border-gray-700 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-5">
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Total de Equipamentos</p>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="f4002-total">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Operacionais</p>
                                    <p class="text-2xl font-bold text-green-500" id="f4002-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Manutenção</p>
                                    <p class="text-2xl font-bold text-yellow-500" id="f4002-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Em Reforma</p>
                                    <p class="text-2xl font-bold text-red-500" id="f4002-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-5">
                                <p class="text-base text-gray-500 dark:text-gray-400 font-medium mb-2">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-3 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-red-500 rounded-full" id="f4002-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-4 font-bold text-xl" id="f4002-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-5 py-4 border border-gray-200 dark:border-gray-700 mb-6 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4002-search" placeholder="Buscar..." class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <select id="f4002-type-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-4">
                                    <select id="f4002-status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-4">
                                    <select id="f4002-add-type" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-base focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4002">Colhedora</option>
                                        <option value="tracao-4002">Tração</option>
                                    </select>
                                </div>
                                <button id="f4002-add-btn" class="bg-primary text-white px-4 py-2 rounded-md text-base hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4002 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 table-content">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-2 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-5 py-4 text-left text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-5 py-4 text-right text-base font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4002-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Modais -->
    
    <!-- Modal para adicionar equipamento -->
    <div id="add-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white">Adicionar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('add-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Equipamento</label>
                    <select id="equipment-type" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                        <option value="reboque">Reboque</option>
                        <option value="caminhao-proprio">Caminhão Próprio</option>
                        <option value="caminhao-terceiro">Caminhão Terceiro</option>
                        <option value="colhedora-4001">Colhedora Frente 4001</option>
                        <option value="tracao-4001">Tração Frente 4001</option>
                        <option value="colhedora-4002">Colhedora Frente 4002</option>
                        <option value="tracao-4002">Tração Frente 4002</option>
                    </select>
                </div>
                
                <div id="add-form-fields" class="text-base">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('add-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-equipment-btn" class="px-5 py-2 text-base bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para editar equipamento -->
    <div id="edit-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white" id="modal-title">Editar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div id="edit-form-fields" class="text-base">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-changes-btn" class="px-5 py-2 text-base bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão -->
    <div id="delete-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white">Confirmar Exclusão</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="mb-5">
                    <div class="flex items-center justify-center mb-5 text-red-500">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                    </div>
                    <p id="delete-confirm-message" class="text-center text-lg">Tem certeza que deseja excluir este equipamento?</p>
                    <p id="delete-item-details" class="text-center mt-3 font-medium text-lg"></p>
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-delete-btn" class="px-5 py-2 text-base bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão de todos os registros -->
    <div id="clear-data-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white">Confirmar Exclusão Total</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="mb-5">
                    <div class="flex items-center justify-center mb-5 text-red-500">
                        <i class="fas fa-exclamation-triangle text-6xl"></i>
                    </div>
                    <p class="text-center text-xl font-bold text-red-600 dark:text-red-400">ATENÇÃO!</p>
                    <p class="text-center mt-3 text-lg">Você está prestes a excluir TODOS os registros do sistema. Esta ação não pode ser desfeita.</p>
                    <p class="text-center mt-5 font-medium text-lg">Por favor, digite "CONFIRMAR" para prosseguir:</p>
                    <input type="text" id="clear-data-confirmation" class="w-full mt-3 px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-lg" placeholder="Digite CONFIRMAR">
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-clear-data-btn" class="px-5 py-2 text-base bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir Todos os Registros
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para importar backup -->
    <div id="import-backup-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white">Importar Backup</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="mb-5">
                    <p class="mb-4 text-lg">Selecione um arquivo JSON de backup para importar. Este arquivo substituirá todos os dados atuais do sistema.</p>
                    <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center">
                        <input type="file" id="backup-file-input" accept=".json" class="hidden">
                        <label for="backup-file-input" class="cursor-pointer">
                            <i class="fas fa-file-upload text-gray-400 text-4xl mb-3"></i>
                            <p class="text-gray-500 dark:text-gray-400 text-lg">Clique para selecionar um arquivo JSON</p>
                            <p class="text-base text-gray-400 dark:text-gray-500 mt-2">ou arraste e solte aqui</p>
                        </label>
                        <p id="selected-file-name" class="mt-3 text-lg text-primary hidden"></p>
                    </div>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="import-backup-btn" class="px-5 py-2 text-base bg-primary text-white rounded-md hover:bg-primary-dark transition" disabled>
                        Importar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para visualizar histórico -->
    <div id="history-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-primary bg-opacity-10 text-primary flex items-center justify-center mr-3">
                        <i id="history-icon" class="fas fa-truck text-xl"></i>
                    </div>
                    <div>
                        <h3 id="history-title" class="text-xl font-medium text-gray-800 dark:text-white">Histórico</h3>
                        <p id="history-subtitle" class="text-base text-gray-500 dark:text-gray-400">Total de registros: 0</p>
                    </div>
                </div>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="p-5 overflow-y-auto flex-1">
                <div class="relative pl-12 border-l-2 border-gray-200 dark:border-gray-700" id="history-timeline">
                    <!-- Histórico será carregado via JavaScript -->
                </div>
            </div>
            
            <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button class="px-5 py-2 text-base bg-primary text-white rounded-md hover:bg-primary-dark transition" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    Fechar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal para agendar manutenção -->
    <div id="schedule-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-xl font-medium text-gray-800 dark:text-white">Agendar Manutenção</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <div id="schedule-equipment-info" class="mb-5 text-lg">
                    <!-- Detalhes do equipamento serão carregados via JavaScript -->
                </div>
                
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                    <input type="date" id="schedule-date" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" required>
                </div>
                
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Hora</label>
                    <input type="time" id="schedule-time" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" required>
                </div>
                
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Manutenção</label>
                    <select id="schedule-type" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" required>
                        <option value="preventiva">Manutenção Preventiva</option>
                        <option value="corretiva">Manutenção Corretiva</option>
                        <option value="revisao">Revisão Geral</option>
                        <option value="troca-oleo">Troca de Óleo</option>
                        <option value="reforma">Reforma</option>
                    </select>
                </div>
                
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Descrição</label>
                    <textarea id="schedule-description" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva a manutenção a ser realizada" required></textarea>
                </div>
                
                <div class="mb-5">
                    <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Responsável</label>
                    <input type="text" id="schedule-responsible" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Nome do responsável" required>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-3 px-5 py-2 text-base bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-schedule-btn" class="px-5 py-2 text-base bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Agendar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Área de impressão -->
    <div id="print-area" class="hidden bg-white text-black p-8">
        <div class="mb-8 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="print-title" class="text-3xl font-bold">Relatório</h1>
                <p id="print-date" class="text-xl text-gray-600"></p>
            </div>
        </div>
        
        <div id="print-content" class="mb-8 text-lg">
            <!-- Conteúdo para impressão será inserido aqui -->
        </div>
        
        <div class="text-right text-base text-gray-500 mt-8">
            <p>Gerado em: <span id="print-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Área para relatório PDF -->
    <div id="pdf-report-area" class="hidden bg-white text-black p-8">
        <div class="mb-8 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="pdf-report-title" class="text-3xl font-bold">Relatório Completo</h1>
                <p id="pdf-report-date" class="text-xl text-gray-600"></p>
            </div>
        </div>
        
        <div id="pdf-report-content" class="mb-8 text-lg">
            <!-- Conteúdo do relatório PDF será inserido aqui -->
        </div>
        
        <div class="text-right text-base text-gray-500 mt-8">
            <p>Gerado em: <span id="pdf-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Container para notificações -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 flex flex-col space-y-3"></div>
    
    <!-- JavaScript -->
    <script>
        // Aplicação principal
        const APP = {
            data: {
                // Dados dos equipamentos
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                
                // Histórico
                history: {},
                
                // Agendamentos
                schedules: [],
                
                // Preferências e estados da UI
                currentSort: {
                    field: null,
                    direction: 'asc'
                },
                searchText: '',
                statusFilter: 'all',
                typeFilter: 'all',
                
                // Referências para os gráficos
                charts: {},
                
                // Estado de edição
                editingItem: null,
                editingType: null,
                
                // Estado de exclusão
                deletingId: null,
                deletingType: null,
                deletingIndex: null,
                deletingArray: null,
                
                // Estado de agendamento
                schedulingEquipment: null
            },
            
            // Inicializar a aplicação
            init() {
                // Configurar temas e preferências
                this.setupTheme();
                
                // Inicializar interface
                this.initUI();
                
                // Carregar dados
                this.loadData();
                
                // Inicializar gráficos
                this.initializeCharts();
                
                // Renderizar tabelas
                this.renderAllTables();
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Carregar visualização real
                this.initializeRealEquipmentView();
                
                // Atualizar todos os gráficos
                this.updateAllCharts();
                
                // Configurar event listeners
                this.setupEventListeners();
            },
            
            // Configurar tema (claro/escuro)
            setupTheme() {
                const themeToggle = document.getElementById('theme-toggle');
                
                // Configurar tema baseado na preferência do sistema
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                // Toggle de tema claro/escuro
                themeToggle.addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                });
            },
            
            // Inicializar a interface do usuário
            initUI() {
                // Configurar navegação entre abas
                document.querySelectorAll('[data-target]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // Atualizar classes do link
                        document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                        
                        // Atualizar o conteúdo visível
                        const targetId = link.getAttribute('data-target');
                        document.querySelectorAll('.tab-content').forEach(tab => {
                            tab.classList.add('hidden');
                            tab.classList.remove('active');
                        });
                        
                        const target = document.getElementById(targetId);
                        target.classList.remove('hidden');
                        target.classList.add('active');
                        
                        // Atualizar breadcrumb
                        document.getElementById('current-page').textContent = link.querySelector('span').textContent;
                        
                        // Fechar sidebar em dispositivos móveis
                        if (window.innerWidth < 768) {
                            document.querySelector('.sidebar').classList.remove('open');
                        }
                    });
                });
                
                // Toggle sidebar em dispositivos móveis
                document.getElementById('sidebar-toggle').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.add('open');
                });
                
                document.getElementById('close-sidebar').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.remove('open');
                });
                
                // Menu de ações
                const actionMenuBtn = document.getElementById('action-menu-btn');
                const actionMenu = document.getElementById('action-menu');
                
                actionMenuBtn.addEventListener('click', () => {
                    actionMenu.classList.toggle('hidden');
                });
                
                // Fechar o menu ao clicar fora dele
                document.addEventListener('click', (e) => {
                    if (!actionMenuBtn.contains(e.target) && !actionMenu.contains(e.target)) {
                        actionMenu.classList.add('hidden');
                    }
                });
                
                // Formulário de adição de equipamento
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Botões de ação
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('save-equipment-btn').addEventListener('click', () => {
                    this.saveNewEquipment();
                });
                
                document.getElementById('save-changes-btn').addEventListener('click', () => {
                    this.saveEquipmentChanges();
                });
                
                document.getElementById('confirm-delete-btn').addEventListener('click', () => {
                    this.deleteEquipment();
                });
                
                document.getElementById('save-schedule-btn').addEventListener('click', () => {
                    this.saveSchedule();
                });
                
                // Botões para adicionar equipamentos específicos
                document.getElementById('reboques-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'reboque';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('cp-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-proprio';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('ct-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-terceiro';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4001-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4001-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4002-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4002-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                // Botões de exportação e impressão
                document.getElementById('export-csv-btn').addEventListener('click', () => {
                    this.exportToCSV();
                });

                document.getElementById('export-json-btn').addEventListener('click', () => {
                    this.exportToJSON();
                });
                
                document.getElementById('print-btn').addEventListener('click', () => {
                    this.printActiveTable();
                });
                
                document.getElementById('print-dashboard-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                document.getElementById('pdf-report-btn').addEventListener('click', () => {
                    this.generatePDFReport();
                });
                
                // Botão de limpeza de dados
                document.getElementById('clear-data-btn').addEventListener('click', () => {
                    document.getElementById('clear-data-confirm-modal').classList.remove('hidden');
                });
                
                document.getElementById('confirm-clear-data-btn').addEventListener('click', () => {
                    this.clearAllData();
                });
                
                // Botão para importar backup
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    document.getElementById('import-backup-modal').classList.remove('hidden');
                });
                
                // Configurar input de arquivo de backup
                const fileInput = document.getElementById('backup-file-input');
                const fileNameDisplay = document.getElementById('selected-file-name');
                const importBtn = document.getElementById('import-backup-btn');
                
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        const file = e.target.files[0];
                        fileNameDisplay.textContent = file.name;
                        fileNameDisplay.classList.remove('hidden');
                        document.getElementById('import-backup-btn').removeAttribute('disabled');
                    } else {
                        fileNameDisplay.classList.add('hidden');
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                    }
                });
                
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    this.importDataFromFile();
                });
                
                // Botão de atualização do dashboard detalhado
                document.getElementById('detailed-refresh-btn')?.addEventListener('click', () => {
                    this.updateDetailedDashboardCharts();
                    this.updateDetailedDashboard();
                });
            },
            
            // Configurar event listeners adicionais
            setupEventListeners() {
                // Event listeners para filtros
                document.getElementById('reboques-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('reboques-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('cp-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('cp-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('ct-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('ct-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('f4001-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4002-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                // Event listeners para ordenação
                document.querySelectorAll('th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        const field = th.getAttribute('data-sort');
                        
                        if (this.data.currentSort.field === field) {
                            this.data.currentSort.direction = this.data.currentSort.direction === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.data.currentSort.field = field;
                            this.data.currentSort.direction = 'asc';
                        }
                        
                        // Atualizar visualmente os ícones de ordenação
                        document.querySelectorAll('th[data-sort] i').forEach(icon => {
                            icon.className = 'fas fa-sort ml-2 text-gray-400';
                        });
                        
                        const icon = th.querySelector('i');
                        icon.className = `fas fa-sort-${this.data.currentSort.direction === 'asc' ? 'up' : 'down'} ml-2 text-gray-800 dark:text-white`;
                        
                        // Renderizar a tabela atual
                        const activeTab = document.querySelector('.tab-content.active');
                        if (activeTab) {
                            const id = activeTab.id;
                            
                            if (id === 'reboques') {
                                this.renderReboquesTable();
                            } else if (id === 'caminhoes-proprios') {
                                this.renderCPTable();
                            } else if (id === 'caminhoes-terceiros') {
                                this.renderCTTable();
                            } else if (id === 'frente-4001') {
                                this.renderF4001Table();
                            } else if (id === 'frente-4002') {
                                this.renderF4002Table();
                            }
                        }
                    });
                });
                
                // Configurar area de arrastar e soltar para importação de backup
                const dropZone = document.querySelector('.border-dashed');
                
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropZone.addEventListener(eventName, highlight, false);
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, unhighlight, false);
                });

                function highlight() {
                    dropZone.classList.add('border-primary', 'bg-primary', 'bg-opacity-5');
                }

                function unhighlight() {
                    dropZone.classList.remove('border-primary', 'bg-primary', 'bg-opacity-5');
                }
                
                dropZone.addEventListener('drop', (e) => {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type === 'application/json' || file.name.endsWith('.json')) {
                            document.getElementById('backup-file-input').files = files;
                            document.getElementById('selected-file-name').textContent = file.name;
                            document.getElementById('selected-file-name').classList.remove('hidden');
                            document.getElementById('import-backup-btn').removeAttribute('disabled');
                        } else {
                            this.showNotification('error', 'Erro', 'Por favor, selecione um arquivo JSON válido.');
                        }
                    }
                });
            },
            
            // Carregar dados (inicialmente usando dados de exemplo)
            loadData() {
                // Verificar se já existem dados no LocalStorage
                const savedData = localStorage.getItem('fleetManagementData');
                
                if (savedData) {
                    try {
                        const parsedData = JSON.parse(savedData);
                        
                        // Atualizar dados
                        this.data.reboques = parsedData.reboques || [];
                        this.data.caminhoesProps = parsedData.caminhoesProps || [];
                        this.data.caminhoesTerc = parsedData.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = parsedData.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = parsedData.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = parsedData.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = parsedData.frente4002Tracoes || [];
                        this.data.history = parsedData.history || {};
                        this.data.schedules = parsedData.schedules || [];
                        
                        return;
                    } catch (error) {
                        console.error("Erro ao carregar dados do LocalStorage:", error);
                    }
                }
                
                // Se não houver dados ou ocorrer erro, carregar dados de exemplo
                this.loadExampleData();
            },
            
            // Carregar dados de exemplo
            loadExampleData() {
                // Dados de exemplo para reboques
                this.data.reboques = [
                    { frota: '1101', tipo: 'SEMI REBOQUE', acoplado: '7520', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1102', tipo: 'SEMI REBOQUE', acoplado: '7521', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1103', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Em manutenção', dataParada: '2023-05-15', motivo: 'Suspensão danificada', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1104', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1105', tipo: 'REBOQUE', acoplado: '7522', status: 'Operacional', tipoAcoplado: 'REBOQUE' },
                    { frota: '1106', tipo: 'REBOQUE', acoplado: '', status: 'Em reforma', dataParada: '2023-04-10', motivo: 'Reforma geral programada', tipoAcoplado: 'REBOQUE' },
                    { frota: '1107', tipo: 'DOLLY', acoplado: '7523', status: 'Operacional', tipoAcoplado: 'DOLLY' },
                    { frota: '1108', tipo: 'DOLLY', acoplado: '', status: 'Inoperante', dataParada: '2023-05-22', motivo: 'Eixo quebrado', tipoAcoplado: 'DOLLY' }
                ];
                
                // Dados de exemplo para caminhões próprios
                this.data.caminhoesProps = [
                    { caminhao: '7520', status: 'Operacional' },
                    { caminhao: '7521', status: 'Operacional' },
                    { caminhao: '7522', status: 'Operacional' },
                    { caminhao: '7523', status: 'Operacional' },
                    { caminhao: '7524', status: 'Em manutenção', data: '2023-05-18', motivo: 'Troca de óleo e filtros' },
                    { caminhao: '7525', status: 'Em reforma', data: '2023-03-15', motivo: 'Reforma do motor' },
                    { caminhao: '7526', status: 'Emprestado', data: '2023-05-10', motivo: 'Emprestado para filial' }
                ];
                
                // Dados de exemplo para caminhões terceiros
                this.data.caminhoesTerc = [
                    { caminhao: 'T001', proprietario: 'Transportes Silva', reboques: '1201-1202', status: 'Operacional' },
                    { caminhao: 'T002', proprietario: 'Logística Express', reboques: '1203', status: 'Operacional' },
                    { caminhao: 'T003', proprietario: 'Transportes Rápidos', reboques: '1204-1205', status: 'Em manutenção', motivo: 'Problemas no freio' },
                    { caminhao: 'T004', proprietario: 'Rodovias Transport', reboques: '1206', status: 'Operacional' },
                    { caminhao: 'T005', proprietario: 'JK Logística', reboques: '1207-1208', status: 'Inoperante', motivo: 'Acidente na estrada' }
                ];
                
                // Dados de exemplo para frente 4001
                this.data.frente4001Colhedoras = [
                    { codigo: 'C101', status: 'Operacional' },
                    { codigo: 'C102', status: 'Em manutenção', data: '2023-05-20', motivo: 'Manutenção preventiva' },
                    { codigo: 'C103', status: 'Operacional' },
                    { codigo: 'C104', status: 'Inoperante', data: '2023-04-25', motivo: 'Problemas no sistema hidráulico' }
                ];
                
                this.data.frente4001Tracoes = [
                    { codigo: 'T101', status: 'Operacional' },
                    { codigo: 'T102', status: 'Operacional' },
                    { codigo: 'T103', status: 'Em manutenção', data: '2023-05-19', motivo: 'Troca de pneus' },
                    { codigo: 'T104', status: 'Operacional' }
                ];
                
                // Dados de exemplo para frente 4002
                this.data.frente4002Colhedoras = [
                    { codigo: 'C201', status: 'Operacional' },
                    { codigo: 'C202', status: 'Operacional' },
                    { codigo: 'C203', status: 'Em reforma', data: '2023-03-10', motivo: 'Reforma programada' },
                    { codigo: 'C204', status: 'Em manutenção', data: '2023-05-21', motivo: 'Falha no sistema elétrico' }
                ];
                
                this.data.frente4002Tracoes = [
                    { codigo: 'T201', status: 'Operacional' },
                    { codigo: 'T202', status: 'Inoperante', data: '2023-05-05', motivo: 'Motor danificado' },
                    { codigo: 'T203', status: 'Operacional' },
                    { codigo: 'T204', status: 'Em manutenção', data: '2023-05-22', motivo: 'Manutenção programada' }
                ];
                
                // Histórico de exemplo
                this.data.history = {
                    '7524': [
                        {
                            date: '2023-05-18T10:30:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Troca de óleo e filtros',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-10T08:15:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-05T14:20:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Revisão de 50.000 km',
                            user: 'Técnico'
                        }
                    ],
                    'C102': [
                        {
                            date: '2023-05-20T09:45:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Manutenção preventiva',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-03-15T11:30:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Técnico'
                        },
                        {
                            date: '2023-03-10T08:15:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Falha no sistema eletrônico',
                            user: 'Operador'
                        }
                    ]
                };
                
                // Agendamentos de exemplo
                this.data.schedules = [
                    {
                        equipment: '7520',
                        equipmentType: 'Caminhão Próprio',
                        date: '2023-06-05',
                        time: '09:00',
                        type: 'preventiva',
                        description: 'Revisão de 30.000 km',
                        responsible: 'João Silva',
                        created: '2023-05-20T14:30:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: 'C201',
                        equipmentType: 'Colhedora Frente 4002',
                        date: '2023-06-10',
                        time: '08:30',
                        type: 'troca-oleo',
                        description: 'Troca de óleo e filtros',
                        responsible: 'Carlos Oliveira',
                        created: '2023-05-22T10:15:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: '1102',
                        equipmentType: 'Reboque',
                        date: '2023-06-15',
                        time: '14:00',
                        type: 'corretiva',
                        description: 'Reparo na suspensão',
                        responsible: 'Pedro Santos',
                        created: '2023-05-23T09:45:00',
                        status: 'Agendado'
                    }
                ];
                
                // Salvar os dados de exemplo no LocalStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar dados no LocalStorage
            saveDataToLocalStorage() {
                try {
                    localStorage.setItem('fleetManagementData', JSON.stringify({
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules
                    }));
                } catch (error) {
                    console.error("Erro ao salvar dados no LocalStorage:", error);
                    this.showNotification('error', 'Erro', 'Falha ao salvar dados. As alterações não serão mantidas após a recarga da página.');
                }
            },
            
            // Limpar todos os dados
            clearAllData() {
                const confirmationInput = document.getElementById('clear-data-confirmation');
                if (confirmationInput.value !== 'CONFIRMAR') {
                    this.showNotification('error', 'Erro', 'Por favor, digite "CONFIRMAR" para prosseguir com a exclusão dos dados.');
                    return;
                }
                
                // Limpar todos os arrays de dados
                this.data.reboques = [];
                this.data.caminhoesProps = [];
                this.data.caminhoesTerc = [];
                this.data.frente4001Colhedoras = [];
                this.data.frente4001Tracoes = [];
                this.data.frente4002Colhedoras = [];
                this.data.frente4002Tracoes = [];
                this.data.history = {};
                this.data.schedules = [];
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('clear-data-confirm-modal').classList.add('hidden');
                confirmationInput.value = '';
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Todos os registros foram excluídos com sucesso.');
            },
            
            // Importar dados de um arquivo
            importDataFromFile() {
                const fileInput = document.getElementById('backup-file-input');
                if (fileInput.files.length === 0) {
                    this.showNotification('error', 'Erro', 'Nenhum arquivo selecionado.');
                    return;
                }
                
                const file = fileInput.files[0];
                if (file.type !== 'application/json' && !file.name.endsWith('.json')) {
                    this.showNotification('error', 'Erro', 'O arquivo deve ser um JSON válido.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Verificar se o arquivo contém os dados esperados
                        if (!data.reboques || !data.caminhoesProps || !data.caminhoesTerc || 
                            !data.frente4001Colhedoras || !data.frente4001Tracoes || 
                            !data.frente4002Colhedoras || !data.frente4002Tracoes) {
                            throw new Error('O arquivo não contém dados válidos para importação.');
                        }
                        
                        // Atualizar os dados
                        this.data.reboques = data.reboques || [];
                        this.data.caminhoesProps = data.caminhoesProps || [];
                        this.data.caminhoesTerc = data.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = data.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = data.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = data.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = data.frente4002Tracoes || [];
                        this.data.history = data.history || {};
                        this.data.schedules = data.schedules || [];
                        
                        // Salvar no localStorage
                        this.saveDataToLocalStorage();
                        
                        // Atualizar visualizações
                        this.renderAllTables();
                        this.updateAllDashboards();
                        this.updateAllCharts();
                        this.initializeRealEquipmentView();
                        
                        // Fechar modal
                        document.getElementById('import-backup-modal').classList.add('hidden');
                        document.getElementById('selected-file-name').classList.add('hidden');
                        fileInput.value = '';
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Sucesso', 'Backup importado com sucesso.');
                        
                    } catch (error) {
                        this.showNotification('error', 'Erro', 'Falha ao importar backup: ' + error.message);
                    }
                };
                
                reader.onerror = () => {
                    this.showNotification('error', 'Erro', 'Falha ao ler o arquivo.');
                };
                
                reader.readAsText(file);
            },
            
            // Exportar dados para arquivo JSON
            exportToJSON() {
                const backupData = {
                    reboques: this.data.reboques,
                    caminhoesProps: this.data.caminhoesProps,
                    caminhoesTerc: this.data.caminhoesTerc,
                    frente4001Colhedoras: this.data.frente4001Colhedoras,
                    frente4001Tracoes: this.data.frente4001Tracoes,
                    frente4002Colhedoras: this.data.frente4002Colhedoras,
                    frente4002Tracoes: this.data.frente4002Tracoes,
                    history: this.data.history,
                    schedules: this.data.schedules
                };
                
                // Converter dados para JSON
                const jsonString = JSON.stringify(backupData, null, 2);
                
                // Criar blob e link para download
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                
                // Nome do arquivo com data atual
                const date = new Date();
                const dateStr = date.toISOString().split('T')[0];
                link.download = `backup_frota_${dateStr}.json`;
                
                // Realizar download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Backup exportado com sucesso.');
            },
            
            // Filtrar dados com base nos filtros atuais
            filterData(data) {
                return data.filter(item => {
                    // Filtro de pesquisa
                    const searchTerms = this.data.searchText.toLowerCase().split(' ');
                    
                    const matchesSearch = searchTerms.every(term => {
                        return Object.values(item).some(value => {
                            if (value === null || value === undefined) return false;
                            return value.toString().toLowerCase().includes(term);
                        });
                    });
                    
                    if (!matchesSearch) return false;
                    
                    // Filtro de status
                    if (this.data.statusFilter !== 'all' && item.status !== this.data.statusFilter) {
                        return false;
                    }
                    
                    // Filtro de tipo (para frentes 4001 e 4002)
                    if (this.data.typeFilter !== 'all' && item.type !== this.data.typeFilter) {
                        return false;
                    }
                    
                    return true;
                });
            },
            
            // Ordenar dados com base no campo e direção atuais
            sortData(data) {
                if (!this.data.currentSort.field) return data;
                
                return [...data].sort((a, b) => {
                    const field = this.data.currentSort.field;
                    const aValue = a[field];
                    const bValue = b[field];
                    
                    if (aValue === null || aValue === undefined) return 1;
                    if (bValue === null || bValue === undefined) return -1;
                    
                    if (aValue < bValue) {
                        return this.data.currentSort.direction === 'asc' ? -1 : 1;
                    }
                    if (aValue > bValue) {
                        return this.data.currentSort.direction === 'asc' ? 1 : -1;
                    }
                    return 0;
                });
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCPTable();
                this.renderCTTable();
                this.renderF4001Table();
                this.renderF4002Table();
            },
            
            // Renderizar tabela de reboques
            renderReboquesTable() {
                const tableBody = document.getElementById('reboques-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.reboques);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-5 py-5 text-base text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-5">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum reboque encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((reboque, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(reboque.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (reboque.dataParada) {
                        const data = new Date(reboque.dataParada);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-5 py-4 text-base">${reboque.frota || '-'}</td>
                            <td class="px-5 py-4 text-base">${reboque.tipo || '-'}</td>
                            <td class="px-5 py-4 text-base">${reboque.acoplado || '-'}</td>
                            <td class="px-5 py-4 text-base">
                                <span class="status-badge ${statusClass}">
                                    ${reboque.status}
                                </span>
                            </td>
                            <td class="px-5 py-4 text-base">${dataFormatada || '-'}</td>
                            <td class="px-5 py-4 text-base">${reboque.motivo || '-'}</td>
                            <td class="px-5 py-4 text-base text-right">
                                <div class="flex justify-end items-center space-x-3">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg" data-id="${reboque.frota}" data-type="Reboque" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-lg" data-id="${reboque.frota}" data-type="Reboque" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark text-lg" data-id="${reboque.frota}" data-type="Reboque" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-lg" data-id="${reboque.frota}" data-type="Reboque" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'reboques');
                    });
                });
            },
            
            // Renderizar tabela de caminhões próprios
            renderCPTable() {
                const tableBody = document.getElementById('cp-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesProps);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-5 py-5 text-base text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-5">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum caminhão próprio encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (caminhao.data) {
                        const data = new Date(caminhao.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-5 py-4 text-base">${caminhao.caminhao || '-'}</td>
                            <td class="px-5 py-4 text-base">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-5 py-4 text-base">${dataFormatada || '-'}</td>
                            <td class="px-5 py-4 text-base">${caminhao.motivo || '-'}</td>
                            <td class="px-5 py-4 text-base text-right">
                                <div class="flex justify-end items-center space-x-3">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesProps');
                    });
                });
            },
            
            // Renderizar tabela de caminhões terceiros
            renderCTTable() {
                const tableBody = document.getElementById('ct-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesTerc);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-5 py-5 text-base text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-5">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum caminhão terceiro encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-5 py-4 text-base">${caminhao.caminhao || '-'}</td>
                            <td class="px-5 py-4 text-base">${caminhao.proprietario || '-'}</td>
                            <td class="px-5 py-4 text-base">${caminhao.reboques || '-'}</td>
                            <td class="px-5 py-4 text-base">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-5 py-4 text-base">${caminhao.motivo || '-'}</td>
                            <td class="px-5 py-4 text-base text-right">
                                <div class="flex justify-end items-center space-x-3">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-lg" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesTerc');
                    });
                });
            },
            
            // Renderizar tabela da frente 4001
            renderF4001Table() {
                const tableBody = document.getElementById('f4001-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4001Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4001Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-5 py-5 text-base text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-5">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4001Colhedoras' : 'frente4001Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-5 py-4 text-base">${item.type}</td>
                            <td class="px-5 py-4 text-base">${item.codigo || '-'}</td>
                            <td class="px-5 py-4 text-base">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-5 py-4 text-base">${dataFormatada || '-'}</td>
                            <td class="px-5 py-4 text-base">${item.motivo || '-'}</td>
                            <td class="px-5 py-4 text-base text-right">
                                <div class="flex justify-end items-center space-x-3">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4001" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Renderizar tabela da frente 4002
            renderF4002Table() {
                const tableBody = document.getElementById('f4002-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4002Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4002Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-5 py-5 text-base text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-5">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-5xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4002Colhedoras' : 'frente4002Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-5 py-4 text-base">${item.type}</td>
                            <td class="px-5 py-4 text-base">${item.codigo || '-'}</td>
                            <td class="px-5 py-4 text-base">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-5 py-4 text-base">${dataFormatada || '-'}</td>
                            <td class="px-5 py-4 text-base">${item.motivo || '-'}</td>
                            <td class="px-5 py-4 text-base text-right">
                                <div class="flex justify-end items-center space-x-3">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-lg" data-id="${item.codigo}" data-type="${item.type} Frente 4002" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Inicializar gráficos
            initializeCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                Chart.defaults.font.size = 14;
                
                // Gráfico de status por categoria
                const statusCtx = document.getElementById('status-by-category-chart');
                if (statusCtx) {
                    this.data.charts.statusByCategoryChart = new Chart(statusCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Frente 4001', 'Frente 4002'],
                            datasets: [{
                                label: 'Operacionais',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#10B981'
                            }, {
                                label: 'Em Manutenção',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#F59E0B'
                            }, {
                                label: 'Em Reforma/Inoperantes',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#EF4444'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    stacked: true,
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true,
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    labels: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de disponibilidade
                const availabilityCtx = document.getElementById('availability-chart');
                if (availabilityCtx) {
                    this.data.charts.availabilityChart = new Chart(availabilityCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma', 'Outros'],
                            datasets: [{
                                data: [0, 0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de status dos reboques
                const reboquesStatusCtx = document.getElementById('reboques-status-chart');
                if (reboquesStatusCtx) {
                    this.data.charts.reboquesStatusChart = new Chart(reboquesStatusCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma/Inoperantes'],
                            datasets: [{
                                data: [0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Inicializar gráficos do dashboard detalhado
                this.initializeDetailedDashboardCharts();
            },
            
            // Inicializar gráficos do dashboard detalhado
            initializeDetailedDashboardCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                Chart.defaults.font.size = 14;
                
                // Gráfico de distribuição de status
                const statusDistCtx = document.getElementById('detailed-status-distribution-chart');
                if (statusDistCtx) {
                    this.data.charts.detailedStatusDistributionChart = new Chart(statusDistCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'F4001 Colhedoras', 'F4001 Trações', 'F4002 Colhedoras', 'F4002 Trações'],
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#10B981'
                                },
                                {
                                    label: 'Em Manutenção',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#F59E0B'
                                },
                                {
                                    label: 'Em Reforma/Inoperante',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#EF4444'
                                },
                                {
                                    label: 'Outros',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#3B82F6'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    stacked: true,
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true,
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de tendência de disponibilidade
                const availTrendCtx = document.getElementById('detailed-availability-trend-chart');
                if (availTrendCtx) {
                    // Criar dados de exemplo para mostrar a tendência
                    const labels = [];
                    
                    // Usar datas reais (últimos 3 meses)
                    const today = new Date();
                    for (let i = 2; i >= 0; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedAvailabilityTrendChart = new Chart(availTrendCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Disponibilidade da Frota (%)',
                                data: [], // Deixar vazio - será preenchido com dados reais
                                borderColor: '#5D5CDE',
                                backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                tension: 0.3,
                                fill: true,
                                borderWidth: 3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 50,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 16
                                        }
                                    },
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                },
                                x: {
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de causas de manutenção
                const causesCtx = document.getElementById('detailed-maintenance-causes-chart');
                if (causesCtx) {
                    this.data.charts.detailedMaintenanceCausesChart = new Chart(causesCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Desgaste normal', 'Falha mecânica', 'Problemas elétricos', 'Manutenção preventiva', 'Outros'],
                            datasets: [{
                                data: [], // Deixar vazio - será preenchido com dados reais
                                backgroundColor: ['#3B82F6', '#EF4444', '#F59E0B', '#10B981', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de previsão
                const forecastCtx = document.getElementById('detailed-forecast-chart');
                if (forecastCtx) {
                    // Criar dados para previsão baseados apenas nos meses reais
                    const labels = [];
                    
                    // Últimos 3 meses (dados históricos) + próximos 3 meses (previsão)
                    const today = new Date();
                    for (let i = 2; i >= -3; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedForecastChart = new Chart(forecastCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Dados Históricos',
                                    data: [], // Deixar vazio - será preenchido com dados reais se existirem
                                    borderColor: '#3B82F6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.3,
                                    borderWidth: 3
                                },
                                {
                                    label: 'Previsão',
                                    data: [], // Deixar vazio - será preenchido apenas se houver dados suficientes
                                    borderColor: '#5D5CDE',
                                    borderDash: [5, 5],
                                    backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                    fill: true,
                                    tension: 0.3,
                                    borderWidth: 3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 14
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            if (context.raw !== null) {
                                                return `${context.dataset.label}: ${context.raw.toFixed(1)}%`;
                                            }
                                            return '';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    min: 60,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937',
                                        font: {
                                            size: 16
                                        }
                                    },
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                },
                                x: {
                                    ticks: {
                                        font: {
                                            size: 14
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Mostrar mensagens de "sem dados" para os gráficos
                document.getElementById('detailed-forecast-no-data')?.classList.remove('hidden');
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Verificar se o tema mudou e atualizar os padrões
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Atualizar gráficos do dashboard principal
                this.updateStatusCategoryChart();
                this.updateAvailabilityChart();
                
                // Atualizar gráficos específicos por categoria
                this.updateReboquesCharts();
                
                // Atualizar gráficos do dashboard detalhado
                this.updateDetailedDashboardCharts();
            },
            
            // Atualizar gráfico de status por categoria
            updateStatusCategoryChart() {
                if (!this.data.charts.statusByCategoryChart) return;
                
                // Contar status para cada categoria
                const reboquesOperacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesManutencao = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reboquesReforma = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                const cpOperacional = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpManutencao = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const cpReforma = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                const ctOperacional = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctManutencao = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const ctReforma = this.data.caminhoesTerc.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                // Frente 4001
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4001Reforma = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Frente 4002
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4002Reforma = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.statusByCategoryChart.data.datasets[0].data = [
                    reboquesOperacional, cpOperacional, ctOperacional, f4001Operacional, f4002Operacional
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[1].data = [
                    reboquesManutencao, cpManutencao, ctManutencao, f4001Manutencao, f4002Manutencao
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[2].data = [
                    reboquesReforma, cpReforma, ctReforma, f4001Reforma, f4002Reforma
                ];
                
                this.data.charts.statusByCategoryChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = 
                    reboquesOperacional + reboquesManutencao + reboquesReforma +
                    cpOperacional + cpManutencao + cpReforma +
                    ctOperacional + ctManutencao + ctReforma +
                    f4001Operacional + f4001Manutencao + f4001Reforma +
                    f4002Operacional + f4002Manutencao + f4002Reforma;
                
                if (totalData > 0) {
                    document.getElementById('status-category-no-data').classList.add('hidden');
                } else {
                    document.getElementById('status-category-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar gráfico de disponibilidade
            updateAvailabilityChart() {
                if (!this.data.charts.availabilityChart) return;
                
                // Contar todos os equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                // Todos os outros status (emprestados, etc)
                const other = 
                    this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length +
                    this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length +
                    this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.availabilityChart.data.datasets[0].data = [
                    operational, maintenance, reform, other
                ];
                
                this.data.charts.availabilityChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operational + maintenance + reform + other;
                
                if (totalData > 0) {
                    document.getElementById('availability-no-data').classList.add('hidden');
                } else {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                }
                
                // Atualizar indicadores globais no dashboard
                const total = operational + maintenance + reform + other;
                
                document.getElementById('dash-global-operational').textContent = operational;
                document.getElementById('dash-global-maintenance').textContent = maintenance;
                document.getElementById('dash-global-reform').textContent = reform;
                document.getElementById('dash-global-other').textContent = other;
                document.getElementById('dash-global-total').textContent = total;
                
                if (total > 0) {
                    document.getElementById('dash-global-operational-percent').textContent = `${Math.round(operational / total * 100)}%`;
                    document.getElementById('dash-global-maintenance-percent').textContent = `${Math.round(maintenance / total * 100)}%`;
                    document.getElementById('dash-global-reform-percent').textContent = `${Math.round(reform / total * 100)}%`;
                    document.getElementById('dash-global-other-percent').textContent = `${Math.round(other / total * 100)}%`;
                }
            },
            
            // Atualizar gráficos de reboques
            updateReboquesCharts() {
                if (!this.data.charts.reboquesStatusChart) return;
                
                // Contar status dos reboques
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.reboquesStatusChart.data.datasets[0].data = [
                    operational, maintenance, reform
                ];
                
                this.data.charts.reboquesStatusChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operational + maintenance + reform;
                
                if (totalData > 0) {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar gráficos do dashboard detalhado
            updateDetailedDashboardCharts() {
                if (!this.data.charts.detailedStatusDistributionChart) {
                    this.initializeDetailedDashboardCharts();
                    return;
                }
                
                // Atualizar dados para o gráfico de distribuição de status
                const data = {
                    reboques: {
                        operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                        maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                        reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                        other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                    },
                    caminhoesProprios: {
                        operational: this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    caminhoesTerceiros: {
                        operational: this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001Colhedoras: {
                        operational: this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001Tracoes: {
                        operational: this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    },
                    frente4002Colhedoras: {
                        operational: this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4002Tracoes: {
                        operational: this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    }
                };
                
                // Atualizar rótulos para incluir categorias separadas
                this.data.charts.detailedStatusDistributionChart.data.labels = [
                    'Reboques', 
                    'Caminhões Próprios', 
                    'Caminhões Terceiros', 
                    'F4001 Colhedoras', 
                    'F4001 Trações', 
                    'F4002 Colhedoras', 
                    'F4002 Trações'
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[0].data = [
                    data.reboques.operational,
                    data.caminhoesProprios.operational,
                    data.caminhoesTerceiros.operational,
                    data.frente4001Colhedoras.operational,
                    data.frente4001Tracoes.operational,
                    data.frente4002Colhedoras.operational,
                    data.frente4002Tracoes.operational
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[1].data = [
                    data.reboques.maintenance,
                    data.caminhoesProprios.maintenance,
                    data.caminhoesTerceiros.maintenance,
                    data.frente4001Colhedoras.maintenance,
                    data.frente4001Tracoes.maintenance,
                    data.frente4002Colhedoras.maintenance,
                    data.frente4002Tracoes.maintenance
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[2].data = [
                    data.reboques.reform,
                    data.caminhoesProprios.reform,
                    data.caminhoesTerceiros.reform,
                    data.frente4001Colhedoras.reform,
                    data.frente4001Tracoes.reform,
                    data.frente4002Colhedoras.reform,
                    data.frente4002Tracoes.reform
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[3].data = [
                    data.reboques.other,
                    data.caminhoesProprios.other,
                    data.caminhoesTerceiros.other,
                    data.frente4001Colhedoras.other,
                    data.frente4001Tracoes.other,
                    data.frente4002Colhedoras.other,
                    data.frente4002Tracoes.other
                ];
                
                this.data.charts.detailedStatusDistributionChart.update();
                
                // Atualizar o gráfico de tendência para refletir o tema atual
                const isDark = document.documentElement.classList.contains('dark');
                this.data.charts.detailedAvailabilityTrendChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                this.data.charts.detailedAvailabilityTrendChart.options.scales.y.title.color = isDark ? '#E5E7EB' : '#1F2937';
                this.data.charts.detailedAvailabilityTrendChart.update();
                
                // Atualizar gráficos de causas e duração
                if (this.data.charts.detailedMaintenanceCausesChart) {
                    this.data.charts.detailedMaintenanceCausesChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedMaintenanceCausesChart.update();
                }
                
                // Atualizar gráfico de previsão
                if (this.data.charts.detailedForecastChart) {
                    this.data.charts.detailedForecastChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedForecastChart.options.scales.y.title.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedForecastChart.update();
                }
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateMainDashboard();
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
                this.updateDetailedDashboard();
            },
            
            // Atualizar dashboard principal
            updateMainDashboard() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contagem por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                const borrowed = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Emprestado').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Emprestado').length;
                
                const other = totalEquipments - operational - maintenance - reform - borrowed;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                // Atualizar resumo visual
                document.getElementById('dash-summary-operational').textContent = operational;
                document.getElementById('dash-summary-maintenance').textContent = maintenance;
                document.getElementById('dash-summary-reform').textContent = reform;
                document.getElementById('dash-summary-borrowed').textContent = borrowed;
                document.getElementById('dash-summary-other').textContent = other;
                document.getElementById('dash-summary-availability').textContent = `${availability}%`;
                document.getElementById('dash-availability-bar').style.width = `${availability}%`;
                
                // Atualizar cards
                this.updateDashboardCard('cp', this.data.caminhoesProps);
                this.updateDashboardCard('reboques', this.data.reboques);
                
                // Frente 4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4001-count').textContent = f4001Total;
                document.getElementById('dash-f4001-operational').textContent = f4001Operacional;
                document.getElementById('dash-f4001-maintenance').textContent = f4001Manutencao;
                
                if (f4001Total > 0) {
                    const f4001Availability = Math.round((f4001Operacional / f4001Total) * 100);
                    document.getElementById('dash-f4001-bar').style.width = `${f4001Availability}%`;
                }
                
                // Frente 4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4002-count').textContent = f4002Total;
                document.getElementById('dash-f4002-operational').textContent = f4002Operacional;
                document.getElementById('dash-f4002-maintenance').textContent = f4002Manutencao;
                
                if (f4002Total > 0) {
                    const f4002Availability = Math.round((f4002Operacional / f4002Total) * 100);
                    document.getElementById('dash-f4002-bar').style.width = `${f4002Availability}%`;
                }
                
                // Listar equipamentos em manutenção
                this.updateMaintenanceList();
                
                // Listar próximas manutenções agendadas
                this.updateUpcomingMaintenanceList();
            },
            
            // Atualizar lista de equipamentos em manutenção
            updateMaintenanceList() {
                const listContainer = document.getElementById('equipment-maintenance-list');
                if (!listContainer) return;
                
                // Buscar todos os equipamentos em manutenção
                const maintenanceEquipments = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({ 
                        id: r.frota, 
                        type: 'Reboque', 
                        date: r.dataParada, 
                        reason: r.motivo 
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.caminhao, 
                        type: 'Caminhão Próprio', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.caminhao, 
                        type: 'Caminhão Terceiro', 
                        date: null, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.codigo, 
                        type: 'Colhedora Frente 4001', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({ 
                        id: t.codigo, 
                        type: 'Tração Frente 4001', 
                        date: t.data, 
                        reason: t.motivo 
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.codigo, 
                        type: 'Colhedora Frente 4002', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({ 
                        id: t.codigo, 
                        type: 'Tração Frente 4002', 
                        date: t.data, 
                        reason: t.motivo 
                    }))
                ];
                
                // Ordenar por data, mais recentes primeiro
                maintenanceEquipments.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                if (maintenanceEquipments.length === 0) {
                    listContainer.innerHTML = `
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                        </li>
                    `;
                    return;
                }
                
                let html = '';
                
                maintenanceEquipments.forEach(equipment => {
                    let formattedDate = '';
                    if (equipment.date) {
                        const date = new Date(equipment.date);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <li class="py-3 hover:bg-gray-50 dark:hover:bg-gray-750 -mx-5 px-5 transition-colors">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <span class="font-medium text-lg">${equipment.type} - ${equipment.id}</span>
                                    <p class="text-gray-500 dark:text-gray-400 text-base mt-1">${equipment.reason || 'Sem motivo especificado'}</p>
                                </div>
                                <div class="mt-2 sm:mt-0 sm:text-right">
                                    <span class="text-gray-500 dark:text-gray-400 text-sm">Desde: <span class="text-base">${formattedDate || 'Data não especificada'}</span></span>
                                </div>
                            </div>
                        </li>
                    `;
                });
                
                listContainer.innerHTML = html;
            },
            
            // Atualizar lista de próximas manutenções agendadas
            updateUpcomingMaintenanceList() {
                const listContainer = document.getElementById('upcoming-maintenance-list');
                if (!listContainer) return;
                
                // Filtrar agendamentos futuros
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingMaintenance = this.data.schedules
                    .filter(schedule => {
                        const scheduleDate = new Date(schedule.date);
                        return scheduleDate >= today && schedule.status === 'Agendado';
                    })
                    .sort((a, b) => {
                        const dateA = new Date(`${a.date}T${a.time}`);
                        const dateB = new Date(`${b.date}T${b.time}`);
                        return dateA - dateB;
                    });
                
                if (upcomingMaintenance.length === 0) {
                    listContainer.innerHTML = `
                        <li class="py-3">
                            <span class="text-base text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                        </li>
                    `;
                    return;
                }
                
                let html = '';
                
                upcomingMaintenance.slice(0, 5).forEach(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    const formattedDate = scheduleDate.toLocaleDateString('pt-BR');
                    
                    html += `
                        <li class="py-3 hover:bg-gray-50 dark:hover:bg-gray-750 -mx-5 px-5 transition-colors">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                                <div>
                                    <span class="font-medium text-lg">${schedule.equipmentType} - ${schedule.equipment}</span>
                                    <p class="text-gray-500 dark:text-gray-400 text-base mt-1">${schedule.description}</p>
                                </div>
                                <div class="mt-2 sm:mt-0 sm:text-right">
                                    <span class="text-primary font-medium text-base">${formattedDate}</span>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm">${schedule.time}</p>
                                </div>
                            </div>
                        </li>
                    `;
                });
                
                listContainer.innerHTML = html;
            },
            
            // Atualizar card no dashboard
            updateDashboardCard(prefix, dataArray) {
                const totalCount = dataArray.length;
                const operationalCount = dataArray.filter(item => item.status === 'Operacional').length;
                const maintenanceCount = dataArray.filter(item => item.status === 'Em manutenção').length;
                
                // Atualizar contagens
                document.getElementById(`dash-${prefix}-count`).textContent = totalCount;
                document.getElementById(`dash-${prefix}-operational`).textContent = operationalCount;
                document.getElementById(`dash-${prefix}-maintenance`).textContent = maintenanceCount;
                
                // Atualizar barra de progresso
                if (totalCount > 0) {
                    const availability = Math.round((operationalCount / totalCount) * 100);
                    document.getElementById(`dash-${prefix}-bar`).style.width = `${availability}%`;
                }
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length;
                
                // Calcular disponibilidade
                const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-reform').textContent = reform;
                document.getElementById('reboques-availability').textContent = `${availability}%`;
                
                // Atualizar porcentagens
                if (total > 0) {
                    document.getElementById('reboques-operational-percentage').textContent = `${Math.round((operational / total) * 100)}%`;
                    document.getElementById('reboques-maintenance-percentage').textContent = `${Math.round((maintenance / total) * 100)}%`;
                    document.getElementById('reboques-reform-percentage').textContent = `${Math.round((reform / total) * 100)}%`;
                }
                
                // Atualizar barra de disponibilidade
                document.getElementById('reboques-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                const total = this.data.caminhoesProps.length;
                const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const reform = this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length;
                
                // Calcular disponibilidade
                const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-reform').textContent = reform;
                document.getElementById('cp-availability').textContent = `${availability}%`;
                
                // Atualizar porcentagens
                if (total > 0) {
                    document.getElementById('cp-operational-percentage').textContent = `${Math.round((operational / total) * 100)}%`;
                    document.getElementById('cp-maintenance-percentage').textContent = `${Math.round((maintenance / total) * 100)}%`;
                    document.getElementById('cp-reform-percentage').textContent = `${Math.round((reform / total) * 100)}%`;
                }
                
                // Atualizar barra de disponibilidade
                document.getElementById('cp-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                const total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const operational = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('f4001-total').textContent = total;
                document.getElementById('f4001-operational').textContent = operational;
                document.getElementById('f4001-maintenance').textContent = maintenance;
                document.getElementById('f4001-reform').textContent = reform;
                document.getElementById('f4001-availability').textContent = `${availability}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('f4001-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                const total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const operational = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('f4002-total').textContent = total;
                document.getElementById('f4002-operational').textContent = operational;
                document.getElementById('f4002-maintenance').textContent = maintenance;
                document.getElementById('f4002-reform').textContent = reform;
                document.getElementById('f4002-availability').textContent = `${availability}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('f4002-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard detalhado
            updateDetailedDashboard() {
                // Contar equipamentos por categoria e status
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contagem por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                // Atualizar contadores
                document.getElementById('detailed-total-equipment').textContent = totalEquipments;
                document.getElementById('detailed-total-maintenances').textContent = maintenance;
                
                // Calcular e atualizar porcentagem operacional
                const operationalPercentage = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                document.getElementById('detailed-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('detailed-operational-bar').style.width = `${operationalPercentage}%`;
                
                // Atualizar detalhes por categoria
                this.updateDetailedCategoryInfo('reboques', this.data.reboques);
                this.updateDetailedCategoryInfo('cp', this.data.caminhoesProps);
                this.updateDetailedCategoryInfo('ct', this.data.caminhoesTerc);
                
                // Atualizar detalhes de Frente 4001
                this.updateDetailedFrenteInfo('f4001-colh', this.data.frente4001Colhedoras);
                this.updateDetailedFrenteInfo('f4001-trac', this.data.frente4001Tracoes);
                
                // Atualizar detalhes de Frente 4002
                this.updateDetailedFrenteInfo('f4002-colh', this.data.frente4002Colhedoras);
                this.updateDetailedFrenteInfo('f4002-trac', this.data.frente4002Tracoes);
                
                // Atualizar KPIs (valores fictícios apenas para ilustração)
                document.getElementById('detailed-mtbf').textContent = '75.3 horas';
                document.getElementById('detailed-mttr').textContent = '8.2 horas';
                document.getElementById('detailed-oee').textContent = '84.7%';
                
                // Atualizar gráficos
                this.updateDetailedDashboardCharts();
                
                // Gerar dados fictícios para o gráfico de causas de manutenção
                if (this.data.charts.detailedMaintenanceCausesChart) {
                    // Em um sistema real, esses dados viriam de estatísticas reais
                    this.data.charts.detailedMaintenanceCausesChart.data.datasets[0].data = [32, 24, 18, 41, 15];
                    this.data.charts.detailedMaintenanceCausesChart.update();
                }
                
                // Gerar dados de tendência e previsão
                if (this.data.charts.detailedAvailabilityTrendChart) {
                    const trendData = [75.8, 78.2, 80.1]; // Dados fictícios
                    this.data.charts.detailedAvailabilityTrendChart.data.datasets[0].data = trendData;
                    this.data.charts.detailedAvailabilityTrendChart.update();
                    
                    // Esconder mensagem de "sem dados"
                    document.getElementById('detailed-trend-no-data').classList.add('hidden');
                }
                
                if (this.data.charts.detailedForecastChart) {
                    const historicalData = [76.3, 79.8, 81.2]; // Dados históricos fictícios
                    const forecastData = [null, null, null, 82.5, 83.7, 85.1]; // Previsão fictícia
                    
                    this.data.charts.detailedForecastChart.data.datasets[0].data = [...historicalData, null, null, null];
                    this.data.charts.detailedForecastChart.data.datasets[1].data = forecastData;
                    this.data.charts.detailedForecastChart.update();
                    
                    // Esconder mensagem de "sem dados"
                    document.getElementById('detailed-forecast-no-data').classList.add('hidden');
                }
            },
            
            // Atualizar detalhes de categoria no dashboard detalhado
            updateDetailedCategoryInfo(prefix, dataArray) {
                const count = dataArray.length;
                const operational = dataArray.filter(item => item.status === 'Operacional').length;
                const availability = count > 0 ? Math.round((operational / count) * 100) : 0;
                
                document.getElementById(`detailed-${prefix}-count`).textContent = count;
                document.getElementById(`detailed-${prefix}-availability`).textContent = `${availability}%`;
                document.getElementById(`detailed-${prefix}-avail-value`).textContent = `${availability}%`;
                document.getElementById(`detailed-${prefix}-avail-bar`).style.width = `${availability}%`;
            },
            
            // Atualizar detalhes de frente no dashboard detalhado
            updateDetailedFrenteInfo(prefix, dataArray) {
                const count = dataArray.length;
                const operational = dataArray.filter(item => item.status === 'Operacional').length;
                const availability = count > 0 ? Math.round((operational / count) * 100) : 0;
                
                document.getElementById(`detailed-${prefix}-count`).textContent = count;
                document.getElementById(`detailed-${prefix}-availability`).textContent = `${availability}%`;
                document.getElementById(`detailed-${prefix}-avail-value`).textContent = `${availability}%`;
                document.getElementById(`detailed-${prefix}-avail-bar`).style.width = `${availability}%`;
            },
            
            // Inicializar visualização real de equipamentos
            initializeRealEquipmentView() {
                // Carregar todos os equipamentos
                this.filterRealEquipment('all');
            },
            
            // Filtrar equipamentos na visualização real
            filterRealEquipment(filter) {
                const container = document.getElementById('real-equipment-container');
                if (!container) return;
                
                let equipments = [];
                
                // Aplicar filtro de tipo
                if (filter === 'all' || filter === 'reboques') {
                    equipments = [...equipments, ...this.data.reboques.map(item => ({ 
                        ...item, 
                        type: 'Reboque', 
                        id: item.frota,
                        description: `Tipo: ${item.tipo || '-'}, Acoplado: ${item.acoplado || 'Não'}`
                    }))];
                }
                
                if (filter === 'all' || filter === 'caminhoes') {
                    equipments = [...equipments, ...this.data.caminhoesProps.map(item => ({ 
                        ...item, 
                        type: 'Caminhão Próprio', 
                        id: item.caminhao,
                        description: 'Caminhão próprio da frota'
                    }))];
                    
                    equipments = [...equipments, ...this.data.caminhoesTerc.map(item => ({ 
                        ...item, 
                        type: 'Caminhão Terceiro', 
                        id: item.caminhao,
                        description: `Proprietário: ${item.proprietario || '-'}`
                    }))];
                }
                
                if (filter === 'all' || filter === 'colhedoras' || filter === 'frente4001') {
                    equipments = [...equipments, ...this.data.frente4001Colhedoras.map(item => ({ 
                        ...item, 
                        type: 'Colhedora Frente 4001', 
                        id: item.codigo,
                        description: 'Colhedora frente 4001'
                    }))];
                }
                
                if (filter === 'all' || filter === 'tracoes' || filter === 'frente4001') {
                    equipments = [...equipments, ...this.data.frente4001Tracoes.map(item => ({ 
                        ...item, 
                        type: 'Tração Frente 4001', 
                        id: item.codigo,
                        description: 'Tração frente 4001'
                    }))];
                }
                
                if (filter === 'all' || filter === 'colhedoras' || filter === 'frente4002') {
                    equipments = [...equipments, ...this.data.frente4002Colhedoras.map(item => ({ 
                        ...item, 
                        type: 'Colhedora Frente 4002', 
                        id: item.codigo,
                        description: 'Colhedora frente 4002'
                    }))];
                }
                
                if (filter === 'all' || filter === 'tracoes' || filter === 'frente4002') {
                    equipments = [...equipments, ...this.data.frente4002Tracoes.map(item => ({ 
                        ...item, 
                        type: 'Tração Frente 4002', 
                        id: item.codigo,
                        description: 'Tração frente 4002'
                    }))];
                }
                
                // Aplicar filtro de status
                if (filter === 'operational') {
                    equipments = equipments.filter(item => item.status === 'Operacional');
                } else if (filter === 'maintenance') {
                    equipments = equipments.filter(item => item.status === 'Em manutenção');
                } else if (filter === 'reform') {
                    equipments = equipments.filter(item => 
                        item.status === 'Em reforma' || 
                        item.status === 'Inoperante' || 
                        item.status === 'Aguardando reforma'
                    );
                }
                
                // Atualizar contador
                document.getElementById('real-equipment-count').textContent = `${equipments.length} equipamentos`;
                
                // Renderizar os cards
                let html = '<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5">';
                
                equipments.forEach(equipment => {
                    // Determinar ícone com base no tipo
                    let icon = 'fa-truck';
                    if (equipment.type.includes('Reboque')) {
                        icon = 'fa-trailer';
                    } else if (equipment.type.includes('Colhedora')) {
                        icon = 'fa-tractor';
                    } else if (equipment.type.includes('Tração')) {
                        icon = 'fa-truck-monster';
                    }
                    
                    // Determinar cor com base no status
                    let statusBgColor = 'bg-blue-100 dark:bg-blue-900';
                    let statusTextColor = 'text-blue-700 dark:text-blue-300';
                    let statusIconBgColor = 'bg-blue-500';
                    
                    if (equipment.status === 'Operacional') {
                        statusBgColor = 'bg-green-100 dark:bg-green-900';
                        statusTextColor = 'text-green-700 dark:text-green-300';
                        statusIconBgColor = 'bg-green-500';
                    } else if (equipment.status === 'Em manutenção') {
                        statusBgColor = 'bg-yellow-100 dark:bg-yellow-900';
                        statusTextColor = 'text-yellow-700 dark:text-yellow-300';
                        statusIconBgColor = 'bg-yellow-500';
                    } else if (equipment.status === 'Em reforma' || equipment.status === 'Inoperante' || equipment.status === 'Aguardando reforma') {
                        statusBgColor = 'bg-red-100 dark:bg-red-900';
                        statusTextColor = 'text-red-700 dark:text-red-300';
                        statusIconBgColor = 'bg-red-500';
                    }
                    
                    // Renderizar card
                    html += `
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                            <div class="p-5">
                                <div class="flex items-center mb-3">
                                    <div class="w-12 h-12 rounded-full bg-primary bg-opacity-10 flex items-center justify-center">
                                        <i class="fas ${icon} text-primary text-2xl"></i>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-lg font-medium">${equipment.type}</h3>
                                        <p class="text-base font-bold text-primary">${equipment.id}</p>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">${equipment.description}</p>
                                <div class="flex items-center mt-4">
                                    <div class="h-8 px-3 rounded-full ${statusBgColor} ${statusTextColor} flex items-center">
                                        <div class="w-2 h-2 rounded-full ${statusIconBgColor} mr-2"></div>
                                        <span class="text-sm font-medium">${equipment.status}</span>
                                    </div>
                                    <div class="ml-auto">
                                        <button class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-base edit-equipment-btn" data-id="${equipment.id}" data-type="${equipment.type}">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                if (equipments.length === 0) {
                    html = `
                        <div class="flex flex-col items-center justify-center py-8">
                            <div class="w-24 h-24 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center mb-4">
                                <i class="fas fa-search text-gray-400 dark:text-gray-500 text-4xl"></i>
                            </div>
                            <h3 class="text-xl font-medium text-gray-700 dark:text-gray-300 mb-2">Nenhum equipamento encontrado</h3>
                            <p class="text-gray-500 dark:text-gray-400 text-center max-w-md">Não foram encontrados equipamentos com os filtros selecionados. Tente selecionar outros filtros.</p>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
                
                // Adicionar listeners aos botões de edição
                container.querySelectorAll('.edit-equipment-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                this.updateAddFormFields();
                document.getElementById('add-modal').classList.remove('hidden');
            },
            
            // Atualizar campos do formulário para adicionar equipamento
            updateAddFormFields() {
                const formFieldsContainer = document.getElementById('add-form-fields');
                const equipmentType = document.getElementById('equipment-type').value;
                
                let html = '';
                
                switch (equipmentType) {
                    case 'reboque':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número da Frota</label>
                                <input type="text" id="add-reboque-frota" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 1101">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Reboque</label>
                                <select id="add-reboque-tipo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="SEMI REBOQUE">SEMI REBOQUE</option>
                                    <option value="REBOQUE">REBOQUE</option>
                                    <option value="DOLLY">DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-reboque-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                </select>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Acoplado ao Caminhão</label>
                                <input type="text" id="add-reboque-acoplado" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 7520">
                            </div>
                            <div id="motivo-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="add-reboque-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                            </div>
                            <div id="data-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data da Parada</label>
                                <input type="date" id="add-reboque-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('add-reboque-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('motivo-container');
                            const dataContainer = document.getElementById('data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'caminhao-proprio':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número do Caminhão</label>
                                <input type="text" id="add-cp-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 7520">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-cp-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Emprestado">Emprestado</option>
                                </select>
                            </div>
                            <div id="cp-motivo-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="add-cp-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                            </div>
                            <div id="cp-data-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                <input type="date" id="add-cp-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('add-cp-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('cp-motivo-container');
                            const dataContainer = document.getElementById('cp-data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'caminhao-terceiro':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Identificação do Caminhão</label>
                                <input type="text" id="add-ct-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: T001">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Proprietário</label>
                                <input type="text" id="add-ct-proprietario" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Nome do proprietário">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Reboques</label>
                                <input type="text" id="add-ct-reboques" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: 1201-1202">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-ct-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="ct-motivo-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="add-ct-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campo de motivo quando o status muda
                        document.getElementById('add-ct-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('ct-motivo-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'colhedora-4001':
                    case 'tracao-4001':
                    case 'colhedora-4002':
                    case 'tracao-4002':
                        const frenteNum = equipmentType.includes('4001') ? '4001' : '4002';
                        const equipType = equipmentType.includes('colhedora') ? 'Colhedora' : 'Tração';
                        const prefixo = equipmentType.includes('colhedora') ? 'C' : 'T';
                        const prefixoNum = frenteNum === '4001' ? '1' : '2';
                        
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da ${equipType}</label>
                                <input type="text" id="add-frente-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Ex: ${prefixo}${prefixoNum}01">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="add-frente-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="frente-motivo-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="add-frente-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" placeholder="Descreva o motivo da parada"></textarea>
                            </div>
                            <div id="frente-data-container" class="mb-5 hidden">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                <input type="date" id="add-frente-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('add-frente-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('frente-motivo-container');
                            const dataContainer = document.getElementById('frente-data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    default:
                        formFieldsContainer.innerHTML = '<p class="text-red-500">Tipo de equipamento inválido.</p>';
                }
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const equipmentType = document.getElementById('equipment-type').value;
                
                // Validação e salvamento baseado no tipo de equipamento
                switch (equipmentType) {
                    case 'reboque':
                        const frota = document.getElementById('add-reboque-frota').value.trim();
                        const tipo = document.getElementById('add-reboque-tipo').value;
                        const status = document.getElementById('add-reboque-status').value;
                        const acoplado = document.getElementById('add-reboque-acoplado').value.trim();
                        
                        let dataParada = null;
                        let motivo = null;
                        
                        if (status !== 'Operacional') {
                            dataParada = document.getElementById('add-reboque-data').value;
                            motivo = document.getElementById('add-reboque-motivo').value.trim();
                        }
                        
                        // Validar campos obrigatórios
                        if (!frota) {
                            this.showNotification('error', 'Erro', 'O número da frota é obrigatório.');
                            return;
                        }
                        
                        // Verificar se o número já existe
                        if (this.data.reboques.some(r => r.frota === frota)) {
                            this.showNotification('error', 'Erro', `Já existe um reboque com o número de frota ${frota}.`);
                            return;
                        }
                        
                        // Adicionar novo reboque
                        const newReboque = {
                            frota,
                            tipo,
                            status,
                            acoplado,
                            dataParada,
                            motivo,
                            tipoAcoplado: tipo
                        };
                        
                        this.data.reboques.push(newReboque);
                        break;
                    
                    case 'caminhao-proprio':
                        const caminhao = document.getElementById('add-cp-caminhao').value.trim();
                        const cpStatus = document.getElementById('add-cp-status').value;
                        
                        let cpData = null;
                        let cpMotivo = null;
                        
                        if (cpStatus !== 'Operacional') {
                            cpData = document.getElementById('add-cp-data').value;
                            cpMotivo = document.getElementById('add-cp-motivo').value.trim();
                        }
                        
                        // Validar campos obrigatórios
                        if (!caminhao) {
                            this.showNotification('error', 'Erro', 'O número do caminhão é obrigatório.');
                            return;
                        }
                        
                        // Verificar se o número já existe
                        if (this.data.caminhoesProps.some(c => c.caminhao === caminhao)) {
                            this.showNotification('error', 'Erro', `Já existe um caminhão próprio com o número ${caminhao}.`);
                            return;
                        }
                        
                        // Adicionar novo caminhão próprio
                        const newCP = {
                            caminhao,
                            status: cpStatus,
                            data: cpData,
                            motivo: cpMotivo
                        };
                        
                        this.data.caminhoesProps.push(newCP);
                        break;
                    
                    case 'caminhao-terceiro':
                        const ctCaminhao = document.getElementById('add-ct-caminhao').value.trim();
                        const proprietario = document.getElementById('add-ct-proprietario').value.trim();
                        const reboques = document.getElementById('add-ct-reboques').value.trim();
                        const ctStatus = document.getElementById('add-ct-status').value;
                        
                        let ctMotivo = null;
                        
                        if (ctStatus !== 'Operacional') {
                            ctMotivo = document.getElementById('add-ct-motivo').value.trim();
                        }
                        
                        // Validar campos obrigatórios
                        if (!ctCaminhao) {
                            this.showNotification('error', 'Erro', 'A identificação do caminhão é obrigatória.');
                            return;
                        }
                        
                        if (!proprietario) {
                            this.showNotification('error', 'Erro', 'O nome do proprietário é obrigatório.');
                            return;
                        }
                        
                        // Verificar se o número já existe
                        if (this.data.caminhoesTerc.some(c => c.caminhao === ctCaminhao)) {
                            this.showNotification('error', 'Erro', `Já existe um caminhão terceiro com a identificação ${ctCaminhao}.`);
                            return;
                        }
                        
                        // Adicionar novo caminhão terceiro
                        const newCT = {
                            caminhao: ctCaminhao,
                            proprietario,
                            reboques,
                            status: ctStatus,
                            motivo: ctMotivo
                        };
                        
                        this.data.caminhoesTerc.push(newCT);
                        break;
                    
                    case 'colhedora-4001':
                    case 'tracao-4001':
                    case 'colhedora-4002':
                    case 'tracao-4002':
                        const codigo = document.getElementById('add-frente-codigo').value.trim();
                        const frenteStatus = document.getElementById('add-frente-status').value;
                        
                        let frenteData = null;
                        let frenteMotivo = null;
                        
                        if (frenteStatus !== 'Operacional') {
                            frenteData = document.getElementById('add-frente-data').value;
                            frenteMotivo = document.getElementById('add-frente-motivo').value.trim();
                        }
                        
                        // Validar campos obrigatórios
                        if (!codigo) {
                            this.showNotification('error', 'Erro', 'O código do equipamento é obrigatório.');
                            return;
                        }
                        
                        // Determinar qual array atualizar
                        let targetArray;
                        if (equipmentType === 'colhedora-4001') {
                            targetArray = this.data.frente4001Colhedoras;
                        } else if (equipmentType === 'tracao-4001') {
                            targetArray = this.data.frente4001Tracoes;
                        } else if (equipmentType === 'colhedora-4002') {
                            targetArray = this.data.frente4002Colhedoras;
                        } else if (equipmentType === 'tracao-4002') {
                            targetArray = this.data.frente4002Tracoes;
                        }
                        
                        // Verificar se o código já existe
                        if (targetArray.some(item => item.codigo === codigo)) {
                            this.showNotification('error', 'Erro', `Já existe um equipamento com o código ${codigo}.`);
                            return;
                        }
                        
                        // Adicionar novo equipamento
                        const newEquipment = {
                            codigo,
                            status: frenteStatus,
                            data: frenteData,
                            motivo: frenteMotivo
                        };
                        
                        targetArray.push(newEquipment);
                        break;
                    
                    default:
                        this.showNotification('error', 'Erro', 'Tipo de equipamento inválido.');
                        return;
                }
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar o modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento adicionado com sucesso.');
            },
            
            // Atualizar campos do formulário de edição
            updateEditFormFields(formType, equipment) {
                const formFieldsContainer = document.getElementById('edit-form-fields');
                
                let html = '';
                
                switch (formType) {
                    case 'reboque':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número da Frota</label>
                                <input type="text" id="edit-reboque-frota" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.frota}" readonly>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Reboque</label>
                                <select id="edit-reboque-tipo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="SEMI REBOQUE" ${equipment.tipo === 'SEMI REBOQUE' ? 'selected' : ''}>SEMI REBOQUE</option>
                                    <option value="REBOQUE" ${equipment.tipo === 'REBOQUE' ? 'selected' : ''}>REBOQUE</option>
                                    <option value="DOLLY" ${equipment.tipo === 'DOLLY' ? 'selected' : ''}>DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-reboque-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${equipment.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${equipment.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${equipment.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${equipment.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${equipment.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                </select>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Acoplado ao Caminhão</label>
                                <input type="text" id="edit-reboque-acoplado" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.acoplado || ''}">
                            </div>
                            <div id="edit-motivo-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="edit-reboque-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">${equipment.motivo || ''}</textarea>
                            </div>
                            <div id="edit-data-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data da Parada</label>
                                <input type="date" id="edit-reboque-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.dataParada || ''}">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('edit-reboque-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('edit-motivo-container');
                            const dataContainer = document.getElementById('edit-data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'caminhao-proprio':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Número do Caminhão</label>
                                <input type="text" id="edit-cp-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.caminhao}" readonly>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-cp-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${equipment.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${equipment.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${equipment.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${equipment.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Emprestado" ${equipment.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                </select>
                            </div>
                            <div id="edit-cp-motivo-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="edit-cp-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">${equipment.motivo || ''}</textarea>
                            </div>
                            <div id="edit-cp-data-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                <input type="date" id="edit-cp-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.data || ''}">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('edit-cp-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('edit-cp-motivo-container');
                            const dataContainer = document.getElementById('edit-cp-data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'caminhao-terceiro':
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Identificação do Caminhão</label>
                                <input type="text" id="edit-ct-caminhao" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.caminhao}" readonly>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Proprietário</label>
                                <input type="text" id="edit-ct-proprietario" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.proprietario || ''}">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Reboques</label>
                                <input type="text" id="edit-ct-reboques" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.reboques || ''}">
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-ct-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${equipment.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${equipment.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Inoperante" ${equipment.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-ct-motivo-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="edit-ct-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">${equipment.motivo || ''}</textarea>
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campo de motivo quando o status muda
                        document.getElementById('edit-ct-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('edit-ct-motivo-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    case 'colhedora-4001':
                    case 'tracao-4001':
                    case 'colhedora-4002':
                    case 'tracao-4002':
                        const typeLabel = formType.includes('colhedora') ? 'Colhedora' : 'Tração';
                        const frenteLabel = formType.includes('4001') ? '4001' : '4002';
                        
                        html = `
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Código da ${typeLabel}</label>
                                <input type="text" id="edit-frente-codigo" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.codigo}" readonly>
                            </div>
                            <div class="mb-5">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                                <select id="edit-frente-status" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">
                                    <option value="Operacional" ${equipment.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${equipment.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${equipment.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${equipment.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-frente-motivo-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Motivo</label>
                                <textarea id="edit-frente-motivo" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base">${equipment.motivo || ''}</textarea>
                            </div>
                            <div id="edit-frente-data-container" class="mb-5 ${equipment.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-base font-medium text-gray-700 dark:text-gray-300 mb-2">Data</label>
                                <input type="date" id="edit-frente-data" class="w-full px-4 py-3 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-base" value="${equipment.data || ''}">
                            </div>
                        `;
                        
                        formFieldsContainer.innerHTML = html;
                        
                        // Mostrar/esconder campos de motivo e data quando o status muda
                        document.getElementById('edit-frente-status').addEventListener('change', function() {
                            const status = this.value;
                            const motivoContainer = document.getElementById('edit-frente-motivo-container');
                            const dataContainer = document.getElementById('edit-frente-data-container');
                            
                            if (status === 'Operacional') {
                                motivoContainer.classList.add('hidden');
                                dataContainer.classList.add('hidden');
                            } else {
                                motivoContainer.classList.remove('hidden');
                                dataContainer.classList.remove('hidden');
                            }
                        });
                        break;
                    
                    default:
                        formFieldsContainer.innerHTML = '<p class="text-red-500">Tipo de equipamento inválido.</p>';
                }
            },
            
            // Editar equipamento
            editEquipment(type, id) {
                // Buscar o equipamento a ser editado
                let equipmentArray, equipmentIndex, formType;
                
                if (type === 'Reboque') {
                    equipmentArray = this.data.reboques;
                    equipmentIndex = equipmentArray.findIndex(r => r.frota === id);
                    formType = 'reboque';
                } else if (type === 'Caminhão Próprio') {
                    equipmentArray = this.data.caminhoesProps;
                    equipmentIndex = equipmentArray.findIndex(c => c.caminhao === id);
                    formType = 'caminhao-proprio';
                } else if (type === 'Caminhão Terceiro') {
                    equipmentArray = this.data.caminhoesTerc;
                    equipmentIndex = equipmentArray.findIndex(c => c.caminhao === id);
                    formType = 'caminhao-terceiro';
                } else if (type === 'Colhedora Frente 4001' || type === 'Colhedora F4001') {
                    equipmentArray = this.data.frente4001Colhedoras;
                    equipmentIndex = equipmentArray.findIndex(c => c.codigo === id);
                    formType = 'colhedora-4001';
                } else if (type === 'Tração Frente 4001' || type === 'Tração F4001') {
                    equipmentArray = this.data.frente4001Tracoes;
                    equipmentIndex = equipmentArray.findIndex(t => t.codigo === id);
                    formType = 'tracao-4001';
                } else if (type === 'Colhedora Frente 4002' || type === 'Colhedora F4002') {
                    equipmentArray = this.data.frente4002Colhedoras;
                    equipmentIndex = equipmentArray.findIndex(c => c.codigo === id);
                    formType = 'colhedora-4002';
                } else if (type === 'Tração Frente 4002' || type === 'Tração F4002') {
                    equipmentArray = this.data.frente4002Tracoes;
                    equipmentIndex = equipmentArray.findIndex(t => t.codigo === id);
                    formType = 'tracao-4002';
                }
                
                // Se não encontrou, exibir erro
                if (equipmentIndex === -1) {
                    this.showNotification('error', 'Erro', 'Equipamento não encontrado.');
                    return;
                }
                
                // Guardar referência ao item a ser editado
                const equipment = equipmentArray[equipmentIndex];
                this.data.editingItem = equipment;
                this.data.editingType = type;
                
                // Definir título do modal
                document.getElementById('modal-title').textContent = `Editar ${type} - ${id}`;
                
                // Atualizar campos do formulário
                this.updateEditFormFields(formType, equipment);
                
                // Exibir modal
                document.getElementById('edit-modal').classList.remove('hidden');
            },
            
            // Salvar alterações do equipamento
            saveEquipmentChanges() {
                if (!this.data.editingItem || !this.data.editingType) {
                    this.showNotification('error', 'Erro', 'Nenhum equipamento sendo editado.');
                    return;
                }
                
                const type = this.data.editingType;
                let oldStatus = this.data.editingItem.status;
                let newStatus, newData, newMotivo;
                let idField, dataField, hasChanged = false;
                
                // Validação e salvamento baseado no tipo de equipamento
                if (type === 'Reboque') {
                    const tipo = document.getElementById('edit-reboque-tipo').value;
                    newStatus = document.getElementById('edit-reboque-status').value;
                    const acoplado = document.getElementById('edit-reboque-acoplado').value.trim();
                    
                    if (newStatus !== 'Operacional') {
                        newData = document.getElementById('edit-reboque-data').value;
                        newMotivo = document.getElementById('edit-reboque-motivo').value.trim();
                    } else {
                        newData = null;
                        newMotivo = null;
                    }
                    
                    // Atualizar os campos
                    this.data.editingItem.tipo = tipo;
                    this.data.editingItem.status = newStatus;
                    this.data.editingItem.acoplado = acoplado;
                    this.data.editingItem.dataParada = newData;
                    this.data.editingItem.motivo = newMotivo;
                    
                    idField = 'frota';
                    dataField = 'dataParada';
                    hasChanged = true;
                    
                } else if (type === 'Caminhão Próprio') {
                    newStatus = document.getElementById('edit-cp-status').value;
                    
                    if (newStatus !== 'Operacional') {
                        newData = document.getElementById('edit-cp-data').value;
                        newMotivo = document.getElementById('edit-cp-motivo').value.trim();
                    } else {
                        newData = null;
                        newMotivo = null;
                    }
                    
                    // Atualizar os campos
                    this.data.editingItem.status = newStatus;
                    this.data.editingItem.data = newData;
                    this.data.editingItem.motivo = newMotivo;
                    
                    idField = 'caminhao';
                    dataField = 'data';
                    hasChanged = true;
                    
                } else if (type === 'Caminhão Terceiro') {
                    const proprietario = document.getElementById('edit-ct-proprietario').value.trim();
                    const reboques = document.getElementById('edit-ct-reboques').value.trim();
                    newStatus = document.getElementById('edit-ct-status').value;
                    
                    if (newStatus !== 'Operacional') {
                        newMotivo = document.getElementById('edit-ct-motivo').value.trim();
                    } else {
                        newMotivo = null;
                    }
                    
                    // Atualizar os campos
                    this.data.editingItem.proprietario = proprietario;
                    this.data.editingItem.reboques = reboques;
                    this.data.editingItem.status = newStatus;
                    this.data.editingItem.motivo = newMotivo;
                    
                    idField = 'caminhao';
                    hasChanged = true;
                    
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    newStatus = document.getElementById('edit-frente-status').value;
                    
                    if (newStatus !== 'Operacional') {
                        newData = document.getElementById('edit-frente-data').value;
                        newMotivo = document.getElementById('edit-frente-motivo').value.trim();
                    } else {
                        newData = null;
                        newMotivo = null;
                    }
                    
                    // Atualizar os campos
                    this.data.editingItem.status = newStatus;
                    this.data.editingItem.data = newData;
                    this.data.editingItem.motivo = newMotivo;
                    
                    idField = 'codigo';
                    dataField = 'data';
                    hasChanged = true;
                }
                
                // Se houve alteração no status, registrar no histórico
                if (hasChanged && oldStatus !== newStatus) {
                    const id = this.data.editingItem[idField];
                    
                    // Inicializar o histórico se não existir
                    if (!this.data.history[id]) {
                        this.data.history[id] = [];
                    }
                    
                    // Adicionar registro ao histórico
                    const historyEntry = {
                        date: new Date().toISOString(),
                        status: newStatus,
                        description: `Status alterado de ${oldStatus} para ${newStatus}${newMotivo ? ` - Motivo: ${newMotivo}` : ''}`,
                        user: 'Administrador'
                    };
                    
                    this.data.history[id].unshift(historyEntry);
                }
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar o modal
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento atualizado com sucesso.');
                
                // Limpar referências
                this.data.editingItem = null;
                this.data.editingType = null;
            },
            
            // Confirmar exclusão de equipamento
            confirmDeleteEquipment(type, id, index, arrayName) {
                this.data.deletingId = id;
                this.data.deletingType = type;
                this.data.deletingIndex = index;
                this.data.deletingArray = arrayName;
                
                document.getElementById('delete-item-details').textContent = `${type} - ${id}`;
                document.getElementById('delete-confirm-modal').classList.remove('hidden');
            },
            
            // Excluir equipamento
            deleteEquipment() {
                if (!this.data.deletingId || !this.data.deletingType || this.data.deletingIndex === null || !this.data.deletingArray) {
                    this.showNotification('error', 'Erro', 'Dados de exclusão incompletos.');
                    return;
                }
                
                // Excluir o item do array correto
                this.data[this.data.deletingArray].splice(this.data.deletingIndex, 1);
                
                // Excluir histórico do equipamento
                if (this.data.history[this.data.deletingId]) {
                    delete this.data.history[this.data.deletingId];
                }
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar o modal
                document.getElementById('delete-confirm-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento excluído com sucesso.');
                
                // Limpar referências
                this.data.deletingId = null;
                this.data.deletingType = null;
                this.data.deletingIndex = null;
                this.data.deletingArray = null;
            },
            
            // Visualizar histórico de equipamento
            viewEquipmentHistory(type, id) {
                // Atualizar título do modal
                document.getElementById('history-title').textContent = `Histórico - ${type} ${id}`;
                
                // Atualizar ícone com base no tipo
                let icon = 'fa-truck';
                if (type.includes('Reboque')) {
                    icon = 'fa-trailer';
                } else if (type.includes('Colhedora')) {
                    icon = 'fa-tractor';
                } else if (type.includes('Tração')) {
                    icon = 'fa-truck-monster';
                }
                
                document.getElementById('history-icon').className = `fas ${icon} text-xl`;
                
                // Buscar histórico
                const historyEntries = this.data.history[id] || [];
                
                document.getElementById('history-subtitle').textContent = `Total de registros: ${historyEntries.length}`;
                
                // Renderizar histórico
                const historyContainer = document.getElementById('history-timeline');
                
                if (historyEntries.length === 0) {
                    historyContainer.innerHTML = `
                        <div class="flex flex-col items-center justify-center py-6">
                            <div class="w-16 h-16 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center mb-3">
                                <i class="fas fa-history text-gray-400 dark:text-gray-500 text-2xl"></i>
                            </div>
                            <p class="text-lg text-gray-500 dark:text-gray-400">Nenhum registro no histórico</p>
                        </div>
                    `;
                } else {
                    let html = '';
                    
                    historyEntries.forEach((entry, index) => {
                        let statusBadgeClass = '';
                        
                        if (entry.status === 'Operacional') {
                            statusBadgeClass = 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';
                        } else if (entry.status === 'Em manutenção') {
                            statusBadgeClass = 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';
                        } else if (['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(entry.status)) {
                            statusBadgeClass = 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200';
                        } else {
                            statusBadgeClass = 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200';
                        }
                        
                        const date = new Date(entry.date);
                        const formattedDate = date.toLocaleDateString('pt-BR');
                        const formattedTime = date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                        
                        html += `
                            <div class="mb-6 relative">
                                <div class="absolute -left-12 mt-1.5 w-6 h-6 rounded-full bg-primary flex items-center justify-center text-white text-sm">
                                    <i class="fas fa-circle"></i>
                                </div>
                                <div class="bg-white dark:bg-gray-750 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700">
                                    <div class="flex flex-wrap justify-between items-start mb-2">
                                        <span class="text-base font-medium text-gray-700 dark:text-gray-300">${formattedDate} às ${formattedTime}</span>
                                        <span class="px-3 py-1 rounded-full ${statusBadgeClass} text-sm font-medium mt-1 sm:mt-0">${entry.status}</span>
                                    </div>
                                    <p class="text-base text-gray-600 dark:text-gray-400">${entry.description}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-500 mt-2"><i class="fas fa-user mr-1"></i> ${entry.user}</p>
                                </div>
                            </div>
                        `;
                    });
                    
                    historyContainer.innerHTML = html;
                }
                
                // Exibir modal
                document.getElementById('history-modal').classList.remove('hidden');
            },
            
            // Agendar manutenção de equipamento
            scheduleEquipmentMaintenance(type, id) {
                // Guardar referência ao equipamento selecionado
                this.data.schedulingEquipment = {
                    id,
                    type
                };
                
                // Atualizar informações no modal
                document.getElementById('schedule-equipment-info').innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                        <p class="font-medium text-gray-800 dark:text-gray-200">${type}</p>
                        <p class="text-xl font-bold text-primary">${id}</p>
                    </div>
                `;
                
                // Limpar campos do formulário
                document.getElementById('schedule-date').value = '';
                document.getElementById('schedule-time').value = '';
                document.getElementById('schedule-type').value = 'preventiva';
                document.getElementById('schedule-description').value = '';
                document.getElementById('schedule-responsible').value = '';
                
                // Exibir modal
                document.getElementById('schedule-modal').classList.remove('hidden');
            },
            
            // Salvar agendamento de manutenção
            saveSchedule() {
                if (!this.data.schedulingEquipment) {
                    this.showNotification('error', 'Erro', 'Nenhum equipamento selecionado.');
                    return;
                }
                
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const type = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value.trim();
                const responsible = document.getElementById('schedule-responsible').value.trim();
                
                // Validar campos obrigatórios
                if (!date || !time || !description || !responsible) {
                    this.showNotification('error', 'Erro', 'Todos os campos são obrigatórios.');
                    return;
                }
                
                // Criar novo agendamento
                const newSchedule = {
                    equipment: this.data.schedulingEquipment.id,
                    equipmentType: this.data.schedulingEquipment.type,
                    date,
                    time,
                    type,
                    description,
                    responsible,
                    created: new Date().toISOString(),
                    status: 'Agendado'
                };
                
                // Adicionar ao array de agendamentos
                this.data.schedules.push(newSchedule);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar lista de próximas manutenções
                this.updateUpcomingMaintenanceList();
                
                // Fechar o modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Manutenção agendada com sucesso.');
                
                // Limpar referência
                this.data.schedulingEquipment = null;
            },
            
            // Exportar para CSV
            exportToCSV() {
                // Determinar qual tabela está ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                
                let data = [];
                let headers = [];
                
                // Preparar dados com base na tabela ativa
                switch (tabId) {
                    case 'reboques':
                        headers = ['Frota', 'Tipo', 'Acoplado', 'Status', 'Data', 'Motivo'];
                        data = this.data.reboques.map(r => [
                            r.frota,
                            r.tipo,
                            r.acoplado || '',
                            r.status,
                            r.dataParada || '',
                            r.motivo || ''
                        ]);
                        break;
                    
                    case 'caminhoes-proprios':
                        headers = ['Caminhão', 'Status', 'Data', 'Motivo'];
                        data = this.data.caminhoesProps.map(c => [
                            c.caminhao,
                            c.status,
                            c.data || '',
                            c.motivo || ''
                        ]);
                        break;
                    
                    case 'caminhoes-terceiros':
                        headers = ['Caminhão', 'Proprietário', 'Reboques', 'Status', 'Motivo'];
                        data = this.data.caminhoesTerc.map(c => [
                            c.caminhao,
                            c.proprietario,
                            c.reboques || '',
                            c.status,
                            c.motivo || ''
                        ]);
                        break;
                    
                    case 'frente-4001':
                    case 'frente-4002':
                        headers = ['Tipo', 'Código', 'Status', 'Data', 'Motivo'];
                        
                        if (tabId === 'frente-4001') {
                            data = [
                                ...this.data.frente4001Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data || '',
                                    c.motivo || ''
                                ]),
                                ...this.data.frente4001Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data || '',
                                    t.motivo || ''
                                ])
                            ];
                        } else {
                            data = [
                                ...this.data.frente4002Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data || '',
                                    c.motivo || ''
                                ]),
                                ...this.data.frente4002Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data || '',
                                    t.motivo || ''
                                ])
                            ];
                        }
                        break;
                    
                    default:
                        // Exportar todos os dados
                        headers = ['Tipo', 'ID', 'Status', 'Data', 'Motivo', 'Disponibilidade'];
                        
                        // Calcular disponibilidade para cada tipo
                        const totalReboques = this.data.reboques.length;
                        const operacionalReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                        const dispReboques = totalReboques > 0 ? Math.round((operacionalReboques / totalReboques) * 100) : 0;
                        
                        const totalCP = this.data.caminhoesProps.length;
                        const operacionalCP = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                        const dispCP = totalCP > 0 ? Math.round((operacionalCP / totalCP) * 100) : 0;
                        
                        const totalCT = this.data.caminhoesTerc.length;
                        const operacionalCT = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                        const dispCT = totalCT > 0 ? Math.round((operacionalCT / totalCT) * 100) : 0;
                        
                        const totalF4001Colh = this.data.frente4001Colhedoras.length;
                        const operacionalF4001Colh = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                        const dispF4001Colh = totalF4001Colh > 0 ? Math.round((operacionalF4001Colh / totalF4001Colh) * 100) : 0;
                        
                        const totalF4001Trac = this.data.frente4001Tracoes.length;
                        const operacionalF4001Trac = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                        const dispF4001Trac = totalF4001Trac > 0 ? Math.round((operacionalF4001Trac / totalF4001Trac) * 100) : 0;
                        
                        const totalF4002Colh = this.data.frente4002Colhedoras.length;
                        const operacionalF4002Colh = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                        const dispF4002Colh = totalF4002Colh > 0 ? Math.round((operacionalF4002Colh / totalF4002Colh) * 100) : 0;
                        
                        const totalF4002Trac = this.data.frente4002Tracoes.length;
                        const operacionalF4002Trac = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                        const dispF4002Trac = totalF4002Trac > 0 ? Math.round((operacionalF4002Trac / totalF4002Trac) * 100) : 0;
                        
                        data = [
                            ...this.data.reboques.map(r => [
                                'Reboque',
                                r.frota,
                                r.status,
                                r.dataParada || '',
                                r.motivo || '',
                                `${dispReboques}%`
                            ]),
                            ...this.data.caminhoesProps.map(c => [
                                'Caminhão Próprio',
                                c.caminhao,
                                c.status,
                                c.data || '',
                                c.motivo || '',
                                `${dispCP}%`
                            ]),
                            ...this.data.caminhoesTerc.map(c => [
                                'Caminhão Terceiro',
                                c.caminhao,
                                c.status,
                                '',
                                c.motivo || '',
                                `${dispCT}%`
                            ]),
                            ...this.data.frente4001Colhedoras.map(c => [
                                'Colhedora F4001',
                                c.codigo,
                                c.status,
                                c.data || '',
                                c.motivo || '',
                                `${dispF4001Colh}%`
                            ]),
                            ...this.data.frente4001Tracoes.map(t => [
                                'Tração F4001',
                                t.codigo,
                                t.status,
                                t.data || '',
                                t.motivo || '',
                                `${dispF4001Trac}%`
                            ]),
                            ...this.data.frente4002Colhedoras.map(c => [
                                'Colhedora F4002',
                                c.codigo,
                                c.status,
                                c.data || '',
                                c.motivo || '',
                                `${dispF4002Colh}%`
                            ]),
                            ...this.data.frente4002Tracoes.map(t => [
                                'Tração F4002',
                                t.codigo,
                                t.status,
                                t.data || '',
                                t.motivo || '',
                                `${dispF4002Trac}%`
                            ])
                        ];
                }
                
                // Gerar CSV
                const csvRows = [
                    headers.join(';'),
                    ...data.map(row => row.join(';'))
                ];
                
                const csvContent = csvRows.join('\n');
                
                // Criar blob e link para download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                
                // Nome do arquivo com data atual
                const date = new Date();
                const dateStr = date.toISOString().split('T')[0];
                link.download = `frota_${tabId}_${dateStr}.csv`;
                
                // Realizar download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.showNotification('success', 'Sucesso', 'Dados exportados com sucesso.');
            },
            
            // Exportar para JSON
            exportToJSON() {
                const backupData = {
                    reboques: this.data.reboques,
                    caminhoesProps: this.data.caminhoesProps,
                    caminhoesTerc: this.data.caminhoesTerc,
                    frente4001Colhedoras: this.data.frente4001Colhedoras,
                    frente4001Tracoes: this.data.frente4001Tracoes,
                    frente4002Colhedoras: this.data.frente4002Colhedoras,
                    frente4002Tracoes: this.data.frente4002Tracoes,
                    history: this.data.history,
                    schedules: this.data.schedules
                };
                
                // Converter dados para JSON
                const jsonString = JSON.stringify(backupData, null, 2);
                
                // Criar blob e link para download
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                
                // Nome do arquivo com data atual
                const date = new Date();
                const dateStr = date.toISOString().split('T')[0];
                link.download = `backup_frota_${dateStr}.json`;
                
                // Realizar download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Backup exportado com sucesso.');
            },
            
            // Imprimir tabela ativa
            printActiveTable() {
                // Determinar qual tabela está ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                let title, tableHTML;
                
                // Preparar conteúdo com base na tabela ativa
                switch (tabId) {
                    case 'reboques':
                        title = 'Relatório de Reboques';
                        tableHTML = this.generateTableHTML(
                            ['Frota', 'Tipo', 'Acoplado', 'Status', 'Data', 'Motivo'],
                            this.data.reboques.map(r => [
                                r.frota,
                                r.tipo,
                                r.acoplado || '-',
                                r.status,
                                r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-',
                                r.motivo || '-'
                            ])
                        );
                        break;
                    
                    case 'caminhoes-proprios':
                        title = 'Relatório de Caminhões Próprios';
                        tableHTML = this.generateTableHTML(
                            ['Caminhão', 'Status', 'Data', 'Motivo'],
                            this.data.caminhoesProps.map(c => [
                                c.caminhao,
                                c.status,
                                c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                c.motivo || '-'
                            ])
                        );
                        break;
                    
                    case 'caminhoes-terceiros':
                        title = 'Relatório de Caminhões Terceiros';
                        tableHTML = this.generateTableHTML(
                            ['Caminhão', 'Proprietário', 'Reboques', 'Status', 'Motivo'],
                            this.data.caminhoesTerc.map(c => [
                                c.caminhao,
                                c.proprietario,
                                c.reboques || '-',
                                c.status,
                                c.motivo || '-'
                            ])
                        );
                        break;
                    
                    case 'frente-4001':
                        title = 'Relatório da Frente 4001';
                        tableHTML = this.generateTableHTML(
                            ['Tipo', 'Código', 'Status', 'Data', 'Motivo'],
                            [
                                ...this.data.frente4001Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                    c.motivo || '-'
                                ]),
                                ...this.data.frente4001Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                                    t.motivo || '-'
                                ])
                            ]
                        );
                        break;
                    
                    case 'frente-4002':
                        title = 'Relatório da Frente 4002';
                        tableHTML = this.generateTableHTML(
                            ['Tipo', 'Código', 'Status', 'Data', 'Motivo'],
                            [
                                ...this.data.frente4002Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                    c.motivo || '-'
                                ]),
                                ...this.data.frente4002Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                                    t.motivo || '-'
                                ])
                            ]
                        );
                        break;
                    
                    default:
                        // Dashboard ou outra visualização
                        title = 'Relatório Geral da Frota';
                        
                        // Gerar resumo geral
                        const totalOperacional = 
                            this.data.reboques.filter(r => r.status === 'Operacional').length +
                            this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                            this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                            this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                            this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                            this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                            this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                        
                        const totalEquipamentos = 
                            this.data.reboques.length +
                            this.data.caminhoesProps.length +
                            this.data.caminhoesTerc.length +
                            this.data.frente4001Colhedoras.length +
                            this.data.frente4001Tracoes.length +
                            this.data.frente4002Colhedoras.length +
                            this.data.frente4002Tracoes.length;
                        
                        const disponibilidadeGlobal = totalEquipamentos > 0 ? Math.round((totalOperacional / totalEquipamentos) * 100) : 0;
                        
                        tableHTML = `
                            <div class="mb-6">
                                <h2 class="text-2xl font-bold mb-4">Resumo Geral</h2>
                                <p class="mb-2">Total de Equipamentos: <strong>${totalEquipamentos}</strong></p>
                                <p class="mb-2">Equipamentos Operacionais: <strong>${totalOperacional}</strong></p>
                                <p class="mb-2">Disponibilidade Global: <strong>${disponibilidadeGlobal}%</strong></p>
                            </div>
                            
                            <h2 class="text-2xl font-bold mb-4">Detalhes por Categoria</h2>
                            <div class="mb-6">
                                <h3 class="text-xl font-semibold mb-3">Reboques</h3>
                                ${this.generateTableHTML(
                                    ['Frota', 'Status'],
                                    this.data.reboques.map(r => [r.frota, r.status])
                                )}
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="text-xl font-semibold mb-3">Caminhões Próprios</h3>
                                ${this.generateTableHTML(
                                    ['Caminhão', 'Status'],
                                    this.data.caminhoesProps.map(c => [c.caminhao, c.status])
                                )}
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="text-xl font-semibold mb-3">Equipamentos Frente 4001</h3>
                                ${this.generateTableHTML(
                                    ['Tipo', 'Código', 'Status'],
                                    [
                                        ...this.data.frente4001Colhedoras.map(c => ['Colhedora', c.codigo, c.status]),
                                        ...this.data.frente4001Tracoes.map(t => ['Tração', t.codigo, t.status])
                                    ]
                                )}
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="text-xl font-semibold mb-3">Equipamentos Frente 4002</h3>
                                ${this.generateTableHTML(
                                    ['Tipo', 'Código', 'Status'],
                                    [
                                        ...this.data.frente4002Colhedoras.map(c => ['Colhedora', c.codigo, c.status]),
                                        ...this.data.frente4002Tracoes.map(t => ['Tração', t.codigo, t.status])
                                    ]
                                )}
                            </div>
                        `;
                }
                
                // Atualizar área de impressão
                document.getElementById('print-title').textContent = title;
                document.getElementById('print-date').textContent = new Date().toLocaleDateString('pt-BR', { year: 'numeric', month: 'long', day: 'numeric' });
                document.getElementById('print-content').innerHTML = tableHTML;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Abrir janela de impressão
                window.print();
            },
            
            // Imprimir dashboard
            printDashboard() {
                // Preparar conteúdo do dashboard
                const totalEquipamentos = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                const totalOperacional = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalManutencao = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const totalReforma = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                const totalEmprestado = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Emprestado').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Emprestado').length;
                
                const totalOutros = totalEquipamentos - totalOperacional - totalManutencao - totalReforma - totalEmprestado;
                
                const disponibilidadeGlobal = totalEquipamentos > 0 ? Math.round((totalOperacional / totalEquipamentos) * 100) : 0;
                
                // Preparar conteúdo por categoria
                const reboquesOperacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesTotal = this.data.reboques.length;
                const reboquesDisp = reboquesTotal > 0 ? Math.round((reboquesOperacional / reboquesTotal) * 100) : 0;
                
                const cpOperacional = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpTotal = this.data.caminhoesProps.length;
                const cpDisp = cpTotal > 0 ? Math.round((cpOperacional / cpTotal) * 100) : 0;
                
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Disp = f4001Total > 0 ? Math.round((f4001Operacional / f4001Total) * 100) : 0;
                
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Disp = f4002Total > 0 ? Math.round((f4002Operacional / f4002Total) * 100) : 0;
                
                // Atualizar área de impressão
                document.getElementById('print-title').textContent = 'Dashboard da Frota';
                document.getElementById('print-date').textContent = new Date().toLocaleDateString('pt-BR', { year: 'numeric', month: 'long', day: 'numeric' });
                
                const dashboardContent = `
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Resumo Geral da Frota</h2>
                        <div class="grid grid-cols-3 gap-4 mb-6">
                            <div class="border p-4">
                                <p class="font-medium text-gray-600">Total de Equipamentos</p>
                                <p class="text-2xl font-bold">${totalEquipamentos}</p>
                            </div>
                            <div class="border p-4">
                                <p class="font-medium text-gray-600">Equipamentos Operacionais</p>
                                <p class="text-2xl font-bold">${totalOperacional}</p>
                            </div>
                            <div class="border p-4">
                                <p class="font-medium text-gray-600">Disponibilidade Global</p>
                                <p class="text-2xl font-bold">${disponibilidadeGlobal}%</p>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-semibold mb-3">Status da Frota</h3>
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr>
                                        <th class="border p-2 text-left">Status</th>
                                        <th class="border p-2 text-right">Quantidade</th>
                                        <th class="border p-2 text-right">Porcentagem</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border p-2">Operacionais</td>
                                        <td class="border p-2 text-right">${totalOperacional}</td>
                                        <td class="border p-2 text-right">${totalEquipamentos > 0 ? Math.round((totalOperacional / totalEquipamentos) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2">Em Manutenção</td>
                                        <td class="border p-2 text-right">${totalManutencao}</td>
                                        <td class="border p-2 text-right">${totalEquipamentos > 0 ? Math.round((totalManutencao / totalEquipamentos) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2">Em Reforma/Inoperantes</td>
                                        <td class="border p-2 text-right">${totalReforma}</td>
                                        <td class="border p-2 text-right">${totalEquipamentos > 0 ? Math.round((totalReforma / totalEquipamentos) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2">Emprestados</td>
                                        <td class="border p-2 text-right">${totalEmprestado}</td>
                                        <td class="border p-2 text-right">${totalEquipamentos > 0 ? Math.round((totalEmprestado / totalEquipamentos) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2">Outros</td>
                                        <td class="border p-2 text-right">${totalOutros}</td>
                                        <td class="border p-2 text-right">${totalEquipamentos > 0 ? Math.round((totalOutros / totalEquipamentos) * 100) : 0}%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Disponibilidade por Categoria</h2>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="border p-4">
                                <h3 class="text-xl font-semibold mb-2">Reboques</h3>
                                <p class="mb-1">Total: <strong>${reboquesTotal}</strong></p>
                                <p class="mb-1">Operacionais: <strong>${reboquesOperacional}</strong></p>
                                <p class="mb-1">Disponibilidade: <strong>${reboquesDisp}%</strong></p>
                            </div>
                            <div class="border p-4">
                                <h3 class="text-xl font-semibold mb-2">Caminhões Próprios</h3>
                                <p class="mb-1">Total: <strong>${cpTotal}</strong></p>
                                <p class="mb-1">Operacionais: <strong>${cpOperacional}</strong></p>
                                <p class="mb-1">Disponibilidade: <strong>${cpDisp}%</strong></p>
                            </div>
                            <div class="border p-4">
                                <h3 class="text-xl font-semibold mb-2">Frente 4001</h3>
                                <p class="mb-1">Total: <strong>${f4001Total}</strong></p>
                                <p class="mb-1">Operacionais: <strong>${f4001Operacional}</strong></p>
                                <p class="mb-1">Disponibilidade: <strong>${f4001Disp}%</strong></p>
                            </div>
                            <div class="border p-4">
                                <h3 class="text-xl font-semibold mb-2">Frente 4002</h3>
                                <p class="mb-1">Total: <strong>${f4002Total}</strong></p>
                                <p class="mb-1">Operacionais: <strong>${f4002Operacional}</strong></p>
                                <p class="mb-1">Disponibilidade: <strong>${f4002Disp}%</strong></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-8 pdf-page-break">
                        <h2 class="text-2xl font-bold mb-4">Equipamentos em Manutenção</h2>
                        ${this.generateMaintenanceList()}
                    </div>
                `;
                
                document.getElementById('print-content').innerHTML = dashboardContent;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Abrir janela de impressão
                window.print();
            },
            
            // Gerar lista de equipamentos em manutenção para impressão
            generateMaintenanceList() {
                // Buscar todos os equipamentos em manutenção
                const maintenanceEquipments = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({ 
                        id: r.frota, 
                        type: 'Reboque', 
                        date: r.dataParada, 
                        reason: r.motivo 
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.caminhao, 
                        type: 'Caminhão Próprio', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.caminhao, 
                        type: 'Caminhão Terceiro', 
                        date: null, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.codigo, 
                        type: 'Colhedora Frente 4001', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({ 
                        id: t.codigo, 
                        type: 'Tração Frente 4001', 
                        date: t.data, 
                        reason: t.motivo 
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({ 
                        id: c.codigo, 
                        type: 'Colhedora Frente 4002', 
                        date: c.data, 
                        reason: c.motivo 
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({ 
                        id: t.codigo, 
                        type: 'Tração Frente 4002', 
                        date: t.data, 
                        reason: t.motivo 
                    }))
                ];
                
                // Ordenar por data, mais recentes primeiro
                maintenanceEquipments.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                if (maintenanceEquipments.length === 0) {
                    return '<p class="text-center text-gray-500">Nenhum equipamento em manutenção no momento.</p>';
                }
                
                return this.generateTableHTML(
                    ['Tipo', 'ID', 'Data', 'Motivo'],
                    maintenanceEquipments.map(equipment => [
                        equipment.type,
                        equipment.id,
                        equipment.date ? new Date(equipment.date).toLocaleDateString('pt-BR') : '-',
                        equipment.reason || '-'
                    ])
                );
            },
            
            // Gerar HTML para uma tabela
            generateTableHTML(headers, data) {
                let tableHTML = `
                    <table class="w-full border-collapse">
                        <thead>
                            <tr>
                `;
                
                // Adicionar cabeçalhos
                headers.forEach(header => {
                    tableHTML += `<th class="border p-2 text-left">${header}</th>`;
                });
                
                tableHTML += `
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                // Adicionar linhas de dados
                data.forEach(row => {
                    tableHTML += '<tr>';
                    row.forEach(cell => {
                        tableHTML += `<td class="border p-2">${cell}</td>`;
                    });
                    tableHTML += '</tr>';
                });
                
                tableHTML += `
                        </tbody>
                    </table>
                `;
                
                return tableHTML;
            },
            
            // Gerar relatório PDF
            generatePDFReport() {
                // Para o propósito deste exemplo, usaremos a mesma abordagem que usamos para imprimir
                // Em um ambiente real, você usaria uma biblioteca como jsPDF
                
                document.getElementById('pdf-report-title').textContent = 'Relatório Completo da Frota';
                document.getElementById('pdf-report-date').textContent = new Date().toLocaleDateString('pt-BR', { year: 'numeric', month: 'long', day: 'numeric' });
                
                // Contagem de equipamentos por tipo
                const totalReboques = this.data.reboques.length;
                const totalCP = this.data.caminhoesProps.length;
                const totalCT = this.data.caminhoesTerc.length;
                const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                
                // Contagem por status
                const totalOperacional = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalManutencao = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const totalReforma = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                const totalEquipamentos = totalReboques + totalCP + totalCT + totalF4001 + totalF4002;
                const disponibilidadeGlobal = totalEquipamentos > 0 ? Math.round((totalOperacional / totalEquipamentos) * 100) : 0;
                
                // Preparar conteúdo do relatório
                const reportContent = `
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Resumo Executivo</h2>
                        <p class="mb-4">Este relatório apresenta a situação atual da frota, incluindo disponibilidade, equipamentos em manutenção e detalhes por categoria.</p>
                        
                        <div class="p-4 bg-gray-100 rounded mb-4">
                            <p class="font-bold">Disponibilidade Global: ${disponibilidadeGlobal}%</p>
                            <p>Total de Equipamentos: ${totalEquipamentos}</p>
                            <p>Equipamentos Operacionais: ${totalOperacional}</p>
                            <p>Equipamentos em Manutenção: ${totalManutencao}</p>
                            <p>Equipamentos em Reforma/Inoperantes: ${totalReforma}</p>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Distribuição por Categoria</h2>
                        <table class="w-full border-collapse mb-4">
                            <thead>
                                <tr>
                                    <th class="border p-2 text-left">Categoria</th>
                                    <th class="border p-2 text-right">Total</th>
                                    <th class="border p-2 text-right">Operacionais</th>
                                    <th class="border p-2 text-right">Disponibilidade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border p-2">Reboques</td>
                                    <td class="border p-2 text-right">${totalReboques}</td>
                                    <td class="border p-2 text-right">${this.data.reboques.filter(r => r.status === 'Operacional').length}</td>
                                    <td class="border p-2 text-right">${totalReboques > 0 ? Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / totalReboques) * 100) : 0}%</td>
                                </tr>
                                <tr>
                                    <td class="border p-2">Caminhões Próprios</td>
                                    <td class="border p-2 text-right">${totalCP}</td>
                                    <td class="border p-2 text-right">${this.data.caminhoesProps.filter(c => c.status === 'Operacional').length}</td>
                                    <td class="border p-2 text-right">${totalCP > 0 ? Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / totalCP) * 100) : 0}%</td>
                                </tr>
                                <tr>
                                    <td class="border p-2">Caminhões Terceiros</td>
                                    <td class="border p-2 text-right">${totalCT}</td>
                                    <td class="border p-2 text-right">${this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length}</td>
                                    <td class="border p-2 text-right">${totalCT > 0 ? Math.round((this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length / totalCT) * 100) : 0}%</td>
                                </tr>
                                <tr>
                                    <td class="border p-2">Frente 4001</td>
                                    <td class="border p-2 text-right">${totalF4001}</td>
                                    <td class="border p-2 text-right">${this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                    <td class="border p-2 text-right">${totalF4001 > 0 ? Math.round(((this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length) / totalF4001) * 100) : 0}%</td>
                                </tr>
                                <tr>
                                    <td class="border p-2">Frente 4002</td>
                                    <td class="border p-2 text-right">${totalF4002}</td>
                                    <td class="border p-2 text-right">${this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                    <td class="border p-2 text-right">${totalF4002 > 0 ? Math.round(((this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length) / totalF4002) * 100) : 0}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="pdf-page-break"></div>
                    
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Equipamentos em Manutenção</h2>
                        ${this.generateMaintenanceList()}
                    </div>
                    
                    <div class="pdf-page-break"></div>
                    
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold mb-4">Detalhes por Categoria</h2>
                        
                        <h3 class="text-xl font-semibold mb-3">Reboques</h3>
                        ${this.generateTableHTML(
                            ['Frota', 'Tipo', 'Status', 'Data Parada', 'Motivo'],
                            this.data.reboques.map(r => [
                                r.frota,
                                r.tipo,
                                r.status,
                                r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-',
                                r.motivo || '-'
                            ])
                        )}
                        
                        <div class="pdf-page-break"></div>
                        
                        <h3 class="text-xl font-semibold mb-3 mt-8">Caminhões Próprios</h3>
                        ${this.generateTableHTML(
                            ['Caminhão', 'Status', 'Data', 'Motivo'],
                            this.data.caminhoesProps.map(c => [
                                c.caminhao,
                                c.status,
                                c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                c.motivo || '-'
                            ])
                        )}
                        
                        <div class="pdf-page-break"></div>
                        
                        <h3 class="text-xl font-semibold mb-3 mt-8">Frente 4001</h3>
                        ${this.generateTableHTML(
                            ['Tipo', 'Código', 'Status', 'Data', 'Motivo'],
                            [
                                ...this.data.frente4001Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                    c.motivo || '-'
                                ]),
                                ...this.data.frente4001Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                                    t.motivo || '-'
                                ])
                            ]
                        )}
                        
                        <div class="pdf-page-break"></div>
                        
                        <h3 class="text-xl font-semibold mb-3 mt-8">Frente 4002</h3>
                        ${this.generateTableHTML(
                            ['Tipo', 'Código', 'Status', 'Data', 'Motivo'],
                            [
                                ...this.data.frente4002Colhedoras.map(c => [
                                    'Colhedora',
                                    c.codigo,
                                    c.status,
                                    c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-',
                                    c.motivo || '-'
                                ]),
                                ...this.data.frente4002Tracoes.map(t => [
                                    'Tração',
                                    t.codigo,
                                    t.status,
                                    t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '-',
                                    t.motivo || '-'
                                ])
                            ]
                        )}
                    </div>
                `;
                
                document.getElementById('pdf-report-content').innerHTML = reportContent;
                document.getElementById('pdf-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Abrir janela de impressão
                window.print();
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                // Classe e ícone com base no tipo
                let bgClass, iconClass;
                switch (type) {
                    case 'success':
                        bgClass = 'bg-green-50 dark:bg-green-900 border-green-500';
                        iconClass = 'text-green-500 fas fa-check-circle';
                        break;
                    case 'error':
                        bgClass = 'bg-red-50 dark:bg-red-900 border-red-500';
                        iconClass = 'text-red-500 fas fa-exclamation-circle';
                        break;
                    case 'warning':
                        bgClass = 'bg-yellow-50 dark:bg-yellow-900 border-yellow-500';
                        iconClass = 'text-yellow-500 fas fa-exclamation-triangle';
                        break;
                    case 'info':
                    default:
                        bgClass = 'bg-blue-50 dark:bg-blue-900 border-blue-500';
                        iconClass = 'text-blue-500 fas fa-info-circle';
                }
                
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = `notification ${bgClass} p-4 rounded-lg shadow-md border-l-4 max-w-md text-base`;
                notification.innerHTML = `
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="${iconClass} text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="font-medium text-black dark:text-white">${title}</h3>
                            <div class="mt-1 text-gray-700 dark:text-gray-200">${message}</div>
                        </div>
                        <button class="close-notification ml-auto -mt-1 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                // Adicionar ao container
                container.appendChild(notification);
                
                // Adicionar evento para fechar
                const closeButton = notification.querySelector('.close-notification');
                closeButton.addEventListener('click', () => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                });
                
                // Remover automaticamente após 5 segundos
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateY(-20px)';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }
                }, 5000);
            }
        };
        
        // Inicializar aplicação
        document.addEventListener('DOMContentLoaded', function() {
            APP.init();
        });
    </script>
</body>
</html>
