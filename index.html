<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG - Sistema de Gestão de Frota Safra 2025/26</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                    },
                }
            }
        }
    </script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #print-area, #print-area * {
                visibility: visible;
            }
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none !important;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .dark ::-webkit-scrollbar-track {
            background: #374151;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .dark ::-webkit-scrollbar-thumb {
            background: #4B5563;
        }
        
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #6B7280;
        }
        
        /* Table styling */
        .styled-table th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .loading-shimmer {
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.6) 50%, rgba(255,255,255,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        .dark .loading-shimmer {
            background: linear-gradient(90deg, rgba(55,65,81,0) 0%, rgba(55,65,81,0.6) 50%, rgba(55,65,81,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        /* Notification styling */
        .notification {
            transform: translateX(100%);
            animation: slide-in 0.5s forwards, fade-out 0.5s 4.5s forwards;
        }
        
        @keyframes slide-in {
            100% { transform: translateX(0); }
        }
        
        @keyframes fade-out {
            100% { opacity: 0; }
        }
        
        /* Active tab styling */
        .tab-btn.active {
            border-bottom: 2px solid #5D5CDE;
        }
        
        /* Card hover effects */
        .stat-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* Equipment status colors */
        .status-operational {
            color: #10B981;
        }
        
        .status-maintenance {
            color: #F59E0B;
        }
        
        .status-inoperational {
            color: #EF4444;
        }
        
        .status-other {
            color: #3B82F6;
        }
        
        /* Real equipment visualization */
        .equipment-card {
            position: relative;
            perspective: 1000px;
            transition: all 0.3s;
        }
        
        .equipment-card:hover {
            transform: translateY(-5px);
        }
        
        .equipment-card.operational {
            border-left: 4px solid #10B981;
        }
        
        .equipment-card.maintenance {
            border-left: 4px solid #F59E0B; 
        }
        
        .equipment-card.reform {
            border-left: 4px solid #EF4444;
        }
        
        .equipment-card.other {
            border-left: 4px solid #3B82F6;
        }
        
        /* Dashboard tabs display */
        .category-dashboard {
            display: none;
        }
        
        .category-dashboard.active {
            display: block;
        }

        /* PDF Report Area */
        #pdf-report-area {
            display: none;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            background-color: white;
            padding: 20px;
            z-index: 1000;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #pdf-report-area, #pdf-report-area * {
                visibility: visible;
            }
            #pdf-report-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .pdf-page-break {
                page-break-after: always;
            }
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-200">
    <div id="loading-overlay" class="fixed inset-0 bg-white dark:bg-gray-900 z-50 flex flex-col items-center justify-center">
        <div class="w-24 h-24 border-t-4 border-b-4 border-primary rounded-full animate-spin mb-4"></div>
        <h2 class="text-2xl font-semibold text-primary">Carregando Sistema...</h2>
        <p class="text-gray-600 dark:text-gray-400 mt-2">GGOMES-LOG SAFRA 2025/26</p>
    </div>

    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-md py-4 px-4 sticky top-0 z-10">
            <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-3 md:mb-0">
                    <h1 class="text-2xl font-bold text-primary dark:text-primary">UsinaCambui SAFRA 2025/26</h1>
                </div>
                <div class="flex flex-wrap items-center gap-2">
                    <button id="add-equipment-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 bg-green-500 text-white" title="Adicionar equipamento">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button id="refresh-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary" title="Atualizar dados">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <div class="relative">
                        <button id="export-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary" title="Exportar dados">
                            <i class="fas fa-file-export"></i>
                        </button>
                        <div id="export-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-20">
                            <button id="export-csv" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-file-csv mr-2"></i> Exportar CSV
                            </button>
                            <button id="export-print" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-print mr-2"></i> Imprimir
                            </button>
                            <button id="export-pdf" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-file-pdf mr-2"></i> Relatório PDF
                            </button>
                        </div>
                    </div>
                    <button id="dashboard-main-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary flex items-center" title="Dashboard geral">
                        <i class="fas fa-chart-line mr-1"></i>
                        <span class="hidden sm:inline">Dashboard Geral</span>
                    </button>
                    <button id="real-equipment-btn" class="p-2 rounded-md bg-primary text-white hover:bg-primary hover:bg-opacity-90 flex items-center" title="Visualização real dos equipamentos">
                        <i class="fas fa-truck-monster mr-1"></i>
                        <span class="hidden sm:inline">Equipamentos Reais</span>
                    </button>
                    <span id="last-updated" class="text-gray-600 dark:text-gray-400 text-sm mr-2 hidden md:block"></span>
                    <button id="theme-toggle" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700" title="Alternar tema claro/escuro">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Breadcrumb Navigation -->
        <div class="bg-gray-100 dark:bg-gray-800 py-2 px-4 border-b border-gray-200 dark:border-gray-700">
            <div class="container mx-auto">
                <nav class="flex" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="#" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-primary dark:text-gray-400 dark:hover:text-white">
                                <i class="fas fa-home mr-2"></i>
                                Início
                            </a>
                        </li>
                        <li aria-current="page">
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-1"></i>
                                <span id="breadcrumb-current" class="ml-1 text-sm font-medium text-primary md:ml-2">Dashboard</span>
                            </div>
                        </li>
                    </ol>
                </nav>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-16 z-10">
            <div class="container mx-auto px-4">
                <div class="flex overflow-x-auto whitespace-nowrap py-3 scrollbar-hide" id="tabs">
                    <button class="tab-btn active px-4 py-2 font-medium rounded-md mr-2" data-target="reboques">
                        <i class="fas fa-trailer mr-1"></i>Reboques
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="caminhoes-proprios">
                        <i class="fas fa-truck mr-1"></i>Caminhões Próprios
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="caminhoes-terceiros">
                        <i class="fas fa-truck-moving mr-1"></i>Caminhões Terceiros
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="frente-4001">
                        <i class="fas fa-tractor mr-1"></i>Frente 4001
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md" data-target="frente-4002">
                        <i class="fas fa-tractor mr-1"></i>Frente 4002
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <!-- Dashboards for each category -->
            <!-- Dashboard for Reboques -->
            <div id="dashboard-reboques" class="category-dashboard active mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Reboques</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-red-100 dark:bg-red-800 p-3 mr-4">
                                <i class="fas fa-tools text-red-500 dark:text-red-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Reforma</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-reform">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-reform-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-exchange-alt text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-vs-last-month">
                                        <i class="fas fa-arrow-up text-green-500"></i> 4%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1">
                            <h3 class="text-md font-medium mb-3">Status dos Reboques</h3>
                            <div class="h-64">
                                <canvas id="reboques-status-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1 md:col-span-2">
                            <h3 class="text-md font-medium mb-3">Tendência de Manutenção</h3>
                            <div class="h-64">
                                <canvas id="reboques-maintenance-trend-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Caminhões Próprios -->
            <div id="dashboard-caminhoes-proprios" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Caminhões Próprios</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-exchange-alt text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Emprestados</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-borrowed">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-borrowed-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Prazo Médio</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-avg-time">0d</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-vs-last-month">
                                        <i class="fas fa-arrow-down text-green-500"></i> 1d
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1">
                            <h3 class="text-md font-medium mb-3">Status dos Caminhões</h3>
                            <div class="h-64">
                                <canvas id="cp-status-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1 md:col-span-2">
                            <h3 class="text-md font-medium mb-3">Evolução de Status</h3>
                            <div class="h-64">
                                <canvas id="cp-status-evolution-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Caminhões Terceiros -->
            <div id="dashboard-caminhoes-terceiros" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Caminhões Terceiros</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="ct-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="ct-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-user-tie text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Proprietários</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-owners">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-truck-loading text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Reboques Acoplados</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-coupled-trailers">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Proprietários - Quantidade</h3>
                            <div class="h-64">
                                <canvas id="ct-owners-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status por Proprietário</h3>
                            <div class="h-64">
                                <canvas id="ct-status-by-owner-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Frente 4001 -->
            <div id="dashboard-frente-4001" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard da Frente 4001</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Colhedoras OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-colhedoras-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-colhedoras-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Trações OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-tracoes-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-tracoes-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Equip. em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-vs-target">
                                        <i class="fas fa-arrow-up text-green-500"></i> 2%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status dos Equipamentos</h3>
                            <div class="h-64">
                                <canvas id="f4001-status-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Motivos de Parada</h3>
                            <div class="h-64">
                                <canvas id="f4001-breakdown-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Frente 4002 -->
            <div id="dashboard-frente-4002" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard da Frente 4002</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Colhedoras OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-colhedoras-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-colhedoras-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Trações OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-tracoes-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-tracoes-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Equip. em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-vs-target">
                                        <i class="fas fa-arrow-up text-green-500"></i> 5%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status dos Equipamentos</h3>
                            <div class="h-64">
                                <canvas id="f4002-status-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Motivos de Parada</h3>
                            <div class="h-64">
                                <canvas id="f4002-breakdown-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4">
                <h2 id="section-title" class="text-xl font-semibold">Reboques</h2>
                <div class="flex flex-col sm:flex-row gap-2">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Pesquisar..." 
                            class="w-full sm:w-64 px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                            bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                    <select id="status-filter" class="px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                        bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="all">Todos os Status</option>
                        <option value="Operacional">Operacional</option>
                        <option value="Em manutenção">Em manutenção</option>
                        <option value="Em reforma">Em reforma</option>
                        <option value="Inoperante">Inoperante</option>
                        <option value="Aguardando reforma">Aguardando reforma</option>
                        <option value="Emprestado">Emprestado</option>
                        <option value="Na base">Na base</option>
                        <option value="Reserva">Reserva</option>
                    </select>
                    <div class="relative">
                        <button id="advanced-filter-btn" class="px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                            bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                            <i class="fas fa-filter mr-1"></i> Filtros Avançados
                        </button>
                        <div id="advanced-filter-dropdown" class="hidden absolute right-0 mt-2 w-72 bg-white dark:bg-gray-800 rounded-md shadow-lg p-4 z-20">
                            <h4 class="font-medium text-gray-800 dark:text-gray-200 mb-2">Filtros Avançados</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                    <div class="flex space-x-2">
                                        <input type="date" id="date-filter-start" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                        <input type="date" id="date-filter-end" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Motivo Contém</label>
                                    <input type="text" id="motivo-filter" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                </div>
                                <div class="flex justify-end mt-4">
                                    <button id="apply-advanced-filters" class="px-3 py-1.5 text-sm bg-primary text-white rounded-md">Aplicar Filtros</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Content -->
            <div class="tab-content active" id="reboques">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="frota">
                                    FROTA <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="tipo">
                                    TIPO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="acoplado">
                                    ACOPLADO COM <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="tipoAcoplado">
                                    TIPO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="reboques-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="7" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="showing-start">0</span> - <span id="showing-end">0</span> de <span id="total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="caminhoes-proprios">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="caminhao">
                                    CAMINHÃO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                    DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="caminhoes-proprios-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="cp-showing-start">0</span> - <span id="cp-showing-end">0</span> de <span id="cp-total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="cp-prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="cp-pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="cp-next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="caminhoes-terceiros">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="caminhao">
                                    CAMINHÃO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="reboques">
                                    REBOQUES <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="proprietario">
                                    PROPRIETÁRIO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="caminhoes-terceiros-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="6" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="ct-showing-start">0</span> - <span id="ct-showing-end">0</span> de <span id="ct-total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="ct-prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="ct-pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="ct-next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="frente-4001">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6">
                    <h3 class="text-lg font-medium mb-4">Colhedoras</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4001-colhedoras-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                    <h3 class="text-lg font-medium mb-4">Trações Transbordo</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4001-tracoes-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="frente-4002">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6">
                    <h3 class="text-lg font-medium mb-4">Colhedoras</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4002-colhedoras-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                    <h3 class="text-lg font-medium mb-4">Trações Transbordo</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4002-tracoes-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Área de impressão -->
            <div id="print-area" class="hidden">
                <div class="px-6 py-4">
                    <h1 class="text-2xl font-bold mb-4">UsinaCambui SAFRA 2025/26 - Relatório</h1>
                    <div class="mb-4">
                        <h2 id="print-title" class="text-xl font-semibold"></h2>
                        <p id="print-date" class="text-sm text-gray-600"></p>
                    </div>
                    <div id="print-content"></div>
                </div>
            </div>

            <!-- Área de relatório em PDF -->
            <div id="pdf-report-area" class="hidden">
                <div class="px-6 py-4">
                    <h1 class="text-2xl font-bold mb-4">UsinaCambui SAFRA 2025/26 - Relatório Completo</h1>
                    <div class="mb-4">
                        <h2 id="pdf-report-title" class="text-xl font-semibold"></h2>
                        <p id="pdf-report-date" class="text-sm text-gray-600"></p>
                    </div>
                    <div id="pdf-report-content"></div>
                </div>
            </div>
        </main>

        <!-- Modal de detalhes do equipamento -->
        <div id="equipment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold" id="modal-title">Detalhes do Equipamento</h3>
                        <button id="close-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div id="modal-content" class="space-y-4">
                        <!-- Conteúdo do modal será preenchido dinamicamente -->
                    </div>
                    <div class="mt-6 flex justify-between">
                        <div>
                            <button id="history-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all mr-2">
                                <i class="fas fa-history mr-1"></i> Histórico
                            </button>
                            <button id="schedule-btn" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-all">
                                <i class="fas fa-calendar mr-1"></i> Agendar
                            </button>
                        </div>
                        <div class="flex space-x-2">
                            <button id="edit-equipment-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-all">
                                <i class="fas fa-edit mr-1"></i> Editar
                            </button>
                            <button id="print-details-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                <i class="fas fa-print mr-1"></i> Imprimir
                            </button>
                            <button id="close-modal-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 transition-all">
                                Fechar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de edição de equipamento -->
        <div id="edit-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold" id="edit-modal-title">Editar Equipamento</h3>
                        <button id="close-edit-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="edit-equipment-form" class="space-y-4">
                        <div id="edit-form-fields">
                            <!-- Campos do formulário serão preenchidos dinamicamente -->
                        </div>
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-edit-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-edit-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-save mr-1"></i> Salvar Alterações
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Modal para adicionar novo equipamento -->
        <div id="add-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Adicionar Novo Equipamento</h3>
                        <button id="close-add-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="add-equipment-form" class="space-y-4">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                            <select id="equipment-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <option value="reboque">Reboque</option>
                                <option value="caminhao-proprio">Caminhão Próprio</option>
                                <option value="caminhao-terceiro">Caminhão Terceiro</option>
                                <option value="colhedora-4001">Colhedora Frente 4001</option>
                                <option value="tracao-4001">Tração Frente 4001</option>
                                <option value="colhedora-4002">Colhedora Frente 4002</option>
                                <option value="tracao-4002">Tração Frente 4002</option>
                            </select>
                        </div>
                        <div id="add-form-fields" class="space-y-4">
                            <!-- Campos gerados dinamicamente com base no tipo de equipamento -->
                        </div>
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-add-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-add-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-plus mr-1"></i> Adicionar Equipamento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Modal de histórico -->
        <div id="history-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Histórico do Equipamento</h3>
                        <button id="close-history-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div id="history-content" class="mt-4">
                        <div class="flex items-center mb-4">
                            <div class="w-16 h-16 flex items-center justify-center rounded-full bg-primary text-white text-2xl mr-4">
                                <i id="history-icon" class="fas fa-truck"></i>
                            </div>
                            <div>
                                <h4 id="history-title" class="text-lg font-medium">Caminhão #0000</h4>
                                <p id="history-subtitle" class="text-sm text-gray-600 dark:text-gray-400">Total de registros: 0</p>
                            </div>
                        </div>
                        
                        <div class="relative pl-8 mt-8">
                            <div class="absolute left-0 top-0 bottom-0 w-0.5 bg-gray-300 dark:bg-gray-600"></div>
                            <div id="history-timeline">
                                <!-- Timeline items will be added here via JavaScript -->
                                <div class="flex flex-col items-start mb-6 ml-6 relative">
                                    <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-primary"></div>
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                        <div class="flex justify-between items-start">
                                            <p class="text-sm font-medium">Carregando histórico...</p>
                                            <span class="text-xs text-gray-500 dark:text-gray-400"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button id="close-history-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 transition-all">
                            Fechar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de agendamento -->
        <div id="schedule-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Agendar Manutenção</h3>
                        <button id="close-schedule-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="schedule-form" class="space-y-4">
                        <div id="schedule-equipment-info" class="bg-gray-100 dark:bg-gray-700 p-3 rounded-md mb-4">
                            <!-- Informações do equipamento -->
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                    Data Agendada
                                </label>
                                <input type="date" id="schedule-date" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required placeholder="Selecione uma data">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                    Hora
                                </label>
                                <input type="time" id="schedule-time" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Tipo de Manutenção
                            </label>
                            <select id="schedule-type" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="">Selecione o tipo</option>
                                <option value="preventive">Preventiva</option>
                                <option value="corrective">Corretiva</option>
                                <option value="emergency">Emergencial</option>
                                <option value="revision">Revisão</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Descrição/Motivo
                            </label>
                            <textarea id="schedule-description" rows="3" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Responsável
                            </label>
                            <input type="text" id="schedule-responsible" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                        </div>
                        
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-schedule-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-schedule-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-calendar-check mr-1"></i> Confirmar Agendamento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Dashboard detalhado modal -->
        <div id="dashboard-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Dashboard Detalhado de Frota</h3>
                        <button id="close-dashboard-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                        <div class="text-lg font-medium">Visão Geral da Frota</div>
                        <div class="mt-2 md:mt-0 flex items-center gap-2">
                            <select id="dashboard-date-range" class="px-3 py-1.5 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <option value="all">Todos os dados</option>
                                <option value="today">Hoje</option>
                                <option value="week">Últimos 7 dias</option>
                                <option value="month">Último mês</option>
                                <option value="quarter">Último trimestre</option>
                                <option value="year">Último ano</option>
                            </select>
                            <button id="print-dashboard-btn" class="px-3 py-1.5 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <i class="fas fa-print mr-1"></i> Imprimir
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-green-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Disponibilidade de Frota</p>
                                <p class="text-2xl font-bold" id="dash-availability">0%</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-availability-trend" class="text-green-500">
                                        <i class="fas fa-arrow-up mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-yellow-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Tempo Médio de Manutenção</p>
                                <p class="text-2xl font-bold" id="dash-avg-maintenance">0h</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-maintenance-trend" class="text-red-500">
                                        <i class="fas fa-arrow-up mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-blue-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Total de Equipamentos</p>
                                <p class="text-2xl font-bold" id="dash-total-equipment">0</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-equipment-trend" class="text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-minus mr-1"></i>0
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-red-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Equipamentos Críticos</p>
                                <p class="text-2xl font-bold" id="dash-critical-equipment">0</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-critical-trend" class="text-green-500">
                                        <i class="fas fa-arrow-down mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Disponibilidade por Categoria</h4>
                            <div class="h-64">
                                <canvas id="availability-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Motivos de Manutenção</h4>
                            <div class="h-64">
                                <canvas id="maintenance-reasons-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 mb-6">
                        <h4 class="text-md font-medium mb-3">Tendências de Status por Semana</h4>
                        <div class="h-64">
                            <canvas id="status-trends-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Top 5 Equipamentos em Manutenção</h4>
                            <ul id="top-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-600">
                                <!-- Lista preenchida via JavaScript -->
                                <li class="py-2 flex justify-between">
                                    <span class="text-sm loading-shimmer">Carregando dados...</span>
                                    <span class="text-sm text-yellow-500"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Propriedade dos Equipamentos</h4>
                            <div class="h-40">
                                <canvas id="ownership-chart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Manutenções Agendadas Próximas</h4>
                            <ul id="upcoming-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-600">
                                <!-- Lista preenchida via JavaScript -->
                                <li class="py-2 flex justify-between">
                                    <span class="text-sm loading-shimmer">Carregando dados...</span>
                                    <span class="text-sm text-blue-500"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de Visualização Real dos Equipamentos -->
        <div id="real-equipment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Visualização Real dos Equipamentos</h3>
                        <button id="close-real-equipment-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4 flex flex-wrap gap-2">
                        <button class="real-equipment-filter active px-3 py-1.5 rounded-md bg-primary text-white" data-filter="all">Todos</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="reboques">Reboques</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="caminhoes-proprios">Caminhões Próprios</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="caminhoes-terceiros">Caminhões Terceiros</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="frente-4001">Frente 4001</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="frente-4002">Frente 4002</button>
                    </div>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="real-equipment-grid">
                        <!-- Equipment cards will be added here via JavaScript -->
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Sistema de notificações -->
        <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

        <!-- Footer -->
        <footer class="bg-white dark:bg-gray-800 py-4 border-t border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 text-center">
                <p class="text-sm text-gray-600 dark:text-gray-400">
                    GGOMES-LOG SAFRA 2025/26 - Usina Cambuí Sistema de Gestão de Frota - v3.5
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Configurações
        const APP = {
            // Armazenamento dos dados
            data: {
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                currentSort: {
                    key: null,
                    order: 'asc'
                },
                filters: {
                    search: '',
                    status: 'all',
                    dateStart: '',
                    dateEnd: '',
                    motivo: ''
                },
                pagination: {
                    itemsPerPage: 10,
                    currentPage: 1
                },
                charts: {
                    // Gráficos gerais
                    statusChart: null,
                    categoryChart: null,
                    trendChart: null,
                    availabilityChart: null,
                    maintenanceReasonsChart: null,
                    statusTrendsChart: null,
                    ownershipChart: null,
                    
                    // Gráficos específicos por categoria
                    reboquesStatusChart: null,
                    reboquesMaintenanceTrendChart: null,
                    cpStatusChart: null,
                    cpStatusEvolutionChart: null,
                    ctOwnersChart: null,
                    ctStatusByOwnerChart: null,
                    f4001StatusChart: null,
                    f4001BreakdownChart: null,
                    f4002StatusChart: null,
                    f4002BreakdownChart: null
                },
                history: {
                    // Histórico simulado para alguns equipamentos
                    '6186': [
                        { date: '2025-04-10', status: 'Em manutenção', description: 'Entrada para manutenção preventiva', user: 'João Silva' },
                        { date: '2025-04-15', status: 'Em manutenção', description: 'Detectado problema na travessa do assoalho', user: 'Carlos Ferreira' },
                        { date: '2025-05-01', status: 'Em manutenção', description: 'Aguardando peças para reparo', user: 'Maria Oliveira' },
                        { date: '2025-05-05', status: 'Em manutenção', description: 'Troca da travessa do assoalho em andamento', user: 'Pedro Souza' }
                    ],
                    '6699': [
                        { date: '2025-04-28', status: 'Operacional', description: 'Problema no ar condicionado reportado', user: 'José Santos' },
                        { date: '2025-05-01', status: 'Em manutenção', description: 'Verificação do sistema de ar condicionado', user: 'Ricardo Lima' },
                        { date: '2025-05-02', status: 'Em manutenção', description: 'Substituição do compressor de ar', user: 'Ricardo Lima' }
                    ],
                    '6146': [
                        { date: '2025-02-15', status: 'Operacional', description: 'Verificação de irregularidades', user: 'André Moraes' },
                        { date: '2025-02-28', status: 'Em manutenção', description: 'Avaliação para reforma completa', user: 'Fernando Castro' },
                        { date: '2025-03-01', status: 'Em reforma', description: 'Início de reforma geral', user: 'Marcos Pereira' },
                        { date: '2025-03-15', status: 'Em reforma', description: 'Substituição de componentes principais', user: 'Antônio Rodrigues' },
                        { date: '2025-04-10', status: 'Em reforma', description: 'Reforma do sistema hidráulico', user: 'Lucas Mendes' },
                        { date: '2025-04-25', status: 'Em reforma', description: 'Testes preliminares', user: 'Marcos Pereira' }
                    ]
                },
                schedules: [
                    { equipment: '6181', equipmentType: 'Reboque', date: '2025-05-15', time: '08:00', type: 'preventive', description: 'Manutenção preventiva programada', responsible: 'Paulo Costa' },
                    { equipment: '6138', equipmentType: 'Caminhão Próprio', date: '2025-05-20', time: '14:30', type: 'revision', description: 'Revisão geral após operação', responsible: 'Carlos Magno' },
                    { equipment: '490998', equipmentType: 'Caminhão Terceiro', date: '2025-05-18', time: '09:00', type: 'corrective', description: 'Correção de problema no sistema de freios', responsible: 'Ricardo Almeida' },
                    { equipment: '6988', equipmentType: 'Colhedora Frente 4001', date: '2025-05-25', time: '07:00', type: 'preventive', description: 'Lubrificação e verificação geral', responsible: 'Fernando Dias' }
                ],
                dashboardPeriod: 'all',
                editingItem: null,
                editingType: null,
                activeTab: 'reboques',
                isDragging: false,
                dashboardContentVisible: {} // Para controlar visibilidade dos dashboards
            },
            
            // Inicialização
            init() {
                // Aplicar tema
                this.setupTheme();
                
                // Exibir splash screen
                this.showSplashScreen();
                
                // Carregar dados
                this.loadData();
                
                // Configurar eventos da UI
                this.setupEventListeners();
                
                // Atualizar horário
                this.updateLastUpdated();
                
                // Inicializar estados dos dashboards (mostrar por padrão)
                this.setupDashboardVisibility();
            },
            
            // Configurar visibilidade inicial dos dashboards
            setupDashboardVisibility() {
                document.querySelectorAll('.category-dashboard').forEach(dashboard => {
                    const id = dashboard.id;
                    // Inicialmente mostrar dashboards
                    this.data.dashboardContentVisible[id] = true;
                    
                    // Encontrar botões de toggle
                    const toggleBtn = dashboard.querySelector('.toggle-dashboard');
                    if (toggleBtn) {
                        toggleBtn.querySelector('.show-text').classList.add('hidden');
                        toggleBtn.querySelector('.hide-text').classList.remove('hidden');
                    }
                    
                    // Mostrar conteúdo
                    const content = dashboard.querySelector('.dashboard-content');
                    if (content) {
                        content.style.display = 'block';
                    }
                });
            },
            
            // Exibir splash screen
            showSplashScreen() {
                const loadingOverlay = document.getElementById('loading-overlay');
                
                // Ocultar a splash screen após 1.5 segundos
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    loadingOverlay.style.transition = 'opacity 0.5s';
                    
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                }, 1500);
            },
            
            // Configurar tema
            setupTheme() {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    if (event.matches) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                    // Atualizar gráficos para o novo tema
                    this.updateAllCharts();
                });
                
                document.getElementById('theme-toggle').addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    // Atualizar gráficos para o novo tema
                    this.updateAllCharts();
                });
            },
            
            // Carregar dados
            loadData() {
                // Simulação de carregamento para demonstrar loading state
                setTimeout(() => {
                    this.data.reboques = [
                        { frota: '4373', tipo: 'SEMI REBOQUE', acoplado: '6239', tipoAcoplado: 'REBOQUE', motivo: 'Problema na sapata', status: 'Em manutenção', dataParada: '2025-05-02' },
                        { frota: '6181', tipo: 'SEMI REBOQUE', acoplado: '6222', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6184', tipo: 'SEMI REBOQUE', acoplado: '6190', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6185', tipo: 'SEMI REBOQUE', acoplado: '6188', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6186', tipo: 'SEMI REBOQUE', acoplado: '6201', tipoAcoplado: 'REBOQUE', motivo: 'Trocar travessa assoalho', status: 'Em manutenção', dataParada: '2025-04-10' },
                        { frota: '6187', tipo: 'SEMI REBOQUE', acoplado: '6224', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6195', tipo: 'SEMI REBOQUE', acoplado: '6214', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6196', tipo: 'SEMI REBOQUE', acoplado: '9542', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6197', tipo: 'SEMI REBOQUE', acoplado: '6183', tipoAcoplado: 'REBOQUE', motivo: 'preventiva', status: 'Em manutenção', dataParada: '2025-04-28' },
                        { frota: '6198', tipo: 'SEMI REBOQUE', acoplado: '6193', tipoAcoplado: 'REBOQUE', motivo: 'Preventiva', status: 'Em manutenção', dataParada: '2025-04-30' },
                        { frota: '6199', tipo: 'SEMI REBOQUE', acoplado: '9546', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6202', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: '', motivo: 'Travessa da mesa da quinta roda quebrada', status: 'Em manutenção', dataParada: '2025-04-15' },
                        { frota: '6218', tipo: 'SEMI REBOQUE', acoplado: '4377', tipoAcoplado: 'REBOQUE', motivo: 'Revisar cubo de roda e regular freios (Travessa quebrada)', status: 'Em manutenção', dataParada: '2025-04-18' },
                        { frota: '6221', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: '', motivo: 'Reforma', status: 'Em reforma', dataParada: '2025-03-15' },
                        { frota: '6241', tipo: 'SEMI REBOQUE', acoplado: '6209', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '9492', tipo: 'SEMI REBOQUE', acoplado: '6210', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '9501', tipo: 'SEMI REBOQUE', acoplado: '6225', tipoAcoplado: 'REBOQUE', motivo: 'Mola arriada e regular freios', status: 'Em manutenção', dataParada: '2025-04-25' },
                        { frota: '6194', tipo: 'SEMI REBOQUE', acoplado: '6242', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '', tipo: '', acoplado: '6182', tipoAcoplado: 'REBOQUE', motivo: 'Aguardando Reforma', status: 'Aguardando reforma', dataParada: '2025-03-10' },
                        { frota: '', tipo: '', acoplado: '6191', tipoAcoplado: 'REBOQUE', motivo: 'Reforma', status: 'Em reforma', dataParada: '2025-02-25' },
                        { frota: '4631', tipo: 'SEMI REBOQUE', acoplado: '6401', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '4632', tipo: 'SEMI REBOQUE', acoplado: '6434', tipoAcoplado: 'REBOQUE', motivo: 'serviço de solda', status: 'Em manutenção', dataParada: '2025-04-29' },
                        { frota: '4648', tipo: 'SEMI REBOQUE', acoplado: '6426', tipoAcoplado: 'REBOQUE', motivo: 'Problema na sapata', status: 'Em manutenção', dataParada: '2025-05-03' },
                        { frota: '4653', tipo: 'SEMI REBOQUE', acoplado: '4619', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6388', tipo: 'SEMI REBOQUE', acoplado: '6397', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6390', tipo: 'SEMI REBOQUE', acoplado: '6430', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                    ];

                    this.data.caminhoesProps = [
                        { caminhao: '4786', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6138', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6679', motivo: 'Aguardando Peça (Parafusos do Câmbio)', data: '2025-05-01', status: 'Em manutenção' },
                        { caminhao: '6680', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6682', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6697', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6698', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6699', motivo: 'ar condicionado', data: '2025-05-02', status: 'Em manutenção' },
                        { caminhao: '6700', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6960', motivo: 'Emprestimo Vinhaça', data: '2025-04-20', status: 'Emprestado' },
                        { caminhao: '6961', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6962', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6963', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6964', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6965', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '4787', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6134', motivo: 'Emprestimo transporte de veneno', data: '2025-04-15', status: 'Emprestado' },
                        { caminhao: '6143', motivo: 'Escada e suporte eletrico da sapata', data: '2025-05-03', status: 'Em manutenção' },
                        { caminhao: '6416', motivo: 'apoio prancha', data: '2025-04-10', status: 'Emprestado' },
                        { caminhao: '6137', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6145', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6146', motivo: 'Reforma', data: '2025-03-01', status: 'Em reforma' },
                    ];

                    this.data.caminhoesTerc = [
                        { caminhao: '490996', reboques: '491005-491002', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490997', reboques: '491008-491003-491009', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490998', reboques: '491004-491001-491006', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490999', reboques: '491007-491000', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490988', reboques: '', proprietario: 'RICARDO VICTOR', motivo: 'ok', status: 'Operacional' },
                        { caminhao: '490989', reboques: '4900990 - 490994', proprietario: 'RICARDO VICTOR', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490987', reboques: '', proprietario: 'RICARDO VICTOR', motivo: 'Problema no diferencial', status: 'Em manutenção' },
                        { caminhao: '491035', reboques: '491042-491040', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491036', reboques: '491041-491039', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491037', reboques: '491043-491038', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491011', reboques: '491013 - 491015', proprietario: 'EDSON FERNANDES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491012', reboques: '491016 - 491014', proprietario: 'EDSON FERNANDES', motivo: '', status: 'Operacional' },
                        { caminhao: '491020', reboques: '', proprietario: 'J D DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491025', reboques: '491031 - 491032', proprietario: 'G M GONÇALVES', motivo: 'eixo quebrado', status: 'Em manutenção' },
                        { caminhao: '491026', reboques: '491029 - 491030', proprietario: 'G M GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491046', reboques: '491047-491048', proprietario: 'HDS TRANSPORTES', motivo: '', status: 'Operacional' },
                        { caminhao: '490948', reboques: '490958-490959-490960', proprietario: 'EDUARDO GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '50022', reboques: '490933-490934', proprietario: 'SILVA GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490272', reboques: '50025-50027', proprietario: 'SILVA GONÇALVES', motivo: 'VAZAMENTO DO RETENTOR DO CUBO E MOLAS', status: 'Em manutenção' },
                        { caminhao: '390085', reboques: '390231-390241', proprietario: 'VC Transporte', motivo: 'Não esta engatando', status: 'Em manutenção' },
                        { caminhao: '390119', reboques: '39772-39775', proprietario: 'VC Transporte', motivo: 'Quebrou ponta de eixo', status: 'Em manutenção' },
                        { caminhao: '491057', reboques: '', proprietario: 'TT Transporte', motivo: 'ok', status: 'Operacional' },
                    ];

                    this.data.frente4001Colhedoras = [
                        { codigo: '6988', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6989', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6721', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6602', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6702', motivo: 'falta operador', data: '2025-05-05', status: 'Inoperante' },
                    ];

                    this.data.frente4001Tracoes = [
                        { codigo: '6966-6726', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6967-70032', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6968-8164', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6969-6516', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6611-562/5427', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6612', motivo: 'Agregados motor, radiador, acoplar', data: '2025-04-22', status: 'Em manutenção' },
                        { codigo: '6525-6517', motivo: 'Revisão preventiva', data: '2025-05-01', status: 'Em manutenção' },
                        { codigo: '6526-3294/8058', motivo: 'avaliação no cambio', data: '2025-04-25', status: 'Em manutenção' },
                        { codigo: '6528-6515', motivo: '', data: '', status: 'Operacional' },
                    ];

                    this.data.frente4002Colhedoras = [
                        { codigo: '6990', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6722', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6703', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6704', motivo: 'Base', data: '2025-05-01', status: 'Na base' },
                        { codigo: '5911', motivo: 'reserva', data: '', status: 'Reserva' },
                    ];

                    this.data.frente4002Tracoes = [
                        { codigo: '6615-3293/8057', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6616-6512', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6617', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6459-6678', motivo: 'Quebrou cardan da tração', data: '2025-05-03', status: 'Em manutenção' },
                        { codigo: '6527-5414/3135', motivo: 'finalizado serviço pra depois seguir pro campo.', data: '2025-04-22', status: 'Em manutenção' },
                        { codigo: '6522-6514', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6668', motivo: 'diferencial (na base)', data: '2025-04-10', status: 'Em manutenção' },
                        { codigo: '6669-6513', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6670', motivo: '', data: '', status: 'Operacional' },
                    ];

                    // Renderizar as tabelas
                    this.renderAllTables();
                    
                    // Atualizar paginação
                    this.updatePagination();
                    
                    // Iniciar os gráficos
                    this.initializeCharts();
                    
                    // Atualizar contadores para todos os dashboards
                    this.updateAllDashboards();
                    
                    // Atualizar informações do dashboard detalhado
                    this.updateDashboardDetails();
                    
                    // Inicializar visualização real dos equipamentos
                    this.initializeRealEquipmentView();

                    // Mostrar mensagem de boas-vindas
                    this.showNotification('success', 'Sistema carregado', 'Bem-vindo ao Sistema de Gestão de Frota da GGOMES-LOG  SAFRA 2025/26!');
                }, 800);
            },
            
            // Configurar event listeners
            setupEventListeners() {
                // Abas de navegação
                document.querySelectorAll('.tab-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        // Atualizar botão ativo
                        document.querySelectorAll('.tab-btn').forEach(btn => {
                            btn.classList.remove('active', 'bg-primary', 'text-white');
                        });
                        button.classList.add('active', 'bg-primary', 'text-white');
                        
                        // Atualizar conteúdo visível
                        const targetId = button.getAttribute('data-target');
                        document.querySelectorAll('.tab-content').forEach(content => {
                            content.classList.add('hidden');
                            content.classList.remove('active');
                        });
                        document.getElementById(targetId).classList.remove('hidden');
                        document.getElementById(targetId).classList.add('active');
                        
                        // Atualizar dashboards visíveis
                        document.querySelectorAll('.category-dashboard').forEach(dashboard => {
                            dashboard.classList.add('hidden');
                            dashboard.classList.remove('active');
                        });
                        document.getElementById(`dashboard-${targetId}`).classList.remove('hidden');
                        document.getElementById(`dashboard-${targetId}`).classList.add('active');
                        
                        // Atualizar título da seção
                        const title = button.textContent.trim();
                        document.getElementById('section-title').textContent = title;
                        document.getElementById('breadcrumb-current').textContent = title;
                        
                        // Atualizar abas ativas
                        this.data.activeTab = targetId;
                        
                        // Limpar a busca ao mudar de aba
                        document.getElementById('search-input').value = '';
                        document.getElementById('status-filter').value = 'all';
                        this.data.filters.search = '';
                        this.data.filters.status = 'all';
                        this.data.filters.motivo = '';
                        this.data.filters.dateStart = '';
                        this.data.filters.dateEnd = '';
                        
                        // Resetar paginação
                        this.data.pagination.currentPage = 1;
                        
                        // Re-renderizar tabela ativa
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                });
                
                // Botões de toggle do dashboard
                document.querySelectorAll('.toggle-dashboard').forEach(button => {
                    button.addEventListener('click', () => {
                        const dashboard = button.closest('.category-dashboard');
                        const id = dashboard.id;
                        const content = dashboard.querySelector('.dashboard-content');
                        const showText = button.querySelector('.show-text');
                        const hideText = button.querySelector('.hide-text');
                        
                        if (this.data.dashboardContentVisible[id]) {
                            // Ocultar dashboard
                            content.style.display = 'none';
                            showText.classList.remove('hidden');
                            hideText.classList.add('hidden');
                            this.data.dashboardContentVisible[id] = false;
                        } else {
                            // Mostrar dashboard
                            content.style.display = 'block';
                            showText.classList.add('hidden');
                            hideText.classList.remove('hidden');
                            this.data.dashboardContentVisible[id] = true;
                            
                            // Atualizar gráficos se necessário
                            this.updateAllCharts();
                        }
                    });
                });
                
                // Pesquisa
                document.getElementById('search-input').addEventListener('input', (e) => {
                    this.data.filters.search = e.target.value.toLowerCase();
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                });
                
                // Filtro de status
                document.getElementById('status-filter').addEventListener('change', (e) => {
                    this.data.filters.status = e.target.value;
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                });
                
                // Botão de filtros avançados
                document.getElementById('advanced-filter-btn').addEventListener('click', () => {
                    const dropdown = document.getElementById('advanced-filter-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Aplicar filtros avançados
                document.getElementById('apply-advanced-filters').addEventListener('click', () => {
                    const dateStart = document.getElementById('date-filter-start').value;
                    const dateEnd = document.getElementById('date-filter-end').value;
                    const motivo = document.getElementById('motivo-filter').value.toLowerCase();
                    
                    this.data.filters.dateStart = dateStart;
                    this.data.filters.dateEnd = dateEnd;
                    this.data.filters.motivo = motivo;
                    
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                    
                    // Esconder o dropdown
                    document.getElementById('advanced-filter-dropdown').classList.add('hidden');
                    
                    // Mostrar notificação
                    if (dateStart || dateEnd || motivo) {
                        this.showNotification('info', 'Filtros aplicados', 'Os filtros avançados foram aplicados aos dados.');
                    } else {
                        this.showNotification('info', 'Filtros limpos', 'Os filtros avançados foram limpos.');
                    }
                });
                
                // Ordenação de tabelas
                document.querySelectorAll('.sortable').forEach(header => {
                    header.addEventListener('click', () => {
                        const key = header.getAttribute('data-key');
                        
                        // Alternar ordem se clicar na mesma coluna
                        if (this.data.currentSort.key === key) {
                            this.data.currentSort.order = this.data.currentSort.order === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.data.currentSort.key = key;
                            this.data.currentSort.order = 'asc';
                        }
                        
                        // Atualizar ícones de ordenação
                        document.querySelectorAll('.sortable i').forEach(icon => {
                            icon.className = 'fas fa-sort ml-1';
                        });
                        
                        const sortIcon = header.querySelector('i');
                        if (this.data.currentSort.order === 'asc') {
                            sortIcon.className = 'fas fa-sort-up ml-1';
                        } else {
                            sortIcon.className = 'fas fa-sort-down ml-1';
                        }
                        
                        // Re-renderizar tabela com a nova ordenação
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                });
                
                // Paginação
                document.getElementById('prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderActiveTable();
                        this.updatePagination();
                    }
                });
                
                document.getElementById('next-page').addEventListener('click', () => {
                    const activeTab = document.querySelector('.tab-content.active');
                    const id = activeTab.id;
                    let totalPages = 1;
                    
                    // Calcular total de páginas com base nos dados filtrados
                    const filteredData = this.getFilteredDataForActiveTab();
                    totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderActiveTable();
                        this.updatePagination();
                    }
                });
                
                // Paginação para caminhões próprios
                document.getElementById('cp-prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    }
                });
                
                document.getElementById('cp-next-page').addEventListener('click', () => {
                    const filteredData = this.filterData(this.data.caminhoesProps);
                    const totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    }
                });
                
                // Paginação para caminhões terceiros
                document.getElementById('ct-prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    }
                });
                
                document.getElementById('ct-next-page').addEventListener('click', () => {
                    const filteredData = this.filterData(this.data.caminhoesTerc);
                    const totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    }
                });
                
                // Fechar modal de detalhes
                document.getElementById('close-modal').addEventListener('click', () => {
                    document.getElementById('equipment-modal').classList.add('hidden');
                });
                
                document.getElementById('close-modal-btn').addEventListener('click', () => {
                    document.getElementById('equipment-modal').classList.add('hidden');
                });
                
                // Imprimir detalhes
                document.getElementById('print-details-btn').addEventListener('click', () => {
                    this.printEquipmentDetails();
                });
                
                // Editar equipamento
                document.getElementById('edit-equipment-btn').addEventListener('click', () => {
                    this.showEditModal();
                });
                
                // Fechar modal de edição
                document.getElementById('close-edit-modal').addEventListener('click', () => {
                    document.getElementById('edit-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-edit-btn').addEventListener('click', () => {
                    document.getElementById('edit-modal').classList.add('hidden');
                });
                
                // Salvar alterações
                document.getElementById('edit-equipment-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveEquipmentChanges();
                });
                
                // Abrir modal de histórico
                document.getElementById('history-btn').addEventListener('click', () => {
                    this.showHistoryModal();
                });
                
                // Fechar modal de histórico
                document.getElementById('close-history-modal').addEventListener('click', () => {
                    document.getElementById('history-modal').classList.add('hidden');
                });
                
                document.getElementById('close-history-btn').addEventListener('click', () => {
                    document.getElementById('history-modal').classList.add('hidden');
                });
                
                // Abrir modal de agendamento
                document.getElementById('schedule-btn').addEventListener('click', () => {
                    this.showScheduleModal();
                });
                
                // Fechar modal de agendamento
                document.getElementById('close-schedule-modal').addEventListener('click', () => {
                    document.getElementById('schedule-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-schedule-btn').addEventListener('click', () => {
                    document.getElementById('schedule-modal').classList.add('hidden');
                });
                
                // Salvar agendamento
                document.getElementById('schedule-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveSchedule();
                });
                
                // Abrir modal de adição de equipamento
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                // Fechar modal de adição
                document.getElementById('close-add-modal').addEventListener('click', () => {
                    document.getElementById('add-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-add-btn').addEventListener('click', () => {
                    document.getElementById('add-modal').classList.add('hidden');
                });
                
                // Salvar novo equipamento
                document.getElementById('add-equipment-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveNewEquipment();
                });
                
                // Tipo de equipamento mudou (no modal de adicionar)
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Botão de atualizar
                document.getElementById('refresh-btn').addEventListener('click', () => {
                    // Mostrar loading state
                    this.showLoadingState();
                    
                    // Simular atualização
                    setTimeout(() => {
                        this.loadData();
                        this.updateLastUpdated();
                        this.updateAllDashboards();
                        this.updateDashboardDetails();
                        
                        // Adicionar classe de animação e remover depois
                        document.getElementById('refresh-btn').classList.add('animate-spin');
                        setTimeout(() => {
                            document.getElementById('refresh-btn').classList.remove('animate-spin');
                        }, 1000);
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Dados atualizados', 'Os dados foram atualizados com sucesso!');
                    }, 800);
                });
                
                // Dropdown de exportação
                document.getElementById('export-btn').addEventListener('click', () => {
                    const dropdown = document.getElementById('export-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Exportar para CSV
                document.getElementById('export-csv').addEventListener('click', () => {
                    this.exportToCSV();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Exportar para impressão
                document.getElementById('export-print').addEventListener('click', () => {
                    this.printActiveTable();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Exportar para PDF
                document.getElementById('export-pdf').addEventListener('click', () => {
                    this.generatePDFReport();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Dashboard detalhado
                document.getElementById('dashboard-main-btn').addEventListener('click', () => {
                    document.getElementById('dashboard-modal').classList.remove('hidden');
                    this.updateDashboardCharts();
                });
                
                // Fechar dashboard detalhado
                document.getElementById('close-dashboard-modal').addEventListener('click', () => {
                    document.getElementById('dashboard-modal').classList.add('hidden');
                });
                
                // Período do dashboard mudou
                document.getElementById('dashboard-date-range').addEventListener('change', () => {
                    this.updateDashboardCharts();
                });
                
                // Imprimir dashboard detalhado
                document.getElementById('print-dashboard-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                // Visualização real dos equipamentos
                document.getElementById('real-equipment-btn').addEventListener('click', () => {
                    document.getElementById('real-equipment-modal').classList.remove('hidden');
                    // Atualizar a visualização de equipamentos reais (caso já tenha sido filtrada antes)
                    this.filterRealEquipment('all');
                });
                
                // Fechar visualização real dos equipamentos
                document.getElementById('close-real-equipment-modal').addEventListener('click', () => {
                    document.getElementById('real-equipment-modal').classList.add('hidden');
                });
                
                // Filtros da visualização real dos equipamentos
                document.querySelectorAll('.real-equipment-filter').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.real-equipment-filter').forEach(btn => {
                            btn.classList.remove('active', 'bg-primary', 'text-white');
                            btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                        });
                        button.classList.add('active', 'bg-primary', 'text-white');
                        button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                        
                        const filter = button.getAttribute('data-filter');
                        this.filterRealEquipment(filter);
                    });
                });
                
                // Fechar notificações ao clicar
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('close-notification')) {
                        const notification = e.target.closest('.notification');
                        if (notification) {
                            notification.remove();
                        }
                    }
                });
                
                // Fechar dropdowns ao clicar fora
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#export-btn') && !e.target.closest('#export-dropdown')) {
                        document.getElementById('export-dropdown').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#advanced-filter-btn') && !e.target.closest('#advanced-filter-dropdown')) {
                        document.getElementById('advanced-filter-dropdown').classList.add('hidden');
                    }
                });
                
                // Teclas de atalho
                document.addEventListener('keydown', (e) => {
                    // Esc para fechar modais
                    if (e.key === 'Escape') {
                        document.getElementById('equipment-modal').classList.add('hidden');
                        document.getElementById('edit-modal').classList.add('hidden');
                        document.getElementById('add-modal').classList.add('hidden');
                        document.getElementById('history-modal').classList.add('hidden');
                        document.getElementById('schedule-modal').classList.add('hidden');
                        document.getElementById('dashboard-modal').classList.add('hidden');
                        document.getElementById('real-equipment-modal').classList.add('hidden');
                    }
                });
            },
            
            // Mostrar loading state em todas as tabelas
            showLoadingState() {
                const loadingHTML = `
                    <tr>
                        <td colspan="7" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                <p>Atualizando dados...</p>
                            </div>
                        </td>
                    </tr>
                `;
                
                document.getElementById('reboques-table').innerHTML = loadingHTML;
                document.getElementById('caminhoes-proprios-table').innerHTML = loadingHTML;
                document.getElementById('caminhoes-terceiros-table').innerHTML = loadingHTML;
                document.getElementById('frente-4001-colhedoras-table').innerHTML = loadingHTML;
                document.getElementById('frente-4001-tracoes-table').innerHTML = loadingHTML;
                document.getElementById('frente-4002-colhedoras-table').innerHTML = loadingHTML;
                document.getElementById('frente-4002-tracoes-table').innerHTML = loadingHTML;
            },
            
            // Atualizar horário de última atualização
            updateLastUpdated() {
                const now = new Date();
                const formattedDate = now.toLocaleDateString('pt-BR');
                const formattedTime = now.toLocaleTimeString('pt-BR');
                document.getElementById('last-updated').textContent = `Atualizado em: ${formattedDate} às ${formattedTime}`;
                document.getElementById('last-updated').classList.remove('hidden');
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCaminhoesPropriosTable();
                this.renderCaminhoesTerc();
                this.renderFrente4001Colhedoras();
                this.renderFrente4001Tracoes();
                this.renderFrente4002Colhedoras();
                this.renderFrente4002Tracoes();
            },
            
            // Renderizar apenas a tabela ativa
            renderActiveTable() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const id = activeTab.id;
                
                switch(id) {
                    case 'reboques':
                        this.renderReboquesTable();
                        break;
                    case 'caminhoes-proprios':
                        this.renderCaminhoesPropriosTable();
                        break;
                    case 'caminhoes-terceiros':
                        this.renderCaminhoesTerc();
                        break;
                    case 'frente-4001':
                        this.renderFrente4001Colhedoras();
                        this.renderFrente4001Tracoes();
                        break;
                    case 'frente-4002':
                        this.renderFrente4002Colhedoras();
                        this.renderFrente4002Tracoes();
                        break;
                }
            },
            
            // Obter os dados filtrados para a aba ativa
            getFilteredDataForActiveTab() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return [];
                
                const id = activeTab.id;
                
                switch(id) {
                    case 'reboques':
                        return this.filterData(this.data.reboques);
                    case 'caminhoes-proprios':
                        return this.filterData(this.data.caminhoesProps);
                    case 'caminhoes-terceiros':
                        return this.filterData(this.data.caminhoesTerc);
                    case 'frente-4001':
                        // Deveria retornar a tabela atualmente visível, mas por simplificação, retornaremos as colhedoras
                        return this.filterData(this.data.frente4001Colhedoras);
                    case 'frente-4002':
                        // Deveria retornar a tabela atualmente visível, mas por simplificação, retornaremos as colhedoras
                        return this.filterData(this.data.frente4002Colhedoras);
                    default:
                        return [];
                }
            },
            
            // Função para obter o status formatado com badge
            getStatusBadge(status) {
                let bgColor, textColor, icon;
                
                switch(status.toLowerCase()) {
                    case 'operacional':
                        bgColor = 'bg-green-100 dark:bg-green-900';
                        textColor = 'text-green-800 dark:text-green-200';
                        icon = 'fa-check';
                        break;
                    case 'em manutenção':
                    case 'aguardando reforma':
                        bgColor = 'bg-yellow-100 dark:bg-yellow-900';
                        textColor = 'text-yellow-800 dark:text-yellow-200';
                        icon = 'fa-wrench';
                        break;
                    case 'em reforma':
                    case 'inoperante':
                        bgColor = 'bg-red-100 dark:bg-red-900';
                        textColor = 'text-red-800 dark:text-red-200';
                        icon = 'fa-tools';
                        break;
                    case 'emprestado':
                    case 'na base':
                    case 'reserva':
                        bgColor = 'bg-blue-100 dark:bg-blue-900';
                        textColor = 'text-blue-800 dark:text-blue-200';
                        icon = 'fa-exchange-alt';
                        break;
                    default:
                        bgColor = 'bg-gray-100 dark:bg-gray-700';
                        textColor = 'text-gray-800 dark:text-gray-200';
                        icon = 'fa-info-circle';
                }
                
                return `<span class="px-2 py-1 text-xs font-medium rounded-full ${bgColor} ${textColor} flex items-center justify-center w-fit"><i class="fas ${icon} mr-1"></i> ${status}</span>`;
            },
            
            // Filtrar dados com base nos filtros ativos
            filterData(data) {
                const { search, status, dateStart, dateEnd, motivo } = this.data.filters;
                
                return data.filter(item => {
                    // Filtrar por status
                    if (status !== 'all' && item.status !== status) {
                        return false;
                    }
                    
                    // Filtrar por data de início
                    if (dateStart && item.data && new Date(item.data) < new Date(dateStart)) {
                        return false;
                    }
                    
                    // Filtrar por data de fim
                    if (dateEnd && item.data && new Date(item.data) > new Date(dateEnd)) {
                        return false;
                    }
                    
                    // Também verificar dataParada (para reboques)
                    if (dateStart && item.dataParada && new Date(item.dataParada) < new Date(dateStart)) {
                        return false;
                    }
                    
                    if (dateEnd && item.dataParada && new Date(item.dataParada) > new Date(dateEnd)) {
                        return false;
                    }
                    
                    // Filtrar por motivo
                    if (motivo && (!item.motivo || !item.motivo.toLowerCase().includes(motivo))) {
                        return false;
                    }
                    
                    // Filtrar por texto de pesquisa
                    if (search) {
                        return Object.values(item).some(value => 
                            value && value.toString().toLowerCase().includes(search)
                        );
                    }
                    
                    return true;
                });
            },
            
            // Ordenar dados
            sortData(data) {
                if (!this.data.currentSort.key) return data;
                
                return [...data].sort((a, b) => {
                    let valueA = a[this.data.currentSort.key] || '';
                    let valueB = b[this.data.currentSort.key] || '';
                    
                    // Converter para número se possível
                    if (!isNaN(valueA) && !isNaN(valueB)) {
                        valueA = Number(valueA);
                        valueB = Number(valueB);
                    } else {
                        valueA = valueA.toString().toLowerCase();
                        valueB = valueB.toString().toLowerCase();
                    }
                    
                    if (this.data.currentSort.order === 'asc') {
                        if (valueA < valueB) return -1;
                        if (valueA > valueB) return 1;
                        return 0;
                    } else {
                        if (valueA > valueB) return -1;
                        if (valueA < valueB) return 1;
                        return 0;
                    }
                });
            },
            
            // Paginar dados
            paginateData(data) {
                const { currentPage, itemsPerPage } = this.data.pagination;
                const startIndex = (currentPage - 1) * itemsPerPage;
                return data.slice(startIndex, startIndex + itemsPerPage);
            },
            
            // Atualizar paginação
            updatePagination() {
                const filteredData = this.getFilteredDataForActiveTab();
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('showing-end').textContent = end;
                document.getElementById('total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('prev-page').disabled = currentPage <= 1;
                document.getElementById('next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Atualizar paginação para caminhões próprios
            updateCPPagination() {
                const filteredData = this.filterData(this.data.caminhoesProps);
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('cp-showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('cp-showing-end').textContent = end;
                document.getElementById('cp-total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('cp-prev-page').disabled = currentPage <= 1;
                document.getElementById('cp-next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('cp-pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Atualizar paginação para caminhões terceiros
            updateCTPagination() {
                const filteredData = this.filterData(this.data.caminhoesTerc);
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('ct-showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('ct-showing-end').textContent = end;
                document.getElementById('ct-total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('ct-prev-page').disabled = currentPage <= 1;
                document.getElementById('ct-next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('ct-pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Renderizar tabelas específicas
            renderReboquesTable() {
                const filteredData = this.filterData(this.data.reboques);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('reboques-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.frota || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.tipo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.acoplado || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.tipoAcoplado || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Reboque', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Reboque';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Reboque';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderCaminhoesPropriosTable() {
                const filteredData = this.filterData(this.data.caminhoesProps);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('caminhoes-proprios-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.caminhao || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Caminhão Próprio', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Próprio';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Próprio';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderCaminhoesTerc() {
                const filteredData = this.filterData(this.data.caminhoesTerc);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('caminhoes-terceiros-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.caminhao || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.reboques || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.proprietario || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Caminhão Terceiro', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Terceiro';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Terceiro';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4001Colhedoras() {
                const filteredData = this.filterData(this.data.frente4001Colhedoras);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4001-colhedoras-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Colhedora Frente 4001', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4001';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4001';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4001Tracoes() {
                const filteredData = this.filterData(this.data.frente4001Tracoes);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4001-tracoes-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Tração Frente 4001', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4001';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4001';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4002Colhedoras() {
                const filteredData = this.filterData(this.data.frente4002Colhedoras);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4002-colhedoras-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Colhedora Frente 4002', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4002';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4002';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4002Tracoes() {
                const filteredData = this.filterData(this.data.frente4002Tracoes);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4002-tracoes-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Tração Frente 4002', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4002';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4002';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            // Mostrar detalhes do equipamento
            showEquipmentDetails(type, item) {
                const modal = document.getElementById('equipment-modal');
                const title = document.getElementById('modal-title');
                const content = document.getElementById('modal-content');
                
                title.textContent = `Detalhes do ${type}`;
                
                // Salvar o item atual para edição posterior
                this.data.editingItem = item;
                this.data.editingType = type;
                
                // Criar HTML do conteúdo com base no tipo
                let contentHTML = '';
                
                if (type === 'Reboque') {
                    let formattedDate = '-';
                    if (item.dataParada) {
                        const date = new Date(item.dataParada);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Frota:</span>
                                <p class="font-semibold">${item.frota || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Tipo:</span>
                                <p class="font-semibold">${item.tipo || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Acoplado com:</span>
                                <p class="font-semibold">${item.acoplado || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Tipo Acoplado:</span>
                                <p class="font-semibold">${item.tipoAcoplado || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Equipamento do tipo Semi Reboque, utilizado para transporte de cargas. Última manutenção preventiva realizada em ${formattedDate !== '-' ? formattedDate : '2025-04-01'}.
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva agendada: ${formattedDate !== '-' ? new Date(new Date(item.dataParada).setDate(new Date(item.dataParada).getDate() + 30)).toLocaleDateString('pt-BR') : '2025-06-01'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Próprio') {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Caminhão:</span>
                                <p class="font-semibold">${item.caminhao || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Proprietário:</span>
                                <p class="font-semibold">UsinaCambui</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Caminhão da frota própria da UsinaCambui, modelo VW Constellation 26.420. Utilizado para transporte de cana de açúcar. ${item.status === 'Em manutenção' ? 'Atualmente em manutenção, com previsão de 3 dias para retorno operacional.' : ''}
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva agendada: ${formattedDate !== '-' ? new Date(new Date(item.data).setDate(new Date(item.data).getDate() + 45)).toLocaleDateString('pt-BR') : '2025-06-15'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Terceiro') {
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Caminhão:</span>
                                <p class="font-semibold">${item.caminhao || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Proprietário:</span>
                                <p class="font-semibold">${item.proprietario || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Contrato:</span>
                                <p class="font-semibold">CONT-${item.caminhao}-${new Date().getFullYear()}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Reboques:</span>
                            <p class="font-semibold">${item.reboques || 'Nenhum reboque associado'}</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Caminhão de propriedade de terceiros, contratado para a safra 2025/26. Responsabilidade de manutenção: ${item.proprietario}.
                                </p>
                            </div>
                        </div>
                    `;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    const frenteNum = type.includes('4001') ? '4001' : '4002';
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Código:</span>
                                <p class="font-semibold">${item.codigo || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Frente:</span>
                                <p class="font-semibold">${frenteNum}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    ${type.includes('Colhedora') ? 'Colhedora' : 'Tração'} alocada na frente ${frenteNum}. ${item.status === 'Em manutenção' ? 'Previsão de retorno: ' + new Date(new Date().setDate(new Date().getDate() + 5)).toLocaleDateString('pt-BR') + '.' : ''}
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva: ${formattedDate !== '-' ? new Date(new Date(item.data).setDate(new Date(item.data).getDate() + 30)).toLocaleDateString('pt-BR') : '2025-06-10'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                // Adicionar histórico e manutenções agendadas
                const id = this.getEquipmentId(item, type);
                
                contentHTML += `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <h3 class="text-lg font-medium mb-2">Últimas Atividades</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md max-h-36 overflow-y-auto">
                                <ul class="divide-y divide-gray-200 dark:divide-gray-600">
                                    ${this.getRecentHistory(id)}
                                </ul>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium mb-2">Próximas Manutenções</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md max-h-36 overflow-y-auto">
                                <ul class="divide-y divide-gray-200 dark:divide-gray-600">
                                    ${this.getScheduledMaintenance(id)}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
                
                content.innerHTML = contentHTML;
                modal.classList.remove('hidden');
            },
            
            // Obter ID único do equipamento (para relacionar com histórico)
            getEquipmentId(item, type) {
                if (type === 'Reboque') {
                    return item.frota || item.acoplado;
                } else if (type === 'Caminhão Próprio') {
                    return item.caminhao;
                } else if (type === 'Caminhão Terceiro') {
                    return item.caminhao;
                } else {
                    return item.codigo;
                }
            },
            
            // Obter histórico recente
            getRecentHistory(id) {
                const history = this.data.history[id];
                
                if (!history || history.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhum registro de atividade encontrado.</span></li>`;
                }
                
                // Ordenar histórico por data (mais recente primeiro)
                const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Limitar a 3 itens mais recentes
                const recentHistory = sortedHistory.slice(0, 3);
                
                return recentHistory.map(entry => {
                    const date = new Date(entry.date).toLocaleDateString('pt-BR');
                    return `
                        <li class="py-2">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    ${this.getStatusIcon(entry.status)}
                                </div>
                                <div class="ml-2">
                                    <p class="text-sm font-medium">${entry.description}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${date} - ${entry.user}</p>
                                </div>
                            </div>
                        </li>
                    `;
                }).join('') || `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhum registro de atividade encontrado.</span></li>`;
            },
            
            // Obter manutenções agendadas
            getScheduledMaintenance(id) {
                // Filtrar agendamentos pelo ID do equipamento
                const schedules = this.data.schedules.filter(schedule => schedule.equipment === id);
                
                if (schedules.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span></li>`;
                }
                
                // Ordenar agendamentos por data
                const sortedSchedules = [...schedules].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Mostrar apenas futuros agendamentos
                const now = new Date();
                const futureSchedules = sortedSchedules.filter(schedule => new Date(`${schedule.date}T${schedule.time}`) > now);
                
                if (futureSchedules.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span></li>`;
                }
                
                return futureSchedules.map(schedule => {
                    const date = new Date(`${schedule.date}T${schedule.time}`).toLocaleString('pt-BR');
                    const typeIcon = this.getMaintenanceTypeIcon(schedule.type);
                    
                    return `
                        <li class="py-2">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    ${typeIcon}
                                </div>
                                <div class="ml-2">
                                    <p class="text-sm font-medium">${this.getMaintenanceTypeName(schedule.type)}</p>
                                    <p class="text-xs">${schedule.description}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${date} - ${schedule.responsible}</p>
                                </div>
                            </div>
                        </li>
                    `;
                }).join('');
            },
            
            // Obter ícone de status
            getStatusIcon(status) {
                let icon, color;
                
                switch(status.toLowerCase()) {
                    case 'operacional':
                        icon = 'fa-check-circle';
                        color = 'text-green-500';
                        break;
                    case 'em manutenção':
                    case 'aguardando reforma':
                        icon = 'fa-wrench';
                        color = 'text-yellow-500';
                        break;
                    case 'em reforma':
                    case 'inoperante':
                        icon = 'fa-tools';
                        color = 'text-red-500';
                        break;
                    default:
                        icon = 'fa-info-circle';
                        color = 'text-blue-500';
                }
                
                return `<i class="fas ${icon} ${color}"></i>`;
            },
            
            // Obter ícone de tipo de manutenção
            getMaintenanceTypeIcon(type) {
                let icon, color;
                
                switch(type) {
                    case 'preventive':
                        icon = 'fa-shield-alt';
                        color = 'text-green-500';
                        break;
                    case 'corrective':
                        icon = 'fa-tools';
                        color = 'text-yellow-500';
                        break;
                    case 'emergency':
                        icon = 'fa-exclamation-triangle';
                        color = 'text-red-500';
                        break;
                    case 'revision':
                        icon = 'fa-search';
                        color = 'text-blue-500';
                        break;
                    default:
                        icon = 'fa-calendar-check';
                        color = 'text-gray-500';
                }
                
                return `<i class="fas ${icon} ${color}"></i>`;
            },
            
            // Obter nome do tipo de manutenção
            getMaintenanceTypeName(type) {
                switch(type) {
                    case 'preventive':
                        return 'Manutenção Preventiva';
                    case 'corrective':
                        return 'Manutenção Corretiva';
                    case 'emergency':
                        return 'Manutenção Emergencial';
                    case 'revision':
                        return 'Revisão Geral';
                    default:
                        return 'Agendamento';
                }
            },
            
            // Mostrar modal de edição
            showEditModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('edit-modal');
                const title = document.getElementById('edit-modal-title');
                const formFields = document.getElementById('edit-form-fields');
                
                title.textContent = `Editar ${this.data.editingType}`;
                
                // Gerar campos do formulário com base no tipo
                let fieldsHTML = '';
                
                if (this.data.editingType === 'Reboque') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota</label>
                                <input type="text" id="edit-frota" value="${this.data.editingItem.frota || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <input type="text" id="edit-tipo" value="${this.data.editingItem.tipo || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="edit-acoplado" value="${this.data.editingItem.acoplado || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="edit-tipoAcoplado" value="${this.data.editingItem.tipoAcoplado || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-dataParada" value="${this.data.editingItem.dataParada || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" value="${this.data.editingItem.caminhao || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-data" value="${this.data.editingItem.data || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" value="${this.data.editingItem.caminhao || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="edit-proprietario" value="${this.data.editingItem.proprietario || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="edit-reboques" value="${this.data.editingItem.reboques || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType.includes('Colhedora') || this.data.editingType.includes('Tração')) {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" value="${this.data.editingItem.codigo || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-data" value="${this.data.editingItem.data || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                }
                
                // Adicionar campo para registrar a alteração no histórico
                fieldsHTML += `
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-md">
                        <div class="flex items-center text-blue-800 dark:text-blue-200 mb-2">
                            <i class="fas fa-info-circle mr-2"></i>
                            <h4 class="font-medium">Registrar Alteração</h4>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrição da Alteração</label>
                            <textarea id="edit-history-desc" rows="2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva brevemente a alteração realizada..."></textarea>
                        </div>
                        <div class="mt-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                            <input type="text" id="edit-history-user" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Nome do responsável">
                        </div>
                    </div>
                `;
                
                formFields.innerHTML = fieldsHTML;
                modal.classList.remove('hidden');
            },
            
            // Salvar alterações do equipamento
            saveEquipmentChanges() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                // Obter valores do formulário
                let updatedItem = { ...this.data.editingItem };
                const oldStatus = updatedItem.status;
                
                if (this.data.editingType === 'Reboque') {
                    updatedItem.frota = document.getElementById('edit-frota').value;
                    updatedItem.tipo = document.getElementById('edit-tipo').value;
                    updatedItem.acoplado = document.getElementById('edit-acoplado').value;
                    updatedItem.tipoAcoplado = document.getElementById('edit-tipoAcoplado').value;
                    updatedItem.dataParada = document.getElementById('edit-dataParada').value;
                    updatedItem.status = document.getElementById('edit-status').value;
                    updatedItem.motivo = document.getElementById('edit-motivo').value;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    updatedItem.caminhao = document.getElementById('edit-caminhao').value;
                    updatedItem.data = document.getElementById('edit-data').value;
                    updatedItem.status = document.getElementById('edit-status').value;
                    updatedItem.motivo = document.getElementById('edit-motivo').value;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    updatedItem.caminhao = document.getElementById('edit-caminhao').value;
                    updatedItem.proprietario = document.getElementById('edit-proprietario').value;
                    updatedItem.reboques = document.getElementById('edit-reboques').value;
                    updatedItem.status = document.getElementById('edit-status').value;
                    updatedItem.motivo = document.getElementById('edit-motivo').value;
                } else if (this.data.editingType.includes('Colhedora') || this.data.editingType.includes('Tração')) {
                    updatedItem.codigo = document.getElementById('edit-codigo').value;
                    updatedItem.data = document.getElementById('edit-data').value;
                    updatedItem.status = document.getElementById('edit-status').value;
                    updatedItem.motivo = document.getElementById('edit-motivo').value;
                }
                
                // Atualizar o item no array apropriado
                if (this.data.editingType === 'Reboque') {
                    const index = this.data.reboques.findIndex(item => 
                        item.frota === this.data.editingItem.frota || 
                        (item.acoplado === this.data.editingItem.acoplado && !this.data.editingItem.frota)
                    );
                    if (index !== -1) {
                        this.data.reboques[index] = updatedItem;
                    }
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    const index = this.data.caminhoesProps.findIndex(item => 
                        item.caminhao === this.data.editingItem.caminhao
                    );
                    if (index !== -1) {
                        this.data.caminhoesProps[index] = updatedItem;
                    }
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    const index = this.data.caminhoesTerc.findIndex(item => 
                        item.caminhao === this.data.editingItem.caminhao
                    );
                    if (index !== -1) {
                        this.data.caminhoesTerc[index] = updatedItem;
                    }
                } else if (this.data.editingType.includes('Colhedora Frente 4001')) {
                    const index = this.data.frente4001Colhedoras.findIndex(item => 
                        item.codigo === this.data.editingItem.codigo
                    );
                    if (index !== -1) {
                        this.data.frente4001Colhedoras[index] = updatedItem;
                    }
                } else if (this.data.editingType.includes('Tração Frente 4001')) {
                    const index = this.data.frente4001Tracoes.findIndex(item => 
                        item.codigo === this.data.editingItem.codigo
                    );
                    if (index !== -1) {
                        this.data.frente4001Tracoes[index] = updatedItem;
                    }
                } else if (this.data.editingType.includes('Colhedora Frente 4002')) {
                    const index = this.data.frente4002Colhedoras.findIndex(item => 
                        item.codigo === this.data.editingItem.codigo
                    );
                    if (index !== -1) {
                        this.data.frente4002Colhedoras[index] = updatedItem;
                    }
                } else if (this.data.editingType.includes('Tração Frente 4002')) {
                    const index = this.data.frente4002Tracoes.findIndex(item => 
                        item.codigo === this.data.editingItem.codigo
                    );
                    if (index !== -1) {
                        this.data.frente4002Tracoes[index] = updatedItem;
                    }
                }
                
                // Adicionar ao histórico
                const historyDesc = document.getElementById('edit-history-desc').value;
                const historyUser = document.getElementById('edit-history-user').value;
                
                if (historyDesc && historyUser) {
                    const now = new Date();
                    const formattedDate = now.toISOString().slice(0, 10);
                    const id = this.getEquipmentId(updatedItem, this.data.editingType);
                    
                    // Inicializar o histórico para este equipamento se não existir
                    if (!this.data.history[id]) {
                        this.data.history[id] = [];
                    }
                    
                    // Adicionar nova entrada ao histórico
                    this.data.history[id].push({
                        date: formattedDate,
                        status: updatedItem.status,
                        description: historyDesc,
                        user: historyUser
                    });
                }
                
                // Atualizar UI
                this.renderActiveTable();
                this.updateAllDashboards();
                this.updateDashboardDetails();
                
                // Fechar o modal
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Alterações salvas', 'As alterações foram salvas com sucesso!');
            },
            
            // Mostrar modal de histórico
            showHistoryModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('history-modal');
                const title = document.getElementById('history-title');
                const subtitle = document.getElementById('history-subtitle');
                const icon = document.getElementById('history-icon');
                const timeline = document.getElementById('history-timeline');
                
                // Determinar ID e obter o histórico
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                const history = this.data.history[id] || [];
                
                // Configurar ícone com base no tipo
                if (this.data.editingType === 'Reboque') {
                    icon.className = 'fas fa-trailer';
                } else if (this.data.editingType.includes('Caminhão')) {
                    icon.className = 'fas fa-truck';
                } else if (this.data.editingType.includes('Colhedora')) {
                    icon.className = 'fas fa-tractor';
                } else if (this.data.editingType.includes('Tração')) {
                    icon.className = 'fas fa-truck-moving';
                }
                
                // Configurar título
                if (this.data.editingType === 'Reboque') {
                    title.textContent = `Reboque #${this.data.editingItem.frota || this.data.editingItem.acoplado}`;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    title.textContent = `Caminhão #${this.data.editingItem.caminhao}`;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    title.textContent = `Caminhão #${this.data.editingItem.caminhao}`;
                } else {
                    title.textContent = `${this.data.editingType} #${this.data.editingItem.codigo}`;
                }
                
                subtitle.textContent = `Total de registros: ${history.length}`;
                
                // Renderizar timeline
                timeline.innerHTML = '';
                
                if (history.length === 0) {
                    timeline.innerHTML = `
                        <div class="flex flex-col items-start mb-6 ml-6 relative">
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-gray-300 dark:bg-gray-600"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Nenhum registro encontrado no histórico.</p>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Ordenar histórico por data (mais recente primeiro)
                    const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    sortedHistory.forEach(entry => {
                        const date = new Date(entry.date);
                        const formattedDate = date.toLocaleDateString('pt-BR');
                        
                        const timelineItem = document.createElement('div');
                        timelineItem.className = 'flex flex-col items-start mb-6 ml-6 relative';
                        
                        let dotColor;
                        switch (entry.status.toLowerCase()) {
                            case 'operacional':
                                dotColor = 'bg-green-500';
                                break;
                            case 'em manutenção':
                            case 'aguardando reforma':
                                dotColor = 'bg-yellow-500';
                                break;
                            case 'em reforma':
                            case 'inoperante':
                                dotColor = 'bg-red-500';
                                break;
                            default:
                                dotColor = 'bg-blue-500';
                        }
                        
                        timelineItem.innerHTML = `
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full ${dotColor}"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium">${entry.description}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">
                                            Status: <span class="font-medium ${this.getStatusTextColor(entry.status)}">${entry.status}</span>
                                        </p>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-xs text-gray-500 dark:text-gray-400">${formattedDate}</span>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Por: ${entry.user}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        timeline.appendChild(timelineItem);
                    });
                }
                
                modal.classList.remove('hidden');
            },
            
            // Obter classe CSS de cor para status
            getStatusTextColor(status) {
                switch(status.toLowerCase()) {
                    case 'operacional':
                        return 'text-green-500 dark:text-green-400';
                    case 'em manutenção':
                    case 'aguardando reforma':
                        return 'text-yellow-500 dark:text-yellow-400';
                    case 'em reforma':
                    case 'inoperante':
                        return 'text-red-500 dark:text-red-400';
                    default:
                        return 'text-blue-500 dark:text-blue-400';
                }
            },
            
            // Mostrar modal de agendamento
            showScheduleModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('schedule-modal');
                const info = document.getElementById('schedule-equipment-info');
                
                // Determinar ID
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                
                // Configurar informações do equipamento
                let infoHTML = '';
                
                if (this.data.editingType === 'Reboque') {
                    infoHTML = `
                        <div class="flex items-center mb-2">
                            <i class="fas fa-trailer text-xl text-primary mr-2"></i>
                            <span class="font-medium">Reboque #${this.data.editingItem.frota || this.data.editingItem.acoplado}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><span class="text-gray-600 dark:text-gray-400">Tipo:</span> ${this.data.editingItem.tipo || '-'}</div>
                            <div><span class="text-gray-600 dark:text-gray-400">Status:</span> ${this.data.editingItem.status}</div>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    infoHTML = `
                        <div class="flex items-center mb-2">
                            <i class="fas fa-truck text-xl text-primary mr-2"></i>
                            <span class="font-medium">Caminhão #${this.data.editingItem.caminhao}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><span class="text-gray-600 dark:text-gray-400">Proprietário:</span> UsinaCambui</div>
                            <div><span class="text-gray-600 dark:text-gray-400">Status:</span> ${this.data.editingItem.status}</div>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    infoHTML = `
                        <div class="flex items-center mb-2">
                            <i class="fas fa-truck-moving text-xl text-primary mr-2"></i>
                            <span class="font-medium">Caminhão #${this.data.editingItem.caminhao}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><span class="text-gray-600 dark:text-gray-400">Proprietário:</span> ${this.data.editingItem.proprietario}</div>
                            <div><span class="text-gray-600 dark:text-gray-400">Status:</span> ${this.data.editingItem.status}</div>
                        </div>
                    `;
                } else if (this.data.editingType.includes('Colhedora')) {
                    const frente = this.data.editingType.includes('4001') ? '4001' : '4002';
                    infoHTML = `
                        <div class="flex items-center mb-2">
                            <i class="fas fa-tractor text-xl text-primary mr-2"></i>
                            <span class="font-medium">Colhedora #${this.data.editingItem.codigo}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><span class="text-gray-600 dark:text-gray-400">Frente:</span> ${frente}</div>
                            <div><span class="text-gray-600 dark:text-gray-400">Status:</span> ${this.data.editingItem.status}</div>
                        </div>
                    `;
                } else if (this.data.editingType.includes('Tração')) {
                    const frente = this.data.editingType.includes('4001') ? '4001' : '4002';
                    infoHTML = `
                        <div class="flex items-center mb-2">
                            <i class="fas fa-truck-monster text-xl text-primary mr-2"></i>
                            <span class="font-medium">Tração #${this.data.editingItem.codigo}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><span class="text-gray-600 dark:text-gray-400">Frente:</span> ${frente}</div>
                            <div><span class="text-gray-600 dark:text-gray-400">Status:</span> ${this.data.editingItem.status}</div>
                        </div>
                    `;
                }
                
                info.innerHTML = infoHTML;
                
                // Configurar data mínima como hoje
                const now = new Date();
                const today = now.toISOString().split('T')[0];
                document.getElementById('schedule-date').min = today;
                
                // Limpar os campos
                document.getElementById('schedule-form').reset();
                
                modal.classList.remove('hidden');
            },
            
            // Salvar agendamento
            saveSchedule() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                // Obter valores do formulário
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const type = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value;
                const responsible = document.getElementById('schedule-responsible').value;
                
                if (!date || !time || !type || !description || !responsible) {
                    this.showNotification('error', 'Dados incompletos', 'Por favor, preencha todos os campos.');
                    return;
                }
                
                // Determinar ID
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                
                // Adicionar novo agendamento
                this.data.schedules.push({
                    equipment: id,
                    equipmentType: this.data.editingType,
                    date,
                    time,
                    type,
                    description,
                    responsible
                });
                
                // Adicionar ao histórico se o agendamento for para hoje
                const today = new Date().toISOString().split('T')[0];
                if (date === today) {
                    // Inicializar o histórico para este equipamento se não existir
                    if (!this.data.history[id]) {
                        this.data.history[id] = [];
                    }
                    
                    // Adicionar nova entrada ao histórico
                    this.data.history[id].push({
                        date,
                        status: this.data.editingItem.status,
                        description: `Agendamento: ${this.getMaintenanceTypeName(type)} - ${description}`,
                        user: responsible
                    });
                }
                
                // Fechar o modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Agendamento salvo', 'O agendamento foi salvo com sucesso!');
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                const modal = document.getElementById('add-modal');
                
                // Limpar formulário
                document.getElementById('equipment-type').value = 'reboque';
                document.getElementById('add-form-fields').innerHTML = '';
                
                // Gerar campos para o tipo selecionado
                this.updateAddFormFields();
                
                // Mostrar modal
                modal.classList.remove('hidden');
            },
            
            // Atualizar campos do formulário de adição
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const fields = document.getElementById('add-form-fields');
                
                if (type === 'reboque') {
                    fields.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota *</label>
                                <input type="text" id="add-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo *</label>
                                <input type="text" id="add-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="add-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="add-tipoAcoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-dataParada" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status *</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                        </div>
                    `;
                } else if (type === 'caminhao-proprio') {
                    fields.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão *</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status *</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                        </div>
                    `;
                } else if (type === 'caminhao-terceiro') {
                    fields.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão *</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário *</label>
                                <input type="text" id="add-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="add-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status *</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                        </div>
                    `;
                } else if (type.includes('colhedora') || type.includes('tracao')) {
                    const frente = type.includes('4001') ? '4001' : '4002';
                    const equipType = type.includes('colhedora') ? 'Colhedora' : 'Tração';
                    
                    fields.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código *</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status *</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frente</label>
                                <input type="text" value="${frente}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" readonly>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                        </div>
                    `;
                }
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                let newItem = {};
                
                // Criar objeto com base no tipo
                if (type === 'reboque') {
                    newItem = {
                        frota: document.getElementById('add-frota').value,
                        tipo: document.getElementById('add-tipo').value,
                        acoplado: document.getElementById('add-acoplado').value,
                        tipoAcoplado: document.getElementById('add-tipoAcoplado').value,
                        dataParada: document.getElementById('add-dataParada').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.reboques.push(newItem);
                } else if (type === 'caminhao-proprio') {
                    newItem = {
                        caminhao: document.getElementById('add-caminhao').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.caminhoesProps.push(newItem);
                } else if (type === 'caminhao-terceiro') {
                    newItem = {
                        caminhao: document.getElementById('add-caminhao').value,
                        proprietario: document.getElementById('add-proprietario').value,
                        reboques: document.getElementById('add-reboques').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.caminhoesTerc.push(newItem);
                } else if (type === 'colhedora-4001') {
                    newItem = {
                        codigo: document.getElementById('add-codigo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.frente4001Colhedoras.push(newItem);
                } else if (type === 'tracao-4001') {
                    newItem = {
                        codigo: document.getElementById('add-codigo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.frente4001Tracoes.push(newItem);
                } else if (type === 'colhedora-4002') {
                    newItem = {
                        codigo: document.getElementById('add-codigo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.frente4002Colhedoras.push(newItem);
                } else if (type === 'tracao-4002') {
                    newItem = {
                        codigo: document.getElementById('add-codigo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value,
                        motivo: document.getElementById('add-motivo').value
                    };
                    
                    // Adicionar ao array
                    this.data.frente4002Tracoes.push(newItem);
                }
                
                // Atualizar UI
                this.renderActiveTable();
                this.updateAllDashboards();
                this.updateDashboardDetails();
                
                // Fechar o modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Equipamento adicionado', 'O equipamento foi adicionado com sucesso!');
            },
            
            // Imprimir detalhes do equipamento
            printEquipmentDetails() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const item = this.data.editingItem;
                const type = this.data.editingType;
                
                // Preparar o conteúdo para impressão
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                const printContent = document.getElementById('print-content');
                
                // Configurar título e data
                printTitle.textContent = `Detalhes do ${type} - ${this.getEquipmentTitle(item, type)}`;
                const now = new Date();
                printDate.textContent = `Relatório gerado em ${now.toLocaleDateString('pt-BR')} às ${now.toLocaleTimeString('pt-BR')}`;
                
                // Gerar conteúdo de impressão
                let contentHTML = `<div class="text-black">`;
                
                if (type === 'Reboque') {
                    let formattedDate = '-';
                    if (item.dataParada) {
                        const date = new Date(item.dataParada);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Informações Básicas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Frota</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.frota || '-'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Tipo</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.tipo || '-'}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Acoplado Com</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.acoplado || '-'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Tipo Acoplado</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.tipoAcoplado || '-'}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Data de Parada</td>
                                    <td class="border border-gray-300 px-4 py-2">${formattedDate}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Status</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.status}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Motivo</h3>
                            <div class="border border-gray-300 px-4 py-2 rounded">
                                ${item.motivo || 'Sem motivo registrado'}
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Próprio') {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Informações Básicas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Caminhão</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.caminhao || '-'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Proprietário</td>
                                    <td class="border border-gray-300 px-4 py-2">UsinaCambui</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Data de Parada</td>
                                    <td class="border border-gray-300 px-4 py-2">${formattedDate}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Status</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.status}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Motivo</h3>
                            <div class="border border-gray-300 px-4 py-2 rounded">
                                ${item.motivo || 'Sem motivo registrado'}
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Terceiro') {
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Informações Básicas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Caminhão</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.caminhao || '-'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Proprietário</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.proprietario || '-'}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Reboques</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.reboques || 'Nenhum reboque associado'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Status</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.status}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Motivo</h3>
                            <div class="border border-gray-300 px-4 py-2 rounded">
                                ${item.motivo || 'Sem motivo registrado'}
                            </div>
                        </div>
                    `;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    const frente = type.includes('4001') ? '4001' : '4002';
                    
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Informações Básicas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Código</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.codigo || '-'}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Frente</td>
                                    <td class="border border-gray-300 px-4 py-2">${frente}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Data de Parada</td>
                                    <td class="border border-gray-300 px-4 py-2">${formattedDate}</td>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Status</td>
                                    <td class="border border-gray-300 px-4 py-2">${item.status}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Motivo</h3>
                            <div class="border border-gray-300 px-4 py-2 rounded">
                                ${item.motivo || 'Sem motivo registrado'}
                            </div>
                        </div>
                    `;
                }
                
                // Adicionar histórico
                const id = this.getEquipmentId(item, type);
                const history = this.data.history[id] || [];
                
                if (history.length > 0) {
                    // Ordenar histórico por data (mais recente primeiro)
                    const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Histórico de Atividades</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr>
                                        <th class="border border-gray-300 px-4 py-2">Data</th>
                                        <th class="border border-gray-300 px-4 py-2">Status</th>
                                        <th class="border border-gray-300 px-4 py-2">Descrição</th>
                                        <th class="border border-gray-300 px-4 py-2">Responsável</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    sortedHistory.forEach(entry => {
                        const date = new Date(entry.date).toLocaleDateString('pt-BR');
                        contentHTML += `
                            <tr>
                                <td class="border border-gray-300 px-4 py-2">${date}</td>
                                <td class="border border-gray-300 px-4 py-2">${entry.status}</td>
                                <td class="border border-gray-300 px-4 py-2">${entry.description}</td>
                                <td class="border border-gray-300 px-4 py-2">${entry.user}</td>
                            </tr>
                        `;
                    });
                    
                    contentHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                // Adicionar manutenções agendadas
                const schedules = this.data.schedules.filter(schedule => schedule.equipment === id);
                
                if (schedules.length > 0) {
                    // Ordenar agendamentos por data
                    const sortedSchedules = [...schedules].sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    contentHTML += `
                        <div class="mb-4">
                            <h3 class="text-lg font-bold mb-2">Manutenções Agendadas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr>
                                        <th class="border border-gray-300 px-4 py-2">Data</th>
                                        <th class="border border-gray-300 px-4 py-2">Horário</th>
                                        <th class="border border-gray-300 px-4 py-2">Tipo</th>
                                        <th class="border border-gray-300 px-4 py-2">Descrição</th>
                                        <th class="border border-gray-300 px-4 py-2">Responsável</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    sortedSchedules.forEach(schedule => {
                        const date = new Date(schedule.date).toLocaleDateString('pt-BR');
                        contentHTML += `
                            <tr>
                                <td class="border border-gray-300 px-4 py-2">${date}</td>
                                <td class="border border-gray-300 px-4 py-2">${schedule.time}</td>
                                <td class="border border-gray-300 px-4 py-2">${this.getMaintenanceTypeName(schedule.type)}</td>
                                <td class="border border-gray-300 px-4 py-2">${schedule.description}</td>
                                <td class="border border-gray-300 px-4 py-2">${schedule.responsible}</td>
                            </tr>
                        `;
                    });
                    
                    contentHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                contentHTML += `</div>`;
                
                // Preencher a área de impressão
                printContent.innerHTML = contentHTML;
                
                // Imprimir
                window.print();
            },
            
            // Obter título do equipamento
            getEquipmentTitle(item, type) {
                if (type === 'Reboque') {
                    return `${item.frota || item.acoplado}`;
                } else if (type === 'Caminhão Próprio' || type === 'Caminhão Terceiro') {
                    return `${item.caminhao}`;
                } else {
                    return `${item.codigo}`;
                }
            },
            
            // Exportar dados para CSV
            exportToCSV() {
                // Determinar quais dados exportar com base na aba ativa
                let data = [];
                let filename = '';
                
                if (this.data.activeTab === 'reboques') {
                    data = this.data.reboques;
                    filename = 'Reboques';
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    data = this.data.caminhoesProps;
                    filename = 'Caminhoes_Proprios';
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    data = this.data.caminhoesTerc;
                    filename = 'Caminhoes_Terceiros';
                } else if (this.data.activeTab === 'frente-4001') {
                    // Combinar colhedoras e trações
                    data = [...this.data.frente4001Colhedoras.map(i => ({...i, tipo: 'Colhedora'})), 
                           ...this.data.frente4001Tracoes.map(i => ({...i, tipo: 'Tração'}))];
                    filename = 'Frente_4001';
                } else if (this.data.activeTab === 'frente-4002') {
                    // Combinar colhedoras e trações
                    data = [...this.data.frente4002Colhedoras.map(i => ({...i, tipo: 'Colhedora'})), 
                           ...this.data.frente4002Tracoes.map(i => ({...i, tipo: 'Tração'}))];
                    filename = 'Frente_4002';
                }
                
                // Aplicar filtros
                data = this.filterData(data);
                
                // Se não houver dados, mostrar notificação
                if (data.length === 0) {
                    this.showNotification('warning', 'Sem dados para exportar', 'Não há dados disponíveis para exportar com os filtros atuais.');
                    return;
                }
                
                // Converter para CSV
                const replacer = (key, value) => value === null ? '' : value;
                const header = Object.keys(data[0]);
                let csv = data.map(row => header.map(fieldName => 
                    JSON.stringify(row[fieldName], replacer)).join(','));
                csv.unshift(header.join(','));
                csv = csv.join('\r\n');
                
                // Download do arquivo
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                link.setAttribute('href', url);
                link.setAttribute('download', `${filename}_${new Date().toISOString().slice(0, 10)}.csv`);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Exportação concluída', `Os dados foram exportados com sucesso para ${filename}.csv.`);
            },
            
            // Imprimir tabela ativa
            printActiveTable() {
                let title = '';
                let html = '';
                
                if (this.data.activeTab === 'reboques') {
                    title = 'Reboques';
                    html = this.generatePrintTable(this.data.reboques, ['frota', 'tipo', 'acoplado', 'tipoAcoplado', 'motivo', 'status']);
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    title = 'Caminhões Próprios';
                    html = this.generatePrintTable(this.data.caminhoesProps, ['caminhao', 'motivo', 'data', 'status']);
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    title = 'Caminhões Terceiros';
                    html = this.generatePrintTable(this.data.caminhoesTerc, ['caminhao', 'reboques', 'proprietario', 'motivo', 'status']);
                } else if (this.data.activeTab === 'frente-4001') {
                    title = 'Frente 4001';
                    
                    html = '<h3 class="text-lg font-medium mb-2">Colhedoras</h3>';
                    html += this.generatePrintTable(this.data.frente4001Colhedoras, ['codigo', 'motivo', 'data', 'status']);
                    
                    html += '<h3 class="text-lg font-medium mb-2 mt-6">Trações Transbordo</h3>';
                    html += this.generatePrintTable(this.data.frente4001Tracoes, ['codigo', 'motivo', 'data', 'status']);
                } else if (this.data.activeTab === 'frente-4002') {
                    title = 'Frente 4002';
                    
                    html = '<h3 class="text-lg font-medium mb-2">Colhedoras</h3>';
                    html += this.generatePrintTable(this.data.frente4002Colhedoras, ['codigo', 'motivo', 'data', 'status']);
                    
                    html += '<h3 class="text-lg font-medium mb-2 mt-6">Trações Transbordo</h3>';
                    html += this.generatePrintTable(this.data.frente4002Tracoes, ['codigo', 'motivo', 'data', 'status']);
                }
                
                // Adicionar estatísticas
                const stats = this.generatePrintStats();
                
                // Configurar a área de impressão
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                const printContent = document.getElementById('print-content');
                
                printTitle.textContent = title;
                const now = new Date();
                printDate.textContent = `Relatório gerado em ${now.toLocaleDateString('pt-BR')} às ${now.toLocaleTimeString('pt-BR')}`;
                printContent.innerHTML = stats + html;
                
                // Imprimir
                window.print();
            },
            
            // Gerar tabela para impressão
            generatePrintTable(data, columns) {
                // Filtrar dados
                data = this.filterData(data);
                
                // Aplicar ordenação
                data = this.sortData(data);
                
                if (data.length === 0) {
                    return '<p class="my-4 text-gray-500">Nenhum dado encontrado com os filtros atuais.</p>';
                }
                
                // Mapear colunas para nomes mais amigáveis
                const columnLabels = {
                    frota: 'FROTA',
                    tipo: 'TIPO',
                    acoplado: 'ACOPLADO COM',
                    tipoAcoplado: 'TIPO ACOPLADO',
                    motivo: 'MOTIVO',
                    status: 'STATUS',
                    caminhao: 'CAMINHÃO',
                    data: 'DATA DE PARADA',
                    proprietario: 'PROPRIETÁRIO',
                    reboques: 'REBOQUES',
                    codigo: 'CÓDIGO'
                };
                
                let html = `
                    <table class="min-w-full border-collapse border border-gray-300 text-black">
                        <thead>
                            <tr>
                `;
                
                // Cabeçalho
                columns.forEach(column => {
                    html += `<th class="border border-gray-300 px-4 py-2 text-left">${columnLabels[column] || column.toUpperCase()}</th>`;
                });
                
                html += `
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                // Dados
                data.forEach(item => {
                    html += '<tr>';
                    
                    columns.forEach(column => {
                        let value = item[column] || '-';
                        
                        // Formatar data se necessário
                        if ((column === 'data' || column === 'dataParada') && value !== '-') {
                            value = new Date(value).toLocaleDateString('pt-BR');
                        }
                        
                        html += `<td class="border border-gray-300 px-4 py-2">${value}</td>`;
                    });
                    
                    html += '</tr>';
                });
                
                html += `
                        </tbody>
                    </table>
                `;
                
                return html;
            },
            
            // Gerar estatísticas para impressão
            generatePrintStats() {
                let stats = '';
                
                if (this.data.activeTab === 'reboques') {
                    const total = this.data.reboques.length;
                    const operational = this.data.reboques.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.reboques.filter(item => item.status === 'Em manutenção').length;
                    const reform = this.data.reboques.filter(item => item.status === 'Em reforma').length;
                    
                    const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                    
                    stats = `
                        <div class="mb-6">
                            <h3 class="text-lg font-medium mb-2">Estatísticas Gerais</h3>
                            <div class="flex flex-wrap gap-4">
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl">${total}</div>
                                    <div class="text-gray-600">Total de Reboques</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-green-600">${operational}</div>
                                    <div class="text-gray-600">Operacionais (${operationalPerc}%)</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-yellow-600">${maintenance}</div>
                                    <div class="text-gray-600">Em Manutenção</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-red-600">${reform}</div>
                                    <div class="text-gray-600">Em Reforma</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    const total = this.data.caminhoesProps.length;
                    const operational = this.data.caminhoesProps.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length;
                    const borrowed = this.data.caminhoesProps.filter(item => item.status === 'Emprestado').length;
                    
                    const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                    
                    stats = `
                        <div class="mb-6">
                            <h3 class="text-lg font-medium mb-2">Estatísticas Gerais</h3>
                            <div class="flex flex-wrap gap-4">
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl">${total}</div>
                                    <div class="text-gray-600">Total de Caminhões</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-green-600">${operational}</div>
                                    <div class="text-gray-600">Operacionais (${operationalPerc}%)</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-yellow-600">${maintenance}</div>
                                    <div class="text-gray-600">Em Manutenção</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-blue-600">${borrowed}</div>
                                    <div class="text-gray-600">Emprestados</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    const total = this.data.caminhoesTerc.length;
                    const operational = this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção').length;
                    
                    // Contar proprietários únicos
                    const owners = new Set(this.data.caminhoesTerc.map(item => item.proprietario)).size;
                    
                    // Contar reboques acoplados
                    const withTrailers = this.data.caminhoesTerc.filter(item => item.reboques && item.reboques.trim() !== '').length;
                    
                    stats = `
                        <div class="mb-6">
                            <h3 class="text-lg font-medium mb-2">Estatísticas Gerais</h3>
                            <div class="flex flex-wrap gap-4">
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl">${total}</div>
                                    <div class="text-gray-600">Total de Caminhões</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-green-600">${operational}</div>
                                    <div class="text-gray-600">Operacionais</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-yellow-600">${maintenance}</div>
                                    <div class="text-gray-600">Em Manutenção</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-blue-600">${owners}</div>
                                    <div class="text-gray-600">Proprietários</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-purple-600">${withTrailers}</div>
                                    <div class="text-gray-600">Com Reboques</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'frente-4001' || this.data.activeTab === 'frente-4002') {
                    const frente = this.data.activeTab === 'frente-4001' ? '4001' : '4002';
                    const colhedoras = this.data.activeTab === 'frente-4001' ? this.data.frente4001Colhedoras : this.data.frente4002Colhedoras;
                    const tracoes = this.data.activeTab === 'frente-4001' ? this.data.frente4001Tracoes : this.data.frente4002Tracoes;
                    
                    const totalColhedoras = colhedoras.length;
                    const operationalColhedoras = colhedoras.filter(item => item.status === 'Operacional').length;
                    
                    const totalTracoes = tracoes.length;
                    const operationalTracoes = tracoes.filter(item => item.status === 'Operacional').length;
                    
                    const totalMaintenance = colhedoras.filter(item => item.status === 'Em manutenção').length + 
                                             tracoes.filter(item => item.status === 'Em manutenção').length;
                    
                    const totalAvailability = ((operationalColhedoras + operationalTracoes) / (totalColhedoras + totalTracoes) * 100).toFixed(1);
                    
                    stats = `
                        <div class="mb-6">
                            <h3 class="text-lg font-medium mb-2">Estatísticas da Frente ${frente}</h3>
                            <div class="flex flex-wrap gap-4">
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-green-600">${operationalColhedoras}/${totalColhedoras}</div>
                                    <div class="text-gray-600">Colhedoras Operacionais</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-green-600">${operationalTracoes}/${totalTracoes}</div>
                                    <div class="text-gray-600">Trações Operacionais</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-yellow-600">${totalMaintenance}</div>
                                    <div class="text-gray-600">Em Manutenção</div>
                                </div>
                                <div class="border border-gray-300 p-3 rounded">
                                    <div class="font-bold text-xl text-blue-600">${totalAvailability}%</div>
                                    <div class="text-gray-600">Disponibilidade</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                return stats;
            },
            
            // Gerar PDF completo
            generatePDFReport() {
                const now = new Date();
                const formattedDate = now.toLocaleDateString('pt-BR');
                const formattedTime = now.toLocaleTimeString('pt-BR');
                
                // Definir título e data
                document.getElementById('pdf-report-title').textContent = `Relatório Completo - ${this.getCurrentTabName()}`;
                document.getElementById('pdf-report-date').textContent = `Gerado em ${formattedDate} às ${formattedTime}`;
                
                // Conteúdo para o relatório em PDF
                let reportHTML = '';
                
                // Adicionar dashboard atual
                reportHTML += this.generateDashboardReport();
                
                // Adicionar quebrra de página
                reportHTML += '<div class="pdf-page-break"></div>';
                
                // Adicionar tabela de dados
                reportHTML += this.generateTableReport();
                
                // Adicionar gráficos se necessário
                if (this.data.activeTab === 'reboques') {
                    // Capturar os gráficos como imagens
                    const statusChartImg = this.captureChartAsImage('reboques-status-chart');
                    const trendChartImg = this.captureChartAsImage('reboques-maintenance-trend-chart');
                    
                    reportHTML += '<div class="pdf-page-break"></div>';
                    reportHTML += `
                        <h3 class="text-xl font-semibold mb-4">Análise Gráfica</h3>
                        <div class="grid grid-cols-1 gap-6 mb-6">
                            <div>
                                <h4 class="text-lg font-medium mb-2">Status dos Reboques</h4>
                                <img src="${statusChartImg}" alt="Status Chart" class="w-full max-w-md mx-auto mb-6">
                            </div>
                            <div>
                                <h4 class="text-lg font-medium mb-2">Tendência de Manutenção</h4>
                                <img src="${trendChartImg}" alt="Trend Chart" class="w-full max-w-lg mx-auto mb-6">
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    // Capturar os gráficos como imagens
                    const statusChartImg = this.captureChartAsImage('cp-status-chart');
                    const evolutionChartImg = this.captureChartAsImage('cp-status-evolution-chart');
                    
                    reportHTML += '<div class="pdf-page-break"></div>';
                    reportHTML += `
                        <h3 class="text-xl font-semibold mb-4">Análise Gráfica</h3>
                        <div class="grid grid-cols-1 gap-6 mb-6">
                            <div>
                                <h4 class="text-lg font-medium mb-2">Status dos Caminhões</h4>
                                <img src="${statusChartImg}" alt="Status Chart" class="w-full max-w-md mx-auto mb-6">
                            </div>
                            <div>
                                <h4 class="text-lg font-medium mb-2">Evolução de Status</h4>
                                <img src="${evolutionChartImg}" alt="Evolution Chart" class="w-full max-w-lg mx-auto mb-6">
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    // Capturar os gráficos como imagens
                    const ownersChartImg = this.captureChartAsImage('ct-owners-chart');
                    const statusByOwnerChartImg = this.captureChartAsImage('ct-status-by-owner-chart');
                    
                    reportHTML += '<div class="pdf-page-break"></div>';
                    reportHTML += `
                        <h3 class="text-xl font-semibold mb-4">Análise Gráfica</h3>
                        <div class="grid grid-cols-1 gap-6 mb-6">
                            <div>
                                <h4 class="text-lg font-medium mb-2">Proprietários - Quantidade</h4>
                                <img src="${ownersChartImg}" alt="Owners Chart" class="w-full max-w-md mx-auto mb-6">
                            </div>
                            <div>
                                <h4 class="text-lg font-medium mb-2">Status por Proprietário</h4>
                                <img src="${statusByOwnerChartImg}" alt="Status by Owner Chart" class="w-full max-w-lg mx-auto mb-6">
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'frente-4001') {
                    // Capturar os gráficos como imagens
                    const statusChartImg = this.captureChartAsImage('f4001-status-chart');
                    const breakdownChartImg = this.captureChartAsImage('f4001-breakdown-chart');
                    
                    reportHTML += '<div class="pdf-page-break"></div>';
                    reportHTML += `
                        <h3 class="text-xl font-semibold mb-4">Análise Gráfica</h3>
                        <div class="grid grid-cols-1 gap-6 mb-6">
                            <div>
                                <h4 class="text-lg font-medium mb-2">Status dos Equipamentos</h4>
                                <img src="${statusChartImg}" alt="Status Chart" class="w-full max-w-md mx-auto mb-6">
                            </div>
                            <div>
                                <h4 class="text-lg font-medium mb-2">Motivos de Parada</h4>
                                <img src="${breakdownChartImg}" alt="Breakdown Chart" class="w-full max-w-lg mx-auto mb-6">
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'frente-4002') {
                    // Capturar os gráficos como imagens
                    const statusChartImg = this.captureChartAsImage('f4002-status-chart');
                    const breakdownChartImg = this.captureChartAsImage('f4002-breakdown-chart');
                    
                    reportHTML += '<div class="pdf-page-break"></div>';
                    reportHTML += `
                        <h3 class="text-xl font-semibold mb-4">Análise Gráfica</h3>
                        <div class="grid grid-cols-1 gap-6 mb-6">
                            <div>
                                <h4 class="text-lg font-medium mb-2">Status dos Equipamentos</h4>
                                <img src="${statusChartImg}" alt="Status Chart" class="w-full max-w-md mx-auto mb-6">
                            </div>
                            <div>
                                <h4 class="text-lg font-medium mb-2">Motivos de Parada</h4>
                                <img src="${breakdownChartImg}" alt="Breakdown Chart" class="w-full max-w-lg mx-auto mb-6">
                            </div>
                        </div>
                    `;
                }
                
                // Adicionar informações de resumo
                reportHTML += '<div class="pdf-page-break"></div>';
                reportHTML += this.generateSummaryReport();
                
                // Colocar o conteúdo na área de PDF report
                document.getElementById('pdf-report-content').innerHTML = reportHTML;
                
                // Mostrar a área do relatório
                const pdfReportArea = document.getElementById('pdf-report-area');
                pdfReportArea.style.display = 'block';
                
                // Imprimir o relatório PDF
                window.print();
                
                // Ocultar a área do relatório após a impressão
                pdfReportArea.style.display = 'none';
                
                // Mostrar notificação
                this.showNotification('success', 'Relatório gerado', 'O relatório em PDF foi gerado com sucesso!');
            },
            
            // Capturar gráfico como imagem
            captureChartAsImage(chartId) {
                const canvas = document.getElementById(chartId);
                if (!canvas) return '';
                
                try {
                    return canvas.toDataURL('image/png');
                } catch (e) {
                    console.error('Erro ao capturar gráfico:', e);
                    return '';
                }
            },
            
            // Obter nome da aba atual
            getCurrentTabName() {
                switch (this.data.activeTab) {
                    case 'reboques': return 'Reboques';
                    case 'caminhoes-proprios': return 'Caminhões Próprios';
                    case 'caminhoes-terceiros': return 'Caminhões Terceiros';
                    case 'frente-4001': return 'Frente 4001';
                    case 'frente-4002': return 'Frente 4002';
                    default: return 'Equipamentos';
                }
            },
            
            // Gerar relatório de dashboard para PDF
            generateDashboardReport() {
                let reportHTML = `
                    <h3 class="text-xl font-semibold mb-4">Dashboard de ${this.getCurrentTabName()}</h3>
                `;
                
                if (this.data.activeTab === 'reboques') {
                    // Contagens
                    const total = this.data.reboques.length;
                    const operational = this.data.reboques.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.reboques.filter(item => item.status === 'Em manutenção').length;
                    const reform = this.data.reboques.filter(item => item.status === 'Em reforma').length;
                    
                    const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                    const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                    const reformPerc = total > 0 ? ((reform / total) * 100).toFixed(1) : 0;
                    
                    reportHTML += `
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-green-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Operacionais</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operational}</span>
                                    <span class="text-lg text-gray-600">${operationalPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-yellow-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Em Manutenção</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${maintenance}</span>
                                    <span class="text-lg text-gray-600">${maintenancePerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-red-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Em Reforma</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${reform}</span>
                                    <span class="text-lg text-gray-600">${reformPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-blue-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Disponibilidade</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operationalPerc}%</span>
                                    <span class="text-lg text-gray-600">
                                        <i class="fas fa-arrow-up text-green-500"></i> 4%
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    // Contagens
                    const total = this.data.caminhoesProps.length;
                    const operational = this.data.caminhoesProps.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length;
                    const borrowed = this.data.caminhoesProps.filter(item => item.status === 'Emprestado').length;
                    
                    const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                    const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                    const borrowedPerc = total > 0 ? ((borrowed / total) * 100).toFixed(1) : 0;
                    
                    reportHTML += `
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-green-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Operacionais</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operational}</span>
                                    <span class="text-lg text-gray-600">${operationalPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-yellow-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Em Manutenção</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${maintenance}</span>
                                    <span class="text-lg text-gray-600">${maintenancePerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-blue-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Emprestados</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${borrowed}</span>
                                    <span class="text-lg text-gray-600">${borrowedPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-purple-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Prazo Médio</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">5d</span>
                                    <span class="text-lg text-gray-600">
                                        <i class="fas fa-arrow-down text-green-500"></i> 1d
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    // Contagens
                    const total = this.data.caminhoesTerc.length;
                    const operational = this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length;
                    const maintenance = this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção').length;
                    
                    // Contar proprietários únicos
                    const owners = new Set(this.data.caminhoesTerc.map(item => item.proprietario)).size;
                    
                    // Contar reboques acoplados
                    const withTrailers = this.data.caminhoesTerc.filter(item => item.reboques && item.reboques.trim() !== '').length;
                    
                    const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                    const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                    
                    reportHTML += `
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-green-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Operacionais</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operational}</span>
                                    <span class="text-lg text-gray-600">${operationalPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-yellow-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Em Manutenção</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${maintenance}</span>
                                    <span class="text-lg text-gray-600">${maintenancePerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-blue-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Proprietários</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${owners}</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-purple-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Reboques Acoplados</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${withTrailers}</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.data.activeTab === 'frente-4001' || this.data.activeTab === 'frente-4002') {
                    const frente = this.data.activeTab === 'frente-4001' ? '4001' : '4002';
                    const colhedoras = this.data.activeTab === 'frente-4001' ? this.data.frente4001Colhedoras : this.data.frente4002Colhedoras;
                    const tracoes = this.data.activeTab === 'frente-4001' ? this.data.frente4001Tracoes : this.data.frente4002Tracoes;
                    
                    const totalColhedoras = colhedoras.length;
                    const operationalColhedoras = colhedoras.filter(item => item.status === 'Operacional').length;
                    
                    const totalTracoes = tracoes.length;
                    const operationalTracoes = tracoes.filter(item => item.status === 'Operacional').length;
                    
                    const totalMaintenance = colhedoras.filter(item => item.status === 'Em manutenção').length + 
                                             tracoes.filter(item => item.status === 'Em manutenção').length;
                    
                    const colhedorasPerc = totalColhedoras > 0 ? ((operationalColhedoras / totalColhedoras) * 100).toFixed(1) : 0;
                    const tracoesPerc = totalTracoes > 0 ? ((operationalTracoes / totalTracoes) * 100).toFixed(1) : 0;
                    const totalAvailability = ((operationalColhedoras + operationalTracoes) / (totalColhedoras + totalTracoes) * 100).toFixed(1);
                    
                    reportHTML += `
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-green-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Colhedoras OK</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operationalColhedoras}</span>
                                    <span class="text-lg text-gray-600">${colhedorasPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-green-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Trações OK</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${operationalTracoes}</span>
                                    <span class="text-lg text-gray-600">${tracoesPerc}%</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-yellow-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Equip. em Manutenção</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${totalMaintenance}</span>
                                </div>
                            </div>
                            <div class="border border-gray-300 p-4 rounded">
                                <div class="flex items-center mb-2">
                                    <div class="w-4 h-4 rounded-full bg-purple-500 mr-2"></div>
                                    <h4 class="text-lg font-medium">Disponibilidade</h4>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-2xl font-bold">${totalAvailability}%</span>
                                    <span class="text-lg text-gray-600">
                                        <i class="fas fa-arrow-up text-green-500"></i> ${frente === '4001' ? '2%' : '5%'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                return reportHTML;
            },
            
            // Gerar relatório de tabela para PDF
            generateTableReport() {
                let reportHTML = `
                    <h3 class="text-xl font-semibold mb-4">Dados Detalhados - ${this.getCurrentTabName()}</h3>
                `;
                
                if (this.data.activeTab === 'reboques') {
                    reportHTML += this.generatePrintTable(this.data.reboques, ['frota', 'tipo', 'acoplado', 'tipoAcoplado', 'motivo', 'status']);
                } else if (this.data.activeTab === 'caminhoes-proprios') {
                    reportHTML += this.generatePrintTable(this.data.caminhoesProps, ['caminhao', 'motivo', 'data', 'status']);
                } else if (this.data.activeTab === 'caminhoes-terceiros') {
                    reportHTML += this.generatePrintTable(this.data.caminhoesTerc, ['caminhao', 'reboques', 'proprietario', 'motivo', 'status']);
                } else if (this.data.activeTab === 'frente-4001') {
                    reportHTML += '<h4 class="text-lg font-medium mb-2">Colhedoras</h4>';
                    reportHTML += this.generatePrintTable(this.data.frente4001Colhedoras, ['codigo', 'motivo', 'data', 'status']);
                    
                    reportHTML += '<h4 class="text-lg font-medium mb-2 mt-6">Trações Transbordo</h4>';
                    reportHTML += this.generatePrintTable(this.data.frente4001Tracoes, ['codigo', 'motivo', 'data', 'status']);
                } else if (this.data.activeTab === 'frente-4002') {
                    reportHTML += '<h4 class="text-lg font-medium mb-2">Colhedoras</h4>';
                    reportHTML += this.generatePrintTable(this.data.frente4002Colhedoras, ['codigo', 'motivo', 'data', 'status']);
                    
                    reportHTML += '<h4 class="text-lg font-medium mb-2 mt-6">Trações Transbordo</h4>';
                    reportHTML += this.generatePrintTable(this.data.frente4002Tracoes, ['codigo', 'motivo', 'data', 'status']);
                }
                
                return reportHTML;
            },
            
            // Gerar relatório de resumo para PDF
            generateSummaryReport() {
                // Informações gerais de todos os equipamentos
                const totalReboques = this.data.reboques.length;
                const totalCaminhoesProps = this.data.caminhoesProps.length;
                const totalCaminhoesTerc = this.data.caminhoesTerc.length;
                const totalColhedoras = this.data.frente4001Colhedoras.length + this.data.frente4002Colhedoras.length;
                const totalTracoes = this.data.frente4001Tracoes.length + this.data.frente4002Tracoes.length;
                
                const operacionalReboques = this.data.reboques.filter(item => item.status === 'Operacional').length;
                const operacionalCamProps = this.data.caminhoesProps.filter(item => item.status === 'Operacional').length;
                const operacionalCamTerc = this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length;
                const operacionalColhedoras = this.data.frente4001Colhedoras.filter(item => item.status === 'Operacional').length + 
                                             this.data.frente4002Colhedoras.filter(item => item.status === 'Operacional').length;
                const operacionalTracoes = this.data.frente4001Tracoes.filter(item => item.status === 'Operacional').length + 
                                          this.data.frente4002Tracoes.filter(item => item.status === 'Operacional').length;
                
                const manutencaoReboques = this.data.reboques.filter(item => item.status === 'Em manutenção').length;
                const manutencaoCamProps = this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length;
                const manutencaoCamTerc = this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção').length;
                const manutencaoColhedoras = this.data.frente4001Colhedoras.filter(item => item.status === 'Em manutenção').length + 
                                            this.data.frente4002Colhedoras.filter(item => item.status === 'Em manutenção').length;
                const manutencaoTracoes = this.data.frente4001Tracoes.filter(item => item.status === 'Em manutenção').length + 
                                         this.data.frente4002Tracoes.filter(item => item.status === 'Em manutenção').length;
                
                // Cálculos de disponibilidade
                const dispReboques = totalReboques > 0 ? (operacionalReboques / totalReboques * 100).toFixed(1) : 0;
                const dispCamProps = totalCaminhoesProps > 0 ? (operacionalCamProps / totalCaminhoesProps * 100).toFixed(1) : 0;
                const dispCamTerc = totalCaminhoesTerc > 0 ? (operacionalCamTerc / totalCaminhoesTerc * 100).toFixed(1) : 0;
                const dispColhedoras = totalColhedoras > 0 ? (operacionalColhedoras / totalColhedoras * 100).toFixed(1) : 0;
                const dispTracoes = totalTracoes > 0 ? (operacionalTracoes / totalTracoes * 100).toFixed(1) : 0;
                
                const totalEquip = totalReboques + totalCaminhoesProps + totalCaminhoesTerc + totalColhedoras + totalTracoes;
                const totalOper = operacionalReboques + operacionalCamProps + operacionalCamTerc + operacionalColhedoras + operacionalTracoes;
                const totalManut = manutencaoReboques + manutencaoCamProps + manutencaoCamTerc + manutencaoColhedoras + manutencaoTracoes;
                
                const dispGeral = totalEquip > 0 ? (totalOper / totalEquip * 100).toFixed(1) : 0;
                
                return `
                    <h3 class="text-xl font-semibold mb-4">Resumo Geral</h3>
                    <div class="mb-6">
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 px-4 py-2">Categoria</th>
                                    <th class="border border-gray-300 px-4 py-2">Total</th>
                                    <th class="border border-gray-300 px-4 py-2">Operacionais</th>
                                    <th class="border border-gray-300 px-4 py-2">Em Manutenção</th>
                                    <th class="border border-gray-300 px-4 py-2">Disponibilidade</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Reboques</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalReboques}</td>
                                    <td class="border border-gray-300 px-4 py-2">${operacionalReboques}</td>
                                    <td class="border border-gray-300 px-4 py-2">${manutencaoReboques}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispReboques}%</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Caminhões Próprios</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalCaminhoesProps}</td>
                                    <td class="border border-gray-300 px-4 py-2">${operacionalCamProps}</td>
                                    <td class="border border-gray-300 px-4 py-2">${manutencaoCamProps}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispCamProps}%</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Caminhões Terceiros</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalCaminhoesTerc}</td>
                                    <td class="border border-gray-300 px-4 py-2">${operacionalCamTerc}</td>
                                    <td class="border border-gray-300 px-4 py-2">${manutencaoCamTerc}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispCamTerc}%</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Colhedoras</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalColhedoras}</td>
                                    <td class="border border-gray-300 px-4 py-2">${operacionalColhedoras}</td>
                                    <td class="border border-gray-300 px-4 py-2">${manutencaoColhedoras}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispColhedoras}%</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2 font-semibold">Trações</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalTracoes}</td>
                                    <td class="border border-gray-300 px-4 py-2">${operacionalTracoes}</td>
                                    <td class="border border-gray-300 px-4 py-2">${manutencaoTracoes}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispTracoes}%</td>
                                </tr>
                                <tr class="bg-gray-100 font-bold">
                                    <td class="border border-gray-300 px-4 py-2">TOTAL</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalEquip}</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalOper}</td>
                                    <td class="border border-gray-300 px-4 py-2">${totalManut}</td>
                                    <td class="border border-gray-300 px-4 py-2">${dispGeral}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-8 border-t border-gray-300 pt-4">
                        <h4 class="text-lg font-medium mb-2">Observações</h4>
                        <p class="mb-2">Este relatório apresenta um panorama completo da situação atual da frota na UsinaCambui para a Safra 2025/26.</p>
                        <p class="mb-2">Recomendações:</p>
                        <ol class="list-decimal ml-5 mb-4">
                            <li class="mb-1">Priorizar a manutenção dos equipamentos críticos identificados no relatório.</li>
                            <li class="mb-1">Agendar manutenções preventivas para os equipamentos que estão em operação há mais de 45 dias.</li>
                            <li class="mb-1">Avaliar a disponibilidade dos fornecedores de peças para agilizar as manutenções em andamento.</li>
                        </ol>
                        
                        <p class="text-sm text-gray-600 mt-6">Relatório gerado pelo Sistema GGOMES-LOG - Usina Cambuí</p>
                    </div>
                `;
            },
            
            // Imprimir dashboard detalhado
            printDashboard() {
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                const printContent = document.getElementById('print-content');
                
                // Configurar título e data
                printTitle.textContent = 'Dashboard Detalhado de Frota';
                const now = new Date();
                printDate.textContent = `Relatório gerado em ${now.toLocaleDateString('pt-BR')} às ${now.toLocaleTimeString('pt-BR')}`;
                
                // Capturar imagens dos gráficos
                const availabilityImg = this.captureChartAsImage('availability-chart');
                const maintenanceReasonsImg = this.captureChartAsImage('maintenance-reasons-chart');
                const statusTrendsImg = this.captureChartAsImage('status-trends-chart');
                const ownershipImg = this.captureChartAsImage('ownership-chart');
                
                // Dados para estatísticas
                const availability = document.getElementById('dash-availability').textContent;
                const avgMaintenance = document.getElementById('dash-avg-maintenance').textContent;
                const totalEquipment = document.getElementById('dash-total-equipment').textContent;
                const criticalEquipment = document.getElementById('dash-critical-equipment').textContent;
                
                // Preparar conteúdo para impressão
                const contentHTML = `
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="border border-gray-300 p-4 rounded">
                            <h3 class="text-lg font-medium mb-2">Disponibilidade de Frota</h3>
                            <div class="text-3xl font-bold">${availability}</div>
                            <div class="text-sm text-gray-600">${document.getElementById('dash-availability-trend').innerHTML}</div>
                        </div>
                        <div class="border border-gray-300 p-4 rounded">
                            <h3 class="text-lg font-medium mb-2">Tempo Médio de Manutenção</h3>
                            <div class="text-3xl font-bold">${avgMaintenance}</div>
                            <div class="text-sm text-gray-600">${document.getElementById('dash-maintenance-trend').innerHTML}</div>
                        </div>
                        <div class="border border-gray-300 p-4 rounded">
                            <h3 class="text-lg font-medium mb-2">Total de Equipamentos</h3>
                            <div class="text-3xl font-bold">${totalEquipment}</div>
                            <div class="text-sm text-gray-600">${document.getElementById('dash-equipment-trend').innerHTML}</div>
                        </div>
                        <div class="border border-gray-300 p-4 rounded">
                            <h3 class="text-lg font-medium mb-2">Equipamentos Críticos</h3>
                            <div class="text-3xl font-bold">${criticalEquipment}</div>
                            <div class="text-sm text-gray-600">${document.getElementById('dash-critical-trend').innerHTML}</div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-medium mb-4">Disponibilidade por Categoria</h3>
                        <img src="${availabilityImg}" alt="Availability Chart" class="w-full max-w-2xl mx-auto mb-6">
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-medium mb-4">Motivos de Manutenção</h3>
                        <img src="${maintenanceReasonsImg}" alt="Maintenance Reasons Chart" class="w-full max-w-2xl mx-auto mb-6">
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xl font-medium mb-4">Tendências de Status por Semana</h3>
                        <img src="${statusTrendsImg}" alt="Status Trends Chart" class="w-full max-w-2xl mx-auto mb-6">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-6 mb-6">
                        <div>
                            <h3 class="text-xl font-medium mb-4">Propriedade dos Equipamentos</h3>
                            <img src="${ownershipImg}" alt="Ownership Chart" class="w-full max-w-md mx-auto mb-6">
                        </div>
                        <div>
                            <h3 class="text-xl font-medium mb-4">Top 5 Equipamentos em Manutenção</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr>
                                        <th class="border border-gray-300 px-4 py-2">Equipamento</th>
                                        <th class="border border-gray-300 px-4 py-2">Dias</th>
                                        <th class="border border-gray-300 px-4 py-2">Motivo</th>
                                    </tr>
                                </thead>
                                <tbody id="print-top-maintenance">
                                    ${Array.from(document.querySelectorAll('#top-maintenance-list li')).map(item => {
                                        const text = item.textContent.trim();
                                        if (text === 'Carregando dados...') return '';
                                        
                                        const parts = text.split(/\s+\d+d$/);
                                        const equip = parts[0].trim();
                                        const days = text.match(/\d+d$/)[0];
                                        const motive = item.querySelector('.text-yellow-500')?.textContent || '';
                                        
                                        return `
                                            <tr>
                                                <td class="border border-gray-300 px-4 py-2">${equip}</td>
                                                <td class="border border-gray-300 px-4 py-2">${days}</td>
                                                <td class="border border-gray-300 px-4 py-2">${motive}</td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                
                printContent.innerHTML = contentHTML;
                
                // Imprimir
                window.print();
            },
            
            // Inicializar gráficos
            initializeCharts() {
                Chart.register(ChartDataLabels);
                
                // Inicializar gráficos do dashboard de reboques
                this.initReboquesCharts();
                
                // Inicializar gráficos do dashboard de caminhões próprios
                this.initCPCharts();
                
                // Inicializar gráficos do dashboard de caminhões terceiros
                this.initCTCharts();
                
                // Inicializar gráficos do dashboard da frente 4001
                this.initF4001Charts();
                
                // Inicializar gráficos do dashboard da frente 4002
                this.initF4002Charts();
            },
            
            // Inicializar gráficos do dashboard de reboques
            initReboquesCharts() {
                const ctx1 = document.getElementById('reboques-status-chart');
                const ctx2 = document.getElementById('reboques-maintenance-trend-chart');
                
                if (!ctx1 || !ctx2) return;
                
                // Dados para o gráfico de status
                const statusLabels = ['Operacional', 'Em manutenção', 'Em reforma', 'Outros'];
                const statusData = [
                    this.data.reboques.filter(item => item.status === 'Operacional').length,
                    this.data.reboques.filter(item => item.status === 'Em manutenção').length,
                    this.data.reboques.filter(item => item.status === 'Em reforma').length,
                    this.data.reboques.filter(item => !['Operacional', 'Em manutenção', 'Em reforma'].includes(item.status)).length
                ];
                
                // Configurar gráfico de status
                this.data.charts.reboquesStatusChart = new Chart(ctx1, {
                    type: 'pie',
                    data: {
                        labels: statusLabels,
                        datasets: [{
                            data: statusData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',  // Verde
                                'rgba(245, 158, 11, 0.7)',  // Amarelo
                                'rgba(239, 68, 68, 0.7)',   // Vermelho
                                'rgba(59, 130, 246, 0.7)'   // Azul
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value, ctx) => {
                                    const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = (value * 100 / sum).toFixed(1) + '%';
                                    return percentage;
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            },
                            title: {
                                display: false,
                                text: 'Status dos Reboques',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            }
                        }
                    }
                });
                
                // Dados para o gráfico de tendência de manutenção
                const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                const currentMonth = new Date().getMonth();
                const trendLabels = months.slice(currentMonth - 5, currentMonth + 1);
                
                // Dados simulados para tendência
                const maintenanceData = [4, 5, 3, 6, 8, 7];
                const reformData = [1, 2, 3, 2, 1, 2];
                
                // Configurar gráfico de tendência
                this.data.charts.reboquesMaintenanceTrendChart = new Chart(ctx2, {
                    type: 'line',
                    data: {
                        labels: trendLabels,
                        datasets: [
                            {
                                label: 'Em manutenção',
                                data: maintenanceData,
                                borderColor: 'rgba(245, 158, 11, 1)',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.3
                            },
                            {
                                label: 'Em reforma',
                                data: reformData,
                                borderColor: 'rgba(239, 68, 68, 1)',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            title: {
                                display: false,
                                text: 'Tendência de Manutenção',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            },
                            datalabels: {
                                display: false
                            }
                        }
                    }
                });
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Atualizar tema dos gráficos
                this.updateChartsTheme();
            },
            
            // Atualizar tema dos gráficos
            updateChartsTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#f3f4f6' : '#333';
                const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
                
                // Atualizar todos os gráficos
                Object.values(this.data.charts).forEach(chart => {
                    if (!chart) return;
                    
                    // Atualizar as labels
                    if (chart.options.plugins && chart.options.plugins.legend) {
                        chart.options.plugins.legend.labels.color = textColor;
                    }
                    
                    if (chart.options.plugins && chart.options.plugins.title) {
                        chart.options.plugins.title.color = textColor;
                    }
                    
                    // Atualizar os eixos se for um gráfico com eixos
                    if (chart.options.scales) {
                        if (chart.options.scales.y) {
                            chart.options.scales.y.ticks.color = textColor;
                            chart.options.scales.y.grid.color = gridColor;
                        }
                        
                        if (chart.options.scales.x) {
                            chart.options.scales.x.ticks.color = textColor;
                            chart.options.scales.x.grid.color = gridColor;
                        }
                    }
                    
                    // Atualizar o gráfico
                    chart.update();
                });
            },
            
            // Inicializar charts de caminhões próprios 
            initCPCharts() {
                const ctx1 = document.getElementById('cp-status-chart');
                const ctx2 = document.getElementById('cp-status-evolution-chart');
                
                if (!ctx1 || !ctx2) return;
                
                // Dados para o gráfico de status
                const statusLabels = ['Operacional', 'Em manutenção', 'Em reforma', 'Emprestado'];
                const statusData = [
                    this.data.caminhoesProps.filter(item => item.status === 'Operacional').length,
                    this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length,
                    this.data.caminhoesProps.filter(item => item.status === 'Em reforma').length,
                    this.data.caminhoesProps.filter(item => item.status === 'Emprestado').length
                ];
                
                // Configurar gráfico de status
                this.data.charts.cpStatusChart = new Chart(ctx1, {
                    type: 'pie',
                    data: {
                        labels: statusLabels,
                        datasets: [{
                            data: statusData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',  // Verde
                                'rgba(245, 158, 11, 0.7)',  // Amarelo
                                'rgba(239, 68, 68, 0.7)',   // Vermelho
                                'rgba(59, 130, 246, 0.7)'   // Azul
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value, ctx) => {
                                    const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = (value * 100 / sum).toFixed(1) + '%';
                                    return percentage;
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            },
                            title: {
                                display: false,
                                text: 'Status dos Caminhões',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            }
                        }
                    }
                });
                
                // Dados para o gráfico de evolução de status
                const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'];
                
                // Dados simulados para evolução
                const operationalData = [15, 16, 17, 16, 18, 17];
                const maintenanceData = [4, 5, 3, 6, 4, 5];
                const borrowedData = [3, 2, 2, 1, 2, 3];
                
                // Configurar gráfico de evolução
                this.data.charts.cpStatusEvolutionChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: months,
                        datasets: [
                            {
                                label: 'Operacional',
                                data: operationalData,
                                backgroundColor: 'rgba(16, 185, 129, 0.7)',
                                borderColor: 'rgba(16, 185, 129, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Em manutenção',
                                data: maintenanceData,
                                backgroundColor: 'rgba(245, 158, 11, 0.7)',
                                borderColor: 'rgba(245, 158, 11, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Emprestado',
                                data: borrowedData,
                                backgroundColor: 'rgba(59, 130, 246, 0.7)',
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                stacked: true,
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                stacked: true,
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            title: {
                                display: false,
                                text: 'Evolução de Status',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            },
                            datalabels: {
                                display: false
                            }
                        }
                    }
                });
            },
            
            // Inicializar charts de caminhões terceirizados
            initCTCharts() {
                const ctx1 = document.getElementById('ct-owners-chart');
                const ctx2 = document.getElementById('ct-status-by-owner-chart');
                
                if (!ctx1 || !ctx2) return;
                
                // Obter proprietários únicos
                const owners = Array.from(new Set(this.data.caminhoesTerc.map(item => item.proprietario)));
                
                // Contar caminhões por proprietário
                const ownerCounts = owners.map(owner => {
                    return this.data.caminhoesTerc.filter(item => item.proprietario === owner).length;
                });
                
                // Limitar a 6 proprietários para o gráfico
                const topOwners = owners.map((owner, index) => ({ owner, count: ownerCounts[index] }))
                                      .sort((a, b) => b.count - a.count)
                                      .slice(0, 6);
                
                // Dados para o gráfico de proprietários
                const ownerLabels = topOwners.map(item => item.owner);
                const ownerData = topOwners.map(item => item.count);
                
                // Configurar gráfico de proprietários
                this.data.charts.ctOwnersChart = new Chart(ctx1, {
                    type: 'pie',
                    data: {
                        labels: ownerLabels,
                        datasets: [{
                            data: ownerData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',   // Verde
                                'rgba(245, 158, 11, 0.7)',   // Amarelo
                                'rgba(239, 68, 68, 0.7)',    // Vermelho
                                'rgba(59, 130, 246, 0.7)',   // Azul
                                'rgba(139, 92, 246, 0.7)',   // Roxo
                                'rgba(236, 72, 153, 0.7)'    // Rosa
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(139, 92, 246, 1)',
                                'rgba(236, 72, 153, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value, ctx) => {
                                    return value;
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            },
                            title: {
                                display: false,
                                text: 'Proprietários - Quantidade',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            }
                        }
                    }
                });
                
                // Dados para o gráfico de status por proprietário
                const topThreeOwners = topOwners.slice(0, 3).map(item => item.owner);
                
                // Calcular status por proprietário
                const statusByOwner = topThreeOwners.map(owner => {
                    const ownerTrucks = this.data.caminhoesTerc.filter(item => item.proprietario === owner);
                    return {
                        owner,
                        operational: ownerTrucks.filter(item => item.status === 'Operacional').length,
                        maintenance: ownerTrucks.filter(item => item.status === 'Em manutenção').length,
                        other: ownerTrucks.filter(item => !['Operacional', 'Em manutenção'].includes(item.status)).length
                    };
                });
                
                // Configurar gráfico de status por proprietário
                this.data.charts.ctStatusByOwnerChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: statusByOwner.map(item => item.owner),
                        datasets: [
                            {
                                label: 'Operacional',
                                data: statusByOwner.map(item => item.operational),
                                backgroundColor: 'rgba(16, 185, 129, 0.7)',
                                borderColor: 'rgba(16, 185, 129, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Em manutenção',
                                data: statusByOwner.map(item => item.maintenance),
                                backgroundColor: 'rgba(245, 158, 11, 0.7)',
                                borderColor: 'rgba(245, 158, 11, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Outros',
                                data: statusByOwner.map(item => item.other),
                                backgroundColor: 'rgba(59, 130, 246, 0.7)',
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                stacked: true,
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                stacked: true,
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            title: {
                                display: false,
                                text: 'Status por Proprietário',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            },
                            datalabels: {
                                display: false
                            }
                        }
                    }
                });
            },
            
            // Inicializar charts da frente 4001
            initF4001Charts() {
                const ctx1 = document.getElementById('f4001-status-chart');
                const ctx2 = document.getElementById('f4001-breakdown-chart');
                
                if (!ctx1 || !ctx2) return;
                
                // Combinar colhedoras e trações para status
                const allEquipment = [...this.data.frente4001Colhedoras, ...this.data.frente4001Tracoes];
                
                // Dados para o gráfico de status
                const statusLabels = ['Operacional', 'Em manutenção', 'Inoperante', 'Outros'];
                const statusData = [
                    allEquipment.filter(item => item.status === 'Operacional').length,
                    allEquipment.filter(item => item.status === 'Em manutenção').length,
                    allEquipment.filter(item => item.status === 'Inoperante').length,
                    allEquipment.filter(item => !['Operacional', 'Em manutenção', 'Inoperante'].includes(item.status)).length
                ];
                
                // Configurar gráfico de status
                this.data.charts.f4001StatusChart = new Chart(ctx1, {
                    type: 'doughnut',
                    data: {
                        labels: statusLabels,
                        datasets: [{
                            data: statusData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',  // Verde
                                'rgba(245, 158, 11, 0.7)',  // Amarelo
                                'rgba(239, 68, 68, 0.7)',   // Vermelho
                                'rgba(59, 130, 246, 0.7)'   // Azul
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value, ctx) => {
                                    const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = (value * 100 / sum).toFixed(1) + '%';
                                    return percentage;
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            },
                            title: {
                                display: false,
                                text: 'Status dos Equipamentos',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            }
                        }
                    }
                });
                
                // Dados para o gráfico de motivos de parada
                const breakdownLabels = ['Mecânico', 'Elétrico', 'Hidráulico', 'Operacional', 'Outros'];
                const breakdownData = [35, 25, 15, 18, 7]; // Percentuais simulados
                
                // Configurar gráfico de motivos de parada
                this.data.charts.f4001BreakdownChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: breakdownLabels,
                        datasets: [{
                            label: 'Motivos de Parada (%)',
                            data: breakdownData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',
                                'rgba(245, 158, 11, 0.7)',
                                'rgba(239, 68, 68, 0.7)',
                                'rgba(59, 130, 246, 0.7)',
                                'rgba(139, 92, 246, 0.7)'
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(139, 92, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    },
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            title: {
                                display: false,
                                text: 'Motivos de Parada',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value) => {
                                    return value + '%';
                                },
                                anchor: 'end',
                                align: 'top',
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            }
                        }
                    }
                });
            },
            
            // Inicializar charts da frente 4002
            initF4002Charts() {
                const ctx1 = document.getElementById('f4002-status-chart');
                const ctx2 = document.getElementById('f4002-breakdown-chart');
                
                if (!ctx1 || !ctx2) return;
                
                // Combinar colhedoras e trações para status
                const allEquipment = [...this.data.frente4002Colhedoras, ...this.data.frente4002Tracoes];
                
                // Dados para o gráfico de status
                const statusLabels = ['Operacional', 'Em manutenção', 'Inoperante', 'Outros'];
                const statusData = [
                    allEquipment.filter(item => item.status === 'Operacional').length,
                    allEquipment.filter(item => item.status === 'Em manutenção').length,
                    allEquipment.filter(item => item.status === 'Inoperante').length,
                    allEquipment.filter(item => !['Operacional', 'Em manutenção', 'Inoperante'].includes(item.status)).length
                ];
                
                // Configurar gráfico de status
                this.data.charts.f4002StatusChart = new Chart(ctx1, {
                    type: 'doughnut',
                    data: {
                        labels: statusLabels,
                        datasets: [{
                            data: statusData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',  // Verde
                                'rgba(245, 158, 11, 0.7)',  // Amarelo
                                'rgba(239, 68, 68, 0.7)',   // Vermelho
                                'rgba(59, 130, 246, 0.7)'   // Azul
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value, ctx) => {
                                    const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = (value * 100 / sum).toFixed(1) + '%';
                                    return percentage;
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            },
                            title: {
                                display: false,
                                text: 'Status dos Equipamentos',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            }
                        }
                    }
                });
                
                // Dados para o gráfico de motivos de parada
                const breakdownLabels = ['Mecânico', 'Elétrico', 'Hidráulico', 'Operacional', 'Outros'];
                const breakdownData = [30, 20, 25, 15, 10]; // Percentuais simulados
                
                // Configurar gráfico de motivos de parada
                this.data.charts.f4002BreakdownChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: breakdownLabels,
                        datasets: [{
                            label: 'Motivos de Parada (%)',
                            data: breakdownData,
                            backgroundColor: [
                                'rgba(16, 185, 129, 0.7)',
                                'rgba(245, 158, 11, 0.7)',
                                'rgba(239, 68, 68, 0.7)',
                                'rgba(59, 130, 246, 0.7)',
                                'rgba(139, 92, 246, 0.7)'
                            ],
                            borderColor: [
                                'rgba(16, 185, 129, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(139, 92, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    },
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            title: {
                                display: false,
                                text: 'Motivos de Parada',
                                color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                            },
                            datalabels: {
                                color: '#fff',
                                formatter: (value) => {
                                    return value + '%';
                                },
                                anchor: 'end',
                                align: 'top',
                                font: {
                                    weight: 'bold',
                                    size: 11
                                }
                            }
                        }
                    }
                });
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateCTDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                const operational = this.data.reboques.filter(item => item.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(item => item.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(item => item.status === 'Em reforma').length;
                
                const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                const reformPerc = total > 0 ? ((reform / total) * 100).toFixed(1) : 0;
                
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-operational-percentage').textContent = `${operationalPerc}%`;
                
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-maintenance-percentage').textContent = `${maintenancePerc}%`;
                
                document.getElementById('reboques-reform').textContent = reform;
                document.getElementById('reboques-reform-percentage').textContent = `${reformPerc}%`;
                
                document.getElementById('reboques-availability').textContent = `${operationalPerc}%`;
                
                // Atualizar gráficos
                if (this.data.charts.reboquesStatusChart) {
                    this.data.charts.reboquesStatusChart.data.datasets[0].data = [
                        operational,
                        maintenance,
                        reform,
                        total - operational - maintenance - reform
                    ];
                    this.data.charts.reboquesStatusChart.update();
                }
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                const total = this.data.caminhoesProps.length;
                const operational = this.data.caminhoesProps.filter(item => item.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length;
                const borrowed = this.data.caminhoesProps.filter(item => item.status === 'Emprestado').length;
                
                const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                const borrowedPerc = total > 0 ? ((borrowed / total) * 100).toFixed(1) : 0;
                
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-operational-percentage').textContent = `${operationalPerc}%`;
                
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-maintenance-percentage').textContent = `${maintenancePerc}%`;
                
                document.getElementById('cp-borrowed').textContent = borrowed;
                document.getElementById('cp-borrowed-percentage').textContent = `${borrowedPerc}%`;
                
                document.getElementById('cp-avg-time').textContent = '5d';
                
                // Atualizar gráficos
                if (this.data.charts.cpStatusChart) {
                    this.data.charts.cpStatusChart.data.datasets[0].data = [
                        operational,
                        maintenance,
                        this.data.caminhoesProps.filter(item => item.status === 'Em reforma').length,
                        borrowed
                    ];
                    this.data.charts.cpStatusChart.update();
                }
            },
            
            // Atualizar dashboard de caminhões terceiros
            updateCTDashboard() {
                const total = this.data.caminhoesTerc.length;
                const operational = this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length;
                const maintenance = this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção').length;
                
                // Contar proprietários únicos
                const owners = new Set(this.data.caminhoesTerc.map(item => item.proprietario)).size;
                
                // Contar reboques acoplados
                const coupledTrailers = this.data.caminhoesTerc.filter(item => item.reboques && item.reboques.trim() !== '').length;
                
                const operationalPerc = total > 0 ? ((operational / total) * 100).toFixed(1) : 0;
                const maintenancePerc = total > 0 ? ((maintenance / total) * 100).toFixed(1) : 0;
                
                document.getElementById('ct-operational').textContent = operational;
                document.getElementById('ct-operational-percentage').textContent = `${operationalPerc}%`;
                
                document.getElementById('ct-maintenance').textContent = maintenance;
                document.getElementById('ct-maintenance-percentage').textContent = `${maintenancePerc}%`;
                
                document.getElementById('ct-owners').textContent = owners;
                document.getElementById('ct-coupled-trailers').textContent = coupledTrailers;
                
                // Atualizar gráficos é mais complexo aqui devido ao agrupamento por proprietário
                // Eles serão atualizados apenas quando os dados forem recarregados
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                const totalColhedoras = this.data.frente4001Colhedoras.length;
                const operationalColhedoras = this.data.frente4001Colhedoras.filter(item => item.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4001Tracoes.length;
                const operationalTracoes = this.data.frente4001Tracoes.filter(item => item.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4001Colhedoras.filter(item => item.status === 'Em manutenção').length + 
                                        this.data.frente4001Tracoes.filter(item => item.status === 'Em manutenção').length;
                
                const colhedorasPerc = totalColhedoras > 0 ? ((operationalColhedoras / totalColhedoras) * 100).toFixed(1) : 0;
                const tracoesPerc = totalTracoes > 0 ? ((operationalTracoes / totalTracoes) * 100).toFixed(1) : 0;
                
                const totalEquipment = totalColhedoras + totalTracoes;
                const totalOperational = operationalColhedoras + operationalTracoes;
                const availabilityPerc = totalEquipment > 0 ? ((totalOperational / totalEquipment) * 100).toFixed(1) : 0;
                
                document.getElementById('f4001-colhedoras-ok').textContent = operationalColhedoras;
                document.getElementById('f4001-colhedoras-percentage').textContent = `${colhedorasPerc}%`;
                
                document.getElementById('f4001-tracoes-ok').textContent = operationalTracoes;
                document.getElementById('f4001-tracoes-percentage').textContent = `${tracoesPerc}%`;
                
                document.getElementById('f4001-maintenance').textContent = totalMaintenance;
                document.getElementById('f4001-maintenance-percentage').textContent = `${(totalMaintenance / totalEquipment * 100).toFixed(1)}%`;
                
                document.getElementById('f4001-availability').textContent = `${availabilityPerc}%`;
                
                // Atualizar gráficos
                if (this.data.charts.f4001StatusChart) {
                    const allEquipment = [...this.data.frente4001Colhedoras, ...this.data.frente4001Tracoes];
                    
                    this.data.charts.f4001StatusChart.data.datasets[0].data = [
                        allEquipment.filter(item => item.status === 'Operacional').length,
                        allEquipment.filter(item => item.status === 'Em manutenção').length,
                        allEquipment.filter(item => item.status === 'Inoperante').length,
                        allEquipment.filter(item => !['Operacional', 'Em manutenção', 'Inoperante'].includes(item.status)).length
                    ];
                    this.data.charts.f4001StatusChart.update();
                }
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                const totalColhedoras = this.data.frente4002Colhedoras.length;
                const operationalColhedoras = this.data.frente4002Colhedoras.filter(item => item.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4002Tracoes.length;
                const operationalTracoes = this.data.frente4002Tracoes.filter(item => item.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4002Colhedoras.filter(item => item.status === 'Em manutenção').length + 
                                        this.data.frente4002Tracoes.filter(item => item.status === 'Em manutenção').length;
                
                const colhedorasPerc = totalColhedoras > 0 ? ((operationalColhedoras / totalColhedoras) * 100).toFixed(1) : 0;
                const tracoesPerc = totalTracoes > 0 ? ((operationalTracoes / totalTracoes) * 100).toFixed(1) : 0;
                
                const totalEquipment = totalColhedoras + totalTracoes;
                const totalOperational = operationalColhedoras + operationalTracoes;
                const availabilityPerc = totalEquipment > 0 ? ((totalOperational / totalEquipment) * 100).toFixed(1) : 0;
                
                document.getElementById('f4002-colhedoras-ok').textContent = operationalColhedoras;
                document.getElementById('f4002-colhedoras-percentage').textContent = `${colhedorasPerc}%`;
                
                document.getElementById('f4002-tracoes-ok').textContent = operationalTracoes;
                document.getElementById('f4002-tracoes-percentage').textContent = `${tracoesPerc}%`;
                
                document.getElementById('f4002-maintenance').textContent = totalMaintenance;
                document.getElementById('f4002-maintenance-percentage').textContent = `${(totalMaintenance / totalEquipment * 100).toFixed(1)}%`;
                
                document.getElementById('f4002-availability').textContent = `${availabilityPerc}%`;
                
                // Atualizar gráficos
                if (this.data.charts.f4002StatusChart) {
                    const allEquipment = [...this.data.frente4002Colhedoras, ...this.data.frente4002Tracoes];
                    
                    this.data.charts.f4002StatusChart.data.datasets[0].data = [
                        allEquipment.filter(item => item.status === 'Operacional').length,
                        allEquipment.filter(item => item.status === 'Em manutenção').length,
                        allEquipment.filter(item => item.status === 'Inoperante').length,
                        allEquipment.filter(item => !['Operacional', 'Em manutenção', 'Inoperante'].includes(item.status)).length
                    ];
                    this.data.charts.f4002StatusChart.update();
                }
            },
            
            // Atualizar informações do dashboard detalhado
            updateDashboardDetails() {
                // Disponibilidade geral
                const totalEquipment = this.data.reboques.length + 
                                     this.data.caminhoesProps.length + 
                                     this.data.caminhoesTerc.length +
                                     this.data.frente4001Colhedoras.length +
                                     this.data.frente4001Tracoes.length +
                                     this.data.frente4002Colhedoras.length +
                                     this.data.frente4002Tracoes.length;
                
                const operationalEquipment = this.data.reboques.filter(item => item.status === 'Operacional').length +
                                           this.data.caminhoesProps.filter(item => item.status === 'Operacional').length +
                                           this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length +
                                           this.data.frente4001Colhedoras.filter(item => item.status === 'Operacional').length +
                                           this.data.frente4001Tracoes.filter(item => item.status === 'Operacional').length +
                                           this.data.frente4002Colhedoras.filter(item => item.status === 'Operacional').length +
                                           this.data.frente4002Tracoes.filter(item => item.status === 'Operacional').length;
                
                const availabilityPerc = totalEquipment > 0 ? ((operationalEquipment / totalEquipment) * 100).toFixed(1) : 0;
                
                // Equipamentos em manutenção
                const maintenanceEquipment = this.data.reboques.filter(item => item.status === 'Em manutenção').length +
                                           this.data.caminhoesProps.filter(item => item.status === 'Em manutenção').length +
                                           this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção').length +
                                           this.data.frente4001Colhedoras.filter(item => item.status === 'Em manutenção').length +
                                           this.data.frente4001Tracoes.filter(item => item.status === 'Em manutenção').length +
                                           this.data.frente4002Colhedoras.filter(item => item.status === 'Em manutenção').length +
                                           this.data.frente4002Tracoes.filter(item => item.status === 'Em manutenção').length;
                
                // Equipamentos críticos (aqueles em reforma)
                const criticalEquipment = this.data.reboques.filter(item => item.status === 'Em reforma').length +
                                        this.data.caminhoesProps.filter(item => item.status === 'Em reforma').length +
                                        this.data.frente4001Colhedoras.filter(item => item.status === 'Inoperante').length +
                                        this.data.frente4001Tracoes.filter(item => item.status === 'Inoperante').length +
                                        this.data.frente4002Colhedoras.filter(item => item.status === 'Inoperante').length +
                                        this.data.frente4002Tracoes.filter(item => item.status === 'Inoperante').length;
                
                // Atualizar estatísticas do dashboard
                document.getElementById('dash-availability').textContent = `${availabilityPerc}%`;
                document.getElementById('dash-avg-maintenance').textContent = '5.3d';
                document.getElementById('dash-total-equipment').textContent = totalEquipment;
                document.getElementById('dash-critical-equipment').textContent = criticalEquipment;
                
                // Gerar top 5 equipamentos em manutenção
                const maintenanceList = [
                    ...this.data.reboques.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.frota || item.acoplado, type: 'Reboque', days: this.calculateDays(item.dataParada), motivo: item.motivo })),
                    ...this.data.caminhoesProps.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.caminhao, type: 'Caminhão', days: this.calculateDays(item.data), motivo: item.motivo })),
                    ...this.data.caminhoesTerc.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.caminhao, type: 'Cam. Terceiro', days: 3, motivo: item.motivo })),
                    ...this.data.frente4001Colhedoras.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.codigo, type: 'Colhedora', days: this.calculateDays(item.data), motivo: item.motivo })),
                    ...this.data.frente4001Tracoes.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.codigo, type: 'Tração', days: this.calculateDays(item.data), motivo: item.motivo })),
                    ...this.data.frente4002Colhedoras.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.codigo, type: 'Colhedora', days: this.calculateDays(item.data), motivo: item.motivo })),
                    ...this.data.frente4002Tracoes.filter(item => item.status === 'Em manutenção')
                        .map(item => ({ id: item.codigo, type: 'Tração', days: this.calculateDays(item.data), motivo: item.motivo }))
                ];
                
                // Ordenar por dias e pegar os 5 primeiros
                const top5Maintenance = maintenanceList.sort((a, b) => b.days - a.days).slice(0, 5);
                
                // Atualizar lista de top 5 em manutenção
                const topMaintenanceList = document.getElementById('top-maintenance-list');
                topMaintenanceList.innerHTML = '';
                
                if (top5Maintenance.length === 0) {
                    topMaintenanceList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção</span>
                        </li>
                    `;
                } else {
                    top5Maintenance.forEach(item => {
                        const li = document.createElement('li');
                        li.className = 'py-2 flex justify-between';
                        li.innerHTML = `
                            <span class="text-sm">${item.type} ${item.id} <span class="text-gray-500 dark:text-gray-400">${item.days}d</span></span>
                            <span class="text-sm text-yellow-500" title="${item.motivo || 'Sem motivo especificado'}">${this.truncateText(item.motivo || '', 15)}</span>
                        `;
                        topMaintenanceList.appendChild(li);
                    });
                }
                
                // Gerar próximas manutenções agendadas
                const upcomingList = document.getElementById('upcoming-maintenance-list');
                upcomingList.innerHTML = '';
                
                // Filtrar datas futuras
                const now = new Date();
                const today = now.toISOString().split('T')[0];
                const upcomingMaintenance = this.data.schedules
                    .filter(schedule => schedule.date >= today)
                    .sort((a, b) => new Date(a.date) - new Date(b.date))
                    .slice(0, 5);
                
                if (upcomingMaintenance.length === 0) {
                    upcomingList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada</span>
                        </li>
                    `;
                } else {
                    upcomingMaintenance.forEach(schedule => {
                        const date = new Date(schedule.date).toLocaleDateString('pt-BR');
                        const li = document.createElement('li');
                        li.className = 'py-2 flex justify-between';
                        li.innerHTML = `
                            <span class="text-sm">${schedule.equipmentType.split(' ')[0]} ${schedule.equipment} <span class="text-gray-500 dark:text-gray-400">${date}</span></span>
                            <span class="text-sm text-blue-500">${this.getMaintenanceTypeName(schedule.type)}</span>
                        `;
                        upcomingList.appendChild(li);
                    });
                }
            },
            
            // Truncar texto para exibição
            truncateText(text, maxLength) {
                if (!text) return '';
                return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
            },
            
            // Calcular dias desde uma data
            calculateDays(dateStr) {
                if (!dateStr) return 1;
                
                const date = new Date(dateStr);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                return diffDays || 1;
            },
            
            // Atualizar os gráficos do dashboard detalhado
            updateDashboardCharts() {
                // Obter o período selecionado
                const period = document.getElementById('dashboard-date-range').value;
                this.data.dashboardPeriod = period;
                
                // Configurar gráficos do dashboard
                this.initializeDashboardCharts();
            },
            
            // Inicializar gráficos do dashboard detalhado
            initializeDashboardCharts() {
                // Gráfico de disponibilidade por categoria
                const availabilityChart = document.getElementById('availability-chart');
                if (availabilityChart) {
                    const reboquesOp = this.data.reboques.filter(item => item.status === 'Operacional').length;
                    const reboquesTotal = this.data.reboques.length;
                    const cpOp = this.data.caminhoesProps.filter(item => item.status === 'Operacional').length;
                    const cpTotal = this.data.caminhoesProps.length;
                    const ctOp = this.data.caminhoesTerc.filter(item => item.status === 'Operacional').length;
                    const ctTotal = this.data.caminhoesTerc.length;
                    const colhedorasOp = this.data.frente4001Colhedoras.filter(item => item.status === 'Operacional').length + 
                                        this.data.frente4002Colhedoras.filter(item => item.status === 'Operacional').length;
                    const colhedorasTotal = this.data.frente4001Colhedoras.length + this.data.frente4002Colhedoras.length;
                    const tracoesOp = this.data.frente4001Tracoes.filter(item => item.status === 'Operacional').length + 
                                     this.data.frente4002Tracoes.filter(item => item.status === 'Operacional').length;
                    const tracoesTotal = this.data.frente4001Tracoes.length + this.data.frente4002Tracoes.length;
                    
                    const reboquesPerc = reboquesTotal > 0 ? (reboquesOp / reboquesTotal * 100).toFixed(1) : 0;
                    const cpPerc = cpTotal > 0 ? (cpOp / cpTotal * 100).toFixed(1) : 0;
                    const ctPerc = ctTotal > 0 ? (ctOp / ctTotal * 100).toFixed(1) : 0;
                    const colhedorasPerc = colhedorasTotal > 0 ? (colhedorasOp / colhedorasTotal * 100).toFixed(1) : 0;
                    const tracoesPerc = tracoesTotal > 0 ? (tracoesOp / tracoesTotal * 100).toFixed(1) : 0;
                    
                    if (this.data.charts.availabilityChart) {
                        this.data.charts.availabilityChart.destroy();
                    }
                    
                    this.data.charts.availabilityChart = new Chart(availabilityChart, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Colhedoras', 'Trações'],
                            datasets: [{
                                label: 'Disponibilidade (%)',
                                data: [reboquesPerc, cpPerc, ctPerc, colhedorasPerc, tracoesPerc],
                                backgroundColor: [
                                    'rgba(16, 185, 129, 0.7)',  // Verde
                                    'rgba(245, 158, 11, 0.7)',  // Amarelo
                                    'rgba(239, 68, 68, 0.7)',   // Vermelho
                                    'rgba(59, 130, 246, 0.7)',  // Azul
                                    'rgba(139, 92, 246, 0.7)'   // Roxo
                                ],
                                borderColor: [
                                    'rgba(16, 185, 129, 1)',
                                    'rgba(245, 158, 11, 1)',
                                    'rgba(239, 68, 68, 1)',
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(139, 92, 246, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        callback: function(value) {
                                            return value + '%';
                                        },
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    },
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    },
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: false,
                                    text: 'Disponibilidade por Categoria',
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                datalabels: {
                                    color: '#fff',
                                    formatter: (value) => {
                                        return value + '%';
                                    },
                                    anchor: 'end',
                                    align: 'top',
                                    font: {
                                        weight: 'bold',
                                        size: 11
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de motivos de manutenção
                const maintenanceReasonsChart = document.getElementById('maintenance-reasons-chart');
                if (maintenanceReasonsChart) {
                    if (this.data.charts.maintenanceReasonsChart) {
                        this.data.charts.maintenanceReasonsChart.destroy();
                    }
                    
                    this.data.charts.maintenanceReasonsChart = new Chart(maintenanceReasonsChart, {
                        type: 'doughnut',
                        data: {
                            labels: ['Mecânico', 'Elétrico', 'Hidráulico', 'Estrutural', 'Preventiva', 'Outros'],
                            datasets: [{
                                data: [30, 20, 15, 12, 18, 5],
                                backgroundColor: [
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(245, 158, 11, 0.7)',
                                    'rgba(239, 68, 68, 0.7)',
                                    'rgba(59, 130, 246, 0.7)',
                                    'rgba(139, 92, 246, 0.7)',
                                    'rgba(75, 85, 99, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(16, 185, 129, 1)',
                                    'rgba(245, 158, 11, 1)',
                                    'rgba(239, 68, 68, 1)',
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(139, 92, 246, 1)',
                                    'rgba(75, 85, 99, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        boxWidth: 12,
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    }
                                },
                                datalabels: {
                                    color: '#fff',
                                    formatter: (value, ctx) => {
                                        const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = (value * 100 / sum).toFixed(1) + '%';
                                        return percentage;
                                    },
                                    font: {
                                        weight: 'bold',
                                        size: 11
                                    }
                                },
                                title: {
                                    display: false,
                                    text: 'Motivos de Manutenção',
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de tendências de status
                const statusTrendsChart = document.getElementById('status-trends-chart');
                if (statusTrendsChart) {
                    if (this.data.charts.statusTrendsChart) {
                        this.data.charts.statusTrendsChart.destroy();
                    }
                    
                    // Últimas 6 semanas
                    const labels = ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4', 'Semana 5', 'Semana 6'];
                    
                    this.data.charts.statusTrendsChart = new Chart(statusTrendsChart, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: [60, 65, 68, 64, 70, 75],
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Em manutenção',
                                    data: [25, 22, 20, 26, 20, 15],
                                    borderColor: 'rgba(245, 158, 11, 1)',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Em reforma',
                                    data: [10, 8, 7, 6, 6, 6],
                                    borderColor: 'rgba(239, 68, 68, 1)',
                                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Outros',
                                    data: [5, 5, 5, 4, 4, 4],
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        callback: function(value) {
                                            return value + '%';
                                        },
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    },
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    },
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        boxWidth: 12,
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    }
                                },
                                title: {
                                    display: false,
                                    text: 'Tendências de Status por Semana',
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                },
                                datalabels: {
                                    display: false
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de propriedade dos equipamentos
                const ownershipChart = document.getElementById('ownership-chart');
                if (ownershipChart) {
                    if (this.data.charts.ownershipChart) {
                        this.data.charts.ownershipChart.destroy();
                    }
                    
                    this.data.charts.ownershipChart = new Chart(ownershipChart, {
                        type: 'pie',
                        data: {
                            labels: ['Próprios', 'Terceirizados'],
                            datasets: [{
                                data: [
                                    this.data.reboques.length + this.data.caminhoesProps.length + 
                                    this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length + 
                                    this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length,
                                    this.data.caminhoesTerc.length
                                ],
                                backgroundColor: [
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(59, 130, 246, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(16, 185, 129, 1)',
                                    'rgba(59, 130, 246, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        boxWidth: 12,
                                        color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                    }
                                },
                                datalabels: {
                                    color: '#fff',
                                    formatter: (value, ctx) => {
                                        const sum = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                        const percentage = (value * 100 / sum).toFixed(1) + '%';
                                        return percentage;
                                    },
                                    font: {
                                        weight: 'bold',
                                        size: 11
                                    }
                                },
                                title: {
                                    display: false,
                                    text: 'Propriedade dos Equipamentos',
                                    color: document.documentElement.classList.contains('dark') ? '#f3f4f6' : '#333'
                                }
                            }
                        }
                    });
                }
            },
            
            // Inicializar visualização real dos equipamentos
            initializeRealEquipmentView() {
                // Gerar cards de equipamentos
                const grid = document.getElementById('real-equipment-grid');
                grid.innerHTML = '';
                
                // Adicionar todos os tipos de equipamentos
                this.addRealEquipmentCards(grid, 'reboques');
                this.addRealEquipmentCards(grid, 'caminhoes-proprios');
                this.addRealEquipmentCards(grid, 'caminhoes-terceiros');
                this.addRealEquipmentCards(grid, 'frente-4001');
                this.addRealEquipmentCards(grid, 'frente-4002');
            },
            
            // Adicionar cards de equipamentos para visualização real
            addRealEquipmentCards(grid, type) {
                if (type === 'reboques') {
                    this.data.reboques.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-reboques`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-trailer text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.frota || item.acoplado || 'Reboque'}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">${item.tipo || 'REBOQUE'}</p>
                            ${item.acoplado ? `<p class="text-sm text-gray-600 dark:text-gray-400">Acoplado: ${item.acoplado}</p>` : ''}
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Reboque', item);
                        });
                        
                        grid.appendChild(card);
                    });
                } else if (type === 'caminhoes-proprios') {
                    this.data.caminhoesProps.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-caminhoes-proprios`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-truck text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.caminhao}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Caminhão Próprio</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Caminhão Próprio', item);
                        });
                        
                        grid.appendChild(card);
                    });
                } else if (type === 'caminhoes-terceiros') {
                    this.data.caminhoesTerc.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-caminhoes-terceiros`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-truck-moving text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.caminhao}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">${this.truncateText(item.proprietario, 20)}</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Caminhão Terceiro', item);
                        });
                        
                        grid.appendChild(card);
                    });
                } else if (type === 'frente-4001') {
                    this.data.frente4001Colhedoras.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-frente-4001`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-tractor text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.codigo}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Colhedora Frente 4001</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Colhedora Frente 4001', item);
                        });
                        
                        grid.appendChild(card);
                    });
                    
                    this.data.frente4001Tracoes.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-frente-4001`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-truck-monster text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.codigo}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Tração Frente 4001</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Tração Frente 4001', item);
                        });
                        
                        grid.appendChild(card);
                    });
                } else if (type === 'frente-4002') {
                    this.data.frente4002Colhedoras.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-frente-4002`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-tractor text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.codigo}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Colhedora Frente 4002</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Colhedora Frente 4002', item);
                        });
                        
                        grid.appendChild(card);
                    });
                    
                    this.data.frente4002Tracoes.forEach(item => {
                        const statusClass = this.getEquipmentCardClass(item.status);
                        const card = document.createElement('div');
                        card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${statusClass} data-type-frente-4002`;
                        card.innerHTML = `
                            <div class="h-28 w-full flex items-center justify-center mb-3 bg-gray-100 dark:bg-gray-800 rounded-md">
                                <i class="fas fa-truck-monster text-4xl text-gray-500 dark:text-gray-400"></i>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <h3 class="font-semibold">${item.codigo}</h3>
                                <span class="text-xs px-2 py-1 rounded-full ${this.getStatusBadgeClass(item.status)}">${item.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Tração Frente 4002</p>
                            ${item.motivo ? `<p class="text-xs mt-2 text-yellow-600 dark:text-yellow-400 truncate">${item.motivo}</p>` : ''}
                        `;
                        
                        card.addEventListener('click', () => {
                            this.showEquipmentDetails('Tração Frente 4002', item);
                        });
                        
                        grid.appendChild(card);
                    });
                }
            },
            
            // Obter classe para card de equipamento
            getEquipmentCardClass(status) {
                switch(status.toLowerCase()) {
                    case 'operacional':
                        return 'operational';
                    case 'em manutenção':
                    case 'aguardando reforma':
                        return 'maintenance';
                    case 'em reforma':
                    case 'inoperante':
                        return 'reform';
                    default:
                        return 'other';
                }
            },
            
            // Obter classe para badge de status
            getStatusBadgeClass(status) {
                switch(status.toLowerCase()) {
                    case 'operacional':
                        return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
                    case 'em manutenção':
                    case 'aguardando reforma':
                        return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                    case 'em reforma':
                    case 'inoperante':
                        return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';
                    default:
                        return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                }
            },
            
            // Filtrar equipamentos na visualização real
            filterRealEquipment(filter) {
                const cards = document.querySelectorAll('.equipment-card');
                
                if (filter === 'all') {
                    cards.forEach(card => {
                        card.style.display = 'block';
                    });
                } else {
                    cards.forEach(card => {
                        if (card.classList.contains(`data-type-${filter}`)) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                }
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                const notification = document.createElement('div');
                notification.className = 'notification bg-white dark:bg-gray-800 rounded-lg shadow-lg border-l-4 p-4 mb-3 max-w-md';
                
                let borderColor, iconClass;
                
                switch(type) {
                    case 'success':
                        borderColor = 'border-green-500';
                        iconClass = 'fas fa-check-circle text-green-500';
                        break;
                    case 'error':
                        borderColor = 'border-red-500';
                        iconClass = 'fas fa-exclamation-circle text-red-500';
                        break;
                    case 'warning':
                        borderColor = 'border-yellow-500';
                        iconClass = 'fas fa-exclamation-triangle text-yellow-500';
                        break;
                    case 'info':
                    default:
                        borderColor = 'border-blue-500';
                        iconClass = 'fas fa-info-circle text-blue-500';
                }
                
                notification.classList.add(borderColor);
                
                notification.innerHTML = `
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="${iconClass} text-xl"></i>
                        </div>
                        <div class="ml-3 flex-grow">
                            <p class="font-medium">${title}</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400">${message}</p>
                        </div>
                        <button class="close-notification text-gray-400 hover:text-gray-500 focus:outline-none">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                container.appendChild(notification);
                
                // Remover automaticamente após 5 segundos
                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }
        };
        
        // Inicializar a aplicação quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            APP.init();
        });
    </script>
</body>
</html>