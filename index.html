<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Frota e Manutenção</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#5D5CDE',
                            dark: '#4B4ACB'
                        },
                        gray: {
                            750: '#2B3544'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Estilos personalizados */
        .sidebar-link {
            transition: all 0.2s;
        }
        
        .sidebar-link:hover {
            background-color: rgba(93, 92, 222, 0.1);
        }
        
        .sidebar-link.active {
            background-color: rgba(93, 92, 222, 0.1);
            border-left: 3px solid #5D5CDE;
        }
        
        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-badge-operational {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }
        
        .status-badge-maintenance {
            background-color: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }
        
        .status-badge-reform {
            background-color: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }
        
        .status-badge-other {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6B7280;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
        }
        
        /* Estilos para impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            
            #print-area, #print-area * {
                visibility: visible;
            }
            
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .pdf-page-break {
                page-break-after: always;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        /* Animação para notificações */
        .notification {
            animation: slide-in 0.3s ease-out;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        @keyframes slide-in {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white min-h-screen">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside class="sidebar w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 fixed h-full z-30 shadow-sm">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-truck-moving text-primary text-xl mr-2"></i>
                    <h1 class="text-lg font-bold truncate">Gestão de Frota</h1>
                </div>
                <button id="close-sidebar" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="py-4">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Dashboard</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white active" data-target="main-dashboard">
                    <i class="fas fa-tachometer-alt w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Dashboard Principal</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="detailed-dashboard">
                    <i class="fas fa-chart-line w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Dashboard Detalhado</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="real-equipment-view">
                    <i class="fas fa-eye w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Visualização Real</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Equipamentos</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="reboques">
                    <i class="fas fa-trailer w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Reboques</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-proprios">
                    <i class="fas fa-truck w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Caminhões Próprios</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-terceiros">
                    <i class="fas fa-truck-moving w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Caminhões Terceiros</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4001">
                    <i class="fas fa-tractor w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Frente 4001</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4002">
                    <i class="fas fa-tractor w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Frente 4002</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Sistema</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-cog w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Configurações</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-question-circle w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Ajuda</span>
                </a>
            </div>
            
            <div class="mt-auto p-4 border-t border-gray-200 dark:border-gray-700">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="ml-2">
                        <p class="text-sm font-medium">Administrador</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">admin@exemplo.com</p>
                    </div>
                    <button class="ml-auto text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden ml-0 md:ml-64">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm p-4 flex items-center">
                <button id="sidebar-toggle" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white mr-3">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav class="hidden md:flex flex-1">
                    <ol class="flex items-center text-sm">
                        <li><a href="#" class="text-primary hover:text-primary-dark">Início</a></li>
                        <li class="mx-2 text-gray-500 dark:text-gray-400">/</li>
                        <li class="text-gray-500 dark:text-gray-400" id="current-page">Dashboard</li>
                    </ol>
                </nav>
                
                <div class="flex items-center ml-auto">
                    <button id="theme-toggle" class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                    
                    <button class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2 relative">
                        <i class="fas fa-bell"></i>
                        <span class="absolute top-1 right-1 w-2 h-2 bg-primary rounded-full"></span>
                    </button>
                    
                    <div class="relative ml-2">
                        <button id="action-menu-btn" class="flex items-center text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                            <span class="mr-1">Ações</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        
                        <div id="action-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-750 rounded-md shadow-lg z-10 border border-gray-200 dark:border-gray-700 hidden">
                            <div class="py-1">
                                <button id="add-equipment-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-plus text-gray-500 dark:text-gray-400 mr-2"></i> Adicionar Equipamento
                                </button>
                                <button id="export-csv-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-file-csv text-gray-500 dark:text-gray-400 mr-2"></i> Exportar para CSV
                                </button>
                                <button id="export-backup-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-download text-gray-500 dark:text-gray-400 mr-2"></i> Exportar Backup (JSON)
                                </button>
                                <button id="print-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-print text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Tabela
                                </button>
                                <button id="print-dashboard-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-chart-bar text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Dashboard
                                </button>
                                <button id="pdf-report-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-file-pdf text-gray-500 dark:text-gray-400 mr-2"></i> Gerar Relatório PDF
                                </button>
                                <button id="import-backup-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-upload text-gray-500 dark:text-gray-400 mr-2"></i> Importar Backup
                                </button>
                                <button id="clear-data-btn" class="w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900">
                                    <i class="fas fa-trash-alt text-red-500 dark:text-red-400 mr-2"></i> Excluir Todos os Registros
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Área de conteúdo principal -->
            <main class="flex-1 overflow-y-auto p-5">
                <!-- Conteúdo das tabs -->
                
                <!-- Dashboard principal -->
                <div id="main-dashboard" class="tab-content active">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Dashboard</h2>
                        
                        <!-- Resumo -->
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
                            <div class="col-span-1 md:col-span-3 lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-medium mb-3">Resumo da Frota</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <p class="text-2xl font-bold text-green-500" id="dash-summary-operational">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <p class="text-2xl font-bold text-yellow-500" id="dash-summary-maintenance">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Em Reforma</p>
                                        <p class="text-2xl font-bold text-red-500" id="dash-summary-reform">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Emprestados</p>
                                        <p class="text-2xl font-bold text-blue-500" id="dash-summary-borrowed">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Outros</p>
                                        <p class="text-2xl font-bold text-gray-500" id="dash-summary-other">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                        <p class="text-2xl font-bold text-primary" id="dash-summary-availability">0%</p>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-primary rounded-full" id="dash-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Disponibilidade global -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="text-base font-medium">Frota Total</h3>
                                    <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                        <span class="w-3 h-3 rounded-full bg-green-500 mr-1"></span>
                                        <span id="dash-global-operational-percent">0%</span>
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <p class="text-3xl font-bold mb-1" id="dash-global-total">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Equipamentos</p>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <div>
                                        <span class="text-green-500 font-medium" id="dash-global-operational">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Operacionais</span>
                                    </div>
                                    <div>
                                        <span class="text-yellow-500 font-medium" id="dash-global-maintenance">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Em Manutenção</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Cards -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                                        <i class="fas fa-trailer text-blue-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Reboques</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-reboques-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-reboques-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-reboques-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="dash-reboques-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                                        <i class="fas fa-truck text-green-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Caminhões</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-cp-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-cp-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-cp-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="dash-cp-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-orange-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Frente 4001</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-f4001-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4001-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4001-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="dash-f4001-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-red-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Frente 4002</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-f4002-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4002-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4002-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="dash-f4002-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos e tabelas -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
                            <!-- Gráfico principal -->
                            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Status por Categoria</h3>
                                </div>
                                <div class="relative h-64">
                                    <canvas id="status-by-category-chart"></canvas>
                                    <div id="status-category-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Gráfico de disponibilidade -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Disponibilidade</h3>
                                </div>
                                <div class="relative h-64">
                                    <canvas id="availability-chart"></canvas>
                                    <div id="availability-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Listas de informações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Equipamentos em manutenção -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Equipamentos em Manutenção</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="equipment-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Manutenções agendadas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Próximas Manutenções Agendadas</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="upcoming-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard detalhado -->
                <div id="detailed-dashboard" class="tab-content bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Dashboard Detalhado</h2>
                        <button id="detailed-refresh-btn" class="btn-primary-outline">
                            <i class="fas fa-sync-alt mr-2"></i>Atualizar
                        </button>
                    </div>
                    
                    <!-- Resumo geral -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <!-- Total de equipamentos -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mr-4">
                                    <i class="fas fa-truck-moving text-primary text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Equipamentos</h3>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="detailed-total-equipment">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Disponibilidade geral -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Disponibilidade Geral</h3>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mb-2" id="detailed-operational-percentage">0%</p>
                            <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500 rounded-full" id="detailed-operational-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <!-- Total em manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                                    <i class="fas fa-tools text-yellow-500 text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Manutenção</h3>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="detailed-total-maintenances">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Painel com gráficos -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <!-- Distribuição de status -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Distribuição de Status por Categoria</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-status-distribution-chart"></canvas>
                                <div id="detailed-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tendência de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Tendência de Disponibilidade</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-availability-trend-chart"></canvas>
                                <div id="detailed-trend-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Análise por categoria -->
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Análise por Categoria</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            <!-- Reboques -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-trailer text-blue-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Reboques</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-reboques-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-reboques-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-reboques-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="detailed-reboques-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Próprios -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck text-green-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Caminhões Próprios</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-cp-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-cp-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-cp-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="detailed-cp-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Terceiros -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-moving text-purple-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Caminhões Terceiros</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-ct-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-ct-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-ct-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-purple-500 rounded-full" id="detailed-ct-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4001 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <!-- Frente 4001 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-orange-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4001 - Colhedoras</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-colh-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4001-colh-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4001-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4001 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-orange-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4001 - Trações</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-trac-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4001-trac-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4001-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4002 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <!-- Frente 4002 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-red-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4002 - Colhedoras</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-colh-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4002-colh-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4002-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4002 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-red-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4002 - Trações</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-trac-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4002-trac-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4002-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs -->
                    <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-6">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Indicadores de Desempenho</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">MTBF (Tempo Médio Entre Falhas)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-mtbf">-</p>
                            </div>
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">MTTR (Tempo Médio Para Reparo)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-mttr">-</p>
                            </div>
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">OEE (Eficácia Global do Equipamento)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-oee">-</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos adicionais -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Causas de manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Causas de Manutenção</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-maintenance-causes-chart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Previsão de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Previsão de Disponibilidade</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-forecast-chart"></canvas>
                                <div id="detailed-forecast-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Dados insuficientes para previsão</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Visualização Real da Frota -->
                <div id="real-equipment-view" class="tab-content hidden">
                    <div class="mb-6">
                        <div class="flex flex-wrap justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Visualização Real da Frota</h2>
                            <p class="mt-2 md:mt-0 text-gray-500 dark:text-gray-400" id="real-equipment-count">0 equipamentos</p>
                        </div>
                        
                        <!-- Filtros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <h3 class="text-base font-medium mb-3">Filtros</h3>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="APP.filterRealEquipment('all')" class="px-3 py-1 bg-primary text-white rounded-md text-sm hover:bg-primary-dark transition">
                                    Todos
                                </button>
                                <button onclick="APP.filterRealEquipment('operational')" class="px-3 py-1 bg-green-500 text-white rounded-md text-sm hover:bg-green-600 transition">
                                    Operacionais
                                </button>
                                <button onclick="APP.filterRealEquipment('maintenance')" class="px-3 py-1 bg-yellow-500 text-white rounded-md text-sm hover:bg-yellow-600 transition">
                                    Em Manutenção
                                </button>
                                <button onclick="APP.filterRealEquipment('reform')" class="px-3 py-1 bg-red-500 text-white rounded-md text-sm hover:bg-red-600 transition">
                                    Em Reforma
                                </button>
                                <button onclick="APP.filterRealEquipment('reboques')" class="px-3 py-1 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600 transition">
                                    Reboques
                                </button>
                                <button onclick="APP.filterRealEquipment('caminhoes')" class="px-3 py-1 bg-gray-500 text-white rounded-md text-sm hover:bg-gray-600 transition">
                                    Caminhões
                                </button>
                                <button onclick="APP.filterRealEquipment('colhedoras')" class="px-3 py-1 bg-orange-500 text-white rounded-md text-sm hover:bg-orange-600 transition">
                                    Colhedoras
                                </button>
                                <button onclick="APP.filterRealEquipment('tracoes')" class="px-3 py-1 bg-purple-500 text-white rounded-md text-sm hover:bg-purple-600 transition">
                                    Trações
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4001')" class="px-3 py-1 bg-orange-400 text-white rounded-md text-sm hover:bg-orange-500 transition">
                                    Frente 4001
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4002')" class="px-3 py-1 bg-red-400 text-white rounded-md text-sm hover:bg-red-500 transition">
                                    Frente 4002
                                </button>
                            </div>
                        </div>
                        
                        <!-- Visualização real -->
                        <div id="real-equipment-container" class="mt-6">
                            <!-- Equipamentos serão renderizados via JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Reboques -->
                <div id="reboques" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Reboques</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="reboques-operational">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-operational-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="reboques-maintenance">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-maintenance-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="reboques-reform">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-reform-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                    <p class="text-xl font-bold text-blue-500" id="reboques-availability">0%</p>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-blue-500 rounded-full" id="reboques-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <h3 class="text-lg font-medium mb-3">Status dos Reboques</h3>
                            <div class="relative h-60">
                                <canvas id="reboques-status-chart"></canvas>
                                <div id="reboques-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="reboques-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="reboques-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Aguardando reforma">Aguardando reforma</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="reboques-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de reboques -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="frota">
                                                <button class="flex items-center">
                                                    Frota
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="tipo">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="acoplado">
                                                <button class="flex items-center">
                                                    Acoplado
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="dataParada">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="reboques-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Próprios -->
                <div id="caminhoes-proprios" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Caminhões Próprios</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="cp-operational">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-operational-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="cp-maintenance">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-maintenance-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="cp-reform">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-reform-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                    <p class="text-xl font-bold text-green-500" id="cp-availability">0%</p>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-green-500 rounded-full" id="cp-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="cp-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="cp-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Emprestado">Emprestado</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="cp-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões próprios -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="cp-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Terceiros -->
                <div id="caminhoes-terceiros" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Caminhões Terceiros</h2>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="ct-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="ct-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="ct-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões terceiros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="proprietario">
                                                <button class="flex items-center">
                                                    Proprietário
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Reboques
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="ct-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4001 -->
                <div id="frente-4001" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Frente 4001</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Total de Equipamentos</p>
                                    <p class="text-xl font-bold text-gray-800 dark:text-white" id="f4001-total">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="f4001-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="f4001-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="f4001-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-orange-500 rounded-full" id="f4001-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-3 font-bold" id="f4001-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4001-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="f4001-type-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-3">
                                    <select id="f4001-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-3">
                                    <select id="f4001-add-type" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4001">Colhedora</option>
                                        <option value="tracao-4001">Tração</option>
                                    </select>
                                </div>
                                <button id="f4001-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4001 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4001-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4002 -->
                <div id="frente-4002" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Frente 4002</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Total de Equipamentos</p>
                                    <p class="text-xl font-bold text-gray-800 dark:text-white" id="f4002-total">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="f4002-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="f4002-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="f4002-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-red-500 rounded-full" id="f4002-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-3 font-bold" id="f4002-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4002-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="f4002-type-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-3">
                                    <select id="f4002-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-3">
                                    <select id="f4002-add-type" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4002">Colhedora</option>
                                        <option value="tracao-4002">Tração</option>
                                    </select>
                                </div>
                                <button id="f4002-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4002 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4002-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Modais -->
    
    <!-- Modal para adicionar equipamento -->
    <div id="add-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Adicionar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('add-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                    <select id="equipment-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                        <option value="reboque">Reboque</option>
                        <option value="caminhao-proprio">Caminhão Próprio</option>
                        <option value="caminhao-terceiro">Caminhão Terceiro</option>
                        <option value="colhedora-4001">Colhedora Frente 4001</option>
                        <option value="tracao-4001">Tração Frente 4001</option>
                        <option value="colhedora-4002">Colhedora Frente 4002</option>
                        <option value="tracao-4002">Tração Frente 4002</option>
                    </select>
                </div>
                
                <div id="add-form-fields">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('add-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-equipment-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para editar equipamento -->
    <div id="edit-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white" id="modal-title">Editar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div id="edit-form-fields">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-changes-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão -->
    <div id="delete-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Confirmar Exclusão</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <div class="flex items-center justify-center mb-4 text-red-500">
                        <i class="fas fa-exclamation-triangle text-3xl"></i>
                    </div>
                    <p id="delete-confirm-message" class="text-center">Tem certeza que deseja excluir este equipamento?</p>
                    <p id="delete-item-details" class="text-center mt-2 font-medium"></p>
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-delete-btn" class="px-4 py-2 text-sm bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão de todos os registros -->
    <div id="clear-data-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Confirmar Exclusão Total</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <div class="flex items-center justify-center mb-4 text-red-500">
                        <i class="fas fa-exclamation-triangle text-5xl"></i>
                    </div>
                    <p class="text-center text-lg font-bold text-red-600 dark:text-red-400">ATENÇÃO!</p>
                    <p class="text-center mt-2">Você está prestes a excluir TODOS os registros do sistema. Esta ação não pode ser desfeita.</p>
                    <p class="text-center mt-4 font-medium">Por favor, digite "CONFIRMAR" para prosseguir:</p>
                    <input type="text" id="clear-data-confirmation" class="w-full mt-2 px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Digite CONFIRMAR">
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-clear-data-btn" class="px-4 py-2 text-sm bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir Todos os Registros
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para importar backup -->
    <div id="import-backup-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Importar Backup</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <p class="mb-4">Selecione um arquivo JSON de backup para importar. Este arquivo substituirá todos os dados atuais do sistema.</p>
                    <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center">
                        <input type="file" id="backup-file-input" accept=".json" class="hidden">
                        <label for="backup-file-input" class="cursor-pointer">
                            <i class="fas fa-file-upload text-gray-400 text-3xl mb-2"></i>
                            <p class="text-gray-500 dark:text-gray-400">Clique para selecionar um arquivo JSON</p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">ou arraste e solte aqui</p>
                        </label>
                        <p id="selected-file-name" class="mt-3 text-sm text-primary hidden"></p>
                    </div>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="import-backup-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition" disabled>
                        Importar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para visualizar histórico -->
    <div id="history-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-primary bg-opacity-10 text-primary flex items-center justify-center mr-2">
                        <i id="history-icon" class="fas fa-truck"></i>
                    </div>
                    <div>
                        <h3 id="history-title" class="text-lg font-medium text-gray-800 dark:text-white">Histórico</h3>
                        <p id="history-subtitle" class="text-xs text-gray-500 dark:text-gray-400">Total de registros: 0</p>
                    </div>
                </div>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="p-4 overflow-y-auto flex-1">
                <div class="relative pl-10 border-l-2 border-gray-200 dark:border-gray-700" id="history-timeline">
                    <!-- Histórico será carregado via JavaScript -->
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    Fechar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal para agendar manutenção -->
    <div id="schedule-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Agendar Manutenção</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div id="schedule-equipment-info" class="mb-4">
                    <!-- Detalhes do equipamento serão carregados via JavaScript -->
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                    <input type="date" id="schedule-date" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hora</label>
                    <input type="time" id="schedule-time" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Manutenção</label>
                    <select id="schedule-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                        <option value="preventiva">Manutenção Preventiva</option>
                        <option value="corretiva">Manutenção Corretiva</option>
                        <option value="revisao">Revisão Geral</option>
                        <option value="troca-oleo">Troca de Óleo</option>
                        <option value="reforma">Reforma</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrição</label>
                    <textarea id="schedule-description" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva a manutenção a ser realizada" required></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                    <input type="text" id="schedule-responsible" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Nome do responsável" required>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-schedule-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Agendar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Área de impressão -->
    <div id="print-area" class="hidden bg-white text-black p-8">
        <div class="mb-6 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="print-title" class="text-2xl font-bold">Relatório</h1>
                <p id="print-date" class="text-sm text-gray-600"></p>
            </div>
        </div>
        
        <div id="print-content" class="mb-6">
            <!-- Conteúdo para impressão será inserido aqui -->
        </div>
        
        <div class="text-right text-xs text-gray-500 mt-8">
            <p>Gerado em: <span id="print-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Área para relatório PDF -->
    <div id="pdf-report-area" class="hidden bg-white text-black p-8">
        <div class="mb-6 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="pdf-report-title" class="text-2xl font-bold">Relatório Completo</h1>
                <p id="pdf-report-date" class="text-sm text-gray-600"></p>
            </div>
        </div>
        
        <div id="pdf-report-content" class="mb-6">
            <!-- Conteúdo do relatório PDF será inserido aqui -->
        </div>
        
        <div class="text-right text-xs text-gray-500 mt-8">
            <p>Gerado em: <span id="pdf-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Container para notificações -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 flex flex-col space-y-2"></div>
    
    <!-- JavaScript -->
    <script>
        // Aplicação principal
        const APP = {
            data: {
                // Dados dos equipamentos
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                
                // Histórico
                history: {},
                
                // Agendamentos
                schedules: [],
                
                // Preferências e estados da UI
                currentSort: {
                    field: null,
                    direction: 'asc'
                },
                searchText: '',
                statusFilter: 'all',
                typeFilter: 'all',
                
                // Referências para os gráficos
                charts: {},
                
                // Estado de edição
                editingItem: null,
                editingType: null,
                
                // Estado de exclusão
                deletingId: null,
                deletingType: null,
                deletingIndex: null,
                deletingArray: null,
                
                // Estado de agendamento
                schedulingEquipment: null
            },
            
            // Inicializar a aplicação
            init() {
                // Configurar temas e preferências
                this.setupTheme();
                
                // Inicializar interface
                this.initUI();
                
                // Carregar dados
                this.loadData();
                
                // Inicializar gráficos
                this.initializeCharts();
                
                // Renderizar tabelas
                this.renderAllTables();
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Carregar visualização real
                this.initializeRealEquipmentView();
                
                // Atualizar todos os gráficos
                this.updateAllCharts();
                
                // Configurar event listeners
                this.setupEventListeners();
            },
            
            // Configurar tema (claro/escuro)
            setupTheme() {
                const themeToggle = document.getElementById('theme-toggle');
                
                // Configurar tema baseado na preferência do sistema
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                // Toggle de tema claro/escuro
                themeToggle.addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                });
            },
            
            // Inicializar a interface do usuário
            initUI() {
                // Configurar navegação entre abas
                document.querySelectorAll('[data-target]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // Atualizar classes do link
                        document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                        
                        // Atualizar o conteúdo visível
                        const targetId = link.getAttribute('data-target');
                        document.querySelectorAll('.tab-content').forEach(tab => {
                            tab.classList.add('hidden');
                            tab.classList.remove('active');
                        });
                        
                        const target = document.getElementById(targetId);
                        target.classList.remove('hidden');
                        target.classList.add('active');
                        
                        // Atualizar breadcrumb
                        document.getElementById('current-page').textContent = link.querySelector('span').textContent;
                        
                        // Fechar sidebar em dispositivos móveis
                        if (window.innerWidth < 768) {
                            document.querySelector('.sidebar').classList.remove('open');
                        }
                    });
                });
                
                // Toggle sidebar em dispositivos móveis
                document.getElementById('sidebar-toggle').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.add('open');
                });
                
                document.getElementById('close-sidebar').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.remove('open');
                });
                
                // Menu de ações
                const actionMenuBtn = document.getElementById('action-menu-btn');
                const actionMenu = document.getElementById('action-menu');
                
                actionMenuBtn.addEventListener('click', () => {
                    actionMenu.classList.toggle('hidden');
                });
                
                // Fechar o menu ao clicar fora dele
                document.addEventListener('click', (e) => {
                    if (!actionMenuBtn.contains(e.target) && !actionMenu.contains(e.target)) {
                        actionMenu.classList.add('hidden');
                    }
                });
                
                // Formulário de adição de equipamento
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Botões de ação
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('save-equipment-btn').addEventListener('click', () => {
                    this.saveNewEquipment();
                });
                
                document.getElementById('save-changes-btn').addEventListener('click', () => {
                    this.saveEquipmentChanges();
                });
                
                document.getElementById('confirm-delete-btn').addEventListener('click', () => {
                    this.deleteEquipment();
                });
                
                document.getElementById('save-schedule-btn').addEventListener('click', () => {
                    this.saveSchedule();
                });
                
                // Botões para adicionar equipamentos específicos
                document.getElementById('reboques-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'reboque';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('cp-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-proprio';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('ct-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-terceiro';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4001-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4001-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4002-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4002-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                // Botões de exportação e impressão
                document.getElementById('export-csv-btn').addEventListener('click', () => {
                    this.exportToCSV();
                });
                
                document.getElementById('export-backup-btn').addEventListener('click', () => {
                    this.exportBackup();
                });
                
                document.getElementById('print-btn').addEventListener('click', () => {
                    this.printActiveTable();
                });
                
                document.getElementById('print-dashboard-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                document.getElementById('pdf-report-btn').addEventListener('click', () => {
                    this.generatePDFReport();
                });
                
                // Botão de limpeza de dados
                document.getElementById('clear-data-btn').addEventListener('click', () => {
                    document.getElementById('clear-data-confirm-modal').classList.remove('hidden');
                });
                
                document.getElementById('confirm-clear-data-btn').addEventListener('click', () => {
                    this.clearAllData();
                });
                
                // Botão para importar backup
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    document.getElementById('import-backup-modal').classList.remove('hidden');
                });
                
                // Configurar input de arquivo de backup
                const fileInput = document.getElementById('backup-file-input');
                const fileNameDisplay = document.getElementById('selected-file-name');
                const importBtn = document.getElementById('import-backup-btn');
                
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        const file = e.target.files[0];
                        fileNameDisplay.textContent = file.name;
                        fileNameDisplay.classList.remove('hidden');
                        document.getElementById('import-backup-btn').removeAttribute('disabled');
                    } else {
                        fileNameDisplay.classList.add('hidden');
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                    }
                });
                
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    this.importDataFromFile();
                });
                
                // Botão de atualização do dashboard detalhado
                document.getElementById('detailed-refresh-btn')?.addEventListener('click', () => {
                    this.updateDetailedDashboardCharts();
                    this.updateDetailedDashboard();
                });
            },
            
            // Configurar event listeners adicionais
            setupEventListeners() {
                // Event listeners para filtros
                document.getElementById('reboques-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('reboques-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('cp-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('cp-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('ct-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('ct-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('f4001-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4002-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                // Event listeners para ordenação
                document.querySelectorAll('th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        const field = th.getAttribute('data-sort');
                        
                        if (this.data.currentSort.field === field) {
                            this.data.currentSort.direction = this.data.currentSort.direction === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.data.currentSort.field = field;
                            this.data.currentSort.direction = 'asc';
                        }
                        
                        // Atualizar visualmente os ícones de ordenação
                        document.querySelectorAll('th[data-sort] i').forEach(icon => {
                            icon.className = 'fas fa-sort ml-1 text-gray-400';
                        });
                        
                        const icon = th.querySelector('i');
                        icon.className = `fas fa-sort-${this.data.currentSort.direction === 'asc' ? 'up' : 'down'} ml-1 text-gray-800 dark:text-white`;
                        
                        // Renderizar a tabela atual
                        const activeTab = document.querySelector('.tab-content.active');
                        if (activeTab) {
                            const id = activeTab.id;
                            
                            if (id === 'reboques') {
                                this.renderReboquesTable();
                            } else if (id === 'caminhoes-proprios') {
                                this.renderCPTable();
                            } else if (id === 'caminhoes-terceiros') {
                                this.renderCTTable();
                            } else if (id === 'frente-4001') {
                                this.renderF4001Table();
                            } else if (id === 'frente-4002') {
                                this.renderF4002Table();
                            }
                        }
                    });
                });
                
                // Configurar area de arrastar e soltar para importação de backup
                const dropZone = document.querySelector('.border-dashed');
                
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropZone.addEventListener(eventName, highlight, false);
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, unhighlight, false);
                });

                function highlight() {
                    dropZone.classList.add('border-primary', 'bg-primary', 'bg-opacity-5');
                }

                function unhighlight() {
                    dropZone.classList.remove('border-primary', 'bg-primary', 'bg-opacity-5');
                }
                
                dropZone.addEventListener('drop', (e) => {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type === 'application/json' || file.name.endsWith('.json')) {
                            document.getElementById('backup-file-input').files = files;
                            document.getElementById('selected-file-name').textContent = file.name;
                            document.getElementById('selected-file-name').classList.remove('hidden');
                            document.getElementById('import-backup-btn').removeAttribute('disabled');
                        } else {
                            this.showNotification('error', 'Erro', 'Por favor, selecione um arquivo JSON válido.');
                        }
                    }
                });
            },
            
            // Carregar dados (inicialmente usando dados de exemplo)
            loadData() {
                // Verificar se já existem dados no LocalStorage
                const savedData = localStorage.getItem('fleetManagementData');
                
                if (savedData) {
                    try {
                        const parsedData = JSON.parse(savedData);
                        
                        // Atualizar dados
                        this.data.reboques = parsedData.reboques || [];
                        this.data.caminhoesProps = parsedData.caminhoesProps || [];
                        this.data.caminhoesTerc = parsedData.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = parsedData.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = parsedData.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = parsedData.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = parsedData.frente4002Tracoes || [];
                        this.data.history = parsedData.history || {};
                        this.data.schedules = parsedData.schedules || [];
                        
                        return;
                    } catch (error) {
                        console.error("Erro ao carregar dados do LocalStorage:", error);
                    }
                }
                
                // Se não houver dados ou ocorrer erro, carregar dados de exemplo
                this.loadExampleData();
            },
            
            // Carregar dados de exemplo
            loadExampleData() {
                // Dados de exemplo para reboques
                this.data.reboques = [
                    { frota: '1101', tipo: 'SEMI REBOQUE', acoplado: '7520', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1102', tipo: 'SEMI REBOQUE', acoplado: '7521', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1103', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Em manutenção', dataParada: '2023-05-15', motivo: 'Suspensão danificada', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1104', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1105', tipo: 'REBOQUE', acoplado: '7522', status: 'Operacional', tipoAcoplado: 'REBOQUE' },
                    { frota: '1106', tipo: 'REBOQUE', acoplado: '', status: 'Em reforma', dataParada: '2023-04-10', motivo: 'Reforma geral programada', tipoAcoplado: 'REBOQUE' },
                    { frota: '1107', tipo: 'DOLLY', acoplado: '7523', status: 'Operacional', tipoAcoplado: 'DOLLY' },
                    { frota: '1108', tipo: 'DOLLY', acoplado: '', status: 'Inoperante', dataParada: '2023-05-22', motivo: 'Eixo quebrado', tipoAcoplado: 'DOLLY' }
                ];
                
                // Dados de exemplo para caminhões próprios
                this.data.caminhoesProps = [
                    { caminhao: '7520', status: 'Operacional' },
                    { caminhao: '7521', status: 'Operacional' },
                    { caminhao: '7522', status: 'Operacional' },
                    { caminhao: '7523', status: 'Operacional' },
                    { caminhao: '7524', status: 'Em manutenção', data: '2023-05-18', motivo: 'Troca de óleo e filtros' },
                    { caminhao: '7525', status: 'Em reforma', data: '2023-03-15', motivo: 'Reforma do motor' },
                    { caminhao: '7526', status: 'Emprestado', data: '2023-05-10', motivo: 'Emprestado para filial' }
                ];
                
                // Dados de exemplo para caminhões terceiros
                this.data.caminhoesTerc = [
                    { caminhao: 'T001', proprietario: 'Transportes Silva', reboques: '1201-1202', status: 'Operacional' },
                    { caminhao: 'T002', proprietario: 'Logística Express', reboques: '1203', status: 'Operacional' },
                    { caminhao: 'T003', proprietario: 'Transportes Rápidos', reboques: '1204-1205', status: 'Em manutenção', motivo: 'Problemas no freio' },
                    { caminhao: 'T004', proprietario: 'Rodovias Transport', reboques: '1206', status: 'Operacional' },
                    { caminhao: 'T005', proprietario: 'JK Logística', reboques: '1207-1208', status: 'Inoperante', motivo: 'Acidente na estrada' }
                ];
                
                // Dados de exemplo para frente 4001
                this.data.frente4001Colhedoras = [
                    { codigo: 'C101', status: 'Operacional' },
                    { codigo: 'C102', status: 'Em manutenção', data: '2023-05-20', motivo: 'Manutenção preventiva' },
                    { codigo: 'C103', status: 'Operacional' },
                    { codigo: 'C104', status: 'Inoperante', data: '2023-04-25', motivo: 'Problemas no sistema hidráulico' }
                ];
                
                this.data.frente4001Tracoes = [
                    { codigo: 'T101', status: 'Operacional' },
                    { codigo: 'T102', status: 'Operacional' },
                    { codigo: 'T103', status: 'Em manutenção', data: '2023-05-19', motivo: 'Troca de pneus' },
                    { codigo: 'T104', status: 'Operacional' }
                ];
                
                // Dados de exemplo para frente 4002
                this.data.frente4002Colhedoras = [
                    { codigo: 'C201', status: 'Operacional' },
                    { codigo: 'C202', status: 'Operacional' },
                    { codigo: 'C203', status: 'Em reforma', data: '2023-03-10', motivo: 'Reforma programada' },
                    { codigo: 'C204', status: 'Em manutenção', data: '2023-05-21', motivo: 'Falha no sistema elétrico' }
                ];
                
                this.data.frente4002Tracoes = [
                    { codigo: 'T201', status: 'Operacional' },
                    { codigo: 'T202', status: 'Inoperante', data: '2023-05-05', motivo: 'Motor danificado' },
                    { codigo: 'T203', status: 'Operacional' },
                    { codigo: 'T204', status: 'Em manutenção', data: '2023-05-22', motivo: 'Manutenção programada' }
                ];
                
                // Histórico de exemplo
                this.data.history = {
                    '7524': [
                        {
                            date: '2023-05-18T10:30:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Troca de óleo e filtros',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-10T08:15:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-05T14:20:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Revisão de 50.000 km',
                            user: 'Técnico'
                        }
                    ],
                    'C102': [
                        {
                            date: '2023-05-20T09:45:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Manutenção preventiva',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-03-15T11:30:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Técnico'
                        },
                        {
                            date: '2023-03-10T08:15:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Falha no sistema eletrônico',
                            user: 'Operador'
                        }
                    ]
                };
                
                // Agendamentos de exemplo
                this.data.schedules = [
                    {
                        equipment: '7520',
                        equipmentType: 'Caminhão Próprio',
                        date: '2023-06-05',
                        time: '09:00',
                        type: 'preventiva',
                        description: 'Revisão de 30.000 km',
                        responsible: 'João Silva',
                        created: '2023-05-20T14:30:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: 'C201',
                        equipmentType: 'Colhedora Frente 4002',
                        date: '2023-06-10',
                        time: '08:30',
                        type: 'troca-oleo',
                        description: 'Troca de óleo e filtros',
                        responsible: 'Carlos Oliveira',
                        created: '2023-05-22T10:15:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: '1102',
                        equipmentType: 'Reboque',
                        date: '2023-06-15',
                        time: '14:00',
                        type: 'corretiva',
                        description: 'Reparo na suspensão',
                        responsible: 'Pedro Santos',
                        created: '2023-05-23T09:45:00',
                        status: 'Agendado'
                    }
                ];
                
                // Salvar os dados de exemplo no LocalStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar dados no LocalStorage
            saveDataToLocalStorage() {
                try {
                    localStorage.setItem('fleetManagementData', JSON.stringify({
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules
                    }));
                } catch (error) {
                    console.error("Erro ao salvar dados no LocalStorage:", error);
                    this.showNotification('error', 'Erro', 'Falha ao salvar dados. As alterações não serão mantidas após a recarga da página.');
                }
            },
            
            // Exportar backup em formato JSON
            exportBackup() {
                // Criar objeto com todos os dados 
                const backupData = {
                    reboques: this.data.reboques,
                    caminhoesProps: this.data.caminhoesProps,
                    caminhoesTerc: this.data.caminhoesTerc,
                    frente4001Colhedoras: this.data.frente4001Colhedoras,
                    frente4001Tracoes: this.data.frente4001Tracoes,
                    frente4002Colhedoras: this.data.frente4002Colhedoras,
                    frente4002Tracoes: this.data.frente4002Tracoes,
                    history: this.data.history,
                    schedules: this.data.schedules
                };
                
                // Converter para JSON
                const jsonData = JSON.stringify(backupData, null, 2);
                
                // Criar blob e link para download
                const blob = new Blob([jsonData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                // Gerar nome do arquivo com data atual
                const date = new Date();
                const formattedDate = date.toISOString().slice(0, 10);
                const fileName = `backup_frota_${formattedDate}.json`;
                
                // Criar link para download
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Backup exportado com sucesso.');
            },
            
            // Limpar todos os dados
            clearAllData() {
                const confirmationInput = document.getElementById('clear-data-confirmation');
                if (confirmationInput.value !== 'CONFIRMAR') {
                    this.showNotification('error', 'Erro', 'Por favor, digite "CONFIRMAR" para prosseguir com a exclusão dos dados.');
                    return;
                }
                
                // Limpar todos os arrays de dados
                this.data.reboques = [];
                this.data.caminhoesProps = [];
                this.data.caminhoesTerc = [];
                this.data.frente4001Colhedoras = [];
                this.data.frente4001Tracoes = [];
                this.data.frente4002Colhedoras = [];
                this.data.frente4002Tracoes = [];
                this.data.history = {};
                this.data.schedules = [];
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('clear-data-confirm-modal').classList.add('hidden');
                confirmationInput.value = '';
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Todos os registros foram excluídos com sucesso.');
            },
            
            // Importar dados de um arquivo
            importDataFromFile() {
                const fileInput = document.getElementById('backup-file-input');
                if (fileInput.files.length === 0) {
                    this.showNotification('error', 'Erro', 'Nenhum arquivo selecionado.');
                    return;
                }
                
                const file = fileInput.files[0];
                if (file.type !== 'application/json' && !file.name.endsWith('.json')) {
                    this.showNotification('error', 'Erro', 'O arquivo deve ser um JSON válido.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Verificar se o arquivo contém os dados esperados
                        if (!data.reboques || !data.caminhoesProps || !data.caminhoesTerc || 
                            !data.frente4001Colhedoras || !data.frente4001Tracoes || 
                            !data.frente4002Colhedoras || !data.frente4002Tracoes) {
                            throw new Error('O arquivo não contém dados válidos para importação.');
                        }
                        
                        // Atualizar os dados
                        this.data.reboques = data.reboques || [];
                        this.data.caminhoesProps = data.caminhoesProps || [];
                        this.data.caminhoesTerc = data.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = data.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = data.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = data.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = data.frente4002Tracoes || [];
                        this.data.history = data.history || {};
                        this.data.schedules = data.schedules || [];
                        
                        // Salvar no localStorage
                        this.saveDataToLocalStorage();
                        
                        // Atualizar visualizações
                        this.renderAllTables();
                        this.updateAllDashboards();
                        this.updateAllCharts();
                        this.initializeRealEquipmentView();
                        
                        // Fechar modal
                        document.getElementById('import-backup-modal').classList.add('hidden');
                        document.getElementById('selected-file-name').classList.add('hidden');
                        fileInput.value = '';
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Sucesso', 'Backup importado com sucesso.');
                        
                    } catch (error) {
                        this.showNotification('error', 'Erro', 'Falha ao importar backup: ' + error.message);
                    }
                };
                
                reader.onerror = () => {
                    this.showNotification('error', 'Erro', 'Falha ao ler o arquivo.');
                };
                
                reader.readAsText(file);
            },
            
            // Filtrar dados com base nos filtros atuais
            filterData(data) {
                return data.filter(item => {
                    // Filtro de pesquisa
                    const searchTerms = this.data.searchText.toLowerCase().split(' ');
                    
                    const matchesSearch = searchTerms.every(term => {
                        return Object.values(item).some(value => {
                            if (value === null || value === undefined) return false;
                            return value.toString().toLowerCase().includes(term);
                        });
                    });
                    
                    if (!matchesSearch) return false;
                    
                    // Filtro de status
                    if (this.data.statusFilter !== 'all' && item.status !== this.data.statusFilter) {
                        return false;
                    }
                    
                    // Filtro de tipo (para frentes 4001 e 4002)
                    if (this.data.typeFilter !== 'all' && item.type !== this.data.typeFilter) {
                        return false;
                    }
                    
                    return true;
                });
            },
            
            // Ordenar dados com base no campo e direção atuais
            sortData(data) {
                if (!this.data.currentSort.field) return data;
                
                return [...data].sort((a, b) => {
                    const field = this.data.currentSort.field;
                    const aValue = a[field];
                    const bValue = b[field];
                    
                    if (aValue === null || aValue === undefined) return 1;
                    if (bValue === null || bValue === undefined) return -1;
                    
                    if (aValue < bValue) {
                        return this.data.currentSort.direction === 'asc' ? -1 : 1;
                    }
                    if (aValue > bValue) {
                        return this.data.currentSort.direction === 'asc' ? 1 : -1;
                    }
                    return 0;
                });
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCPTable();
                this.renderCTTable();
                this.renderF4001Table();
                this.renderF4002Table();
            },
            
            // Renderizar tabela de reboques
            renderReboquesTable() {
                const tableBody = document.getElementById('reboques-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.reboques);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum reboque encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((reboque, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(reboque.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (reboque.dataParada) {
                        const data = new Date(reboque.dataParada);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${reboque.frota || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.tipo || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.acoplado || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${reboque.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${reboque.frota}" data-type="Reboque" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${reboque.frota}" data-type="Reboque" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${reboque.frota}" data-type="Reboque" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${reboque.frota}" data-type="Reboque" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'reboques');
                    });
                });
            },
            
            // Renderizar tabela de caminhões próprios
            renderCPTable() {
                const tableBody = document.getElementById('cp-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesProps);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão próprio encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (caminhao.data) {
                        const data = new Date(caminhao.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesProps');
                    });
                });
            },
            
            // Renderizar tabela de caminhões terceiros
            renderCTTable() {
                const tableBody = document.getElementById('ct-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesTerc);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão terceiro encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.proprietario || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.reboques || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${caminhao.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesTerc');
                    });
                });
            },
            
            // Renderizar tabela da frente 4001
            renderF4001Table() {
                const tableBody = document.getElementById('f4001-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4001Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4001Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4001Colhedoras' : 'frente4001Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Renderizar tabela da frente 4002
            renderF4002Table() {
                const tableBody = document.getElementById('f4002-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4002Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4002Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4002Colhedoras' : 'frente4002Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Inicializar gráficos
            initializeCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Gráfico de status por categoria
                const statusCtx = document.getElementById('status-by-category-chart');
                if (statusCtx) {
                    this.data.charts.statusByCategoryChart = new Chart(statusCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Frente 4001', 'Frente 4002'],
                            datasets: [{
                                label: 'Operacionais',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#10B981'
                            }, {
                                label: 'Em Manutenção',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#F59E0B'
                            }, {
                                label: 'Em Reforma/Inoperantes',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#EF4444'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    stacked: true
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de disponibilidade
                const availabilityCtx = document.getElementById('availability-chart');
                if (availabilityCtx) {
                    this.data.charts.availabilityChart = new Chart(availabilityCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma', 'Outros'],
                            datasets: [{
                                data: [0, 0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de status dos reboques
                const reboquesStatusCtx = document.getElementById('reboques-status-chart');
                if (reboquesStatusCtx) {
                    this.data.charts.reboquesStatusChart = new Chart(reboquesStatusCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma/Inoperantes'],
                            datasets: [{
                                data: [0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Inicializar gráficos do dashboard detalhado
                this.initializeDetailedDashboardCharts();
            },
            
            // Inicializar gráficos do dashboard detalhado
            initializeDetailedDashboardCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Gráfico de distribuição de status
                const statusDistCtx = document.getElementById('detailed-status-distribution-chart');
                if (statusDistCtx) {
                    this.data.charts.detailedStatusDistributionChart = new Chart(statusDistCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'F4001 Colhedoras', 'F4001 Trações', 'F4002 Colhedoras', 'F4002 Trações'],
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#10B981'
                                },
                                {
                                    label: 'Em Manutenção',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#F59E0B'
                                },
                                {
                                    label: 'Em Reforma/Inoperante',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#EF4444'
                                },
                                {
                                    label: 'Outros',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#3B82F6'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    stacked: true
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de tendência de disponibilidade
                const availTrendCtx = document.getElementById('detailed-availability-trend-chart');
                if (availTrendCtx) {
                    // Criar dados de exemplo para mostrar a tendência
                    const labels = [];
                    
                    // Usar datas reais (últimos 3 meses)
                    const today = new Date();
                    for (let i = 2; i >= 0; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedAvailabilityTrendChart = new Chart(availTrendCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Disponibilidade da Frota (%)',
                                data: [], // Deixar vazio - será preenchido com dados reais
                                borderColor: '#5D5CDE',
                                backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                tension: 0.3,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 50,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de causas de manutenção
                const causesCtx = document.getElementById('detailed-maintenance-causes-chart');
                if (causesCtx) {
                    this.data.charts.detailedMaintenanceCausesChart = new Chart(causesCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Desgaste normal', 'Falha mecânica', 'Problemas elétricos', 'Manutenção preventiva', 'Outros'],
                            datasets: [{
                                data: [], // Deixar vazio - será preenchido com dados reais
                                backgroundColor: ['#3B82F6', '#EF4444', '#F59E0B', '#10B981', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de previsão
                const forecastCtx = document.getElementById('detailed-forecast-chart');
                if (forecastCtx) {
                    // Criar dados para previsão baseados apenas nos meses reais
                    const labels = [];
                    
                    // Últimos 3 meses (dados históricos) + próximos 3 meses (previsão)
                    const today = new Date();
                    for (let i = 2; i >= -3; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedForecastChart = new Chart(forecastCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Dados Históricos',
                                    data: [], // Deixar vazio - será preenchido com dados reais se existirem
                                    borderColor: '#3B82F6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Previsão',
                                    data: [], // Deixar vazio - será preenchido apenas se houver dados suficientes
                                    borderColor: '#5D5CDE',
                                    borderDash: [5, 5],
                                    backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            if (context.raw !== null) {
                                                return `${context.dataset.label}: ${context.raw.toFixed(1)}%`;
                                            }
                                            return '';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    min: 60,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Mostrar mensagens de "sem dados" para os gráficos
                document.getElementById('detailed-forecast-no-data')?.classList.remove('hidden');
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Verificar se o tema mudou e atualizar os padrões
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Atualizar gráficos do dashboard principal
                this.updateStatusCategoryChart();
                this.updateAvailabilityChart();
                
                // Atualizar gráficos específicos por categoria
                this.updateReboquesCharts();
                
                // Atualizar gráficos do dashboard detalhado
                this.updateDetailedDashboardCharts();
            },
            
            // Atualizar gráfico de status por categoria
            updateStatusCategoryChart() {
                if (!this.data.charts.statusByCategoryChart) return;
                
                // Contar status para cada categoria
                const reboquesOperacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesManutencao = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reboquesReforma = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                const cpOperacional = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpManutencao = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const cpReforma = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                const ctOperacional = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctManutencao = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const ctReforma = this.data.caminhoesTerc.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                // Frente 4001
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4001Reforma = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Frente 4002
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4002Reforma = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.statusByCategoryChart.data.datasets[0].data = [
                    reboquesOperacional, cpOperacional, ctOperacional, f4001Operacional, f4002Operacional
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[1].data = [
                    reboquesManutencao, cpManutencao, ctManutencao, f4001Manutencao, f4002Manutencao
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[2].data = [
                    reboquesReforma, cpReforma, ctReforma, f4001Reforma, f4002Reforma
                ];
                
                this.data.charts.statusByCategoryChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = 
                    reboquesOperacional + reboquesManutencao + reboquesReforma +
                    cpOperacional + cpManutencao + cpReforma +
                    ctOperacional + ctManutencao + ctReforma +
                    f4001Operacional + f4001Manutencao + f4001Reforma +
                    f4002Operacional + f4002Manutencao + f4002Reforma;
                
                if (totalData > 0) {
                    document.getElementById('status-category-no-data').classList.add('hidden');
                } else {
                    document.getElementById('status-category-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar gráfico de disponibilidade
            updateAvailabilityChart() {
                if (!this.data.charts.availabilityChart) return;
                
                // Contar todos os equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                // Todos os outros status (emprestados, etc)
                const other = 
                    this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length +
                    this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length +
                    this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.availabilityChart.data.datasets[0].data = [
                    operational, maintenance, reform, other
                ];
                
                this.data.charts.availabilityChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operational + maintenance + reform + other;
                
                if (totalData > 0) {
                    document.getElementById('availability-no-data').classList.add('hidden');
                } else {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                }
                
                // Atualizar indicadores globais no dashboard
                const total = operational + maintenance + reform + other;
                
                document.getElementById('dash-global-operational').textContent = operational;
                document.getElementById('dash-global-maintenance').textContent = maintenance;
                document.getElementById('dash-global-reform').textContent = reform;
                document.getElementById('dash-global-other').textContent = other;
                document.getElementById('dash-global-total').textContent = total;
                
                if (total > 0) {
                    document.getElementById('dash-global-operational-percent').textContent = `${Math.round(operational / total * 100)}%`;
                    document.getElementById('dash-global-maintenance-percent').textContent = `${Math.round(maintenance / total * 100)}%`;
                    document.getElementById('dash-global-reform-percent').textContent = `${Math.round(reform / total * 100)}%`;
                    document.getElementById('dash-global-other-percent').textContent = `${Math.round(other / total * 100)}%`;
                }
            },
            
            // Atualizar gráficos específicos dos reboques
            updateReboquesCharts() {
                if (!this.data.charts.reboquesStatusChart) return;
                
                // Contar reboques por status
                const operacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const manutencao = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reforma = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.reboquesStatusChart.data.datasets[0].data = [
                    operacional, manutencao, reforma
                ];
                
                this.data.charts.reboquesStatusChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operacional + manutencao + reforma;
                
                if (totalData > 0) {
                    document.getElementById('reboques-status-no-data')?.classList.add('hidden');
                } else {
                    document.getElementById('reboques-status-no-data')?.classList.remove('hidden');
                }
            },
            
            // Atualizar gráficos do dashboard detalhado
            updateDetailedDashboardCharts() {
                // Distribuição de status por categoria
                if (this.data.charts.detailedStatusDistributionChart) {
                    const chart = this.data.charts.detailedStatusDistributionChart;
                    
                    // Dados para o gráfico
                    const operacionalData = [
                        this.data.reboques.filter(r => r.status === 'Operacional').length,
                        this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                        this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length,
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length,
                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length,
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length,
                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length
                    ];
                    
                    const manutencaoData = [
                        this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                        this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length,
                        this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length,
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length,
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length
                    ];
                    
                    const reformaData = [
                        this.data.reboques.filter(r => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length,
                        this.data.caminhoesProps.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.caminhoesTerc.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4001Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4001Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length,
                        this.data.frente4002Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4002Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length
                    ];
                    
                    const outrosData = [
                        this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length,
                        this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length,
                        this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length,
                        this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length
                    ];
                    
                    // Atualizar os dados do gráfico
                    chart.data.datasets[0].data = operacionalData;
                    chart.data.datasets[1].data = manutencaoData;
                    chart.data.datasets[2].data = reformaData;
                    chart.data.datasets[3].data = outrosData;
                    
                    chart.update();
                    
                    // Esconder mensagem de "sem dados" se houver dados
                    const totalData = operacionalData.reduce((a, b) => a + b, 0) + 
                                     manutencaoData.reduce((a, b) => a + b, 0) + 
                                     reformaData.reduce((a, b) => a + b, 0) + 
                                     outrosData.reduce((a, b) => a + b, 0);
                    
                    if (totalData > 0) {
                        document.getElementById('detailed-status-no-data')?.classList.add('hidden');
                    } else {
                        document.getElementById('detailed-status-no-data')?.classList.remove('hidden');
                    }
                }
                
                // Tendência de disponibilidade - Criar dados fictícios para o gráfico
                if (this.data.charts.detailedAvailabilityTrendChart) {
                    const chart = this.data.charts.detailedAvailabilityTrendChart;
                    
                    // Calcular disponibilidade atual
                    const totalEquipments = 
                        this.data.reboques.length +
                        this.data.caminhoesProps.length +
                        this.data.caminhoesTerc.length +
                        this.data.frente4001Colhedoras.length +
                        this.data.frente4001Tracoes.length +
                        this.data.frente4002Colhedoras.length +
                        this.data.frente4002Tracoes.length;
                    
                    const operational = 
                        this.data.reboques.filter(r => r.status === 'Operacional').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                    
                    const currentAvailability = totalEquipments > 0 ? (operational / totalEquipments) * 100 : 0;
                    
                    // Dados fictícios para meses anteriores (variando um pouco)
                    const historicalData = [
                        Math.max(60, Math.min(100, currentAvailability - Math.random() * 10)), // 2 meses atrás
                        Math.max(60, Math.min(100, currentAvailability - Math.random() * 5)),  // 1 mês atrás
                        currentAvailability                                                    // Atual
                    ];
                    
                    // Atualizar os dados históricos no gráfico
                    chart.data.datasets[0].data = historicalData;
                    
                    // Dados fictícios para previsão futura (tendência crescente)
                    const forecastData = [
                        null, null, null, // Passado (nulo para não mostrar)
                        currentAvailability,                                                 // Atual
                        Math.max(60, Math.min(100, currentAvailability + Math.random() * 2)), // +1 mês
                        Math.max(60, Math.min(100, currentAvailability + Math.random() * 5))  // +2 meses
                    ];
                    
                    // Atualizar os dados de previsão no gráfico
                    chart.data.datasets[1].data = forecastData;
                    
                    chart.update();
                    
                    // Esconder mensagem de "sem dados" se houver dados
                    if (totalEquipments > 0) {
                        document.getElementById('detailed-trend-no-data')?.classList.add('hidden');
                    } else {
                        document.getElementById('detailed-trend-no-data')?.classList.remove('hidden');
                    }
                }
                
                // Causas de manutenção - Usar dados fictícios com base em dados reais
                if (this.data.charts.detailedMaintenanceCausesChart) {
                    const chart = this.data.charts.detailedMaintenanceCausesChart;
                    
                    // Contar todos os equipamentos em manutenção para ter uma base real
                    const totalMaintenance = 
                        this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                    
                    // Distribuir as causas de forma fictícia mas proporcional ao total
                    const causesData = [
                        Math.round(totalMaintenance * 0.3),  // Desgaste normal
                        Math.round(totalMaintenance * 0.25), // Falha mecânica
                        Math.round(totalMaintenance * 0.15), // Problemas elétricos
                        Math.round(totalMaintenance * 0.2),  // Manutenção preventiva
                        Math.round(totalMaintenance * 0.1)   // Outros
                    ];
                    
                    // Atualizar os dados do gráfico
                    chart.data.datasets[0].data = causesData;
                    
                    chart.update();
                }
                
                // Gráfico de previsão - Já atualizado junto com a tendência
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateMainDashboard();
                this.updateDetailedDashboard();
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
            },
            
            // Atualizar dashboard principal
            updateMainDashboard() {
                // Contar todos os equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                const borrowed = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length;
                
                // Outros status
                const other = 
                    this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(r.status)).length +
                    this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)).length +
                    this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)).length +
                    this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)).length +
                    this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)).length +
                    this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(c.status)).length +
                    this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma', 'Emprestado'].includes(t.status)).length;
                
                // Total de equipamentos
                const total = operational + maintenance + reform + borrowed + other;
                
                // Calcular disponibilidade
                const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar cards do resumo
                document.getElementById('dash-summary-operational').textContent = operational;
                document.getElementById('dash-summary-maintenance').textContent = maintenance;
                document.getElementById('dash-summary-reform').textContent = reform;
                document.getElementById('dash-summary-borrowed').textContent = borrowed;
                document.getElementById('dash-summary-other').textContent = other;
                document.getElementById('dash-summary-availability').textContent = `${availability}%`;
                document.getElementById('dash-availability-bar').style.width = `${availability}%`;
                
                // Atualizar cards de categoria de frota
                // Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesMaintenances = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                
                document.getElementById('dash-reboques-count').textContent = reboquesTotal;
                document.getElementById('dash-reboques-operational').textContent = reboquesOperational;
                document.getElementById('dash-reboques-maintenance').textContent = reboquesMaintenances;
                
                if (reboquesTotal > 0) {
                    const reboquesAvailability = Math.round((reboquesOperational / reboquesTotal) * 100);
                    document.getElementById('dash-reboques-bar').style.width = `${reboquesAvailability}%`;
                }
                
                // Caminhões (próprios + terceiros)
                const caminhoesTotal = this.data.caminhoesProps.length + this.data.caminhoesTerc.length;
                const caminhoesOperational = 
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const caminhoesMaintenances = 
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                
                document.getElementById('dash-cp-count').textContent = caminhoesTotal;
                document.getElementById('dash-cp-operational').textContent = caminhoesOperational;
                document.getElementById('dash-cp-maintenance').textContent = caminhoesMaintenances;
                
                if (caminhoesTotal > 0) {
                    const caminhoesAvailability = Math.round((caminhoesOperational / caminhoesTotal) * 100);
                    document.getElementById('dash-cp-bar').style.width = `${caminhoesAvailability}%`;
                }
                
                // Frente 4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Operational = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Maintenances = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4001-count').textContent = f4001Total;
                document.getElementById('dash-f4001-operational').textContent = f4001Operational;
                document.getElementById('dash-f4001-maintenance').textContent = f4001Maintenances;
                
                if (f4001Total > 0) {
                    const f4001Availability = Math.round((f4001Operational / f4001Total) * 100);
                    document.getElementById('dash-f4001-bar').style.width = `${f4001Availability}%`;
                }
                
                // Frente 4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Operational = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Maintenances = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4002-count').textContent = f4002Total;
                document.getElementById('dash-f4002-operational').textContent = f4002Operational;
                document.getElementById('dash-f4002-maintenance').textContent = f4002Maintenances;
                
                if (f4002Total > 0) {
                    const f4002Availability = Math.round((f4002Operational / f4002Total) * 100);
                    document.getElementById('dash-f4002-bar').style.width = `${f4002Availability}%`;
                }
                
                // Atualizar lista de equipamentos em manutenção
                const inMaintenanceList = document.getElementById('equipment-maintenance-list');
                
                // Função para formatar a data
                const formatDate = (dateStr) => {
                    if (!dateStr) return '';
                    
                    const date = new Date(dateStr);
                    return date.toLocaleDateString('pt-BR');
                };
                
                // Encontrar todos os equipamentos em manutenção
                const equipmentsInMaintenance = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                        id: r.frota,
                        type: 'Reboque',
                        date: formatDate(r.dataParada),
                        reason: r.motivo || 'Não informado'
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Próprio',
                        date: formatDate(c.data),
                        reason: c.motivo || 'Não informado'
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Terceiro',
                        date: '',
                        reason: c.motivo || 'Não informado'
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4001',
                        date: formatDate(c.data),
                        reason: c.motivo || 'Não informado'
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4001',
                        date: formatDate(t.data),
                        reason: t.motivo || 'Não informado'
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4002',
                        date: formatDate(c.data),
                        reason: c.motivo || 'Não informado'
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4002',
                        date: formatDate(t.data),
                        reason: t.motivo || 'Não informado'
                    }))
                ];
                
                // Atualizar a lista no dashboard
                if (inMaintenanceList) {
                    if (equipmentsInMaintenance.length > 0) {
                        let html = '';
                        
                        equipmentsInMaintenance.forEach(item => {
                            html += `
                                <li class="py-2 flex items-center justify-between">
                                    <div>
                                        <span class="font-medium">${item.id}</span> - ${item.type}
                                        <p class="text-sm text-gray-500 dark:text-gray-400">${item.reason}</p>
                                    </div>
                                    <div class="text-sm text-gray-500 dark:text-gray-400">
                                        ${item.date ? `Desde: ${item.date}` : ''}
                                    </div>
                                </li>
                            `;
                        });
                        
                        inMaintenanceList.innerHTML = html;
                    } else {
                        inMaintenanceList.innerHTML = `
                            <li class="py-2">
                                <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                            </li>
                        `;
                    }
                }
                
                // Atualizar lista de próximas manutenções agendadas
                const upcomingMaintenanceList = document.getElementById('upcoming-maintenance-list');
                
                // Filtrar apenas as manutenções agendadas futuras
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingMaintenance = this.data.schedules
                    .filter(s => {
                        const scheduleDate = new Date(s.date);
                        scheduleDate.setHours(0, 0, 0, 0);
                        return scheduleDate >= today && s.status === 'Agendado';
                    })
                    .sort((a, b) => new Date(a.date) - new Date(b.date))
                    .slice(0, 5); // Mostrar apenas os próximos 5
                
                // Atualizar a lista no dashboard
                if (upcomingMaintenanceList) {
                    if (upcomingMaintenance.length > 0) {
                        let html = '';
                        
                        upcomingMaintenance.forEach(schedule => {
                            const scheduleDate = new Date(schedule.date);
                            const formattedDate = scheduleDate.toLocaleDateString('pt-BR');
                            
                            html += `
                                <li class="py-2 flex items-center justify-between">
                                    <div>
                                        <span class="font-medium">${schedule.equipment}</span> - ${schedule.equipmentType}
                                        <p class="text-sm text-gray-500 dark:text-gray-400">${schedule.description}</p>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-sm font-medium">${formattedDate}</span>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">${schedule.time}</p>
                                    </div>
                                </li>
                            `;
                        });
                        
                        upcomingMaintenanceList.innerHTML = html;
                    } else {
                        upcomingMaintenanceList.innerHTML = `
                            <li class="py-2">
                                <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                            </li>
                        `;
                    }
                }
            },
            
            // Atualizar dashboard detalhado
            updateDetailedDashboard() {
                // Calcular totais
                const totalEquipment = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                const totalOperational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalMaintenances = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                // Calcular porcentagem de disponibilidade
                const operationalPercentage = totalEquipment > 0 ? Math.round((totalOperational / totalEquipment) * 100) : 0;
                
                // Atualizar cards superiores
                document.getElementById('detailed-total-equipment').textContent = totalEquipment;
                document.getElementById('detailed-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('detailed-operational-bar').style.width = `${operationalPercentage}%`;
                document.getElementById('detailed-total-maintenances').textContent = totalMaintenances;
                
                // Atualizar cards de categoria
                
                // Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesAvailability = reboquesTotal > 0 ? Math.round((reboquesOperational / reboquesTotal) * 100) : 0;
                
                document.getElementById('detailed-reboques-count').textContent = reboquesTotal;
                document.getElementById('detailed-reboques-availability').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-value').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-bar').style.width = `${reboquesAvailability}%`;
                
                // Caminhões Próprios
                const cpTotal = this.data.caminhoesProps.length;
                const cpOperational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpAvailability = cpTotal > 0 ? Math.round((cpOperational / cpTotal) * 100) : 0;
                
                document.getElementById('detailed-cp-count').textContent = cpTotal;
                document.getElementById('detailed-cp-availability').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-value').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-bar').style.width = `${cpAvailability}%`;
                
                // Caminhões Terceiros
                const ctTotal = this.data.caminhoesTerc.length;
                const ctOperational = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctAvailability = ctTotal > 0 ? Math.round((ctOperational / ctTotal) * 100) : 0;
                
                document.getElementById('detailed-ct-count').textContent = ctTotal;
                document.getElementById('detailed-ct-availability').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-value').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-bar').style.width = `${ctAvailability}%`;
                
                // Frente 4001 - Colhedoras
                const f4001ColhTotal = this.data.frente4001Colhedoras.length;
                const f4001ColhOperational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                const f4001ColhAvailability = f4001ColhTotal > 0 ? Math.round((f4001ColhOperational / f4001ColhTotal) * 100) : 0;
                
                document.getElementById('detailed-f4001-colh-count').textContent = f4001ColhTotal;
                document.getElementById('detailed-f4001-colh-availability').textContent = `${f4001ColhAvailability}%`;
                document.getElementById('detailed-f4001-colh-avail-value').textContent = `${f4001ColhAvailability}%`;
                document.getElementById('detailed-f4001-colh-avail-bar').style.width = `${f4001ColhAvailability}%`;
                
                // Frente 4001 - Trações
                const f4001TracTotal = this.data.frente4001Tracoes.length;
                const f4001TracOperational = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001TracAvailability = f4001TracTotal > 0 ? Math.round((f4001TracOperational / f4001TracTotal) * 100) : 0;
                
                document.getElementById('detailed-f4001-trac-count').textContent = f4001TracTotal;
                document.getElementById('detailed-f4001-trac-availability').textContent = `${f4001TracAvailability}%`;
                document.getElementById('detailed-f4001-trac-avail-value').textContent = `${f4001TracAvailability}%`;
                document.getElementById('detailed-f4001-trac-avail-bar').style.width = `${f4001TracAvailability}%`;
                
                // Frente 4002 - Colhedoras
                const f4002ColhTotal = this.data.frente4002Colhedoras.length;
                const f4002ColhOperational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                const f4002ColhAvailability = f4002ColhTotal > 0 ? Math.round((f4002ColhOperational / f4002ColhTotal) * 100) : 0;
                
                document.getElementById('detailed-f4002-colh-count').textContent = f4002ColhTotal;
                document.getElementById('detailed-f4002-colh-availability').textContent = `${f4002ColhAvailability}%`;
                document.getElementById('detailed-f4002-colh-avail-value').textContent = `${f4002ColhAvailability}%`;
                document.getElementById('detailed-f4002-colh-avail-bar').style.width = `${f4002ColhAvailability}%`;
                
                // Frente 4002 - Trações
                const f4002TracTotal = this.data.frente4002Tracoes.length;
                const f4002TracOperational = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002TracAvailability = f4002TracTotal > 0 ? Math.round((f4002TracOperational / f4002TracTotal) * 100) : 0;
                
                document.getElementById('detailed-f4002-trac-count').textContent = f4002TracTotal;
                document.getElementById('detailed-f4002-trac-availability').textContent = `${f4002TracAvailability}%`;
                document.getElementById('detailed-f4002-trac-avail-value').textContent = `${f4002TracAvailability}%`;
                document.getElementById('detailed-f4002-trac-avail-bar').style.width = `${f4002TracAvailability}%`;
                
                // Atualizar KPIs (fictícios para a demonstração)
                document.getElementById('detailed-mtbf').textContent = totalEquipment > 0 ? `${Math.round(125 + Math.random() * 50)} horas` : '-';
                document.getElementById('detailed-mttr').textContent = totalMaintenances > 0 ? `${Math.round(5 + Math.random() * 10)} horas` : '-';
                document.getElementById('detailed-oee').textContent = totalEquipment > 0 ? `${Math.round(70 + Math.random() * 20)}%` : '-';
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                
                if (total === 0) return;
                
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                // Calcular percentagens
                const operationalPercentage = Math.round((operational / total) * 100);
                const maintenancePercentage = Math.round((maintenance / total) * 100);
                const reformPercentage = Math.round((reform / total) * 100);
                
                // Atualizar o card de informações
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-reform').textContent = reform;
                document.getElementById('reboques-availability').textContent = `${operationalPercentage}%`;
                
                document.getElementById('reboques-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('reboques-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                document.getElementById('reboques-reform-percentage').textContent = `${reformPercentage}%`;
                
                document.getElementById('reboques-availability-bar').style.width = `${operationalPercentage}%`;
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                const total = this.data.caminhoesProps.length;
                
                if (total === 0) return;
                
                const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const reform = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                // Calcular percentagens
                const operationalPercentage = Math.round((operational / total) * 100);
                const maintenancePercentage = Math.round((maintenance / total) * 100);
                const reformPercentage = Math.round((reform / total) * 100);
                
                // Atualizar o card de informações
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-reform').textContent = reform;
                document.getElementById('cp-availability').textContent = `${operationalPercentage}%`;
                
                document.getElementById('cp-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('cp-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                document.getElementById('cp-reform-percentage').textContent = `${reformPercentage}%`;
                
                document.getElementById('cp-availability-bar').style.width = `${operationalPercentage}%`;
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                const total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                
                if (total === 0) return;
                
                const operational = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = Math.round((operational / total) * 100);
                
                // Atualizar as informações
                document.getElementById('f4001-total').textContent = total;
                document.getElementById('f4001-operational').textContent = operational;
                document.getElementById('f4001-maintenance').textContent = maintenance;
                document.getElementById('f4001-reform').textContent = reform;
                document.getElementById('f4001-availability').textContent = `${availability}%`;
                document.getElementById('f4001-availability-bar').style.width = `${availability}%`;
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                const total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                
                if (total === 0) return;
                
                const operational = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Calcular disponibilidade
                const availability = Math.round((operational / total) * 100);
                
                // Atualizar as informações
                document.getElementById('f4002-total').textContent = total;
                document.getElementById('f4002-operational').textContent = operational;
                document.getElementById('f4002-maintenance').textContent = maintenance;
                document.getElementById('f4002-reform').textContent = reform;
                document.getElementById('f4002-availability').textContent = `${availability}%`;
                document.getElementById('f4002-availability-bar').style.width = `${availability}%`;
            },
            
            // Inicializar a visualização real dos equipamentos
            initializeRealEquipmentView() {
                const container = document.getElementById('real-equipment-container');
                if (!container) return;
                
                // Limpar o container
                container.innerHTML = '';
                
                // Adicionar todos os equipamentos
                const allEquipments = [
                    ...this.data.reboques.map(r => ({
                        id: r.frota,
                        type: 'Reboque',
                        category: 'reboques',
                        status: r.status,
                        details: `Tipo: ${r.tipo || 'N/A'}, ${r.acoplado ? 'Acoplado: ' + r.acoplado : 'Não acoplado'}`
                    })),
                    ...this.data.caminhoesProps.map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Próprio',
                        category: 'caminhoes',
                        status: c.status,
                        details: ''
                    })),
                    ...this.data.caminhoesTerc.map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Terceiro',
                        category: 'caminhoes',
                        status: c.status,
                        details: `Proprietário: ${c.proprietario || 'N/A'}`
                    })),
                    ...this.data.frente4001Colhedoras.map(c => ({
                        id: c.codigo,
                        type: 'Colhedora',
                        category: 'colhedoras frente4001',
                        status: c.status,
                        details: 'Frente 4001'
                    })),
                    ...this.data.frente4001Tracoes.map(t => ({
                        id: t.codigo,
                        type: 'Tração',
                        category: 'tracoes frente4001',
                        status: t.status,
                        details: 'Frente 4001'
                    })),
                    ...this.data.frente4002Colhedoras.map(c => ({
                        id: c.codigo,
                        type: 'Colhedora',
                        category: 'colhedoras frente4002',
                        status: c.status,
                        details: 'Frente 4002'
                    })),
                    ...this.data.frente4002Tracoes.map(t => ({
                        id: t.codigo,
                        type: 'Tração',
                        category: 'tracoes frente4002',
                        status: t.status,
                        details: 'Frente 4002'
                    }))
                ];
                
                // Atualizar contador
                document.getElementById('real-equipment-count').textContent = `${allEquipments.length} equipamentos`;
                
                // Criar grid de equipamentos
                const gridHtml = `
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        ${allEquipments.map(equip => {
                            // Determinar classes com base no status
                            let statusClass = '';
                            let textClass = '';
                            let bgClass = '';
                            let icon = '';
                            
                            switch(equip.status) {
                                case 'Operacional':
                                    statusClass = 'border-green-500';
                                    textClass = 'text-green-500';
                                    bgClass = 'bg-green-50 dark:bg-green-900';
                                    icon = 'fa-check-circle';
                                    break;
                                case 'Em manutenção':
                                    statusClass = 'border-yellow-500';
                                    textClass = 'text-yellow-500';
                                    bgClass = 'bg-yellow-50 dark:bg-yellow-900';
                                    icon = 'fa-tools';
                                    break;
                                case 'Em reforma':
                                case 'Inoperante':
                                case 'Aguardando reforma':
                                    statusClass = 'border-red-500';
                                    textClass = 'text-red-500';
                                    bgClass = 'bg-red-50 dark:bg-red-900';
                                    icon = 'fa-exclamation-triangle';
                                    break;
                                default:
                                    statusClass = 'border-gray-500';
                                    textClass = 'text-gray-500';
                                    bgClass = 'bg-gray-50 dark:bg-gray-700';
                                    icon = 'fa-question-circle';
                            }
                            
                            // Determinar ícone com base no tipo
                            let typeIcon = '';
                            
                            if (equip.type === 'Reboque') {
                                typeIcon = 'fa-trailer';
                            } else if (equip.type.includes('Caminhão')) {
                                typeIcon = 'fa-truck';
                            } else if (equip.type === 'Colhedora') {
                                typeIcon = 'fa-tractor';
                            } else if (equip.type === 'Tração') {
                                typeIcon = 'fa-truck-monster';
                            }
                            
                            return `
                                <div class="equip-card ${equip.category.toLowerCase().replace(' ', '-')} ${equip.status.toLowerCase().replace(' ', '-')} border ${statusClass} rounded-lg overflow-hidden shadow-sm">
                                    <div class="${bgClass} p-3 flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center mr-2">
                                                <i class="fas ${typeIcon} ${textClass}"></i>
                                            </div>
                                            <span class="font-medium">${equip.id}</span>
                                        </div>
                                        <i class="fas ${icon} ${textClass}"></i>
                                    </div>
                                    <div class="p-3 bg-white dark:bg-gray-800">
                                        <p class="text-sm font-medium">${equip.type}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${equip.details}</p>
                                        <div class="mt-2">
                                            <span class="status-badge ${
                                                equip.status === 'Operacional' ? 'status-badge-operational' :
                                                equip.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                                ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(equip.status) ? 'status-badge-reform' :
                                                'status-badge-other'
                                            }">
                                                ${equip.status}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                container.innerHTML = gridHtml;
            },
            
            // Filtrar equipamentos na visualização real
            filterRealEquipment(filter) {
                const cards = document.querySelectorAll('.equip-card');
                
                cards.forEach(card => {
                    if (filter === 'all') {
                        card.classList.remove('hidden');
                    } else if (filter === 'operational') {
                        card.classList.toggle('hidden', !card.classList.contains('operacional'));
                    } else if (filter === 'maintenance') {
                        card.classList.toggle('hidden', !card.classList.contains('em-manutenção'));
                    } else if (filter === 'reform') {
                        card.classList.toggle('hidden', !(
                            card.classList.contains('em-reforma') || 
                            card.classList.contains('inoperante') || 
                            card.classList.contains('aguardando-reforma')
                        ));
                    } else if (filter === 'reboques') {
                        card.classList.toggle('hidden', !card.classList.contains('reboques'));
                    } else if (filter === 'caminhoes') {
                        card.classList.toggle('hidden', !card.classList.contains('caminhoes'));
                    } else if (filter === 'colhedoras') {
                        card.classList.toggle('hidden', !(
                            card.classList.contains('colhedoras') ||
                            card.classList.contains('colhedoras-frente4001') ||
                            card.classList.contains('colhedoras-frente4002')
                        ));
                    } else if (filter === 'tracoes') {
                        card.classList.toggle('hidden', !(
                            card.classList.contains('tracoes') ||
                            card.classList.contains('tracoes-frente4001') ||
                            card.classList.contains('tracoes-frente4002')
                        ));
                    } else if (filter === 'frente4001') {
                        card.classList.toggle('hidden', !(
                            card.classList.contains('frente4001') ||
                            card.classList.contains('colhedoras-frente4001') ||
                            card.classList.contains('tracoes-frente4001')
                        ));
                    } else if (filter === 'frente4002') {
                        card.classList.toggle('hidden', !(
                            card.classList.contains('frente4002') ||
                            card.classList.contains('colhedoras-frente4002') ||
                            card.classList.contains('tracoes-frente4002')
                        ));
                    }
                });
                
                // Atualizar contador
                const visibleCards = document.querySelectorAll('.equip-card:not(.hidden)').length;
                document.getElementById('real-equipment-count').textContent = `${visibleCards} equipamentos`;
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                // Limpar campos e atualizar formulário
                this.updateAddFormFields();
                
                // Mostrar modal
                document.getElementById('add-modal').classList.remove('hidden');
            },
            
            // Atualizar campos do formulário de adição de equipamento
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const formFields = document.getElementById('add-form-fields');
                
                let fieldsHtml = '';
                
                switch (type) {
                    case 'reboque':
                        fieldsHtml = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº da Frota*</label>
                                <input type="text" id="add-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Reboque*</label>
                                <select id="add-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="SEMI REBOQUE">SEMI REBOQUE</option>
                                    <option value="REBOQUE">REBOQUE</option>
                                    <option value="DOLLY">DOLLY</option>
                                </select>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado a (opcional)</label>
                                <input type="text" id="add-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                </select>
                            </div>
                            
                            <div id="add-reason-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data da Parada</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                                <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo da parada"></textarea>
                            </div>
                        `;
                        break;
                        
                    case 'caminhao-proprio':
                        fieldsHtml = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº do Caminhão*</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Emprestado">Emprestado</option>
                                </select>
                            </div>
                            
                            <div id="add-reason-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                                <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo"></textarea>
                            </div>
                        `;
                        break;
                        
                    case 'caminhao-terceiro':
                        fieldsHtml = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº do Caminhão*</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário*</label>
                                <input type="text" id="add-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques (opcional)</label>
                                <input type="text" id="add-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex: 1201-1202">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            
                            <div id="add-reason-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo"></textarea>
                            </div>
                        `;
                        break;
                        
                    case 'colhedora-4001':
                    case 'colhedora-4002':
                        const frente = type === 'colhedora-4001' ? '4001' : '4002';
                        
                        fieldsHtml = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código da Colhedora*</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            
                            <div id="add-reason-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                                <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo"></textarea>
                            </div>
                            
                            <input type="hidden" id="add-frente" value="${frente}">
                        `;
                        break;
                        
                    case 'tracao-4001':
                    case 'tracao-4002':
                        const frenteTracao = type === 'tracao-4001' ? '4001' : '4002';
                        
                        fieldsHtml = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código da Tração*</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            
                            <div id="add-reason-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                                <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo"></textarea>
                            </div>
                            
                            <input type="hidden" id="add-frente" value="${frenteTracao}">
                        `;
                        break;
                }
                
                formFields.innerHTML = fieldsHtml;
                
                // Adicionar event listener para mostrar/esconder os campos de motivo
                const statusSelect = document.getElementById('add-status');
                if (statusSelect) {
                    statusSelect.addEventListener('change', () => {
                        const status = statusSelect.value;
                        const reasonContainer = document.getElementById('add-reason-container');
                        
                        if (status !== 'Operacional') {
                            reasonContainer.classList.remove('hidden');
                        } else {
                            reasonContainer.classList.add('hidden');
                        }
                    });
                }
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                const status = document.getElementById('add-status').value;
                
                // Verificar campos obrigatórios com base no tipo
                let isValid = true;
                let newEquipment = {};
                
                switch (type) {
                    case 'reboque':
                        const frota = document.getElementById('add-frota').value;
                        const tipo = document.getElementById('add-tipo').value;
                        
                        if (!frota || !tipo || !status) {
                            isValid = false;
                            break;
                        }
                        
                        newEquipment = {
                            frota,
                            tipo,
                            acoplado: document.getElementById('add-acoplado').value || '',
                            status
                        };
                        
                        // Adicionar motivo e data se não estiver operacional
                        if (status !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value || '';
                            newEquipment.dataParada = document.getElementById('add-data').value || '';
                        }
                        
                        // Verificar se já existe
                        const existingReboque = this.data.reboques.find(r => r.frota === frota);
                        if (existingReboque) {
                            this.showNotification('error', 'Erro', `Já existe um reboque com a frota ${frota}.`);
                            return;
                        }
                        
                        this.data.reboques.push(newEquipment);
                        break;
                        
                    case 'caminhao-proprio':
                        const caminhao = document.getElementById('add-caminhao').value;
                        
                        if (!caminhao || !status) {
                            isValid = false;
                            break;
                        }
                        
                        newEquipment = {
                            caminhao,
                            status
                        };
                        
                        // Adicionar motivo e data se não estiver operacional
                        if (status !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value || '';
                            newEquipment.data = document.getElementById('add-data').value || '';
                        }
                        
                        // Verificar se já existe
                        const existingCP = this.data.caminhoesProps.find(c => c.caminhao === caminhao);
                        if (existingCP) {
                            this.showNotification('error', 'Erro', `Já existe um caminhão próprio com o número ${caminhao}.`);
                            return;
                        }
                        
                        this.data.caminhoesProps.push(newEquipment);
                        break;
                        
                    case 'caminhao-terceiro':
                        const caminhaoT = document.getElementById('add-caminhao').value;
                        const proprietario = document.getElementById('add-proprietario').value;
                        
                        if (!caminhaoT || !proprietario || !status) {
                            isValid = false;
                            break;
                        }
                        
                        newEquipment = {
                            caminhao: caminhaoT,
                            proprietario,
                            reboques: document.getElementById('add-reboques').value || '',
                            status
                        };
                        
                        // Adicionar motivo se não estiver operacional
                        if (status !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value || '';
                        }
                        
                        // Verificar se já existe
                        const existingCT = this.data.caminhoesTerc.find(c => c.caminhao === caminhaoT);
                        if (existingCT) {
                            this.showNotification('error', 'Erro', `Já existe um caminhão terceiro com o número ${caminhaoT}.`);
                            return;
                        }
                        
                        this.data.caminhoesTerc.push(newEquipment);
                        break;
                        
                    case 'colhedora-4001':
                    case 'colhedora-4002':
                        const codigo = document.getElementById('add-codigo').value;
                        const frente = document.getElementById('add-frente').value;
                        
                        if (!codigo || !status) {
                            isValid = false;
                            break;
                        }
                        
                        newEquipment = {
                            codigo,
                            status
                        };
                        
                        // Adicionar motivo e data se não estiver operacional
                        if (status !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value || '';
                            newEquipment.data = document.getElementById('add-data').value || '';
                        }
                        
                        // Determinar o array correto com base na frente
                        const colhedorasArray = frente === '4001' ? this.data.frente4001Colhedoras : this.data.frente4002Colhedoras;
                        
                        // Verificar se já existe
                        const existingColhedora = colhedorasArray.find(c => c.codigo === codigo);
                        if (existingColhedora) {
                            this.showNotification('error', 'Erro', `Já existe uma colhedora com o código ${codigo}.`);
                            return;
                        }
                        
                        // Adicionar ao array correto
                        colhedorasArray.push(newEquipment);
                        break;
                        
                    case 'tracao-4001':
                    case 'tracao-4002':
                        const codigoT = document.getElementById('add-codigo').value;
                        const frenteT = document.getElementById('add-frente').value;
                        
                        if (!codigoT || !status) {
                            isValid = false;
                            break;
                        }
                        
                        newEquipment = {
                            codigo: codigoT,
                            status
                        };
                        
                        // Adicionar motivo e data se não estiver operacional
                        if (status !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value || '';
                            newEquipment.data = document.getElementById('add-data').value || '';
                        }
                        
                        // Determinar o array correto com base na frente
                        const tracoesArray = frenteT === '4001' ? this.data.frente4001Tracoes : this.data.frente4002Tracoes;
                        
                        // Verificar se já existe
                        const existingTracao = tracoesArray.find(t => t.codigo === codigoT);
                        if (existingTracao) {
                            this.showNotification('error', 'Erro', `Já existe uma tração com o código ${codigoT}.`);
                            return;
                        }
                        
                        // Adicionar ao array correto
                        tracoesArray.push(newEquipment);
                        break;
                }
                
                if (!isValid) {
                    this.showNotification('error', 'Erro', 'Por favor, preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Registrar no histórico
                this.addToHistory(newEquipment, type);
                
                // Atualizar localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar tabelas e dashboards
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento adicionado com sucesso.');
            },
            
            // Adicionar ao histórico
            addToHistory(equipment, type) {
                // Identificar o ID do equipamento com base no tipo
                let id = '';
                let statusInfo = '';
                
                if (type === 'reboque') {
                    id = equipment.frota;
                    statusInfo = equipment.status;
                    if (equipment.status !== 'Operacional' && equipment.motivo) {
                        statusInfo += ` - Motivo: ${equipment.motivo}`;
                    }
                } else if (type.includes('caminhao')) {
                    id = equipment.caminhao;
                    statusInfo = equipment.status;
                    if (equipment.status !== 'Operacional' && equipment.motivo) {
                        statusInfo += ` - Motivo: ${equipment.motivo}`;
                    }
                } else {
                    id = equipment.codigo;
                    statusInfo = equipment.status;
                    if (equipment.status !== 'Operacional' && equipment.motivo) {
                        statusInfo += ` - Motivo: ${equipment.motivo}`;
                    }
                }
                
                // Se for o primeiro registro para este ID, criar um array
                if (!this.data.history[id]) {
                    this.data.history[id] = [];
                }
                
                // Adicionar entrada ao histórico
                this.data.history[id].unshift({
                    date: new Date().toISOString(),
                    status: equipment.status,
                    description: `Equipamento adicionado - Status inicial: ${statusInfo}`,
                    user: 'Administrador'
                });
            },
            
            // Editar equipamento existente
            editEquipment(type, id) {
                // Encontrar o equipamento pelo ID e tipo
                let item = null;
                let itemIndex = -1;
                let itemArray = null;
                
                if (type === 'Reboque') {
                    item = this.data.reboques.find(r => r.frota === id);
                    itemIndex = this.data.reboques.findIndex(r => r.frota === id);
                    itemArray = 'reboques';
                } else if (type === 'Caminhão Próprio') {
                    item = this.data.caminhoesProps.find(c => c.caminhao === id);
                    itemIndex = this.data.caminhoesProps.findIndex(c => c.caminhao === id);
                    itemArray = 'caminhoesProps';
                } else if (type === 'Caminhão Terceiro') {
                    item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                    itemIndex = this.data.caminhoesTerc.findIndex(c => c.caminhao === id);
                    itemArray = 'caminhoesTerc';
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    if (type.includes('Frente 4001')) {
                        if (type.includes('Colhedora')) {
                            item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                            itemIndex = this.data.frente4001Colhedoras.findIndex(c => c.codigo === id);
                            itemArray = 'frente4001Colhedoras';
                        } else {
                            item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                            itemIndex = this.data.frente4001Tracoes.findIndex(t => t.codigo === id);
                            itemArray = 'frente4001Tracoes';
                        }
                    } else {
                        if (type.includes('Colhedora')) {
                            item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                            itemIndex = this.data.frente4002Colhedoras.findIndex(c => c.codigo === id);
                            itemArray = 'frente4002Colhedoras';
                        } else {
                            item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                            itemIndex = this.data.frente4002Tracoes.findIndex(t => t.codigo === id);
                            itemArray = 'frente4002Tracoes';
                        }
                    }
                }
                
                if (!item) {
                    this.showNotification('error', 'Erro', 'Equipamento não encontrado.');
                    return;
                }
                
                // Armazenar as informações do item sendo editado
                this.data.editingItem = JSON.parse(JSON.stringify(item)); // Clonar o objeto
                this.data.editingType = type;
                this.data.editingIndex = itemIndex;
                this.data.editingArray = itemArray;
                
                // Preencher o formulário de edição com base no tipo
                this.updateEditFormFields();
                
                // Mostrar o modal de edição
                document.getElementById('edit-modal').classList.remove('hidden');
            },
            
            // Atualizar campos do formulário de edição
            updateEditFormFields() {
                const item = this.data.editingItem;
                const type = this.data.editingType;
                const formFields = document.getElementById('edit-form-fields');
                
                let fieldsHtml = '';
                
                if (type === 'Reboque') {
                    fieldsHtml = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº da Frota</label>
                            <input type="text" id="edit-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.frota}" disabled>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Reboque*</label>
                            <select id="edit-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="SEMI REBOQUE" ${item.tipo === 'SEMI REBOQUE' ? 'selected' : ''}>SEMI REBOQUE</option>
                                <option value="REBOQUE" ${item.tipo === 'REBOQUE' ? 'selected' : ''}>REBOQUE</option>
                                <option value="DOLLY" ${item.tipo === 'DOLLY' ? 'selected' : ''}>DOLLY</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado a (opcional)</label>
                            <input type="text" id="edit-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.acoplado || ''}">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                            <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                            </select>
                        </div>
                        
                        <div id="edit-reason-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data da Parada</label>
                            <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.dataParada || ''}">
                            
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo da parada">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type === 'Caminhão Próprio') {
                    fieldsHtml = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº do Caminhão</label>
                            <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao}" disabled>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                            <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                            </select>
                        </div>
                        
                        <div id="edit-reason-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                            <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type === 'Caminhão Terceiro') {
                    fieldsHtml = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nº do Caminhão</label>
                            <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao}" disabled>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário*</label>
                            <input type="text" id="edit-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.proprietario || ''}" required>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques (opcional)</label>
                            <input type="text" id="edit-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.reboques || ''}" placeholder="Ex: 1201-1202">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                            <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                            </select>
                        </div>
                        
                        <div id="edit-reason-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    fieldsHtml = `
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código do Equipamento</label>
                            <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo}" disabled>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status*</label>
                            <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                            </select>
                        </div>
                        
                        <div id="edit-reason-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                            <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 mt-4">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva o motivo">${item.motivo || ''}</textarea>
                        </div>
                    `;
                }
                
                formFields.innerHTML = fieldsHtml;
                
                // Atualizar título do modal
                document.getElementById('modal-title').textContent = `Editar ${type} - ${item.frota || item.caminhao || item.codigo}`;
                
                // Adicionar event listener para mostrar/esconder os campos de motivo
                const statusSelect = document.getElementById('edit-status');
                if (statusSelect) {
                    statusSelect.addEventListener('change', () => {
                        const status = statusSelect.value;
                        const reasonContainer = document.getElementById('edit-reason-container');
                        
                        if (status !== 'Operacional') {
                            reasonContainer.classList.remove('hidden');
                        } else {
                            reasonContainer.classList.add('hidden');
                        }
                    });
                }
            },
            
            // Salvar alterações de equipamento
            saveEquipmentChanges() {
                const item = this.data.editingItem;
                const type = this.data.editingType;
                const oldStatus = item.status;
                
                // Obter valores do formulário
                const statusSelect = document.getElementById('edit-status');
                const newStatus = statusSelect.value;
                
                // Verificar se os campos obrigatórios foram preenchidos
                if (!newStatus) {
                    this.showNotification('error', 'Erro', 'Por favor, preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Armazenar o novo status para registrar no histórico
                const statusChanged = oldStatus !== newStatus;
                
                // Atualizar o objeto com base no tipo
                if (type === 'Reboque') {
                    item.tipo = document.getElementById('edit-tipo').value;
                    item.acoplado = document.getElementById('edit-acoplado').value || '';
                    item.status = newStatus;
                    
                    if (newStatus !== 'Operacional') {
                        item.motivo = document.getElementById('edit-motivo').value || '';
                        item.dataParada = document.getElementById('edit-data').value || '';
                    } else {
                        // Se o status for Operacional, remover motivo e data
                        delete item.motivo;
                        delete item.dataParada;
                    }
                    
                    // Atualizar no array
                    this.data.reboques[this.data.editingIndex] = item;
                } else if (type === 'Caminhão Próprio') {
                    item.status = newStatus;
                    
                    if (newStatus !== 'Operacional') {
                        item.motivo = document.getElementById('edit-motivo').value || '';
                        item.data = document.getElementById('edit-data').value || '';
                    } else {
                        // Se o status for Operacional, remover motivo e data
                        delete item.motivo;
                        delete item.data;
                    }
                    
                    // Atualizar no array
                    this.data.caminhoesProps[this.data.editingIndex] = item;
                } else if (type === 'Caminhão Terceiro') {
                    item.proprietario = document.getElementById('edit-proprietario').value;
                    item.reboques = document.getElementById('edit-reboques').value || '';
                    item.status = newStatus;
                    
                    if (newStatus !== 'Operacional') {
                        item.motivo = document.getElementById('edit-motivo').value || '';
                    } else {
                        // Se o status for Operacional, remover motivo
                        delete item.motivo;
                    }
                    
                    // Atualizar no array
                    this.data.caminhoesTerc[this.data.editingIndex] = item;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    item.status = newStatus;
                    
                    if (newStatus !== 'Operacional') {
                        item.motivo = document.getElementById('edit-motivo').value || '';
                        item.data = document.getElementById('edit-data').value || '';
                    } else {
                        // Se o status for Operacional, remover motivo e data
                        delete item.motivo;
                        delete item.data;
                    }
                    
                    // Atualizar no array correto com base no tipo
                    if (type.includes('Frente 4001')) {
                        if (type.includes('Colhedora')) {
                            this.data.frente4001Colhedoras[this.data.editingIndex] = item;
                        } else {
                            this.data.frente4001Tracoes[this.data.editingIndex] = item;
                        }
                    } else {
                        if (type.includes('Colhedora')) {
                            this.data.frente4002Colhedoras[this.data.editingIndex] = item;
                        } else {
                            this.data.frente4002Tracoes[this.data.editingIndex] = item;
                        }
                    }
                }
                
                // Adicionar ao histórico se o status mudou
                if (statusChanged) {
                    this.updateEquipmentHistory(item, type, oldStatus, newStatus);
                }
                
                // Atualizar localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar tabelas e dashboards
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Limpar dados de edição
                this.data.editingItem = null;
                this.data.editingType = null;
                this.data.editingIndex = -1;
                this.data.editingArray = null;
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento atualizado com sucesso.');
            },
            
            // Atualizar histórico do equipamento após alteração de status
            updateEquipmentHistory(item, type, oldStatus, newStatus) {
                // Identificar o ID do equipamento com base no tipo
                let id = '';
                
                if (type === 'Reboque') {
                    id = item.frota;
                } else if (type.includes('Caminhão')) {
                    id = item.caminhao;
                } else {
                    id = item.codigo;
                }
                
                // Se for o primeiro registro para este ID, criar um array
                if (!this.data.history[id]) {
                    this.data.history[id] = [];
                }
                
                // Criar descrição com base na mudança de status
                let description = `Status alterado de ${oldStatus} para ${newStatus}`;
                if (newStatus !== 'Operacional' && item.motivo) {
                    description += ` - Motivo: ${item.motivo}`;
                }
                
                // Adicionar entrada ao histórico
                this.data.history[id].unshift({
                    date: new Date().toISOString(),
                    status: newStatus,
                    description,
                    user: 'Administrador'
                });
            },
            
            // Confirmar exclusão de equipamento
            confirmDeleteEquipment(type, id, index, arrayName) {
                document.getElementById('delete-item-details').textContent = `${type}: ${id}`;
                
                // Armazenar informações para exclusão
                this.data.deletingId = id;
                this.data.deletingType = type;
                this.data.deletingIndex = index;
                this.data.deletingArray = arrayName;
                
                // Mostrar modal de confirmação
                document.getElementById('delete-confirm-modal').classList.remove('hidden');
            },
            
            // Excluir equipamento
            deleteEquipment() {
                const { deletingId, deletingType, deletingIndex, deletingArray } = this.data;
                
                if (deletingIndex === -1 || !deletingArray) {
                    this.showNotification('error', 'Erro', 'Erro ao excluir equipamento.');
                    return;
                }
                
                // Remover do array correto
                if (Array.isArray(this.data[deletingArray])) {
                    this.data[deletingArray].splice(deletingIndex, 1);
                }
                
                // Remover histórico associado
                if (this.data.history[deletingId]) {
                    delete this.data.history[deletingId];
                }
                
                // Atualizar localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar tabelas e dashboards
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('delete-confirm-modal').classList.add('hidden');
                
                // Limpar dados de exclusão
                this.data.deletingId = null;
                this.data.deletingType = null;
                this.data.deletingIndex = -1;
                this.data.deletingArray = null;
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', `${deletingType} ${deletingId} excluído com sucesso.`);
            },
            
            // Ver histórico de equipamento
            viewEquipmentHistory(type, id) {
                // Verificar se há histórico para este equipamento
                if (!this.data.history[id] || this.data.history[id].length === 0) {
                    this.showNotification('info', 'Histórico', 'Não há histórico disponível para este equipamento.');
                    return;
                }
                
                // Preencher o modal de histórico
                const historyTitle = document.getElementById('history-title');
                const historySubtitle = document.getElementById('history-subtitle');
                const historyIcon = document.getElementById('history-icon');
                const historyTimeline = document.getElementById('history-timeline');
                
                historyTitle.textContent = `Histórico - ${type} ${id}`;
                historySubtitle.textContent = `Total de registros: ${this.data.history[id].length}`;
                
                // Definir ícone com base no tipo
                if (type.includes('Reboque')) {
                    historyIcon.className = 'fas fa-trailer';
                } else if (type.includes('Caminhão')) {
                    historyIcon.className = 'fas fa-truck';
                } else if (type.includes('Colhedora')) {
                    historyIcon.className = 'fas fa-tractor';
                } else if (type.includes('Tração')) {
                    historyIcon.className = 'fas fa-truck-monster';
                }
                
                // Gerar timeline
                let timelineHtml = '';
                
                this.data.history[id].forEach((entry, index) => {
                    const date = new Date(entry.date);
                    const formattedDate = `${date.toLocaleDateString('pt-BR')} ${date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
                    
                    // Determinar cor com base no status
                    let statusColor = '';
                    switch(entry.status) {
                        case 'Operacional':
                            statusColor = 'bg-green-500';
                            break;
                        case 'Em manutenção':
                            statusColor = 'bg-yellow-500';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'bg-red-500';
                            break;
                        default:
                            statusColor = 'bg-gray-500';
                    }
                    
                    timelineHtml += `
                        <div class="mb-6 relative">
                            <div class="absolute -left-6 mt-1.5 w-3 h-3 rounded-full ${statusColor}"></div>
                            <div class="pl-6">
                                <p class="text-sm font-medium">${formattedDate}</p>
                                <p class="text-sm text-gray-700 dark:text-gray-300 mt-1">${entry.description}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Usuário: ${entry.user}</p>
                            </div>
                        </div>
                    `;
                });
                
                historyTimeline.innerHTML = timelineHtml;
                
                // Mostrar o modal
                document.getElementById('history-modal').classList.remove('hidden');
            },
            
            // Agendar manutenção para equipamento
            scheduleEquipmentMaintenance(type, id) {
                // Encontrar o equipamento pelo ID
                let item = null;
                
                if (type === 'Reboque') {
                    item = this.data.reboques.find(r => r.frota === id);
                } else if (type === 'Caminhão Próprio') {
                    item = this.data.caminhoesProps.find(c => c.caminhao === id);
                } else if (type === 'Caminhão Terceiro') {
                    item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    if (type.includes('Frente 4001')) {
                        if (type.includes('Colhedora')) {
                            item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                        } else {
                            item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                        }
                    } else {
                        if (type.includes('Colhedora')) {
                            item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                        } else {
                            item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                        }
                    }
                }
                
                if (!item) {
                    this.showNotification('error', 'Erro', 'Equipamento não encontrado.');
                    return;
                }
                
                // Preencher informações no modal
                const equipmentInfoEl = document.getElementById('schedule-equipment-info');
                
                let equipmentInfo = `
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center bg-primary bg-opacity-10 text-primary">
                            <i class="${
                                type.includes('Reboque') ? 'fas fa-trailer' :
                                type.includes('Caminhão') ? 'fas fa-truck' :
                                type.includes('Colhedora') ? 'fas fa-tractor' :
                                'fas fa-truck-monster'
                            }"></i>
                        </div>
                        <div class="ml-3">
                            <h4 class="text-lg font-medium">${type}</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">${id}</p>
                        </div>
                    </div>
                    <div class="flex items-center bg-gray-50 dark:bg-gray-750 p-3 rounded-md mb-4">
                        <div class="mr-4">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Status Atual:</span>
                            <span class="status-badge ${
                                item.status === 'Operacional' ? 'status-badge-operational' :
                                item.status === 'Em manutenção' ? 'status-badge-maintenance' :
                                ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(item.status) ? 'status-badge-reform' :
                                'status-badge-other'
                            } ml-2">${item.status}</span>
                        </div>
                        ${item.motivo ? `
                        <div>
                            <span class="text-sm text-gray-500 dark:text-gray-400">Motivo:</span>
                            <span class="text-sm ml-1">${item.motivo}</span>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                equipmentInfoEl.innerHTML = equipmentInfo;
                
                // Configurar parâmetros para today como valor mínimo para a data
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('schedule-date').setAttribute('min', today);
                
                // Armazenar informações para agendamento
                this.data.schedulingEquipment = {
                    id,
                    type
                };
                
                // Mostrar o modal
                document.getElementById('schedule-modal').classList.remove('hidden');
            },
            
            // Salvar agendamento de manutenção
            saveSchedule() {
                const { id, type } = this.data.schedulingEquipment;
                
                // Obter valores do formulário
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const scheduleType = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value;
                const responsible = document.getElementById('schedule-responsible').value;
                
                // Validar campos obrigatórios
                if (!date || !time || !scheduleType || !description || !responsible) {
                    this.showNotification('error', 'Erro', 'Por favor, preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Criar novo agendamento
                const newSchedule = {
                    equipment: id,
                    equipmentType: type,
                    date,
                    time,
                    type: scheduleType,
                    description,
                    responsible,
                    created: new Date().toISOString(),
                    status: 'Agendado'
                };
                
                // Adicionar ao array de agendamentos
                this.data.schedules.push(newSchedule);
                
                // Atualizar localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar dashboard principal (manutenções agendadas)
                this.updateMainDashboard();
                
                // Fechar modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Limpar dados de agendamento
                this.data.schedulingEquipment = null;
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Manutenção agendada com sucesso.');
            },
            
            // Exportar para CSV
            exportToCSV() {
                // Determinar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                let data = [];
                let filename = 'export.csv';
                let headers = [];
                
                // Preparar dados com base na tabela ativa
                if (tabId === 'reboques') {
                    headers = ['Frota', 'Tipo', 'Acoplado', 'Status', 'Data', 'Motivo'];
                    data = this.data.reboques.map(r => [
                        r.frota || '',
                        r.tipo || '',
                        r.acoplado || '',
                        r.status || '',
                        r.dataParada || '',
                        r.motivo || ''
                    ]);
                    filename = 'reboques.csv';
                } else if (tabId === 'caminhoes-proprios') {
                    headers = ['Caminhão', 'Status', 'Data', 'Motivo'];
                    data = this.data.caminhoesProps.map(c => [
                        c.caminhao || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || ''
                    ]);
                    filename = 'caminhoes_proprios.csv';
                } else if (tabId === 'caminhoes-terceiros') {
                    headers = ['Caminhão', 'Proprietário', 'Reboques', 'Status', 'Motivo'];
                    data = this.data.caminhoesTerc.map(c => [
                        c.caminhao || '',
                        c.proprietario || '',
                        c.reboques || '',
                        c.status || '',
                        c.motivo || ''
                    ]);
                    filename = 'caminhoes_terceiros.csv';
                } else if (tabId === 'frente-4001') {
                    headers = ['Tipo', 'Código', 'Status', 'Data', 'Motivo'];
                    
                    const colhedoras = this.data.frente4001Colhedoras.map(c => [
                        'Colhedora',
                        c.codigo || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || ''
                    ]);
                    
                    const tracoes = this.data.frente4001Tracoes.map(t => [
                        'Tração',
                        t.codigo || '',
                        t.status || '',
                        t.data || '',
                        t.motivo || ''
                    ]);
                    
                    data = [...colhedoras, ...tracoes];
                    filename = 'frente_4001.csv';
                } else if (tabId === 'frente-4002') {
                    headers = ['Tipo', 'Código', 'Status', 'Data', 'Motivo'];
                    
                    const colhedoras = this.data.frente4002Colhedoras.map(c => [
                        'Colhedora',
                        c.codigo || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || ''
                    ]);
                    
                    const tracoes = this.data.frente4002Tracoes.map(t => [
                        'Tração',
                        t.codigo || '',
                        t.status || '',
                        t.data || '',
                        t.motivo || ''
                    ]);
                    
                    data = [...colhedoras, ...tracoes];
                    filename = 'frente_4002.csv';
                } else if (tabId === 'main-dashboard' || tabId === 'detailed-dashboard') {
                    // Exportar todos os dados
                    headers = ['Tipo', 'ID', 'Status', 'Data', 'Motivo', 'Detalhes'];
                    
                    // Reboques
                    const reboques = this.data.reboques.map(r => [
                        'Reboque',
                        r.frota || '',
                        r.status || '',
                        r.dataParada || '',
                        r.motivo || '',
                        `Tipo: ${r.tipo || ''}, Acoplado: ${r.acoplado || 'Não'}`
                    ]);
                    
                    // Caminhões Próprios
                    const caminhoesProps = this.data.caminhoesProps.map(c => [
                        'Caminhão Próprio',
                        c.caminhao || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || '',
                        ''
                    ]);
                    
                    // Caminhões Terceiros
                    const caminhoesTerc = this.data.caminhoesTerc.map(c => [
                        'Caminhão Terceiro',
                        c.caminhao || '',
                        c.status || '',
                        '',
                        c.motivo || '',
                        `Proprietário: ${c.proprietario || ''}, Reboques: ${c.reboques || ''}`
                    ]);
                    
                    // Frente 4001
                    const f4001Colhedoras = this.data.frente4001Colhedoras.map(c => [
                        'Colhedora Frente 4001',
                        c.codigo || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || '',
                        ''
                    ]);
                    
                    const f4001Tracoes = this.data.frente4001Tracoes.map(t => [
                        'Tração Frente 4001',
                        t.codigo || '',
                        t.status || '',
                        t.data || '',
                        t.motivo || '',
                        ''
                    ]);
                    
                    // Frente 4002
                    const f4002Colhedoras = this.data.frente4002Colhedoras.map(c => [
                        'Colhedora Frente 4002',
                        c.codigo || '',
                        c.status || '',
                        c.data || '',
                        c.motivo || '',
                        ''
                    ]);
                    
                    const f4002Tracoes = this.data.frente4002Tracoes.map(t => [
                        'Tração Frente 4002',
                        t.codigo || '',
                        t.status || '',
                        t.data || '',
                        t.motivo || '',
                        ''
                    ]);
                    
                    data = [
                        ...reboques,
                        ...caminhoesProps,
                        ...caminhoesTerc,
                        ...f4001Colhedoras,
                        ...f4001Tracoes,
                        ...f4002Colhedoras,
                        ...f4002Tracoes
                    ];
                    
                    filename = 'gestao_frota_completo.csv';
                }
                
                // Sair se não houver dados para exportar
                if (data.length === 0) {
                    this.showNotification('info', 'Exportar', 'Não há dados para exportar.');
                    return;
                }
                
                // Converter para CSV
                let csvContent = headers.join(',') + '\n';
                
                data.forEach(row => {
                    // Escapar campos com vírgulas, aspas ou quebras de linha
                    const escapedRow = row.map(field => {
                        // Converter para string
                        const str = String(field);
                        
                        // Escapar se contiver vírgulas, aspas ou quebras de linha
                        if (str.includes(',') || str.includes('"') || str.includes('\n')) {
                            return `"${str.replace(/"/g, '""')}"`;
                        }
                        
                        return str;
                    });
                    
                    csvContent += escapedRow.join(',') + '\n';
                });
                
                // Criar blob e link para download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Dados exportados com sucesso.');
            },
            
            // Imprimir tabela ativa
            printActiveTable() {
                // Determinar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                let tableTitle = '';
                let tableContent = '';
                
                // Preparar conteúdo com base na tabela ativa
                if (tabId === 'reboques') {
                    tableTitle = 'Reboques';
                    
                    // Tabela HTML para impressão
                    tableContent = `
                        <table class="border-collapse w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 p-2 text-left">Frota</th>
                                    <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 p-2 text-left">Acoplado</th>
                                    <th class="border border-gray-300 p-2 text-left">Status</th>
                                    <th class="border border-gray-300 p-2 text-left">Data</th>
                                    <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.reboques.map(r => `
                                    <tr>
                                        <td class="border border-gray-300 p-2">${r.frota || '-'}</td>
                                        <td class="border border-gray-300 p-2">${r.tipo || '-'}</td>
                                        <td class="border border-gray-300 p-2">${r.acoplado || '-'}</td>
                                        <td class="border border-gray-300 p-2">${r.status || '-'}</td>
                                        <td class="border border-gray-300 p-2">${r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-'}</td>
                                        <td class="border border-gray-300 p-2">${r.motivo || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                } else if (tabId === 'caminhoes-proprios') {
                    tableTitle = 'Caminhões Próprios';
                    
                    tableContent = `
                        <table class="border-collapse w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 p-2 text-left">Caminhão</th>
                                    <th class="border border-gray-300 p-2 text-left">Status</th>
                                    <th class="border border-gray-300 p-2 text-left">Data</th>
                                    <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.caminhoesProps.map(c => `
                                    <tr>
                                        <td class="border border-gray-300 p-2">${c.caminhao || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.status || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.motivo || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                } else if (tabId === 'caminhoes-terceiros') {
                    tableTitle = 'Caminhões Terceiros';
                    
                    tableContent = `
                        <table class="border-collapse w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 p-2 text-left">Caminhão</th>
                                    <th class="border border-gray-300 p-2 text-left">Proprietário</th>
                                    <th class="border border-gray-300 p-2 text-left">Reboques</th>
                                    <th class="border border-gray-300 p-2 text-left">Status</th>
                                    <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.caminhoesTerc.map(c => `
                                    <tr>
                                        <td class="border border-gray-300 p-2">${c.caminhao || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.proprietario || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.reboques || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.status || '-'}</td>
                                        <td class="border border-gray-300 p-2">${c.motivo || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                } else if (tabId === 'frente-4001') {
                    tableTitle = 'Frente 4001';
                    
                    // Combinar colhedoras e trações
                    const combinedData = [
                        ...this.data.frente4001Colhedoras.map(c => ({
                            ...c,
                            type: 'Colhedora'
                        })),
                        ...this.data.frente4001Tracoes.map(t => ({
                            ...t,
                            type: 'Tração'
                        }))
                    ];
                    
                    tableContent = `
                        <table class="border-collapse w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 p-2 text-left">Código</th>
                                    <th class="border border-gray-300 p-2 text-left">Status</th>
                                    <th class="border border-gray-300 p-2 text-left">Data</th>
                                    <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${combinedData.map(item => `
                                    <tr>
                                        <td class="border border-gray-300 p-2">${item.type || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.codigo || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.status || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.data ? new Date(item.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.motivo || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                } else if (tabId === 'frente-4002') {
                    tableTitle = 'Frente 4002';
                    
                    // Combinar colhedoras e trações
                    const combinedData = [
                        ...this.data.frente4002Colhedoras.map(c => ({
                            ...c,
                            type: 'Colhedora'
                        })),
                        ...this.data.frente4002Tracoes.map(t => ({
                            ...t,
                            type: 'Tração'
                        }))
                    ];
                    
                    tableContent = `
                        <table class="border-collapse w-full">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                    <th class="border border-gray-300 p-2 text-left">Código</th>
                                    <th class="border border-gray-300 p-2 text-left">Status</th>
                                    <th class="border border-gray-300 p-2 text-left">Data</th>
                                    <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${combinedData.map(item => `
                                    <tr>
                                        <td class="border border-gray-300 p-2">${item.type || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.codigo || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.status || '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.data ? new Date(item.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        <td class="border border-gray-300 p-2">${item.motivo || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                } else {
                    this.showNotification('info', 'Imprimir', 'Não há dados para imprimir nesta página.');
                    return;
                }
                
                // Preencher área de impressão
                document.getElementById('print-title').textContent = `Relatório - ${tableTitle}`;
                document.getElementById('print-date').textContent = new Date().toLocaleDateString('pt-BR');
                document.getElementById('print-content').innerHTML = tableContent;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Iniciar impressão
                window.print();
            },
            
            // Imprimir dashboard atual
            printDashboard() {
                // Determinar o dashboard ativo
                const dashboardTab = document.querySelector('.tab-content.active');
                if (!dashboardTab || (dashboardTab.id !== 'main-dashboard' && dashboardTab.id !== 'detailed-dashboard')) {
                    this.showNotification('info', 'Imprimir', 'Por favor, navegue para um dashboard para imprimir.');
                    return;
                }
                
                const isMainDashboard = dashboardTab.id === 'main-dashboard';
                const title = isMainDashboard ? 'Dashboard Principal' : 'Dashboard Detalhado';
                
                // Capturar os dados dos dashboards
                let dashboardHtml = '';
                
                if (isMainDashboard) {
                    // Resumo da frota
                    const operational = 
                        this.data.reboques.filter(r => r.status === 'Operacional').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                    
                    const maintenance = 
                        this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                    
                    const reform = 
                        this.data.reboques.filter(r => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length +
                        this.data.caminhoesProps.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.caminhoesTerc.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4001Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4001Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length +
                        this.data.frente4002Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4002Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length;
                    
                    const total = operational + maintenance + reform;
                    const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                    
                    // Equipamentos em manutenção
                    const equipmentsInMaintenance = [
                        ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                            id: r.frota,
                            type: 'Reboque',
                            date: r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '',
                            reason: r.motivo || 'Não informado'
                        })),
                        ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.caminhao,
                            type: 'Caminhão Próprio',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.caminhao,
                            type: 'Caminhão Terceiro',
                            date: '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.codigo,
                            type: 'Colhedora F4001',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                            id: t.codigo,
                            type: 'Tração F4001',
                            date: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '',
                            reason: t.motivo || 'Não informado'
                        })),
                        ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.codigo,
                            type: 'Colhedora F4002',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                            id: t.codigo,
                            type: 'Tração F4002',
                            date: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '',
                            reason: t.motivo || 'Não informado'
                        }))
                    ];
                    
                    // Conteúdo para impressão
                    dashboardHtml = `
                        <div class="mb-6">
                            <h3 class="text-xl font-bold border-b pb-2 mb-4">Resumo da Frota</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <p class="font-medium">Total de Equipamentos: ${total}</p>
                                </div>
                                <div>
                                    <p class="font-medium">Disponibilidade: ${availability}%</p>
                                </div>
                            </div>
                            <table class="border-collapse w-full">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="border border-gray-300 p-2 text-left">Status</th>
                                        <th class="border border-gray-300 p-2 text-right">Quantidade</th>
                                        <th class="border border-gray-300 p-2 text-right">Percentual</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Operacionais</td>
                                        <td class="border border-gray-300 p-2 text-right">${operational}</td>
                                        <td class="border border-gray-300 p-2 text-right">${total > 0 ? Math.round((operational / total) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Em Manutenção</td>
                                        <td class="border border-gray-300 p-2 text-right">${maintenance}</td>
                                        <td class="border border-gray-300 p-2 text-right">${total > 0 ? Math.round((maintenance / total) * 100) : 0}%</td>
                                    </tr>
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Em Reforma/Inoperantes</td>
                                        <td class="border border-gray-300 p-2 text-right">${reform}</td>
                                        <td class="border border-gray-300 p-2 text-right">${total > 0 ? Math.round((reform / total) * 100) : 0}%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-bold border-b pb-2 mb-4">Equipamentos em Manutenção</h3>
                            ${equipmentsInMaintenance.length > 0 ? `
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">ID</th>
                                            <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                            <th class="border border-gray-300 p-2 text-left">Data</th>
                                            <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${equipmentsInMaintenance.map(item => `
                                            <tr>
                                                <td class="border border-gray-300 p-2">${item.id}</td>
                                                <td class="border border-gray-300 p-2">${item.type}</td>
                                                <td class="border border-gray-300 p-2">${item.date || '-'}</td>
                                                <td class="border border-gray-300 p-2">${item.reason}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            ` : `<p>Nenhum equipamento em manutenção no momento.</p>`}
                        </div>
                    `;
                    
                } else {
                    // Dashboard detalhado
                    const totalEquipment = 
                        this.data.reboques.length +
                        this.data.caminhoesProps.length +
                        this.data.caminhoesTerc.length +
                        this.data.frente4001Colhedoras.length +
                        this.data.frente4001Tracoes.length +
                        this.data.frente4002Colhedoras.length +
                        this.data.frente4002Tracoes.length;
                    
                    const totalOperational = 
                        this.data.reboques.filter(r => r.status === 'Operacional').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                    
                    const totalMaintenances = 
                        this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                    
                    const operationalPercentage = totalEquipment > 0 ? Math.round((totalOperational / totalEquipment) * 100) : 0;
                    
                    dashboardHtml = `
                        <div class="mb-6">
                            <h3 class="text-xl font-bold border-b pb-2 mb-4">Resumo Geral</h3>
                            <div class="grid grid-cols-3 gap-4 mb-4">
                                <div>
                                    <p class="font-medium">Total de Equipamentos</p>
                                    <p class="text-xl font-bold">${totalEquipment}</p>
                                </div>
                                <div>
                                    <p class="font-medium">Disponibilidade Geral</p>
                                    <p class="text-xl font-bold">${operationalPercentage}%</p>
                                </div>
                                <div>
                                    <p class="font-medium">Em Manutenção</p>
                                    <p class="text-xl font-bold">${totalMaintenances}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6 page-break-after">
                            <h3 class="text-xl font-bold border-b pb-2 mb-4">Análise por Categoria</h3>
                            <table class="border-collapse w-full">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="border border-gray-300 p-2 text-left">Categoria</th>
                                        <th class="border border-gray-300 p-2 text-right">Total</th>
                                        <th class="border border-gray-300 p-2 text-right">Operacionais</th>
                                        <th class="border border-gray-300 p-2 text-right">Em Manutenção</th>
                                        <th class="border border-gray-300 p-2 text-right">Em Reforma</th>
                                        <th class="border border-gray-300 p-2 text-right">Disponibilidade</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Reboques -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Reboques</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => r.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => r.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.reboques.length > 0 
                                            ? Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / this.data.reboques.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Caminhões Próprios -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Caminhões Próprios</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.caminhoesProps.length > 0 
                                            ? Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / this.data.caminhoesProps.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Caminhões Terceiros -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Caminhões Terceiros</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.caminhoesTerc.length > 0 
                                            ? Math.round((this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length / this.data.caminhoesTerc.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4001 - Colhedoras -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4001 - Colhedoras</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4001Colhedoras.length > 0 
                                            ? Math.round((this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length / this.data.frente4001Colhedoras.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4001 - Trações -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4001 - Trações</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4001Tracoes.length > 0 
                                            ? Math.round((this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length / this.data.frente4001Tracoes.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4002 - Colhedoras -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4002 - Colhedoras</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4002Colhedoras.length > 0 
                                            ? Math.round((this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length / this.data.frente4002Colhedoras.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4002 - Trações -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4002 - Trações</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4002Tracoes.length > 0 
                                            ? Math.round((this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length / this.data.frente4002Tracoes.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                // Preencher área de impressão
                document.getElementById('print-title').textContent = `${title}`;
                document.getElementById('print-date').textContent = new Date().toLocaleDateString('pt-BR');
                document.getElementById('print-content').innerHTML = dashboardHtml;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Iniciar impressão
                window.print();
            },
            
            // Gerar relatório PDF
            generatePDFReport() {
                // Mostrar notificação informando que o PDF será gerado e aberto para impressão
                this.showNotification('info', 'Relatório PDF', 'Preparando relatório completo para impressão. Por favor, aguarde...');
                
                setTimeout(() => {
                    // Preparar conteúdo do relatório
                    
                    // Calcular totais gerais
                    const totalEquipment = 
                        this.data.reboques.length +
                        this.data.caminhoesProps.length +
                        this.data.caminhoesTerc.length +
                        this.data.frente4001Colhedoras.length +
                        this.data.frente4001Tracoes.length +
                        this.data.frente4002Colhedoras.length +
                        this.data.frente4002Tracoes.length;
                    
                    const totalOperational = 
                        this.data.reboques.filter(r => r.status === 'Operacional').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                    
                    const totalMaintenances = 
                        this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                        this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                        this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                        this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                        this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                    
                    const totalReform = 
                        this.data.reboques.filter(r => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length +
                        this.data.caminhoesProps.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.caminhoesTerc.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4001Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4001Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length +
                        this.data.frente4002Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                        this.data.frente4002Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length;
                    
                    const operationalPercentage = totalEquipment > 0 ? Math.round((totalOperational / totalEquipment) * 100) : 0;
                    
                    // Equipamentos em manutenção
                    const equipmentsInMaintenance = [
                        ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                            id: r.frota,
                            type: 'Reboque',
                            date: r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '',
                            reason: r.motivo || 'Não informado'
                        })),
                        ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.caminhao,
                            type: 'Caminhão Próprio',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.caminhao,
                            type: 'Caminhão Terceiro',
                            date: '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.codigo,
                            type: 'Colhedora F4001',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                            id: t.codigo,
                            type: 'Tração F4001',
                            date: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '',
                            reason: t.motivo || 'Não informado'
                        })),
                        ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                            id: c.codigo,
                            type: 'Colhedora F4002',
                            date: c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '',
                            reason: c.motivo || 'Não informado'
                        })),
                        ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                            id: t.codigo,
                            type: 'Tração F4002',
                            date: t.data ? new Date(t.data).toLocaleDateString('pt-BR') : '',
                            reason: t.motivo || 'Não informado'
                        }))
                    ];
                    
                    // Próximas manutenções agendadas
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    const upcomingMaintenance = this.data.schedules
                        .filter(s => {
                            const scheduleDate = new Date(s.date);
                            scheduleDate.setHours(0, 0, 0, 0);
                            return scheduleDate >= today && s.status === 'Agendado';
                        })
                        .sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    // Criar o conteúdo do relatório
                    const reportContent = `
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold mb-4">Resumo Geral da Frota</h2>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-gray-600 text-sm">Total de Equipamentos</p>
                                    <p class="text-3xl font-bold">${totalEquipment}</p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-gray-600 text-sm">Operacionais</p>
                                    <p class="text-3xl font-bold text-green-600">${totalOperational}</p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-gray-600 text-sm">Em Manutenção</p>
                                    <p class="text-3xl font-bold text-yellow-600">${totalMaintenances}</p>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-gray-600 text-sm">Disponibilidade</p>
                                    <p class="text-3xl font-bold text-blue-600">${operationalPercentage}%</p>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="text-xl font-bold mb-3">Distribuição por Status</h3>
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">Status</th>
                                            <th class="border border-gray-300 p-2 text-right">Quantidade</th>
                                            <th class="border border-gray-300 p-2 text-right">Percentual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="border border-gray-300 p-2 font-medium">Operacionais</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalOperational}</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalEquipment > 0 ? Math.round((totalOperational / totalEquipment) * 100) : 0}%</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-gray-300 p-2 font-medium">Em Manutenção</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalMaintenances}</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalEquipment > 0 ? Math.round((totalMaintenances / totalEquipment) * 100) : 0}%</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-gray-300 p-2 font-medium">Em Reforma/Inoperantes</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalReform}</td>
                                            <td class="border border-gray-300 p-2 text-right">${totalEquipment > 0 ? Math.round((totalReform / totalEquipment) * 100) : 0}%</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="mb-8 pdf-page-break">
                            <h2 class="text-2xl font-bold mb-4">Análise por Categoria</h2>
                            <table class="border-collapse w-full">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="border border-gray-300 p-2 text-left">Categoria</th>
                                        <th class="border border-gray-300 p-2 text-right">Total</th>
                                        <th class="border border-gray-300 p-2 text-right">Operacionais</th>
                                        <th class="border border-gray-300 p-2 text-right">Em Manutenção</th>
                                        <th class="border border-gray-300 p-2 text-right">Em Reforma</th>
                                        <th class="border border-gray-300 p-2 text-right">Disponibilidade</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Reboques -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Reboques</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => r.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => r.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.reboques.filter(r => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.reboques.length > 0 
                                            ? Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / this.data.reboques.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Caminhões Próprios -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Caminhões Próprios</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesProps.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.caminhoesProps.length > 0 
                                            ? Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / this.data.caminhoesProps.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Caminhões Terceiros -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Caminhões Terceiros</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.caminhoesTerc.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.caminhoesTerc.length > 0 
                                            ? Math.round((this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length / this.data.caminhoesTerc.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4001 - Colhedoras -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4001 - Colhedoras</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4001Colhedoras.length > 0 
                                            ? Math.round((this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length / this.data.frente4001Colhedoras.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4001 - Trações -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4001 - Trações</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4001Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4001Tracoes.length > 0 
                                            ? Math.round((this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length / this.data.frente4001Tracoes.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4002 - Colhedoras -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4002 - Colhedoras</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Colhedoras.filter(c => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4002Colhedoras.length > 0 
                                            ? Math.round((this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length / this.data.frente4002Colhedoras.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                    
                                    <!-- Frente 4002 - Trações -->
                                    <tr>
                                        <td class="border border-gray-300 p-2 font-medium">Frente 4002 - Trações</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${this.data.frente4002Tracoes.filter(t => ['Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length}</td>
                                        <td class="border border-gray-300 p-2 text-right">${
                                            this.data.frente4002Tracoes.length > 0 
                                            ? Math.round((this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length / this.data.frente4002Tracoes.length) * 100) 
                                            : 0
                                        }%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="mb-8 pdf-page-break">
                            <h2 class="text-2xl font-bold mb-4">Equipamentos em Manutenção</h2>
                            ${equipmentsInMaintenance.length > 0 ? `
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">ID</th>
                                            <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                            <th class="border border-gray-300 p-2 text-left">Data</th>
                                            <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${equipmentsInMaintenance.map(item => `
                                            <tr>
                                                <td class="border border-gray-300 p-2">${item.id}</td>
                                                <td class="border border-gray-300 p-2">${item.type}</td>
                                                <td class="border border-gray-300 p-2">${item.date || '-'}</td>
                                                <td class="border border-gray-300 p-2">${item.reason}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            ` : `<p>Nenhum equipamento em manutenção no momento.</p>`}
                        </div>
                        
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold mb-4">Próximas Manutenções Agendadas</h2>
                            ${upcomingMaintenance.length > 0 ? `
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">Equipamento</th>
                                            <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                            <th class="border border-gray-300 p-2 text-left">Data</th>
                                            <th class="border border-gray-300 p-2 text-left">Manutenção</th>
                                            <th class="border border-gray-300 p-2 text-left">Responsável</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${upcomingMaintenance.map(schedule => `
                                            <tr>
                                                <td class="border border-gray-300 p-2">${schedule.equipment}</td>
                                                <td class="border border-gray-300 p-2">${schedule.equipmentType}</td>
                                                <td class="border border-gray-300 p-2">${new Date(schedule.date).toLocaleDateString('pt-BR')} ${schedule.time}</td>
                                                <td class="border border-gray-300 p-2">${schedule.type === 'preventiva' ? 'Manutenção Preventiva' : 
                                                                                          schedule.type === 'corretiva' ? 'Manutenção Corretiva' : 
                                                                                          schedule.type === 'troca-oleo' ? 'Troca de Óleo' : 
                                                                                          schedule.type === 'revisao' ? 'Revisão Geral' : 
                                                                                          schedule.type === 'reforma' ? 'Reforma' : schedule.type}
                                                                              <div class="text-xs text-gray-500 mt-1">${schedule.description}</div>
                                                </td>
                                                <td class="border border-gray-300 p-2">${schedule.responsible}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            ` : `<p>Nenhuma manutenção agendada.</p>`}
                        </div>
                        
                        <div class="pdf-page-break"></div>
                        
                        <!-- Reboques -->
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold mb-4">Tabela de Reboques</h2>
                            ${this.data.reboques.length > 0 ? `
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">Frota</th>
                                            <th class="border border-gray-300 p-2 text-left">Tipo</th>
                                            <th class="border border-gray-300 p-2 text-left">Acoplado</th>
                                            <th class="border border-gray-300 p-2 text-left">Status</th>
                                            <th class="border border-gray-300 p-2 text-left">Data</th>
                                            <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${this.data.reboques.map(r => `
                                            <tr>
                                                <td class="border border-gray-300 p-2">${r.frota || '-'}</td>
                                                <td class="border border-gray-300 p-2">${r.tipo || '-'}</td>
                                                <td class="border border-gray-300 p-2">${r.acoplado || '-'}</td>
                                                <td class="border border-gray-300 p-2">${r.status || '-'}</td>
                                                <td class="border border-gray-300 p-2">${r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-'}</td>
                                                <td class="border border-gray-300 p-2">${r.motivo || '-'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            ` : `<p>Nenhum reboque registrado.</p>`}
                        </div>
                        
                        <div class="pdf-page-break"></div>
                        
                        <!-- Caminhões Próprios -->
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold mb-4">Tabela de Caminhões Próprios</h2>
                            ${this.data.caminhoesProps.length > 0 ? `
                                <table class="border-collapse w-full">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="border border-gray-300 p-2 text-left">Caminhão</th>
                                            <th class="border border-gray-300 p-2 text-left">Status</th>
                                            <th class="border border-gray-300 p-2 text-left">Data</th>
                                            <th class="border border-gray-300 p-2 text-left">Motivo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${this.data.caminhoesProps.map(c => `
                                            <tr>
                                                <td class="border border-gray-300 p-2">${c.caminhao || '-'}</td>
                                                <td class="border border-gray-300 p-2">${c.status || '-'}</td>
                                                <td class="border border-gray-300 p-2">${c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-'}</td>
                                                <td class="border border-gray-300 p-2">${c.motivo || '-'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            ` : `<p>Nenhum caminhão próprio registrado.</p>`}
                        </div>
                        
                        <!-- Mais tabelas de equipamentos seriam adicionadas aqui -->
                    `;
                    
                    // Preencher área do relatório PDF
                    document.getElementById('pdf-report-title').textContent = 'Relatório Completo de Gestão de Frota';
                    document.getElementById('pdf-report-date').textContent = new Date().toLocaleDateString('pt-BR');
                    document.getElementById('pdf-report-content').innerHTML = reportContent;
                    document.getElementById('pdf-timestamp').textContent = new Date().toLocaleString('pt-BR');
                    
                    // Iniciar impressão
                    window.print();
                }, 500);
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = `notification flex items-center w-64 p-4 mb-4 rounded-lg shadow-lg text-white ${
                    type === 'success' ? 'bg-green-500' :
                    type === 'error' ? 'bg-red-500' :
                    type === 'info' ? 'bg-blue-500' :
                    'bg-yellow-500'
                }`;
                
                // Adicionar ícone com base no tipo
                let icon = '';
                switch (type) {
                    case 'success':
                        icon = 'fa-check-circle';
                        break;
                    case 'error':
                        icon = 'fa-exclamation-circle';
                        break;
                    case 'info':
                        icon = 'fa-info-circle';
                        break;
                    default:
                        icon = 'fa-exclamation-triangle';
                }
                
                // Preencher conteúdo da notificação
                notification.innerHTML = `
                    <div class="mr-3">
                        <i class="fas ${icon} text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold">${title}</h4>
                        <p class="text-sm">${message}</p>
                    </div>
                    <button class="notification-close ml-2">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Adicionar ao container
                container.appendChild(notification);
                
                // Adicionar event listener para o botão de fechar
                notification.querySelector('.notification-close').addEventListener('click', () => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    
                    setTimeout(() => {
                        container.removeChild(notification);
                    }, 300);
                });
                
                // Remover automaticamente após 5 segundos
                setTimeout(() => {
                    if (container.contains(notification)) {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(100%)';
                        
                        setTimeout(() => {
                            if (container.contains(notification)) {
                                container.removeChild(notification);
                            }
                        }, 300);
                    }
                }, 5000);
            }
        };
        
        // Inicializar a aplicação quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            APP.init();
        });
    </script>
</body>
</html>
