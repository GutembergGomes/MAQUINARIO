<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Frota e Manutenção</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#5D5CDE',
                            dark: '#4B4ACB'
                        },
                        gray: {
                            750: '#2B3544'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Estilos personalizados */
        .sidebar-link {
            transition: all 0.2s;
        }
        
        .sidebar-link:hover {
            background-color: rgba(93, 92, 222, 0.1);
        }
        
        .sidebar-link.active {
            background-color: rgba(93, 92, 222, 0.1);
            border-left: 3px solid #5D5CDE;
        }
        
        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-badge-operational {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }
        
        .status-badge-maintenance {
            background-color: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }
        
        .status-badge-reform {
            background-color: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }
        
        .status-badge-other {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6B7280;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
        }
        
        /* Estilos para impressão */
        @media print {
            body * {
                visibility: hidden;
            }
            
            #print-area, #print-area * {
                visibility: visible;
            }
            
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .pdf-page-break {
                page-break-after: always;
            }
            
            .no-print {
                display: none !important;
            }
        }
        
        /* Animação para notificações */
        .notification {
            animation: slide-in 0.3s ease-out;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        
        @keyframes slide-in {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white min-h-screen">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside class="sidebar w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 fixed h-full z-30 shadow-sm">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-truck-moving text-primary text-xl mr-2"></i>
                    <h1 class="text-lg font-bold truncate">Gestão de Frota</h1>
                </div>
                <button id="close-sidebar" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="py-4">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Dashboard</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white active" data-target="main-dashboard">
                    <i class="fas fa-tachometer-alt w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Dashboard Principal</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="detailed-dashboard">
                    <i class="fas fa-chart-line w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Dashboard Detalhado</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="real-equipment-view">
                    <i class="fas fa-eye w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Visualização Real</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Equipamentos</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="reboques">
                    <i class="fas fa-trailer w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Reboques</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-proprios">
                    <i class="fas fa-truck w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Caminhões Próprios</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="caminhoes-terceiros">
                    <i class="fas fa-truck-moving w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Caminhões Terceiros</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4001">
                    <i class="fas fa-tractor w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Frente 4001</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white" data-target="frente-4002">
                    <i class="fas fa-tractor w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Frente 4002</span>
                </a>
            </div>
            
            <div class="py-2">
                <p class="px-4 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Sistema</p>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-cog w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Configurações</span>
                </a>
                <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-800 dark:text-white">
                    <i class="fas fa-question-circle w-5 text-gray-500 dark:text-gray-400"></i>
                    <span class="ml-2">Ajuda</span>
                </a>
            </div>
            
            <div class="mt-auto p-4 border-t border-gray-200 dark:border-gray-700">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="ml-2">
                        <p class="text-sm font-medium">Administrador</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">admin@exemplo.com</p>
                    </div>
                    <button class="ml-auto text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden ml-0 md:ml-64">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm p-4 flex items-center">
                <button id="sidebar-toggle" class="md:hidden text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white mr-3">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav class="hidden md:flex flex-1">
                    <ol class="flex items-center text-sm">
                        <li><a href="#" class="text-primary hover:text-primary-dark">Início</a></li>
                        <li class="mx-2 text-gray-500 dark:text-gray-400">/</li>
                        <li class="text-gray-500 dark:text-gray-400" id="current-page">Dashboard</li>
                    </ol>
                </nav>
                
                <div class="flex items-center ml-auto">
                    <button id="theme-toggle" class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                    
                    <button class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white p-2 relative">
                        <i class="fas fa-bell"></i>
                        <span class="absolute top-1 right-1 w-2 h-2 bg-primary rounded-full"></span>
                    </button>
                    
                    <div class="relative ml-2">
                        <button id="action-menu-btn" class="flex items-center text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                            <span class="mr-1">Ações</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        
                        <div id="action-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-750 rounded-md shadow-lg z-10 border border-gray-200 dark:border-gray-700 hidden">
                            <div class="py-1">
                                <button id="add-equipment-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-plus text-gray-500 dark:text-gray-400 mr-2"></i> Adicionar Equipamento
                                </button>
                                <button id="export-csv-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-file-csv text-gray-500 dark:text-gray-400 mr-2"></i> Exportar para CSV
                                </button>
                                <button id="print-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-print text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Tabela
                                </button>
                                <button id="print-dashboard-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-chart-bar text-gray-500 dark:text-gray-400 mr-2"></i> Imprimir Dashboard
                                </button>
                                <button id="pdf-report-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-file-pdf text-gray-500 dark:text-gray-400 mr-2"></i> Gerar Relatório PDF
                                </button>
                                <button id="import-backup-btn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                    <i class="fas fa-upload text-gray-500 dark:text-gray-400 mr-2"></i> Importar Backup
                                </button>
                                <button id="clear-data-btn" class="w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900">
                                    <i class="fas fa-trash-alt text-red-500 dark:text-red-400 mr-2"></i> Excluir Todos os Registros
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Área de conteúdo principal -->
            <main class="flex-1 overflow-y-auto p-5">
                <!-- Conteúdo das tabs -->
                
                <!-- Dashboard principal -->
                <div id="main-dashboard" class="tab-content active">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Dashboard</h2>
                        
                        <!-- Resumo -->
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
                            <div class="col-span-1 md:col-span-3 lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-medium mb-3">Resumo da Frota</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <p class="text-2xl font-bold text-green-500" id="dash-summary-operational">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <p class="text-2xl font-bold text-yellow-500" id="dash-summary-maintenance">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Em Reforma</p>
                                        <p class="text-2xl font-bold text-red-500" id="dash-summary-reform">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Emprestados</p>
                                        <p class="text-2xl font-bold text-blue-500" id="dash-summary-borrowed">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Outros</p>
                                        <p class="text-2xl font-bold text-gray-500" id="dash-summary-other">0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                        <p class="text-2xl font-bold text-primary" id="dash-summary-availability">0%</p>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-primary rounded-full" id="dash-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Disponibilidade global -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="text-base font-medium">Frota Total</h3>
                                    <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                        <span class="w-3 h-3 rounded-full bg-green-500 mr-1"></span>
                                        <span id="dash-global-operational-percent">0%</span>
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <p class="text-3xl font-bold mb-1" id="dash-global-total">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Equipamentos</p>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <div>
                                        <span class="text-green-500 font-medium" id="dash-global-operational">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Operacionais</span>
                                    </div>
                                    <div>
                                        <span class="text-yellow-500 font-medium" id="dash-global-maintenance">0</span>
                                        <span class="text-gray-500 dark:text-gray-400"> Em Manutenção</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Cards -->
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                                        <i class="fas fa-trailer text-blue-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Reboques</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-reboques-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-reboques-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-reboques-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="dash-reboques-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                                        <i class="fas fa-truck text-green-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Caminhões</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-cp-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-cp-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-cp-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="dash-cp-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-orange-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Frente 4001</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-f4001-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4001-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4001-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="dash-f4001-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                                        <i class="fas fa-tractor text-red-500"></i>
                                    </div>
                                    <h3 class="ml-2 text-base font-medium">Frente 4002</h3>
                                </div>
                                <div>
                                    <p class="text-2xl font-bold mb-1" id="dash-f4002-count">0</p>
                                    <div class="flex justify-between items-center text-sm mb-1">
                                        <span class="text-green-500"><i class="fas fa-check-circle mr-1"></i><span id="dash-f4002-operational">0</span> Operacionais</span>
                                        <span class="text-yellow-500"><i class="fas fa-tools mr-1"></i><span id="dash-f4002-maintenance">0</span> Manutenção</span>
                                    </div>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="dash-f4002-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos e tabelas -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
                            <!-- Gráfico principal -->
                            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Status por Categoria</h3>
                                </div>
                                <div class="relative h-64">
                                    <canvas id="status-by-category-chart"></canvas>
                                    <div id="status-category-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Gráfico de disponibilidade -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Disponibilidade</h3>
                                </div>
                                <div class="relative h-64">
                                    <canvas id="availability-chart"></canvas>
                                    <div id="availability-no-data" class="absolute inset-0 flex items-center justify-center">
                                        <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Listas de informações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Equipamentos em manutenção -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Equipamentos em Manutenção</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="equipment-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Manutenções agendadas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-base font-medium">Próximas Manutenções Agendadas</h3>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="upcoming-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard detalhado -->
                <div id="detailed-dashboard" class="tab-content bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Dashboard Detalhado</h2>
                        <button id="detailed-refresh-btn" class="btn-primary-outline">
                            <i class="fas fa-sync-alt mr-2"></i>Atualizar
                        </button>
                    </div>
                    
                    <!-- Resumo geral -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <!-- Total de equipamentos -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-primary bg-opacity-10 flex items-center justify-center mr-4">
                                    <i class="fas fa-truck-moving text-primary text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Equipamentos</h3>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="detailed-total-equipment">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Disponibilidade geral -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Disponibilidade Geral</h3>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mb-2" id="detailed-operational-percentage">0%</p>
                            <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500 rounded-full" id="detailed-operational-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <!-- Total em manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center mr-4">
                                    <i class="fas fa-tools text-yellow-500 text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Manutenção</h3>
                                    <p class="text-2xl font-bold text-gray-800 dark:text-white" id="detailed-total-maintenances">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Painel com gráficos -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <!-- Distribuição de status -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Distribuição de Status por Categoria</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-status-distribution-chart"></canvas>
                                <div id="detailed-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tendência de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Tendência de Disponibilidade</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-availability-trend-chart"></canvas>
                                <div id="detailed-trend-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Análise por categoria -->
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Análise por Categoria</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            <!-- Reboques -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-trailer text-blue-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Reboques</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-reboques-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-reboques-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-reboques-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-blue-500 rounded-full" id="detailed-reboques-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Próprios -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck text-green-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Caminhões Próprios</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-cp-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-cp-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-cp-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-green-500 rounded-full" id="detailed-cp-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Terceiros -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-moving text-purple-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Caminhões Terceiros</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-ct-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-ct-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-ct-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-purple-500 rounded-full" id="detailed-ct-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4001 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <!-- Frente 4001 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-orange-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4001 - Colhedoras</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-colh-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4001-colh-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4001-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4001 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-orange-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4001 - Trações</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4001-trac-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4001-trac-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4001-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-orange-500 rounded-full" id="detailed-f4001-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Frente 4002 - Separado em Colhedoras e Trações -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <!-- Frente 4002 - Colhedoras -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-tractor text-red-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4002 - Colhedoras</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-colh-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4002-colh-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4002-colh-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-colh-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4002 - Trações -->
                            <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                <div class="flex items-center mb-4">
                                    <div class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck-monster text-red-500"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-medium">Frente 4002 - Trações</h4>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="detailed-f4002-trac-count">0</span></p>
                                    </div>
                                    <p class="ml-auto text-lg font-bold" id="detailed-f4002-trac-availability">0%</p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</span>
                                        <span class="text-sm font-medium" id="detailed-f4002-trac-avail-value">0%</span>
                                    </div>
                                    <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                        <div class="h-full bg-red-500 rounded-full" id="detailed-f4002-trac-avail-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- KPIs -->
                    <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-6">
                        <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Indicadores de Desempenho</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">MTBF (Tempo Médio Entre Falhas)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-mtbf">-</p>
                            </div>
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">MTTR (Tempo Médio Para Reparo)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-mttr">-</p>
                            </div>
                            <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700">
                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">OEE (Eficácia Global do Equipamento)</h4>
                                <p class="text-xl font-bold mt-1" id="detailed-oee">-</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos adicionais -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Causas de manutenção -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Causas de Manutenção</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-maintenance-causes-chart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Previsão de disponibilidade -->
                        <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                            <h3 class="text-base font-medium text-gray-800 dark:text-white mb-4">Previsão de Disponibilidade</h3>
                            <div class="relative h-64">
                                <canvas id="detailed-forecast-chart"></canvas>
                                <div id="detailed-forecast-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Dados insuficientes para previsão</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Visualização Real da Frota -->
                <div id="real-equipment-view" class="tab-content hidden">
                    <div class="mb-6">
                        <div class="flex flex-wrap justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Visualização Real da Frota</h2>
                            <p class="mt-2 md:mt-0 text-gray-500 dark:text-gray-400" id="real-equipment-count">0 equipamentos</p>
                        </div>
                        
                        <!-- Filtros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <h3 class="text-base font-medium mb-3">Filtros</h3>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="APP.filterRealEquipment('all')" class="px-3 py-1 bg-primary text-white rounded-md text-sm hover:bg-primary-dark transition">
                                    Todos
                                </button>
                                <button onclick="APP.filterRealEquipment('operational')" class="px-3 py-1 bg-green-500 text-white rounded-md text-sm hover:bg-green-600 transition">
                                    Operacionais
                                </button>
                                <button onclick="APP.filterRealEquipment('maintenance')" class="px-3 py-1 bg-yellow-500 text-white rounded-md text-sm hover:bg-yellow-600 transition">
                                    Em Manutenção
                                </button>
                                <button onclick="APP.filterRealEquipment('reform')" class="px-3 py-1 bg-red-500 text-white rounded-md text-sm hover:bg-red-600 transition">
                                    Em Reforma
                                </button>
                                <button onclick="APP.filterRealEquipment('reboques')" class="px-3 py-1 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600 transition">
                                    Reboques
                                </button>
                                <button onclick="APP.filterRealEquipment('caminhoes')" class="px-3 py-1 bg-gray-500 text-white rounded-md text-sm hover:bg-gray-600 transition">
                                    Caminhões
                                </button>
                                <button onclick="APP.filterRealEquipment('colhedoras')" class="px-3 py-1 bg-orange-500 text-white rounded-md text-sm hover:bg-orange-600 transition">
                                    Colhedoras
                                </button>
                                <button onclick="APP.filterRealEquipment('tracoes')" class="px-3 py-1 bg-purple-500 text-white rounded-md text-sm hover:bg-purple-600 transition">
                                    Trações
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4001')" class="px-3 py-1 bg-orange-400 text-white rounded-md text-sm hover:bg-orange-500 transition">
                                    Frente 4001
                                </button>
                                <button onclick="APP.filterRealEquipment('frente4002')" class="px-3 py-1 bg-red-400 text-white rounded-md text-sm hover:bg-red-500 transition">
                                    Frente 4002
                                </button>
                            </div>
                        </div>
                        
                        <!-- Visualização real -->
                        <div id="real-equipment-container" class="mt-6">
                            <!-- Equipamentos serão renderizados via JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Reboques -->
                <div id="reboques" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Reboques</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="reboques-operational">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-operational-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="reboques-maintenance">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-maintenance-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="reboques-reform">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="reboques-reform-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                    <p class="text-xl font-bold text-blue-500" id="reboques-availability">0%</p>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-blue-500 rounded-full" id="reboques-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <h3 class="text-lg font-medium mb-3">Status dos Reboques</h3>
                            <div class="relative h-60">
                                <canvas id="reboques-status-chart"></canvas>
                                <div id="reboques-status-no-data" class="absolute inset-0 flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="reboques-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="reboques-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Aguardando reforma">Aguardando reforma</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="reboques-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de reboques -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="frota">
                                                <button class="flex items-center">
                                                    Frota
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="tipo">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="acoplado">
                                                <button class="flex items-center">
                                                    Acoplado
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="dataParada">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="reboques-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Próprios -->
                <div id="caminhoes-proprios" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Caminhões Próprios</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="cp-operational">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-operational-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="cp-maintenance">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-maintenance-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="cp-reform">0</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><span id="cp-reform-percentage">0%</span> do total</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                    <p class="text-xl font-bold text-green-500" id="cp-availability">0%</p>
                                    <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-2">
                                        <div class="h-full bg-green-500 rounded-full" id="cp-availability-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="cp-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="cp-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                        <option value="Emprestado">Emprestado</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="cp-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões próprios -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="cp-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhões Terceiros -->
                <div id="caminhoes-terceiros" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Caminhões Terceiros</h2>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="ct-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="ct-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <button id="ct-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela de caminhões terceiros -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="caminhao">
                                                <button class="flex items-center">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="proprietario">
                                                <button class="flex items-center">
                                                    Proprietário
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Reboques
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="ct-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4001 -->
                <div id="frente-4001" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Frente 4001</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Total de Equipamentos</p>
                                    <p class="text-xl font-bold text-gray-800 dark:text-white" id="f4001-total">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="f4001-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="f4001-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="f4001-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-orange-500 rounded-full" id="f4001-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-3 font-bold" id="f4001-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4001-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="f4001-type-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-3">
                                    <select id="f4001-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-3">
                                    <select id="f4001-add-type" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4001">Colhedora</option>
                                        <option value="tracao-4001">Tração</option>
                                    </select>
                                </div>
                                <button id="f4001-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4001 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4001-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Frente 4002 -->
                <div id="frente-4002" class="tab-content hidden">
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Frente 4002</h2>
                        
                        <!-- Card de informações -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700 mb-4">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Total de Equipamentos</p>
                                    <p class="text-xl font-bold text-gray-800 dark:text-white" id="f4002-total">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Operacionais</p>
                                    <p class="text-xl font-bold text-green-500" id="f4002-operational">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Manutenção</p>
                                    <p class="text-xl font-bold text-yellow-500" id="f4002-maintenance">0</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Em Reforma</p>
                                    <p class="text-xl font-bold text-red-500" id="f4002-reform">0</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Disponibilidade</p>
                                <div class="flex items-center">
                                    <div class="flex-1">
                                        <div class="h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-red-500 rounded-full" id="f4002-availability-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span class="ml-3 font-bold" id="f4002-availability">0%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ferramentas de tabela -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-4 py-3 border border-gray-200 dark:border-gray-700 mb-4 flex flex-wrap items-center justify-between">
                            <div class="flex items-center">
                                <div class="relative">
                                    <input type="text" id="f4002-search" placeholder="Buscar..." class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <select id="f4002-type-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os tipos</option>
                                        <option value="Colhedora">Colhedoras</option>
                                        <option value="Tração">Trações</option>
                                    </select>
                                </div>
                                <div class="ml-3">
                                    <select id="f4002-status-filter" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="all">Todos os status</option>
                                        <option value="Operacional">Operacional</option>
                                        <option value="Em manutenção">Em manutenção</option>
                                        <option value="Em reforma">Em reforma</option>
                                        <option value="Inoperante">Inoperante</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex items-center mt-3 sm:mt-0">
                                <div class="mr-3">
                                    <select id="f4002-add-type" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <option value="colhedora-4002">Colhedora</option>
                                        <option value="tracao-4002">Tração</option>
                                    </select>
                                </div>
                                <button id="f4002-add-btn" class="bg-primary text-white px-3 py-2 rounded-md text-sm hover:bg-primary-dark transition">
                                    <i class="fas fa-plus mr-1"></i> Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tabela da frente 4002 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="type">
                                                <button class="flex items-center">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="codigo">
                                                <button class="flex items-center">
                                                    Código
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="status">
                                                <button class="flex items-center">
                                                    Status
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider" data-sort="data">
                                                <button class="flex items-center">
                                                    Data
                                                    <i class="fas fa-sort ml-1 text-gray-400"></i>
                                                </button>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="f4002-table-body" class="divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão carregados via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Modais -->
    
    <!-- Modal para adicionar equipamento -->
    <div id="add-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Adicionar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('add-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                    <select id="equipment-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                        <option value="reboque">Reboque</option>
                        <option value="caminhao-proprio">Caminhão Próprio</option>
                        <option value="caminhao-terceiro">Caminhão Terceiro</option>
                        <option value="colhedora-4001">Colhedora Frente 4001</option>
                        <option value="tracao-4001">Tração Frente 4001</option>
                        <option value="colhedora-4002">Colhedora Frente 4002</option>
                        <option value="tracao-4002">Tração Frente 4002</option>
                    </select>
                </div>
                
                <div id="add-form-fields">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('add-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-equipment-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para editar equipamento -->
    <div id="edit-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white" id="modal-title">Editar Equipamento</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div id="edit-form-fields">
                    <!-- Campos dinâmicos serão carregados via JavaScript -->
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('edit-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-changes-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão -->
    <div id="delete-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Confirmar Exclusão</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <div class="flex items-center justify-center mb-4 text-red-500">
                        <i class="fas fa-exclamation-triangle text-3xl"></i>
                    </div>
                    <p id="delete-confirm-message" class="text-center">Tem certeza que deseja excluir este equipamento?</p>
                    <p id="delete-item-details" class="text-center mt-2 font-medium"></p>
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('delete-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-delete-btn" class="px-4 py-2 text-sm bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar exclusão de todos os registros -->
    <div id="clear-data-confirm-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Confirmar Exclusão Total</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <div class="flex items-center justify-center mb-4 text-red-500">
                        <i class="fas fa-exclamation-triangle text-5xl"></i>
                    </div>
                    <p class="text-center text-lg font-bold text-red-600 dark:text-red-400">ATENÇÃO!</p>
                    <p class="text-center mt-2">Você está prestes a excluir TODOS os registros do sistema. Esta ação não pode ser desfeita.</p>
                    <p class="text-center mt-4 font-medium">Por favor, digite "CONFIRMAR" para prosseguir:</p>
                    <input type="text" id="clear-data-confirmation" class="w-full mt-2 px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Digite CONFIRMAR">
                </div>
                
                <div class="flex justify-center mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('clear-data-confirm-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="confirm-clear-data-btn" class="px-4 py-2 text-sm bg-red-500 text-white rounded-md hover:bg-red-600 transition">
                        Excluir Todos os Registros
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para importar backup -->
    <div id="import-backup-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Importar Backup</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <p class="mb-4">Selecione um arquivo JSON de backup para importar. Este arquivo substituirá todos os dados atuais do sistema.</p>
                    <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center">
                        <input type="file" id="backup-file-input" accept=".json" class="hidden">
                        <label for="backup-file-input" class="cursor-pointer">
                            <i class="fas fa-file-upload text-gray-400 text-3xl mb-2"></i>
                            <p class="text-gray-500 dark:text-gray-400">Clique para selecionar um arquivo JSON</p>
                            <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">ou arraste e solte aqui</p>
                        </label>
                        <p id="selected-file-name" class="mt-3 text-sm text-primary hidden"></p>
                    </div>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('import-backup-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="import-backup-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition" disabled>
                        Importar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para visualizar histórico -->
    <div id="history-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-primary bg-opacity-10 text-primary flex items-center justify-center mr-2">
                        <i id="history-icon" class="fas fa-truck"></i>
                    </div>
                    <div>
                        <h3 id="history-title" class="text-lg font-medium text-gray-800 dark:text-white">Histórico</h3>
                        <p id="history-subtitle" class="text-xs text-gray-500 dark:text-gray-400">Total de registros: 0</p>
                    </div>
                </div>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="p-4 overflow-y-auto flex-1">
                <div class="relative pl-10 border-l-2 border-gray-200 dark:border-gray-700" id="history-timeline">
                    <!-- Histórico será carregado via JavaScript -->
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition" onclick="document.getElementById('history-modal').classList.add('hidden')">
                    Fechar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal para agendar manutenção -->
    <div id="schedule-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-800 dark:text-white">Agendar Manutenção</h3>
                <button class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div id="schedule-equipment-info" class="mb-4">
                    <!-- Detalhes do equipamento serão carregados via JavaScript -->
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                    <input type="date" id="schedule-date" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hora</label>
                    <input type="time" id="schedule-time" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Manutenção</label>
                    <select id="schedule-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                        <option value="preventiva">Manutenção Preventiva</option>
                        <option value="corretiva">Manutenção Corretiva</option>
                        <option value="revisao">Revisão Geral</option>
                        <option value="troca-oleo">Troca de Óleo</option>
                        <option value="reforma">Reforma</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrição</label>
                    <textarea id="schedule-description" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva a manutenção a ser realizada" required></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                    <input type="text" id="schedule-responsible" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Nome do responsável" required>
                </div>
                
                <div class="flex justify-end mt-6">
                    <button class="mr-2 px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition" onclick="document.getElementById('schedule-modal').classList.add('hidden')">
                        Cancelar
                    </button>
                    <button id="save-schedule-btn" class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary-dark transition">
                        Agendar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Área de impressão -->
    <div id="print-area" class="hidden bg-white text-black p-8">
        <div class="mb-6 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="print-title" class="text-2xl font-bold">Relatório</h1>
                <p id="print-date" class="text-sm text-gray-600"></p>
            </div>
        </div>
        
        <div id="print-content" class="mb-6">
            <!-- Conteúdo para impressão será inserido aqui -->
        </div>
        
        <div class="text-right text-xs text-gray-500 mt-8">
            <p>Gerado em: <span id="print-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Área para relatório PDF -->
    <div id="pdf-report-area" class="hidden bg-white text-black p-8">
        <div class="mb-6 pb-6 border-b border-gray-300">
            <div class="flex justify-between items-center">
                <h1 id="pdf-report-title" class="text-2xl font-bold">Relatório Completo</h1>
                <p id="pdf-report-date" class="text-sm text-gray-600"></p>
            </div>
        </div>
        
        <div id="pdf-report-content" class="mb-6">
            <!-- Conteúdo do relatório PDF será inserido aqui -->
        </div>
        
        <div class="text-right text-xs text-gray-500 mt-8">
            <p>Gerado em: <span id="pdf-timestamp"></span></p>
        </div>
    </div>
    
    <!-- Container para notificações -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 flex flex-col space-y-2"></div>
    
    <!-- JavaScript -->
    <script>
        // Aplicação principal
        const APP = {
            data: {
                // Dados dos equipamentos
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                
                // Histórico
                history: {},
                
                // Agendamentos
                schedules: [],
                
                // Preferências e estados da UI
                currentSort: {
                    field: null,
                    direction: 'asc'
                },
                searchText: '',
                statusFilter: 'all',
                typeFilter: 'all',
                
                // Referências para os gráficos
                charts: {},
                
                // Estado de edição
                editingItem: null,
                editingType: null,
                
                // Estado de exclusão
                deletingId: null,
                deletingType: null,
                deletingIndex: null,
                deletingArray: null,
                
                // Estado de agendamento
                schedulingEquipment: null
            },
            
            // Inicializar a aplicação
            init() {
                // Configurar temas e preferências
                this.setupTheme();
                
                // Inicializar interface
                this.initUI();
                
                // Carregar dados
                this.loadData();
                
                // Inicializar gráficos
                this.initializeCharts();
                
                // Renderizar tabelas
                this.renderAllTables();
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Carregar visualização real
                this.initializeRealEquipmentView();
                
                // Atualizar todos os gráficos
                this.updateAllCharts();
                
                // Configurar event listeners
                this.setupEventListeners();
            },
            
            // Configurar tema (claro/escuro)
            setupTheme() {
                const themeToggle = document.getElementById('theme-toggle');
                
                // Configurar tema baseado na preferência do sistema
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                // Toggle de tema claro/escuro
                themeToggle.addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                });
            },
            
            // Inicializar a interface do usuário
            initUI() {
                // Configurar navegação entre abas
                document.querySelectorAll('[data-target]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // Atualizar classes do link
                        document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                        
                        // Atualizar o conteúdo visível
                        const targetId = link.getAttribute('data-target');
                        document.querySelectorAll('.tab-content').forEach(tab => {
                            tab.classList.add('hidden');
                            tab.classList.remove('active');
                        });
                        
                        const target = document.getElementById(targetId);
                        target.classList.remove('hidden');
                        target.classList.add('active');
                        
                        // Atualizar breadcrumb
                        document.getElementById('current-page').textContent = link.querySelector('span').textContent;
                        
                        // Fechar sidebar em dispositivos móveis
                        if (window.innerWidth < 768) {
                            document.querySelector('.sidebar').classList.remove('open');
                        }
                    });
                });
                
                // Toggle sidebar em dispositivos móveis
                document.getElementById('sidebar-toggle').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.add('open');
                });
                
                document.getElementById('close-sidebar').addEventListener('click', () => {
                    document.querySelector('.sidebar').classList.remove('open');
                });
                
                // Menu de ações
                const actionMenuBtn = document.getElementById('action-menu-btn');
                const actionMenu = document.getElementById('action-menu');
                
                actionMenuBtn.addEventListener('click', () => {
                    actionMenu.classList.toggle('hidden');
                });
                
                // Fechar o menu ao clicar fora dele
                document.addEventListener('click', (e) => {
                    if (!actionMenuBtn.contains(e.target) && !actionMenu.contains(e.target)) {
                        actionMenu.classList.add('hidden');
                    }
                });
                
                // Formulário de adição de equipamento
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Botões de ação
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('save-equipment-btn').addEventListener('click', () => {
                    this.saveNewEquipment();
                });
                
                document.getElementById('save-changes-btn').addEventListener('click', () => {
                    this.saveEquipmentChanges();
                });
                
                document.getElementById('confirm-delete-btn').addEventListener('click', () => {
                    this.deleteEquipment();
                });
                
                document.getElementById('save-schedule-btn').addEventListener('click', () => {
                    this.saveSchedule();
                });
                
                // Botões para adicionar equipamentos específicos
                document.getElementById('reboques-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'reboque';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('cp-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-proprio';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('ct-add-btn')?.addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'caminhao-terceiro';
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4001-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4001-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                document.getElementById('f4002-add-btn')?.addEventListener('click', () => {
                    const type = document.getElementById('f4002-add-type').value;
                    document.getElementById('equipment-type').value = type;
                    this.updateAddFormFields();
                    this.showAddEquipmentModal();
                });
                
                // Botões de exportação e impressão
                document.getElementById('export-csv-btn').addEventListener('click', () => {
                    this.exportToCSV();
                });
                
                document.getElementById('print-btn').addEventListener('click', () => {
                    this.printActiveTable();
                });
                
                document.getElementById('print-dashboard-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                document.getElementById('pdf-report-btn').addEventListener('click', () => {
                    this.generatePDFReport();
                });
                
                // Botão de limpeza de dados
                document.getElementById('clear-data-btn').addEventListener('click', () => {
                    document.getElementById('clear-data-confirm-modal').classList.remove('hidden');
                });
                
                document.getElementById('confirm-clear-data-btn').addEventListener('click', () => {
                    this.clearAllData();
                });
                
                // Botão para importar backup
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    document.getElementById('import-backup-modal').classList.remove('hidden');
                });
                
                // Configurar input de arquivo de backup
                const fileInput = document.getElementById('backup-file-input');
                const fileNameDisplay = document.getElementById('selected-file-name');
                const importBtn = document.getElementById('import-backup-btn');
                
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        const file = e.target.files[0];
                        fileNameDisplay.textContent = file.name;
                        fileNameDisplay.classList.remove('hidden');
                        document.getElementById('import-backup-btn').removeAttribute('disabled');
                    } else {
                        fileNameDisplay.classList.add('hidden');
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                    }
                });
                
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    this.importDataFromFile();
                });
                
                // Botão de atualização do dashboard detalhado
                document.getElementById('detailed-refresh-btn')?.addEventListener('click', () => {
                    this.updateDetailedDashboardCharts();
                    this.updateDetailedDashboard();
                });
            },
            
            // Configurar event listeners adicionais
            setupEventListeners() {
                // Event listeners para filtros
                document.getElementById('reboques-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('reboques-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('cp-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('cp-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCPTable();
                });
                
                document.getElementById('ct-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('ct-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderCTTable();
                });
                
                document.getElementById('f4001-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4001-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4001Table();
                });
                
                document.getElementById('f4002-search')?.addEventListener('input', (e) => {
                    this.data.searchText = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-type-filter')?.addEventListener('change', (e) => {
                    this.data.typeFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                document.getElementById('f4002-status-filter')?.addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderF4002Table();
                });
                
                // Event listeners para ordenação
                document.querySelectorAll('th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        const field = th.getAttribute('data-sort');
                        
                        if (this.data.currentSort.field === field) {
                            this.data.currentSort.direction = this.data.currentSort.direction === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.data.currentSort.field = field;
                            this.data.currentSort.direction = 'asc';
                        }
                        
                        // Atualizar visualmente os ícones de ordenação
                        document.querySelectorAll('th[data-sort] i').forEach(icon => {
                            icon.className = 'fas fa-sort ml-1 text-gray-400';
                        });
                        
                        const icon = th.querySelector('i');
                        icon.className = `fas fa-sort-${this.data.currentSort.direction === 'asc' ? 'up' : 'down'} ml-1 text-gray-800 dark:text-white`;
                        
                        // Renderizar a tabela atual
                        const activeTab = document.querySelector('.tab-content.active');
                        if (activeTab) {
                            const id = activeTab.id;
                            
                            if (id === 'reboques') {
                                this.renderReboquesTable();
                            } else if (id === 'caminhoes-proprios') {
                                this.renderCPTable();
                            } else if (id === 'caminhoes-terceiros') {
                                this.renderCTTable();
                            } else if (id === 'frente-4001') {
                                this.renderF4001Table();
                            } else if (id === 'frente-4002') {
                                this.renderF4002Table();
                            }
                        }
                    });
                });
                
                // Configurar area de arrastar e soltar para importação de backup
                const dropZone = document.querySelector('.border-dashed');
                
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropZone.addEventListener(eventName, highlight, false);
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, unhighlight, false);
                });

                function highlight() {
                    dropZone.classList.add('border-primary', 'bg-primary', 'bg-opacity-5');
                }

                function unhighlight() {
                    dropZone.classList.remove('border-primary', 'bg-primary', 'bg-opacity-5');
                }
                
                dropZone.addEventListener('drop', (e) => {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type === 'application/json' || file.name.endsWith('.json')) {
                            document.getElementById('backup-file-input').files = files;
                            document.getElementById('selected-file-name').textContent = file.name;
                            document.getElementById('selected-file-name').classList.remove('hidden');
                            document.getElementById('import-backup-btn').removeAttribute('disabled');
                        } else {
                            this.showNotification('error', 'Erro', 'Por favor, selecione um arquivo JSON válido.');
                        }
                    }
                });
            },
            
            // Carregar dados (inicialmente usando dados de exemplo)
            loadData() {
                // Verificar se já existem dados no LocalStorage
                const savedData = localStorage.getItem('fleetManagementData');
                
                if (savedData) {
                    try {
                        const parsedData = JSON.parse(savedData);
                        
                        // Atualizar dados
                        this.data.reboques = parsedData.reboques || [];
                        this.data.caminhoesProps = parsedData.caminhoesProps || [];
                        this.data.caminhoesTerc = parsedData.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = parsedData.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = parsedData.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = parsedData.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = parsedData.frente4002Tracoes || [];
                        this.data.history = parsedData.history || {};
                        this.data.schedules = parsedData.schedules || [];
                        
                        return;
                    } catch (error) {
                        console.error("Erro ao carregar dados do LocalStorage:", error);
                    }
                }
                
                // Se não houver dados ou ocorrer erro, carregar dados de exemplo
                this.loadExampleData();
            },
            
            // Carregar dados de exemplo
            loadExampleData() {
                // Dados de exemplo para reboques
                this.data.reboques = [
                    { frota: '1101', tipo: 'SEMI REBOQUE', acoplado: '7520', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1102', tipo: 'SEMI REBOQUE', acoplado: '7521', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1103', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Em manutenção', dataParada: '2023-05-15', motivo: 'Suspensão danificada', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1104', tipo: 'SEMI REBOQUE', acoplado: '', status: 'Operacional', tipoAcoplado: 'SEMI REBOQUE' },
                    { frota: '1105', tipo: 'REBOQUE', acoplado: '7522', status: 'Operacional', tipoAcoplado: 'REBOQUE' },
                    { frota: '1106', tipo: 'REBOQUE', acoplado: '', status: 'Em reforma', dataParada: '2023-04-10', motivo: 'Reforma geral programada', tipoAcoplado: 'REBOQUE' },
                    { frota: '1107', tipo: 'DOLLY', acoplado: '7523', status: 'Operacional', tipoAcoplado: 'DOLLY' },
                    { frota: '1108', tipo: 'DOLLY', acoplado: '', status: 'Inoperante', dataParada: '2023-05-22', motivo: 'Eixo quebrado', tipoAcoplado: 'DOLLY' }
                ];
                
                // Dados de exemplo para caminhões próprios
                this.data.caminhoesProps = [
                    { caminhao: '7520', status: 'Operacional' },
                    { caminhao: '7521', status: 'Operacional' },
                    { caminhao: '7522', status: 'Operacional' },
                    { caminhao: '7523', status: 'Operacional' },
                    { caminhao: '7524', status: 'Em manutenção', data: '2023-05-18', motivo: 'Troca de óleo e filtros' },
                    { caminhao: '7525', status: 'Em reforma', data: '2023-03-15', motivo: 'Reforma do motor' },
                    { caminhao: '7526', status: 'Emprestado', data: '2023-05-10', motivo: 'Emprestado para filial' }
                ];
                
                // Dados de exemplo para caminhões terceiros
                this.data.caminhoesTerc = [
                    { caminhao: 'T001', proprietario: 'Transportes Silva', reboques: '1201-1202', status: 'Operacional' },
                    { caminhao: 'T002', proprietario: 'Logística Express', reboques: '1203', status: 'Operacional' },
                    { caminhao: 'T003', proprietario: 'Transportes Rápidos', reboques: '1204-1205', status: 'Em manutenção', motivo: 'Problemas no freio' },
                    { caminhao: 'T004', proprietario: 'Rodovias Transport', reboques: '1206', status: 'Operacional' },
                    { caminhao: 'T005', proprietario: 'JK Logística', reboques: '1207-1208', status: 'Inoperante', motivo: 'Acidente na estrada' }
                ];
                
                // Dados de exemplo para frente 4001
                this.data.frente4001Colhedoras = [
                    { codigo: 'C101', status: 'Operacional' },
                    { codigo: 'C102', status: 'Em manutenção', data: '2023-05-20', motivo: 'Manutenção preventiva' },
                    { codigo: 'C103', status: 'Operacional' },
                    { codigo: 'C104', status: 'Inoperante', data: '2023-04-25', motivo: 'Problemas no sistema hidráulico' }
                ];
                
                this.data.frente4001Tracoes = [
                    { codigo: 'T101', status: 'Operacional' },
                    { codigo: 'T102', status: 'Operacional' },
                    { codigo: 'T103', status: 'Em manutenção', data: '2023-05-19', motivo: 'Troca de pneus' },
                    { codigo: 'T104', status: 'Operacional' }
                ];
                
                // Dados de exemplo para frente 4002
                this.data.frente4002Colhedoras = [
                    { codigo: 'C201', status: 'Operacional' },
                    { codigo: 'C202', status: 'Operacional' },
                    { codigo: 'C203', status: 'Em reforma', data: '2023-03-10', motivo: 'Reforma programada' },
                    { codigo: 'C204', status: 'Em manutenção', data: '2023-05-21', motivo: 'Falha no sistema elétrico' }
                ];
                
                this.data.frente4002Tracoes = [
                    { codigo: 'T201', status: 'Operacional' },
                    { codigo: 'T202', status: 'Inoperante', data: '2023-05-05', motivo: 'Motor danificado' },
                    { codigo: 'T203', status: 'Operacional' },
                    { codigo: 'T204', status: 'Em manutenção', data: '2023-05-22', motivo: 'Manutenção programada' }
                ];
                
                // Histórico de exemplo
                this.data.history = {
                    '7524': [
                        {
                            date: '2023-05-18T10:30:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Troca de óleo e filtros',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-10T08:15:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-04-05T14:20:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Revisão de 50.000 km',
                            user: 'Técnico'
                        }
                    ],
                    'C102': [
                        {
                            date: '2023-05-20T09:45:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Manutenção preventiva',
                            user: 'Administrador'
                        },
                        {
                            date: '2023-03-15T11:30:00',
                            status: 'Operacional',
                            description: 'Status alterado de Em manutenção para Operacional',
                            user: 'Técnico'
                        },
                        {
                            date: '2023-03-10T08:15:00',
                            status: 'Em manutenção',
                            description: 'Status alterado de Operacional para Em manutenção - Motivo: Falha no sistema eletrônico',
                            user: 'Operador'
                        }
                    ]
                };
                
                // Agendamentos de exemplo
                this.data.schedules = [
                    {
                        equipment: '7520',
                        equipmentType: 'Caminhão Próprio',
                        date: '2023-06-05',
                        time: '09:00',
                        type: 'preventiva',
                        description: 'Revisão de 30.000 km',
                        responsible: 'João Silva',
                        created: '2023-05-20T14:30:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: 'C201',
                        equipmentType: 'Colhedora Frente 4002',
                        date: '2023-06-10',
                        time: '08:30',
                        type: 'troca-oleo',
                        description: 'Troca de óleo e filtros',
                        responsible: 'Carlos Oliveira',
                        created: '2023-05-22T10:15:00',
                        status: 'Agendado'
                    },
                    {
                        equipment: '1102',
                        equipmentType: 'Reboque',
                        date: '2023-06-15',
                        time: '14:00',
                        type: 'corretiva',
                        description: 'Reparo na suspensão',
                        responsible: 'Pedro Santos',
                        created: '2023-05-23T09:45:00',
                        status: 'Agendado'
                    }
                ];
                
                // Salvar os dados de exemplo no LocalStorage
                this.saveDataToLocalStorage();
            },
            
            // Salvar dados no LocalStorage
            saveDataToLocalStorage() {
                try {
                    localStorage.setItem('fleetManagementData', JSON.stringify({
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules
                    }));
                } catch (error) {
                    console.error("Erro ao salvar dados no LocalStorage:", error);
                    this.showNotification('error', 'Erro', 'Falha ao salvar dados. As alterações não serão mantidas após a recarga da página.');
                }
            },
            
            // Limpar todos os dados
            clearAllData() {
                const confirmationInput = document.getElementById('clear-data-confirmation');
                if (confirmationInput.value !== 'CONFIRMAR') {
                    this.showNotification('error', 'Erro', 'Por favor, digite "CONFIRMAR" para prosseguir com a exclusão dos dados.');
                    return;
                }
                
                // Limpar todos os arrays de dados
                this.data.reboques = [];
                this.data.caminhoesProps = [];
                this.data.caminhoesTerc = [];
                this.data.frente4001Colhedoras = [];
                this.data.frente4001Tracoes = [];
                this.data.frente4002Colhedoras = [];
                this.data.frente4002Tracoes = [];
                this.data.history = {};
                this.data.schedules = [];
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Fechar modal
                document.getElementById('clear-data-confirm-modal').classList.add('hidden');
                confirmationInput.value = '';
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Todos os registros foram excluídos com sucesso.');
            },
            
            // Importar dados de um arquivo
            importDataFromFile() {
                const fileInput = document.getElementById('backup-file-input');
                if (fileInput.files.length === 0) {
                    this.showNotification('error', 'Erro', 'Nenhum arquivo selecionado.');
                    return;
                }
                
                const file = fileInput.files[0];
                if (file.type !== 'application/json' && !file.name.endsWith('.json')) {
                    this.showNotification('error', 'Erro', 'O arquivo deve ser um JSON válido.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Verificar se o arquivo contém os dados esperados
                        if (!data.reboques || !data.caminhoesProps || !data.caminhoesTerc || 
                            !data.frente4001Colhedoras || !data.frente4001Tracoes || 
                            !data.frente4002Colhedoras || !data.frente4002Tracoes) {
                            throw new Error('O arquivo não contém dados válidos para importação.');
                        }
                        
                        // Atualizar os dados
                        this.data.reboques = data.reboques || [];
                        this.data.caminhoesProps = data.caminhoesProps || [];
                        this.data.caminhoesTerc = data.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = data.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = data.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = data.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = data.frente4002Tracoes || [];
                        this.data.history = data.history || {};
                        this.data.schedules = data.schedules || [];
                        
                        // Salvar no localStorage
                        this.saveDataToLocalStorage();
                        
                        // Atualizar visualizações
                        this.renderAllTables();
                        this.updateAllDashboards();
                        this.updateAllCharts();
                        this.initializeRealEquipmentView();
                        
                        // Fechar modal
                        document.getElementById('import-backup-modal').classList.add('hidden');
                        document.getElementById('selected-file-name').classList.add('hidden');
                        fileInput.value = '';
                        document.getElementById('import-backup-btn').setAttribute('disabled', 'disabled');
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Sucesso', 'Backup importado com sucesso.');
                        
                    } catch (error) {
                        this.showNotification('error', 'Erro', 'Falha ao importar backup: ' + error.message);
                    }
                };
                
                reader.onerror = () => {
                    this.showNotification('error', 'Erro', 'Falha ao ler o arquivo.');
                };
                
                reader.readAsText(file);
            },
            
            // Filtrar dados com base nos filtros atuais
            filterData(data) {
                return data.filter(item => {
                    // Filtro de pesquisa
                    const searchTerms = this.data.searchText.toLowerCase().split(' ');
                    
                    const matchesSearch = searchTerms.every(term => {
                        return Object.values(item).some(value => {
                            if (value === null || value === undefined) return false;
                            return value.toString().toLowerCase().includes(term);
                        });
                    });
                    
                    if (!matchesSearch) return false;
                    
                    // Filtro de status
                    if (this.data.statusFilter !== 'all' && item.status !== this.data.statusFilter) {
                        return false;
                    }
                    
                    // Filtro de tipo (para frentes 4001 e 4002)
                    if (this.data.typeFilter !== 'all' && item.type !== this.data.typeFilter) {
                        return false;
                    }
                    
                    return true;
                });
            },
            
            // Ordenar dados com base no campo e direção atuais
            sortData(data) {
                if (!this.data.currentSort.field) return data;
                
                return [...data].sort((a, b) => {
                    const field = this.data.currentSort.field;
                    const aValue = a[field];
                    const bValue = b[field];
                    
                    if (aValue === null || aValue === undefined) return 1;
                    if (bValue === null || bValue === undefined) return -1;
                    
                    if (aValue < bValue) {
                        return this.data.currentSort.direction === 'asc' ? -1 : 1;
                    }
                    if (aValue > bValue) {
                        return this.data.currentSort.direction === 'asc' ? 1 : -1;
                    }
                    return 0;
                });
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCPTable();
                this.renderCTTable();
                this.renderF4001Table();
                this.renderF4002Table();
            },
            
            // Renderizar tabela de reboques
            renderReboquesTable() {
                const tableBody = document.getElementById('reboques-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.reboques);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum reboque encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((reboque, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(reboque.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (reboque.dataParada) {
                        const data = new Date(reboque.dataParada);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${reboque.frota || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.tipo || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.acoplado || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${reboque.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${reboque.frota}" data-type="Reboque" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${reboque.frota}" data-type="Reboque" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${reboque.frota}" data-type="Reboque" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${reboque.frota}" data-type="Reboque" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'reboques');
                    });
                });
            },
            
            // Renderizar tabela de caminhões próprios
            renderCPTable() {
                const tableBody = document.getElementById('cp-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesProps);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão próprio encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (caminhao.data) {
                        const data = new Date(caminhao.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesProps');
                    });
                });
            },
            
            // Renderizar tabela de caminhões terceiros
            renderCTTable() {
                const tableBody = document.getElementById('ct-table-body');
                if (!tableBody) return;
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesTerc);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão terceiro encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.proprietario || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.reboques || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${caminhao.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, 'caminhoesTerc');
                    });
                });
            },
            
            // Renderizar tabela da frente 4001
            renderF4001Table() {
                const tableBody = document.getElementById('f4001-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4001Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4001Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4001Colhedoras' : 'frente4001Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Renderizar tabela da frente 4002
            renderF4002Table() {
                const tableBody = document.getElementById('f4002-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4002Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4002Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4002Colhedoras' : 'frente4002Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const arrayName = button.getAttribute('data-array');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index, arrayName);
                    });
                });
            },
            
            // Inicializar gráficos
            initializeCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Gráfico de status por categoria
                const statusCtx = document.getElementById('status-by-category-chart');
                if (statusCtx) {
                    this.data.charts.statusByCategoryChart = new Chart(statusCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Frente 4001', 'Frente 4002'],
                            datasets: [{
                                label: 'Operacionais',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#10B981'
                            }, {
                                label: 'Em Manutenção',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#F59E0B'
                            }, {
                                label: 'Em Reforma/Inoperantes',
                                data: [0, 0, 0, 0, 0],
                                backgroundColor: '#EF4444'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    stacked: true
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de disponibilidade
                const availabilityCtx = document.getElementById('availability-chart');
                if (availabilityCtx) {
                    this.data.charts.availabilityChart = new Chart(availabilityCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma', 'Outros'],
                            datasets: [{
                                data: [0, 0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de status dos reboques
                const reboquesStatusCtx = document.getElementById('reboques-status-chart');
                if (reboquesStatusCtx) {
                    this.data.charts.reboquesStatusChart = new Chart(reboquesStatusCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Operacionais', 'Em Manutenção', 'Em Reforma/Inoperantes'],
                            datasets: [{
                                data: [0, 0, 0],
                                backgroundColor: ['#10B981', '#F59E0B', '#EF4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Inicializar gráficos do dashboard detalhado
                this.initializeDetailedDashboardCharts();
            },
            
            // Inicializar gráficos do dashboard detalhado
            initializeDetailedDashboardCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Gráfico de distribuição de status
                const statusDistCtx = document.getElementById('detailed-status-distribution-chart');
                if (statusDistCtx) {
                    this.data.charts.detailedStatusDistributionChart = new Chart(statusDistCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'F4001 Colhedoras', 'F4001 Trações', 'F4002 Colhedoras', 'F4002 Trações'],
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#10B981'
                                },
                                {
                                    label: 'Em Manutenção',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#F59E0B'
                                },
                                {
                                    label: 'Em Reforma/Inoperante',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#EF4444'
                                },
                                {
                                    label: 'Outros',
                                    data: [0, 0, 0, 0, 0, 0, 0],
                                    backgroundColor: '#3B82F6'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    stacked: true
                                },
                                y: {
                                    stacked: true,
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de tendência de disponibilidade
                const availTrendCtx = document.getElementById('detailed-availability-trend-chart');
                if (availTrendCtx) {
                    // Criar dados de exemplo para mostrar a tendência
                    const labels = [];
                    
                    // Usar datas reais (últimos 3 meses)
                    const today = new Date();
                    for (let i = 2; i >= 0; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedAvailabilityTrendChart = new Chart(availTrendCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Disponibilidade da Frota (%)',
                                data: [], // Deixar vazio - será preenchido com dados reais
                                borderColor: '#5D5CDE',
                                backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                tension: 0.3,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 50,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de causas de manutenção
                const causesCtx = document.getElementById('detailed-maintenance-causes-chart');
                if (causesCtx) {
                    this.data.charts.detailedMaintenanceCausesChart = new Chart(causesCtx, {
                        type: 'pie',
                        data: {
                            labels: ['Desgaste normal', 'Falha mecânica', 'Problemas elétricos', 'Manutenção preventiva', 'Outros'],
                            datasets: [{
                                data: [], // Deixar vazio - será preenchido com dados reais
                                backgroundColor: ['#3B82F6', '#EF4444', '#F59E0B', '#10B981', '#6B7280']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Gráfico de previsão
                const forecastCtx = document.getElementById('detailed-forecast-chart');
                if (forecastCtx) {
                    // Criar dados para previsão baseados apenas nos meses reais
                    const labels = [];
                    
                    // Últimos 3 meses (dados históricos) + próximos 3 meses (previsão)
                    const today = new Date();
                    for (let i = 2; i >= -3; i--) {
                        const month = new Date(today.getFullYear(), today.getMonth() - i, 1);
                        labels.push(month.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' }));
                    }
                    
                    this.data.charts.detailedForecastChart = new Chart(forecastCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Dados Históricos',
                                    data: [], // Deixar vazio - será preenchido com dados reais se existirem
                                    borderColor: '#3B82F6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: 'Previsão',
                                    data: [], // Deixar vazio - será preenchido apenas se houver dados suficientes
                                    borderColor: '#5D5CDE',
                                    borderDash: [5, 5],
                                    backgroundColor: 'rgba(93, 92, 222, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            if (context.raw !== null) {
                                                return `${context.dataset.label}: ${context.raw.toFixed(1)}%`;
                                            }
                                            return '';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    min: 60,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: 'Disponibilidade (%)',
                                        color: isDark ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Mostrar mensagens de "sem dados" para os gráficos
                document.getElementById('detailed-forecast-no-data')?.classList.remove('hidden');
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Verificar se o tema mudou e atualizar os padrões
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Atualizar gráficos do dashboard principal
                this.updateStatusCategoryChart();
                this.updateAvailabilityChart();
                
                // Atualizar gráficos específicos por categoria
                this.updateReboquesCharts();
                
                // Atualizar gráficos do dashboard detalhado
                this.updateDetailedDashboardCharts();
            },
            
            // Atualizar gráfico de status por categoria
            updateStatusCategoryChart() {
                if (!this.data.charts.statusByCategoryChart) return;
                
                // Contar status para cada categoria
                const reboquesOperacional = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesManutencao = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reboquesReforma = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                const cpOperacional = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpManutencao = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const cpReforma = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                const ctOperacional = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctManutencao = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const ctReforma = this.data.caminhoesTerc.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                // Frente 4001
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4001Reforma = 
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Frente 4002
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const f4002Reforma = 
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.statusByCategoryChart.data.datasets[0].data = [
                    reboquesOperacional, cpOperacional, ctOperacional, f4001Operacional, f4002Operacional
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[1].data = [
                    reboquesManutencao, cpManutencao, ctManutencao, f4001Manutencao, f4002Manutencao
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[2].data = [
                    reboquesReforma, cpReforma, ctReforma, f4001Reforma, f4002Reforma
                ];
                
                this.data.charts.statusByCategoryChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = 
                    reboquesOperacional + reboquesManutencao + reboquesReforma +
                    cpOperacional + cpManutencao + cpReforma +
                    ctOperacional + ctManutencao + ctReforma +
                    f4001Operacional + f4001Manutencao + f4001Reforma +
                    f4002Operacional + f4002Manutencao + f4002Reforma;
                
                if (totalData > 0) {
                    document.getElementById('status-category-no-data').classList.add('hidden');
                } else {
                    document.getElementById('status-category-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar gráfico de disponibilidade
            updateAvailabilityChart() {
                if (!this.data.charts.availabilityChart) return;
                
                // Contar todos os equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                // Todos os outros status (emprestados, etc)
                const other = 
                    this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(r.status)).length +
                    this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length +
                    this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(c.status)).length +
                    this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Inoperante', 'Aguardando reforma'].includes(t.status)).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.availabilityChart.data.datasets[0].data = [
                    operational, maintenance, reform, other
                ];
                
                this.data.charts.availabilityChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operational + maintenance + reform + other;
                
                if (totalData > 0) {
                    document.getElementById('availability-no-data').classList.add('hidden');
                } else {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                }
                
                // Atualizar indicadores globais no dashboard
                const total = operational + maintenance + reform + other;
                
                document.getElementById('dash-global-operational').textContent = operational;
                document.getElementById('dash-global-maintenance').textContent = maintenance;
                document.getElementById('dash-global-reform').textContent = reform;
                document.getElementById('dash-global-other').textContent = other;
                document.getElementById('dash-global-total').textContent = total;
                
                if (total > 0) {
                    document.getElementById('dash-global-operational-percent').textContent = `${Math.round(operational / total * 100)}%`;
                    document.getElementById('dash-global-maintenance-percent').textContent = `${Math.round(maintenance / total * 100)}%`;
                    document.getElementById('dash-global-reform-percent').textContent = `${Math.round(reform / total * 100)}%`;
                    document.getElementById('dash-global-other-percent').textContent = `${Math.round(other / total * 100)}%`;
                }
            },
            
            // Atualizar gráficos de reboques
            updateReboquesCharts() {
                if (!this.data.charts.reboquesStatusChart) return;
                
                // Contar status dos reboques
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                // Atualizar os dados do gráfico
                this.data.charts.reboquesStatusChart.data.datasets[0].data = [
                    operational, maintenance, reform
                ];
                
                this.data.charts.reboquesStatusChart.update();
                
                // Esconder mensagem de "sem dados" se houver dados
                const totalData = operational + maintenance + reform;
                
                if (totalData > 0) {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar gráficos do dashboard detalhado
            updateDetailedDashboardCharts() {
                if (!this.data.charts.detailedStatusDistributionChart) {
                    this.initializeDetailedDashboardCharts();
                    return;
                }
                
                // Atualizar dados para o gráfico de distribuição de status
                const data = {
                    reboques: {
                        operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                        maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                        reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                        other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                    },
                    caminhoesProprios: {
                        operational: this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    caminhoesTerceiros: {
                        operational: this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001Colhedoras: {
                        operational: this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001Tracoes: {
                        operational: this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    },
                    frente4002Colhedoras: {
                        operational: this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4002Tracoes: {
                        operational: this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    }
                };
                
                // Atualizar rótulos para incluir categorias separadas
                this.data.charts.detailedStatusDistributionChart.data.labels = [
                    'Reboques', 
                    'Caminhões Próprios', 
                    'Caminhões Terceiros', 
                    'F4001 Colhedoras', 
                    'F4001 Trações', 
                    'F4002 Colhedoras', 
                    'F4002 Trações'
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[0].data = [
                    data.reboques.operational,
                    data.caminhoesProprios.operational,
                    data.caminhoesTerceiros.operational,
                    data.frente4001Colhedoras.operational,
                    data.frente4001Tracoes.operational,
                    data.frente4002Colhedoras.operational,
                    data.frente4002Tracoes.operational
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[1].data = [
                    data.reboques.maintenance,
                    data.caminhoesProprios.maintenance,
                    data.caminhoesTerceiros.maintenance,
                    data.frente4001Colhedoras.maintenance,
                    data.frente4001Tracoes.maintenance,
                    data.frente4002Colhedoras.maintenance,
                    data.frente4002Tracoes.maintenance
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[2].data = [
                    data.reboques.reform,
                    data.caminhoesProprios.reform,
                    data.caminhoesTerceiros.reform,
                    data.frente4001Colhedoras.reform,
                    data.frente4001Tracoes.reform,
                    data.frente4002Colhedoras.reform,
                    data.frente4002Tracoes.reform
                ];
                
                this.data.charts.detailedStatusDistributionChart.data.datasets[3].data = [
                    data.reboques.other,
                    data.caminhoesProprios.other,
                    data.caminhoesTerceiros.other,
                    data.frente4001Colhedoras.other,
                    data.frente4001Tracoes.other,
                    data.frente4002Colhedoras.other,
                    data.frente4002Tracoes.other
                ];
                
                this.data.charts.detailedStatusDistributionChart.update();
                
                // Atualizar o gráfico de tendência para refletir o tema atual
                const isDark = document.documentElement.classList.contains('dark');
                this.data.charts.detailedAvailabilityTrendChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                this.data.charts.detailedAvailabilityTrendChart.options.scales.y.title.color = isDark ? '#E5E7EB' : '#1F2937';
                this.data.charts.detailedAvailabilityTrendChart.update();
                
                // Atualizar gráficos de causas e duração
                if (this.data.charts.detailedMaintenanceCausesChart) {
                    this.data.charts.detailedMaintenanceCausesChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedMaintenanceCausesChart.update();
                }
                
                // Atualizar gráfico de previsão
                if (this.data.charts.detailedForecastChart) {
                    this.data.charts.detailedForecastChart.options.plugins.legend.labels.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedForecastChart.options.scales.y.title.color = isDark ? '#E5E7EB' : '#1F2937';
                    this.data.charts.detailedForecastChart.update();
                }
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateMainDashboard();
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
                this.updateDetailedDashboard();
            },
            
            // Atualizar dashboard principal
            updateMainDashboard() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contagem por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => 
                        r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesProps.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.caminhoesTerc.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4001Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Colhedoras.filter(c => 
                        c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                    ).length +
                    this.data.frente4002Tracoes.filter(t => 
                        t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                    ).length;
                
                const borrowed = 
                    this.data.reboques.filter(r => r.status === 'Emprestado').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Emprestado').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Emprestado').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Emprestado').length;
                
                const other = totalEquipments - operational - maintenance - reform - borrowed;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                // Atualizar resumo visual
                document.getElementById('dash-summary-operational').textContent = operational;
                document.getElementById('dash-summary-maintenance').textContent = maintenance;
                document.getElementById('dash-summary-reform').textContent = reform;
                document.getElementById('dash-summary-borrowed').textContent = borrowed;
                document.getElementById('dash-summary-other').textContent = other;
                document.getElementById('dash-summary-availability').textContent = `${availability}%`;
                document.getElementById('dash-availability-bar').style.width = `${availability}%`;
                
                // Atualizar cards
                this.updateDashboardCard('cp', this.data.caminhoesProps);
                this.updateDashboardCard('reboques', this.data.reboques);
                
                // Frente 4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Operacional = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Manutencao = 
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4001-count').textContent = f4001Total;
                document.getElementById('dash-f4001-operational').textContent = f4001Operacional;
                document.getElementById('dash-f4001-maintenance').textContent = f4001Manutencao;
                
                if (f4001Total > 0) {
                    const f4001Availability = Math.round((f4001Operacional / f4001Total) * 100);
                    document.getElementById('dash-f4001-bar').style.width = `${f4001Availability}%`;
                }
                
                // Frente 4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Operacional = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Manutencao = 
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('dash-f4002-count').textContent = f4002Total;
                document.getElementById('dash-f4002-operational').textContent = f4002Operacional;
                document.getElementById('dash-f4002-maintenance').textContent = f4002Manutencao;
                
                if (f4002Total > 0) {
                    const f4002Availability = Math.round((f4002Operacional / f4002Total) * 100);
                    document.getElementById('dash-f4002-bar').style.width = `${f4002Availability}%`;
                }
                
                // Listar equipamentos em manutenção
                this.updateMaintenanceList();
                
                // Listar manutenções agendadas
                this.updateSchedulesList();
            },
            
            // Atualizar card do dashboard
            updateDashboardCard(prefix, dataArray) {
                const total = dataArray.length;
                const operational = dataArray.filter(item => item.status === 'Operacional').length;
                const maintenance = dataArray.filter(item => item.status === 'Em manutenção').length;
                
                document.getElementById(`dash-${prefix}-count`).textContent = total;
                document.getElementById(`dash-${prefix}-operational`).textContent = operational;
                document.getElementById(`dash-${prefix}-maintenance`).textContent = maintenance;
                
                if (total > 0) {
                    const availability = Math.round((operational / total) * 100);
                    document.getElementById(`dash-${prefix}-bar`).style.width = `${availability}%`;
                }
            },
            
            // Atualizar lista de manutenções
            updateMaintenanceList() {
                const list = document.getElementById('equipment-maintenance-list');
                
                // Encontrar todos os equipamentos em manutenção
                const inMaintenance = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                        id: r.frota,
                        type: 'Reboque',
                        date: r.dataParada,
                        reason: r.motivo
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Próprio',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Terceiro',
                        date: null,
                        reason: c.motivo
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4001',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4001',
                        date: t.data,
                        reason: t.motivo
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4002',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4002',
                        date: t.data,
                        reason: t.motivo
                    }))
                ];
                
                if (inMaintenance.length === 0) {
                    list.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                        </li>
                    `;
                    return;
                }
                
                let html = '';
                
                // Ordenar por data (mais recente primeiro)
                inMaintenance.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                // Mostrar os 5 mais recentes
                inMaintenance.slice(0, 5).forEach(item => {
                    // Formatar data
                    let dataFormatada = '';
                    if (item.date) {
                        const data = new Date(item.date);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <li class="py-2 flex justify-between items-start">
                            <div>
                                <span class="font-medium">${item.id}</span> - ${item.type}
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    ${item.reason || 'Sem motivo informado'}
                                </p>
                            </div>
                            <span class="text-xs text-yellow-600 dark:text-yellow-400">${dataFormatada || 'Data não informada'}</span>
                        </li>
                    `;
                });
                
                list.innerHTML = html;
            },
            
            // Atualizar lista de agendamentos
            updateSchedulesList() {
                const list = document.getElementById('upcoming-maintenance-list');
                
                // Filtrar agendamentos futuros
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcoming = this.data.schedules.filter(s => {
                    const scheduleDate = new Date(s.date);
                    return scheduleDate >= today;
                });
                
                if (upcoming.length === 0) {
                    list.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                        </li>
                    `;
                    return;
                }
                
                // Ordenar por data (mais próxima primeiro)
                upcoming.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                let html = '';
                
                // Mostrar os 5 mais próximos
                upcoming.slice(0, 5).forEach(item => {
                    // Formatar data
                    const data = new Date(item.date);
                    const dataFormatada = data.toLocaleDateString('pt-BR');
                    
                    // Formatar tipo de manutenção
                    let tipoFormatado = '';
                    switch(item.type) {
                        case 'preventiva': tipoFormatado = 'Preventiva'; break;
                        case 'corretiva': tipoFormatado = 'Corretiva'; break;
                        case 'revisao': tipoFormatado = 'Revisão Geral'; break;
                        case 'troca-oleo': tipoFormatado = 'Troca de Óleo'; break;
                        case 'reforma': tipoFormatado = 'Reforma'; break;
                        default: tipoFormatado = 'Outro';
                    }
                    
                    html += `
                        <li class="py-2 flex justify-between items-start">
                            <div>
                                <span class="font-medium">${item.equipment}</span> - ${item.equipmentType}
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    ${tipoFormatado}: ${item.description}
                                </p>
                            </div>
                            <div class="text-right">
                                <span class="text-xs text-green-600 dark:text-green-400">${dataFormatada}</span>
                                <p class="text-xs text-gray-500 dark:text-gray-400">${item.time}</p>
                            </div>
                        </li>
                    `;
                });
                
                list.innerHTML = html;
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => 
                    r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma'
                ).length;
                
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-reform').textContent = reform;
                
                if (total > 0) {
                    const operationalPercentage = Math.round((operational / total) * 100);
                    const maintenancePercentage = Math.round((maintenance / total) * 100);
                    const reformPercentage = Math.round((reform / total) * 100);
                    
                    document.getElementById('reboques-operational-percentage').textContent = `${operationalPercentage}%`;
                    document.getElementById('reboques-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                    document.getElementById('reboques-reform-percentage').textContent = `${reformPercentage}%`;
                    
                    document.getElementById('reboques-availability').textContent = `${operationalPercentage}%`;
                    document.getElementById('reboques-availability-bar').style.width = `${operationalPercentage}%`;
                }
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                const total = this.data.caminhoesProps.length;
                const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const reform = this.data.caminhoesProps.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-reform').textContent = reform;
                
                if (total > 0) {
                    const operationalPercentage = Math.round((operational / total) * 100);
                    const maintenancePercentage = Math.round((maintenance / total) * 100);
                    const reformPercentage = Math.round((reform / total) * 100);
                    
                    document.getElementById('cp-operational-percentage').textContent = `${operationalPercentage}%`;
                    document.getElementById('cp-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                    document.getElementById('cp-reform-percentage').textContent = `${reformPercentage}%`;
                    
                    document.getElementById('cp-availability').textContent = `${operationalPercentage}%`;
                    document.getElementById('cp-availability-bar').style.width = `${operationalPercentage}%`;
                }
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                // Contar total de equipamentos
                const colhTotal = this.data.frente4001Colhedoras.length;
                const tracTotal = this.data.frente4001Tracoes.length;
                const total = colhTotal + tracTotal;
                
                // Contar operacionais
                const colhOperational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                const tracOperational = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const operational = colhOperational + tracOperational;
                
                // Contar em manutenção
                const colhMaintenance = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length;
                const tracMaintenance = this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                const maintenance = colhMaintenance + tracMaintenance;
                
                // Contar em reforma/inoperante
                const colhReform = this.data.frente4001Colhedoras.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                const tracReform = this.data.frente4001Tracoes.filter(t => 
                    t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                ).length;
                const reform = colhReform + tracReform;
                
                // Atualizar contadores
                document.getElementById('f4001-total').textContent = total;
                document.getElementById('f4001-operational').textContent = operational;
                document.getElementById('f4001-maintenance').textContent = maintenance;
                document.getElementById('f4001-reform').textContent = reform;
                
                if (total > 0) {
                    const availability = Math.round((operational / total) * 100);
                    document.getElementById('f4001-availability').textContent = `${availability}%`;
                    document.getElementById('f4001-availability-bar').style.width = `${availability}%`;
                }
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                // Contar total de equipamentos
                const colhTotal = this.data.frente4002Colhedoras.length;
                const tracTotal = this.data.frente4002Tracoes.length;
                const total = colhTotal + tracTotal;
                
                // Contar operacionais
                const colhOperational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                const tracOperational = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const operational = colhOperational + tracOperational;
                
                // Contar em manutenção
                const colhMaintenance = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length;
                const tracMaintenance = this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                const maintenance = colhMaintenance + tracMaintenance;
                
                // Contar em reforma/inoperante
                const colhReform = this.data.frente4002Colhedoras.filter(c => 
                    c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma'
                ).length;
                const tracReform = this.data.frente4002Tracoes.filter(t => 
                    t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma'
                ).length;
                const reform = colhReform + tracReform;
                
                // Atualizar contadores
                document.getElementById('f4002-total').textContent = total;
                document.getElementById('f4002-operational').textContent = operational;
                document.getElementById('f4002-maintenance').textContent = maintenance;
                document.getElementById('f4002-reform').textContent = reform;
                
                if (total > 0) {
                    const availability = Math.round((operational / total) * 100);
                    document.getElementById('f4002-availability').textContent = `${availability}%`;
                    document.getElementById('f4002-availability-bar').style.width = `${availability}%`;
                }
            },
            
            // Atualizar dashboard detalhado
            updateDetailedDashboard() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contar equipamentos operacionais
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const operationalPercentage = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                // Contar total de manutenções em andamento
                const totalMaintenances = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                // Atualizar KPIs principais
                document.getElementById('detailed-total-equipment').textContent = totalEquipments;
                document.getElementById('detailed-operational-percentage').textContent = `${operationalPercentage}%`;
                document.getElementById('detailed-operational-bar').style.width = `${operationalPercentage}%`;
                document.getElementById('detailed-total-maintenances').textContent = totalMaintenances;
                
                // Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesAvailability = reboquesTotal > 0 ? Math.round((reboquesOperational / reboquesTotal) * 100) : 0;
                
                document.getElementById('detailed-reboques-count').textContent = reboquesTotal;
                document.getElementById('detailed-reboques-availability').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-value').textContent = `${reboquesAvailability}%`;
                document.getElementById('detailed-reboques-avail-bar').style.width = `${reboquesAvailability}%`;
                
                // Caminhões Próprios
                const cpTotal = this.data.caminhoesProps.length;
                const cpOperational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpAvailability = cpTotal > 0 ? Math.round((cpOperational / cpTotal) * 100) : 0;
                
                document.getElementById('detailed-cp-count').textContent = cpTotal;
                document.getElementById('detailed-cp-availability').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-value').textContent = `${cpAvailability}%`;
                document.getElementById('detailed-cp-avail-bar').style.width = `${cpAvailability}%`;
                
                // Caminhões Terceiros
                const ctTotal = this.data.caminhoesTerc.length;
                const ctOperational = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctAvailability = ctTotal > 0 ? Math.round((ctOperational / ctTotal) * 100) : 0;
                
                document.getElementById('detailed-ct-count').textContent = ctTotal;
                document.getElementById('detailed-ct-availability').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-value').textContent = `${ctAvailability}%`;
                document.getElementById('detailed-ct-avail-bar').style.width = `${ctAvailability}%`;
                
                // Frente 4001 - Colhedoras
                const f4001ColhTotal = this.data.frente4001Colhedoras.length;
                const f4001ColhOperational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                
                document.getElementById('detailed-f4001-colh-count').textContent = f4001ColhTotal;
                
                if (f4001ColhTotal > 0) {
                    const f4001ColhAvailability = Math.round((f4001ColhOperational / f4001ColhTotal) * 100);
                    document.getElementById('detailed-f4001-colh-availability').textContent = `${f4001ColhAvailability}%`;
                    document.getElementById('detailed-f4001-colh-avail-value').textContent = `${f4001ColhAvailability}%`;
                    document.getElementById('detailed-f4001-colh-avail-bar').style.width = `${f4001ColhAvailability}%`;
                }
                
                // Frente 4001 - Trações
                const f4001TracTotal = this.data.frente4001Tracoes.length;
                const f4001TracOperational = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                document.getElementById('detailed-f4001-trac-count').textContent = f4001TracTotal;
                
                if (f4001TracTotal > 0) {
                    const f4001TracAvailability = Math.round((f4001TracOperational / f4001TracTotal) * 100);
                    document.getElementById('detailed-f4001-trac-availability').textContent = `${f4001TracAvailability}%`;
                    document.getElementById('detailed-f4001-trac-avail-value').textContent = `${f4001TracAvailability}%`;
                    document.getElementById('detailed-f4001-trac-avail-bar').style.width = `${f4001TracAvailability}%`;
                }
                
                // Frente 4002 - Colhedoras
                const f4002ColhTotal = this.data.frente4002Colhedoras.length;
                const f4002ColhOperational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                document.getElementById('detailed-f4002-colh-count').textContent = f4002ColhTotal;
                
                if (f4002ColhTotal > 0) {
                    const f4002ColhAvailability = Math.round((f4002ColhOperational / f4002ColhTotal) * 100);
                    document.getElementById('detailed-f4002-colh-availability').textContent = `${f4002ColhAvailability}%`;
                    document.getElementById('detailed-f4002-colh-avail-value').textContent = `${f4002ColhAvailability}%`;
                    document.getElementById('detailed-f4002-colh-avail-bar').style.width = `${f4002ColhAvailability}%`;
                }
                
                // Frente 4002 - Trações
                const f4002TracTotal = this.data.frente4002Tracoes.length;
                const f4002TracOperational = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                document.getElementById('detailed-f4002-trac-count').textContent = f4002TracTotal;
                
                if (f4002TracTotal > 0) {
                    const f4002TracAvailability = Math.round((f4002TracOperational / f4002TracTotal) * 100);
                    document.getElementById('detailed-f4002-trac-availability').textContent = `${f4002TracAvailability}%`;
                    document.getElementById('detailed-f4002-trac-avail-value').textContent = `${f4002TracAvailability}%`;
                    document.getElementById('detailed-f4002-trac-avail-bar').style.width = `${f4002TracAvailability}%`;
                }
                
                // KPIs - Deixar em branco ou mostrar apenas contagens reais
                document.getElementById('detailed-mtbf').textContent = '-';
                document.getElementById('detailed-mttr').textContent = '-';
                document.getElementById('detailed-oee').textContent = '-';
            },
            
            // Inicializar visualização real dos equipamentos
            initializeRealEquipmentView() {
                // Renderizar a visualização inicial com todos os equipamentos
                this.renderRealEquipmentView('all');
                
                // Definir o contador de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                document.getElementById('real-equipment-count').textContent = `${totalEquipments} equipamentos`;
            },
            
            // Filtrar visualização real dos equipamentos
            filterRealEquipment(filter) {
                this.renderRealEquipmentView(filter);
            },
            
            // Renderizar visualização real dos equipamentos
            renderRealEquipmentView(filter) {
                const container = document.getElementById('real-equipment-container');
                if (!container) return;
                
                // Função para verificar se o item deve ser exibido com base no filtro
                const shouldShow = (item, type, frente = null) => {
                    if (filter === 'all') return true;
                    
                    if (filter === 'operational' && item.status === 'Operacional') return true;
                    if (filter === 'maintenance' && item.status === 'Em manutenção') return true;
                    if (filter === 'reform' && (item.status === 'Em reforma' || item.status === 'Inoperante' || item.status === 'Aguardando reforma')) return true;
                    
                    if (filter === 'reboques' && type === 'reboque') return true;
                    if (filter === 'caminhoes' && (type === 'caminhao-proprio' || type === 'caminhao-terceiro')) return true;
                    if (filter === 'colhedoras' && type === 'colhedora') return true;
                    if (filter === 'tracoes' && type === 'tracao') return true;
                    
                    if (filter === 'frente4001' && frente === '4001') return true;
                    if (filter === 'frente4002' && frente === '4002') return true;
                    
                    return false;
                };
                
                // Recolher todos os equipamentos que satisfazem o filtro
                const equipments = [];
                
                // Adicionar reboques
                this.data.reboques.forEach(reboque => {
                    if (shouldShow(reboque, 'reboque')) {
                        equipments.push({
                            id: reboque.frota,
                            type: 'Reboque',
                            status: reboque.status,
                            detail: reboque.tipo || '',
                            icon: 'fa-trailer',
                            color: 'blue'
                        });
                    }
                });
                
                // Adicionar caminhões próprios
                this.data.caminhoesProps.forEach(caminhao => {
                    if (shouldShow(caminhao, 'caminhao-proprio')) {
                        equipments.push({
                            id: caminhao.caminhao,
                            type: 'Caminhão Próprio',
                            status: caminhao.status,
                            detail: '',
                            icon: 'fa-truck',
                            color: 'green'
                        });
                    }
                });
                
                // Adicionar caminhões terceiros
                this.data.caminhoesTerc.forEach(caminhao => {
                    if (shouldShow(caminhao, 'caminhao-terceiro')) {
                        equipments.push({
                            id: caminhao.caminhao,
                            type: 'Caminhão Terceiro',
                            status: caminhao.status,
                            detail: caminhao.proprietario || '',
                            icon: 'fa-truck-moving',
                            color: 'purple'
                        });
                    }
                });
                
                // Adicionar colhedoras da frente 4001
                this.data.frente4001Colhedoras.forEach(colhedora => {
                    if (shouldShow(colhedora, 'colhedora', '4001')) {
                        equipments.push({
                            id: colhedora.codigo,
                            type: 'Colhedora F4001',
                            status: colhedora.status,
                            detail: 'Frente 4001',
                            icon: 'fa-tractor',
                            color: 'orange'
                        });
                    }
                });
                
                // Adicionar trações da frente 4001
                this.data.frente4001Tracoes.forEach(tracao => {
                    if (shouldShow(tracao, 'tracao', '4001')) {
                        equipments.push({
                            id: tracao.codigo,
                            type: 'Tração F4001',
                            status: tracao.status,
                            detail: 'Frente 4001',
                            icon: 'fa-truck-monster',
                            color: 'orange'
                        });
                    }
                });
                
                // Adicionar colhedoras da frente 4002
                this.data.frente4002Colhedoras.forEach(colhedora => {
                    if (shouldShow(colhedora, 'colhedora', '4002')) {
                        equipments.push({
                            id: colhedora.codigo,
                            type: 'Colhedora F4002',
                            status: colhedora.status,
                            detail: 'Frente 4002',
                            icon: 'fa-tractor',
                            color: 'red'
                        });
                    }
                });
                
                // Adicionar trações da frente 4002
                this.data.frente4002Tracoes.forEach(tracao => {
                    if (shouldShow(tracao, 'tracao', '4002')) {
                        equipments.push({
                            id: tracao.codigo,
                            type: 'Tração F4002',
                            status: tracao.status,
                            detail: 'Frente 4002',
                            icon: 'fa-truck-monster',
                            color: 'red'
                        });
                    }
                });
                
                // Atualizar contador de equipamentos filtrados
                document.getElementById('real-equipment-count').textContent = `${equipments.length} equipamentos`;
                
                // Renderizar os equipamentos
                let html = '<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">';
                
                equipments.forEach(equipment => {
                    // Determinar cor do card com base no status
                    let statusColor = '';
                    let statusBg = '';
                    let statusIcon = '';
                    
                    switch(equipment.status) {
                        case 'Operacional':
                            statusColor = 'text-green-500';
                            statusBg = 'bg-green-100 dark:bg-green-900';
                            statusIcon = 'fa-check-circle';
                            break;
                        case 'Em manutenção':
                            statusColor = 'text-yellow-500';
                            statusBg = 'bg-yellow-100 dark:bg-yellow-900';
                            statusIcon = 'fa-tools';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                        case 'Aguardando reforma':
                            statusColor = 'text-red-500';
                            statusBg = 'bg-red-100 dark:bg-red-900';
                            statusIcon = 'fa-exclamation-circle';
                            break;
                        case 'Emprestado':
                            statusColor = 'text-blue-500';
                            statusBg = 'bg-blue-100 dark:bg-blue-900';
                            statusIcon = 'fa-exchange-alt';
                            break;
                        default:
                            statusColor = 'text-gray-500';
                            statusBg = 'bg-gray-100 dark:bg-gray-700';
                            statusIcon = 'fa-question-circle';
                    }
                    
                    // Determinar cor do ícone com base no tipo
                    let iconColor = '';
                    switch(equipment.color) {
                        case 'blue': iconColor = 'text-blue-500'; break;
                        case 'green': iconColor = 'text-green-500'; break;
                        case 'purple': iconColor = 'text-purple-500'; break;
                        case 'orange': iconColor = 'text-orange-500'; break;
                        case 'red': iconColor = 'text-red-500'; break;
                        default: iconColor = 'text-gray-500';
                    }
                    
                    html += `
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700 relative">
                            <div class="absolute top-2 right-2 ${statusColor}">
                                <i class="fas ${statusIcon}"></i>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="w-12 h-12 rounded-full ${statusBg} flex items-center justify-center mb-3">
                                    <i class="fas ${equipment.icon} ${iconColor} text-xl"></i>
                                </div>
                                <p class="font-bold text-center">${equipment.id}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400 text-center">${equipment.type}</p>
                                <p class="text-xs ${statusColor} mt-2">${equipment.status}</p>
                                ${equipment.detail ? `<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${equipment.detail}</p>` : ''}
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                
                // Se não houver equipamentos para mostrar
                if (equipments.length === 0) {
                    html = `
                        <div class="flex flex-col items-center justify-center py-8">
                            <div class="w-16 h-16 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center mb-4">
                                <i class="fas fa-search text-gray-400 dark:text-gray-500 text-2xl"></i>
                            </div>
                            <p class="text-gray-500 dark:text-gray-400 mb-1">Nenhum equipamento encontrado</p>
                            <p class="text-sm text-gray-400 dark:text-gray-500">Tente outro filtro</p>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                this.updateAddFormFields();
                document.getElementById('add-modal').classList.remove('hidden');
            },
            
            // Atualizar campos de formulário de adição com base no tipo selecionado
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const fieldsContainer = document.getElementById('add-form-fields');
                
                let fields = '';
                
                switch(type) {
                    case 'reboque':
                        fields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número da Frota</label>
                                <input type="text" id="add-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex.: 1101">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <select id="add-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="SEMI REBOQUE">SEMI REBOQUE</option>
                                    <option value="REBOQUE">REBOQUE</option>
                                    <option value="DOLLY">DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                </select>
                            </div>
                            <div id="add-motivo-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="add-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Informe o motivo">
                            </div>
                            <div id="add-data-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado a (opcional)</label>
                                <input type="text" id="add-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Número do caminhão">
                            </div>
                        `;
                        break;
                    
                    case 'caminhao-proprio':
                        fields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número do Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex.: 7520">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                </select>
                            </div>
                            <div id="add-motivo-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="add-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Informe o motivo">
                            </div>
                            <div id="add-data-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                        `;
                        break;
                    
                    case 'caminhao-terceiro':
                        fields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ID do Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex.: T001">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="add-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Nome do proprietário">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques (opcional)</label>
                                <input type="text" id="add-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex.: 1201-1202">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="add-motivo-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="add-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Informe o motivo">
                            </div>
                        `;
                        break;
                    
                    case 'colhedora-4001':
                    case 'tracao-4001':
                    case 'colhedora-4002':
                    case 'tracao-4002':
                        const frente = type.includes('4001') ? '4001' : '4002';
                        const equipType = type.includes('colhedora') ? 'Colhedora' : 'Tração';
                        
                        fields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Ex.: C101">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                            <div id="add-motivo-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="add-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Informe o motivo">
                            </div>
                            <div id="add-data-container" class="mb-4 hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                        `;
                        break;
                }
                
                fieldsContainer.innerHTML = fields;
                
                // Adicionar event listener para mostrar/esconder campos adicionais baseado no status
                const statusSelect = document.getElementById('add-status');
                if (statusSelect) {
                    statusSelect.addEventListener('change', () => {
                        const status = statusSelect.value;
                        const motivoContainer = document.getElementById('add-motivo-container');
                        const dataContainer = document.getElementById('add-data-container');
                        
                        if (status === 'Operacional') {
                            motivoContainer.classList.add('hidden');
                            dataContainer?.classList.add('hidden');
                        } else {
                            motivoContainer.classList.remove('hidden');
                            dataContainer?.classList.remove('hidden');
                        }
                    });
                }
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                
                let newEquipment;
                
                switch(type) {
                    case 'reboque':
                        const frota = document.getElementById('add-frota').value?.trim();
                        const tipo = document.getElementById('add-tipo').value;
                        const rebStatus = document.getElementById('add-status').value;
                        const acoplado = document.getElementById('add-acoplado').value?.trim() || '';
                        
                        if (!frota) {
                            this.showNotification('error', 'Erro', 'O número da frota é obrigatório.');
                            return;
                        }
                        
                        // Verificar se já existe um reboque com este número de frota
                        if (this.data.reboques.some(r => r.frota === frota)) {
                            this.showNotification('error', 'Erro', 'Já existe um reboque com este número de frota.');
                            return;
                        }
                        
                        newEquipment = {
                            frota,
                            tipo,
                            status: rebStatus,
                            acoplado
                        };
                        
                        // Adicionar campos adicionais se necessário
                        if (rebStatus !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value?.trim() || '';
                            newEquipment.dataParada = document.getElementById('add-data').value || '';
                        }
                        
                        this.data.reboques.push(newEquipment);
                        break;
                    
                    case 'caminhao-proprio':
                        const caminhao = document.getElementById('add-caminhao').value?.trim();
                        const cpStatus = document.getElementById('add-status').value;
                        
                        if (!caminhao) {
                            this.showNotification('error', 'Erro', 'O número do caminhão é obrigatório.');
                            return;
                        }
                        
                        // Verificar se já existe um caminhão com este número
                        if (this.data.caminhoesProps.some(c => c.caminhao === caminhao)) {
                            this.showNotification('error', 'Erro', 'Já existe um caminhão próprio com este número.');
                            return;
                        }
                        
                        newEquipment = {
                            caminhao,
                            status: cpStatus
                        };
                        
                        // Adicionar campos adicionais se necessário
                        if (cpStatus !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value?.trim() || '';
                            newEquipment.data = document.getElementById('add-data').value || '';
                        }
                        
                        this.data.caminhoesProps.push(newEquipment);
                        break;
                    
                    case 'caminhao-terceiro':
                        const ctCaminhao = document.getElementById('add-caminhao').value?.trim();
                        const proprietario = document.getElementById('add-proprietario').value?.trim();
                        const reboques = document.getElementById('add-reboques').value?.trim() || '';
                        const ctStatus = document.getElementById('add-status').value;
                        
                        if (!ctCaminhao) {
                            this.showNotification('error', 'Erro', 'O ID do caminhão é obrigatório.');
                            return;
                        }
                        
                        if (!proprietario) {
                            this.showNotification('error', 'Erro', 'O nome do proprietário é obrigatório.');
                            return;
                        }
                        
                        // Verificar se já existe um caminhão terceiro com este ID
                        if (this.data.caminhoesTerc.some(c => c.caminhao === ctCaminhao)) {
                            this.showNotification('error', 'Erro', 'Já existe um caminhão terceiro com este ID.');
                            return;
                        }
                        
                        newEquipment = {
                            caminhao: ctCaminhao,
                            proprietario,
                            reboques,
                            status: ctStatus
                        };
                        
                        // Adicionar motivo se necessário
                        if (ctStatus !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value?.trim() || '';
                        }
                        
                        this.data.caminhoesTerc.push(newEquipment);
                        break;
                    
                    case 'colhedora-4001':
                    case 'tracao-4001':
                    case 'colhedora-4002':
                    case 'tracao-4002':
                        const codigo = document.getElementById('add-codigo').value?.trim();
                        const frenteStatus = document.getElementById('add-status').value;
                        
                        if (!codigo) {
                            this.showNotification('error', 'Erro', 'O código do equipamento é obrigatório.');
                            return;
                        }
                        
                        newEquipment = {
                            codigo,
                            status: frenteStatus
                        };
                        
                        // Adicionar campos adicionais se necessário
                        if (frenteStatus !== 'Operacional') {
                            newEquipment.motivo = document.getElementById('add-motivo').value?.trim() || '';
                            newEquipment.data = document.getElementById('add-data').value || '';
                        }
                        
                        // Determinar qual array atualizar
                        if (type === 'colhedora-4001') {
                            // Verificar se já existe uma colhedora com este código na frente 4001
                            if (this.data.frente4001Colhedoras.some(c => c.codigo === codigo)) {
                                this.showNotification('error', 'Erro', 'Já existe uma colhedora com este código na frente 4001.');
                                return;
                            }
                            this.data.frente4001Colhedoras.push(newEquipment);
                        } else if (type === 'tracao-4001') {
                            // Verificar se já existe uma tração com este código na frente 4001
                            if (this.data.frente4001Tracoes.some(t => t.codigo === codigo)) {
                                this.showNotification('error', 'Erro', 'Já existe uma tração com este código na frente 4001.');
                                return;
                            }
                            this.data.frente4001Tracoes.push(newEquipment);
                        } else if (type === 'colhedora-4002') {
                            // Verificar se já existe uma colhedora com este código na frente 4002
                            if (this.data.frente4002Colhedoras.some(c => c.codigo === codigo)) {
                                this.showNotification('error', 'Erro', 'Já existe uma colhedora com este código na frente 4002.');
                                return;
                            }
                            this.data.frente4002Colhedoras.push(newEquipment);
                        } else if (type === 'tracao-4002') {
                            // Verificar se já existe uma tração com este código na frente 4002
                            if (this.data.frente4002Tracoes.some(t => t.codigo === codigo)) {
                                this.showNotification('error', 'Erro', 'Já existe uma tração com este código na frente 4002.');
                                return;
                            }
                            this.data.frente4002Tracoes.push(newEquipment);
                        }
                        break;
                }
                
                // Salvar dados
                this.saveDataToLocalStorage();
                
                // Fechar modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento adicionado com sucesso.');
            },
            
            // Editar equipamento
            editEquipment(type, id) {
                this.data.editingType = type;
                
                let item;
                let editFields = '';
                
                switch(type) {
                    case 'Reboque':
                        item = this.data.reboques.find(r => r.frota === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número da Frota</label>
                                <input type="text" id="edit-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.frota}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <select id="edit-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="SEMI REBOQUE" ${item.tipo === 'SEMI REBOQUE' ? 'selected' : ''}>SEMI REBOQUE</option>
                                    <option value="REBOQUE" ${item.tipo === 'REBOQUE' ? 'selected' : ''}>REBOQUE</option>
                                    <option value="DOLLY" ${item.tipo === 'DOLLY' ? 'selected' : ''}>DOLLY</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.dataParada || ''}">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado a (opcional)</label>
                                <input type="text" id="edit-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.acoplado || ''}" placeholder="Número do caminhão">
                            </div>
                        `;
                        break;
                    
                    case 'Caminhão Próprio':
                        item = this.data.caminhoesProps.find(c => c.caminhao === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número do Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        `;
                        break;
                    
                    case 'Caminhão Terceiro':
                        item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ID do Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="edit-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.proprietario || ''}" placeholder="Nome do proprietário">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques (opcional)</label>
                                <input type="text" id="edit-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.reboques || ''}" placeholder="Ex.: 1201-1202">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                        `;
                        break;
                    
                    case 'Colhedora Frente 4001':
                        item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        `;
                        break;
                    
                    case 'Tração Frente 4001':
                        item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        `;
                        break;
                        
                    case 'Colhedora Frente 4002':
                        item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        `;
                        break;
                    
                    case 'Tração Frente 4002':
                        item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                        if (!item) return;
                        
                        this.data.editingItem = item;
                        
                        editFields = `
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo}" disabled>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                </select>
                            </div>
                            <div id="edit-motivo-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                                <input type="text" id="edit-motivo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.motivo || ''}" placeholder="Informe o motivo">
                            </div>
                            <div id="edit-data-container" class="mb-4 ${item.status === 'Operacional' ? 'hidden' : ''}">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        `;
                        break;
                }
                
                // Atualizar campos do formulário de edição
                document.getElementById('edit-form-fields').innerHTML = editFields;
                
                // Atualizar título do modal
                document.getElementById('modal-title').textContent = `Editar ${type}`;
                
                // Adicionar event listener para mostrar/esconder campos adicionais baseado no status
                const editStatusSelect = document.getElementById('edit-status');
                if (editStatusSelect) {
                    editStatusSelect.addEventListener('change', () => {
                        const status = editStatusSelect.value;
                        const motivoContainer = document.getElementById('edit-motivo-container');
                        const dataContainer = document.getElementById('edit-data-container');
                        
                        if (status === 'Operacional') {
                            motivoContainer.classList.add('hidden');
                            dataContainer?.classList.add('hidden');
                        } else {
                            motivoContainer.classList.remove('hidden');
                            dataContainer?.classList.remove('hidden');
                        }
                    });
                }
                
                // Exibir modal
                document.getElementById('edit-modal').classList.remove('hidden');
            },
            
            // Salvar alterações em equipamento
            saveEquipmentChanges() {
                if (!this.data.editingItem || !this.data.editingType) {
                    this.showNotification('error', 'Erro', 'Erro ao salvar alterações.');
                    return;
                }
                
                const oldStatus = this.data.editingItem.status;
                const newStatus = document.getElementById('edit-status').value;
                let dataChanged = false;
                
                // Obter histórico atual do item ou criar novo
                let itemId;
                switch(this.data.editingType) {
                    case 'Reboque':
                        itemId = this.data.editingItem.frota;
                        this.data.editingItem.tipo = document.getElementById('edit-tipo').value;
                        this.data.editingItem.status = newStatus;
                        this.data.editingItem.acoplado = document.getElementById('edit-acoplado').value?.trim() || '';
                        
                        if (newStatus !== 'Operacional') {
                            this.data.editingItem.motivo = document.getElementById('edit-motivo').value?.trim() || '';
                            this.data.editingItem.dataParada = document.getElementById('edit-data').value || '';
                        } else {
                            // Remover campos desnecessários se voltar para operacional
                            delete this.data.editingItem.motivo;
                            delete this.data.editingItem.dataParada;
                        }
                        break;
                    
                    case 'Caminhão Próprio':
                        itemId = this.data.editingItem.caminhao;
                        this.data.editingItem.status = newStatus;
                        
                        if (newStatus !== 'Operacional') {
                            this.data.editingItem.motivo = document.getElementById('edit-motivo').value?.trim() || '';
                            this.data.editingItem.data = document.getElementById('edit-data').value || '';
                        } else {
                            // Remover campos desnecessários se voltar para operacional
                            delete this.data.editingItem.motivo;
                            delete this.data.editingItem.data;
                        }
                        break;
                    
                    case 'Caminhão Terceiro':
                        itemId = this.data.editingItem.caminhao;
                        this.data.editingItem.proprietario = document.getElementById('edit-proprietario').value?.trim() || '';
                        this.data.editingItem.reboques = document.getElementById('edit-reboques').value?.trim() || '';
                        this.data.editingItem.status = newStatus;
                        
                        if (newStatus !== 'Operacional') {
                            this.data.editingItem.motivo = document.getElementById('edit-motivo').value?.trim() || '';
                        } else {
                            // Remover campos desnecessários se voltar para operacional
                            delete this.data.editingItem.motivo;
                        }
                        break;
                    
                    case 'Colhedora Frente 4001':
                    case 'Tração Frente 4001':
                    case 'Colhedora Frente 4002':
                    case 'Tração Frente 4002':
                        itemId = this.data.editingItem.codigo;
                        this.data.editingItem.status = newStatus;
                        
                        if (newStatus !== 'Operacional') {
                            this.data.editingItem.motivo = document.getElementById('edit-motivo').value?.trim() || '';
                            this.data.editingItem.data = document.getElementById('edit-data').value || '';
                        } else {
                            // Remover campos desnecessários se voltar para operacional
                            delete this.data.editingItem.motivo;
                            delete this.data.editingItem.data;
                        }
                        break;
                }
                
                // Se o status mudou, registrar no histórico
                if (oldStatus !== newStatus) {
                    dataChanged = true;
                    
                    // Criar histórico para este item se não existir
                    if (!this.data.history[itemId]) {
                        this.data.history[itemId] = [];
                    }
                    
                    // Adicionar entrada ao histórico
                    const motivo = newStatus !== 'Operacional' ? 
                        ` - Motivo: ${document.getElementById('edit-motivo').value?.trim() || 'Não informado'}` : '';
                    
                    this.data.history[itemId].unshift({
                        date: new Date().toISOString(),
                        status: newStatus,
                        description: `Status alterado de ${oldStatus} para ${newStatus}${motivo}`,
                        user: 'Administrador'
                    });
                }
                
                // Salvar dados
                this.saveDataToLocalStorage();
                
                // Fechar modal
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Limpar dados de edição
                this.data.editingItem = null;
                this.data.editingType = null;
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Mostrar notificação
                if (dataChanged) {
                    this.showNotification('success', 'Sucesso', 'Equipamento atualizado com sucesso.');
                } else {
                    this.showNotification('info', 'Informação', 'Nenhuma alteração foi feita.');
                }
            },
            
            // Confirmar exclusão de equipamento
            confirmDeleteEquipment(type, id, index, arrayName) {
                this.data.deletingType = type;
                this.data.deletingId = id;
                this.data.deletingIndex = index;
                this.data.deletingArray = arrayName;
                
                // Atualizar mensagem de confirmação
                document.getElementById('delete-item-details').textContent = `${type}: ${id}`;
                
                // Mostrar modal de confirmação
                document.getElementById('delete-confirm-modal').classList.remove('hidden');
            },
            
            // Excluir equipamento
            deleteEquipment() {
                if (!this.data.deletingId || this.data.deletingIndex === null || !this.data.deletingArray) {
                    this.showNotification('error', 'Erro', 'Erro ao excluir equipamento.');
                    return;
                }
                
                // Remover o item do array correspondente
                this.data[this.data.deletingArray].splice(this.data.deletingIndex, 1);
                
                // Salvar dados
                this.saveDataToLocalStorage();
                
                // Fechar modal
                document.getElementById('delete-confirm-modal').classList.add('hidden');
                
                // Atualizar visualizações
                this.renderAllTables();
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Equipamento excluído com sucesso.');
                
                // Limpar dados de exclusão
                this.data.deletingId = null;
                this.data.deletingType = null;
                this.data.deletingIndex = null;
                this.data.deletingArray = null;
            },
            
            // Visualizar histórico de equipamento
            viewEquipmentHistory(type, id) {
                // Histórico a ser exibido
                const history = this.data.history[id] || [];
                
                // Atualizar título e subtítulo
                document.getElementById('history-title').textContent = `Histórico - ${type}: ${id}`;
                document.getElementById('history-subtitle').textContent = `Total de registros: ${history.length}`;
                
                // Definir ícone apropriado
                let icon = 'fa-history';
                switch(type) {
                    case 'Reboque': icon = 'fa-trailer'; break;
                    case 'Caminhão Próprio': icon = 'fa-truck'; break;
                    case 'Caminhão Terceiro': icon = 'fa-truck-moving'; break;
                    case 'Colhedora Frente 4001':
                    case 'Colhedora Frente 4002': icon = 'fa-tractor'; break;
                    case 'Tração Frente 4001':
                    case 'Tração Frente 4002': icon = 'fa-truck-monster'; break;
                }
                document.getElementById('history-icon').className = `fas ${icon}`;
                
                // Renderizar timeline do histórico
                const timelineContainer = document.getElementById('history-timeline');
                
                if (history.length === 0) {
                    timelineContainer.innerHTML = `
                        <div class="flex items-center justify-center py-8">
                            <p class="text-gray-500 dark:text-gray-400">Nenhum registro de histórico encontrado</p>
                        </div>
                    `;
                } else {
                    let html = '';
                    
                    history.forEach((entry, index) => {
                        // Formatar data
                        const date = new Date(entry.date);
                        const formattedDate = date.toLocaleDateString('pt-BR', { 
                            day: '2-digit', 
                            month: '2-digit', 
                            year: 'numeric'
                        });
                        const formattedTime = date.toLocaleTimeString('pt-BR', {
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                        
                        // Cor baseada no status
                        let statusColor = '';
                        switch(entry.status) {
                            case 'Operacional': statusColor = 'bg-green-500'; break;
                            case 'Em manutenção': statusColor = 'bg-yellow-500'; break;
                            case 'Em reforma':
                            case 'Inoperante':
                            case 'Aguardando reforma': statusColor = 'bg-red-500'; break;
                            case 'Emprestado': statusColor = 'bg-blue-500'; break;
                            default: statusColor = 'bg-gray-500';
                        }
                        
                        html += `
                            <div class="mb-6 relative">
                                <div class="absolute -left-6 mt-1.5 w-4 h-4 rounded-full ${statusColor} border-2 border-white dark:border-gray-800"></div>
                                <div class="bg-white dark:bg-gray-750 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
                                    <div class="flex justify-between items-start">
                                        <span class="font-medium">${entry.status}</span>
                                        <div class="text-sm text-gray-500 dark:text-gray-400">
                                            <div>${formattedDate}</div>
                                            <div>${formattedTime}</div>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-2">${entry.description}</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">Registrado por: ${entry.user}</p>
                                </div>
                            </div>
                        `;
                    });
                    
                    timelineContainer.innerHTML = html;
                }
                
                // Exibir modal
                document.getElementById('history-modal').classList.remove('hidden');
            },
            
            // Agendar manutenção para equipamento
            scheduleEquipmentMaintenance(type, id) {
                let equipment;
                
                switch(type) {
                    case 'Reboque':
                        equipment = this.data.reboques.find(r => r.frota === id);
                        break;
                    case 'Caminhão Próprio':
                        equipment = this.data.caminhoesProps.find(c => c.caminhao === id);
                        break;
                    case 'Caminhão Terceiro':
                        equipment = this.data.caminhoesTerc.find(c => c.caminhao === id);
                        break;
                    case 'Colhedora Frente 4001':
                        equipment = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                        break;
                    case 'Tração Frente 4001':
                        equipment = this.data.frente4001Tracoes.find(t => t.codigo === id);
                        break;
                    case 'Colhedora Frente 4002':
                        equipment = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                        break;
                    case 'Tração Frente 4002':
                        equipment = this.data.frente4002Tracoes.find(t => t.codigo === id);
                        break;
                }
                
                if (!equipment) {
                    this.showNotification('error', 'Erro', 'Equipamento não encontrado.');
                    return;
                }
                
                // Armazenar equipamento para agendamento
                this.data.schedulingEquipment = {
                    id: id,
                    type: type
                };
                
                // Definir data mínima (hoje)
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('schedule-date').min = today;
                
                // Definir data padrão (amanhã)
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                document.getElementById('schedule-date').value = tomorrow.toISOString().split('T')[0];
                
                // Exibir informações do equipamento
                const infoContainer = document.getElementById('schedule-equipment-info');
                
                // Determinar cor do status
                let statusClass = '';
                switch(equipment.status) {
                    case 'Operacional': statusClass = 'text-green-500'; break;
                    case 'Em manutenção': statusClass = 'text-yellow-500'; break;
                    case 'Em reforma':
                    case 'Inoperante':
                    case 'Aguardando reforma': statusClass = 'text-red-500'; break;
                    case 'Emprestado': statusClass = 'text-blue-500'; break;
                    default: statusClass = 'text-gray-500';
                }
                
                infoContainer.innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="font-medium">${type}: ${id}</p>
                                <p class="text-sm ${statusClass}">Status atual: ${equipment.status}</p>
                            </div>
                        </div>
                    </div>
                `;
                
                // Exibir modal
                document.getElementById('schedule-modal').classList.remove('hidden');
            },
            
            // Salvar agendamento de manutenção
            saveSchedule() {
                if (!this.data.schedulingEquipment) {
                    this.showNotification('error', 'Erro', 'Erro ao agendar manutenção.');
                    return;
                }
                
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const type = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value?.trim();
                const responsible = document.getElementById('schedule-responsible').value?.trim();
                
                if (!date || !time || !description || !responsible) {
                    this.showNotification('error', 'Erro', 'Todos os campos são obrigatórios.');
                    return;
                }
                
                // Criar novo agendamento
                const newSchedule = {
                    equipment: this.data.schedulingEquipment.id,
                    equipmentType: this.data.schedulingEquipment.type,
                    date,
                    time,
                    type,
                    description,
                    responsible,
                    created: new Date().toISOString(),
                    status: 'Agendado'
                };
                
                // Adicionar à lista de agendamentos
                this.data.schedules.push(newSchedule);
                
                // Salvar dados
                this.saveDataToLocalStorage();
                
                // Fechar modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Limpar dados de agendamento
                this.data.schedulingEquipment = null;
                
                // Atualizar visualizações
                this.updateSchedulesList();
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Manutenção agendada com sucesso.');
            },
            
            // Exportar dados para CSV
            exportToCSV() {
                // Identificar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                let data = [];
                let filename = '';
                let headers = [];
                
                switch(tabId) {
                    case 'reboques':
                        data = this.data.reboques;
                        filename = 'reboques.csv';
                        headers = ['Frota', 'Tipo', 'Acoplado', 'Status', 'Data Parada', 'Motivo'];
                        break;
                    
                    case 'caminhoes-proprios':
                        data = this.data.caminhoesProps;
                        filename = 'caminhoes_proprios.csv';
                        headers = ['Caminhão', 'Status', 'Data', 'Motivo'];
                        break;
                    
                    case 'caminhoes-terceiros':
                        data = this.data.caminhoesTerc;
                        filename = 'caminhoes_terceiros.csv';
                        headers = ['Caminhão', 'Proprietário', 'Reboques', 'Status', 'Motivo'];
                        break;
                    
                    case 'frente-4001':
                        // Combinar colhedoras e trações
                        data = [
                            ...this.data.frente4001Colhedoras.map(item => ({
                                ...item,
                                type: 'Colhedora'
                            })),
                            ...this.data.frente4001Tracoes.map(item => ({
                                ...item,
                                type: 'Tração'
                            }))
                        ];
                        filename = 'frente_4001.csv';
                        headers = ['Tipo', 'Código', 'Status', 'Data', 'Motivo'];
                        break;
                    
                    case 'frente-4002':
                        // Combinar colhedoras e trações
                        data = [
                            ...this.data.frente4002Colhedoras.map(item => ({
                                ...item,
                                type: 'Colhedora'
                            })),
                            ...this.data.frente4002Tracoes.map(item => ({
                                ...item,
                                type: 'Tração'
                            }))
                        ];
                        filename = 'frente_4002.csv';
                        headers = ['Tipo', 'Código', 'Status', 'Data', 'Motivo'];
                        break;
                    
                    default:
                        // Exportar todos os dados
                        filename = 'frota_completa.csv';
                        
                        // Criar um objeto com todos os equipamentos
                        const allEquipments = [];
                        
                        // Adicionar reboques
                        this.data.reboques.forEach(reboque => {
                            allEquipments.push({
                                tipo: 'Reboque',
                                codigo: reboque.frota,
                                detalhe: reboque.tipo,
                                status: reboque.status,
                                data: reboque.dataParada || '',
                                motivo: reboque.motivo || ''
                            });
                        });
                        
                        // Adicionar caminhões próprios
                        this.data.caminhoesProps.forEach(caminhao => {
                            allEquipments.push({
                                tipo: 'Caminhão Próprio',
                                codigo: caminhao.caminhao,
                                detalhe: '',
                                status: caminhao.status,
                                data: caminhao.data || '',
                                motivo: caminhao.motivo || ''
                            });
                        });
                        
                        // Adicionar caminhões terceiros
                        this.data.caminhoesTerc.forEach(caminhao => {
                            allEquipments.push({
                                tipo: 'Caminhão Terceiro',
                                codigo: caminhao.caminhao,
                                detalhe: caminhao.proprietario,
                                status: caminhao.status,
                                data: '',
                                motivo: caminhao.motivo || ''
                            });
                        });
                        
                        // Adicionar colhedoras e trações da frente 4001
                        this.data.frente4001Colhedoras.forEach(colhedora => {
                            allEquipments.push({
                                tipo: 'Colhedora Frente 4001',
                                codigo: colhedora.codigo,
                                detalhe: '',
                                status: colhedora.status,
                                data: colhedora.data || '',
                                motivo: colhedora.motivo || ''
                            });
                        });
                        
                        this.data.frente4001Tracoes.forEach(tracao => {
                            allEquipments.push({
                                tipo: 'Tração Frente 4001',
                                codigo: tracao.codigo,
                                detalhe: '',
                                status: tracao.status,
                                data: tracao.data || '',
                                motivo: tracao.motivo || ''
                            });
                        });
                        
                        // Adicionar colhedoras e trações da frente 4002
                        this.data.frente4002Colhedoras.forEach(colhedora => {
                            allEquipments.push({
                                tipo: 'Colhedora Frente 4002',
                                codigo: colhedora.codigo,
                                detalhe: '',
                                status: colhedora.status,
                                data: colhedora.data || '',
                                motivo: colhedora.motivo || ''
                            });
                        });
                        
                        this.data.frente4002Tracoes.forEach(tracao => {
                            allEquipments.push({
                                tipo: 'Tração Frente 4002',
                                codigo: tracao.codigo,
                                detalhe: '',
                                status: tracao.status,
                                data: tracao.data || '',
                                motivo: tracao.motivo || ''
                            });
                        });
                        
                        data = allEquipments;
                        headers = ['Tipo', 'Código', 'Detalhe', 'Status', 'Data', 'Motivo'];
                }
                
                // Gerar CSV
                let csvContent = headers.join(',') + '\n';
                
                data.forEach(item => {
                    let row = [];
                    
                    switch(tabId) {
                        case 'reboques':
                            row = [
                                `"${item.frota || ''}"`,
                                `"${item.tipo || ''}"`,
                                `"${item.acoplado || ''}"`,
                                `"${item.status || ''}"`,
                                `"${item.dataParada || ''}"`,
                                `"${item.motivo || ''}"`
                            ];
                            break;
                        
                        case 'caminhoes-proprios':
                            row = [
                                `"${item.caminhao || ''}"`,
                                `"${item.status || ''}"`,
                                `"${item.data || ''}"`,
                                `"${item.motivo || ''}"`
                            ];
                            break;
                        
                        case 'caminhoes-terceiros':
                            row = [
                                `"${item.caminhao || ''}"`,
                                `"${item.proprietario || ''}"`,
                                `"${item.reboques || ''}"`,
                                `"${item.status || ''}"`,
                                `"${item.motivo || ''}"`
                            ];
                            break;
                        
                        case 'frente-4001':
                        case 'frente-4002':
                            row = [
                                `"${item.type || ''}"`,
                                `"${item.codigo || ''}"`,
                                `"${item.status || ''}"`,
                                `"${item.data || ''}"`,
                                `"${item.motivo || ''}"`
                            ];
                            break;
                        
                        default:
                            row = [
                                `"${item.tipo || ''}"`,
                                `"${item.codigo || ''}"`,
                                `"${item.detalhe || ''}"`,
                                `"${item.status || ''}"`,
                                `"${item.data || ''}"`,
                                `"${item.motivo || ''}"`
                            ];
                    }
                    
                    csvContent += row.join(',') + '\n';
                });
                
                // Criar arquivo para download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                // Criar link para download
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Sucesso', 'Arquivo CSV exportado com sucesso.');
            },
            
            // Imprimir tabela ativa
            printActiveTable() {
                // Identificar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const tabId = activeTab.id;
                let title = '';
                let tableContent = '';
                
                // Obter tabela HTML completa para impressão
                switch(tabId) {
                    case 'reboques':
                        title = 'Relatório de Reboques';
                        tableContent = this.generateReboquesTableHTML();
                        break;
                    
                    case 'caminhoes-proprios':
                        title = 'Relatório de Caminhões Próprios';
                        tableContent = this.generateCPTableHTML();
                        break;
                    
                    case 'caminhoes-terceiros':
                        title = 'Relatório de Caminhões Terceiros';
                        tableContent = this.generateCTTableHTML();
                        break;
                    
                    case 'frente-4001':
                        title = 'Relatório da Frente 4001';
                        tableContent = this.generateF4001TableHTML();
                        break;
                    
                    case 'frente-4002':
                        title = 'Relatório da Frente 4002';
                        tableContent = this.generateF4002TableHTML();
                        break;
                    
                    case 'main-dashboard':
                        title = 'Dashboard Principal';
                        tableContent = this.generateDashboardHTML();
                        break;
                    
                    case 'detailed-dashboard':
                        title = 'Dashboard Detalhado';
                        tableContent = this.generateDetailedDashboardHTML();
                        break;
                    
                    default:
                        this.showNotification('error', 'Erro', 'Não é possível imprimir esta visualização.');
                        return;
                }
                
                // Atualizar área de impressão
                document.getElementById('print-title').textContent = title;
                document.getElementById('print-content').innerHTML = tableContent;
                
                // Adicionar data e hora
                const now = new Date();
                document.getElementById('print-date').textContent = now.toLocaleDateString('pt-BR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('print-timestamp').textContent = now.toLocaleString('pt-BR');
                
                // Imprimir
                window.print();
            },
            // Imprimir dashboard
            printDashboard() {
                const title = 'Dashboard de Frota';
                const dashboardContent = this.generateDashboardHTML();
                
                // Atualizar área de impressão
                document.getElementById('print-title').textContent = title;
                document.getElementById('print-content').innerHTML = dashboardContent;
                
                // Adicionar data e hora
                const now = new Date();
                document.getElementById('print-date').textContent = now.toLocaleDateString('pt-BR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('print-timestamp').textContent = now.toLocaleString('pt-BR');
                
                // Imprimir
                window.print();
            },
            
            // Gerar relatório PDF
            generatePDFReport() {
                // Preparar conteúdo do relatório
                const title = 'Relatório Completo de Frota';
                
                // Gerar conteúdo completo
                let reportContent = '';
                
                // Adicionar resumo geral
                reportContent += this.generateSummaryHTML();
                reportContent += '<div class="pdf-page-break"></div>';
                
                // Adicionar tabelas para cada categoria
                reportContent += '<h2 class="text-xl font-bold mb-4">Reboques</h2>';
                reportContent += this.generateReboquesTableHTML();
                reportContent += '<div class="pdf-page-break"></div>';
                
                reportContent += '<h2 class="text-xl font-bold mb-4">Caminhões Próprios</h2>';
                reportContent += this.generateCPTableHTML();
                reportContent += '<div class="pdf-page-break"></div>';
                
                reportContent += '<h2 class="text-xl font-bold mb-4">Caminhões Terceiros</h2>';
                reportContent += this.generateCTTableHTML();
                reportContent += '<div class="pdf-page-break"></div>';
                
                reportContent += '<h2 class="text-xl font-bold mb-4">Frente 4001</h2>';
                reportContent += this.generateF4001TableHTML();
                reportContent += '<div class="pdf-page-break"></div>';
                
                reportContent += '<h2 class="text-xl font-bold mb-4">Frente 4002</h2>';
                reportContent += this.generateF4002TableHTML();
                
                // Adicionar agendamentos de manutenção
                if (this.data.schedules.length > 0) {
                    reportContent += '<div class="pdf-page-break"></div>';
                    reportContent += '<h2 class="text-xl font-bold mb-4">Agendamentos de Manutenção</h2>';
                    reportContent += this.generateSchedulesTableHTML();
                }
                
                // Atualizar área do relatório PDF
                document.getElementById('pdf-report-title').textContent = title;
                document.getElementById('pdf-report-content').innerHTML = reportContent;
                
                // Adicionar data e hora
                const now = new Date();
                document.getElementById('pdf-report-date').textContent = now.toLocaleDateString('pt-BR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('pdf-timestamp').textContent = now.toLocaleString('pt-BR');
                
                // Imprimir
                window.print();
            },
            
            // Gerar HTML da tabela de reboques
            generateReboquesTableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Frota</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Acoplado</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Status</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                if (this.data.reboques.length === 0) {
                    html += `
                        <tr>
                            <td colspan="6" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum reboque encontrado</td>
                        </tr>
                    `;
                } else {
                    this.data.reboques.forEach(reboque => {
                        // Formatar data
                        let dataFormatada = '';
                        if (reboque.dataParada) {
                            const data = new Date(reboque.dataParada);
                            dataFormatada = data.toLocaleDateString('pt-BR');
                        }
                        
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${reboque.frota || '-'}</td>
                                <td class="px-4 py-2 text-sm">${reboque.tipo || '-'}</td>
                                <td class="px-4 py-2 text-sm">${reboque.acoplado || '-'}</td>
                                <td class="px-4 py-2 text-sm">${reboque.status || '-'}</td>
                                <td class="px-4 py-2 text-sm">${dataFormatada || '-'}</td>
                                <td class="px-4 py-2 text-sm">${reboque.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da tabela de caminhões próprios
            generateCPTableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Caminhão</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Status</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                if (this.data.caminhoesProps.length === 0) {
                    html += `
                        <tr>
                            <td colspan="4" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum caminhão próprio encontrado</td>
                        </tr>
                    `;
                } else {
                    this.data.caminhoesProps.forEach(caminhao => {
                        // Formatar data
                        let dataFormatada = '';
                        if (caminhao.data) {
                            const data = new Date(caminhao.data);
                            dataFormatada = data.toLocaleDateString('pt-BR');
                        }
                        
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${caminhao.caminhao || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.status || '-'}</td>
                                <td class="px-4 py-2 text-sm">${dataFormatada || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da tabela de caminhões terceiros
            generateCTTableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Caminhão</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Proprietário</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Reboques</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Status</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                if (this.data.caminhoesTerc.length === 0) {
                    html += `
                        <tr>
                            <td colspan="5" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum caminhão terceiro encontrado</td>
                        </tr>
                    `;
                } else {
                    this.data.caminhoesTerc.forEach(caminhao => {
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${caminhao.caminhao || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.proprietario || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.reboques || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.status || '-'}</td>
                                <td class="px-4 py-2 text-sm">${caminhao.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da tabela da frente 4001
            generateF4001TableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Código</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Status</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                // Combinar colhedoras e trações
                const combinedData = [
                    ...this.data.frente4001Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4001Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                if (combinedData.length === 0) {
                    html += `
                        <tr>
                            <td colspan="5" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum equipamento encontrado</td>
                        </tr>
                    `;
                } else {
                    combinedData.forEach(item => {
                        // Formatar data
                        let dataFormatada = '';
                        if (item.data) {
                            const data = new Date(item.data);
                            dataFormatada = data.toLocaleDateString('pt-BR');
                        }
                        
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${item.type || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.codigo || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.status || '-'}</td>
                                <td class="px-4 py-2 text-sm">${dataFormatada || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da tabela da frente 4002
            generateF4002TableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Código</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Status</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                // Combinar colhedoras e trações
                const combinedData = [
                    ...this.data.frente4002Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4002Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                if (combinedData.length === 0) {
                    html += `
                        <tr>
                            <td colspan="5" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum equipamento encontrado</td>
                        </tr>
                    `;
                } else {
                    combinedData.forEach(item => {
                        // Formatar data
                        let dataFormatada = '';
                        if (item.data) {
                            const data = new Date(item.data);
                            dataFormatada = data.toLocaleDateString('pt-BR');
                        }
                        
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${item.type || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.codigo || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.status || '-'}</td>
                                <td class="px-4 py-2 text-sm">${dataFormatada || '-'}</td>
                                <td class="px-4 py-2 text-sm">${item.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da tabela de agendamentos
            generateSchedulesTableHTML() {
                let html = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Equipamento</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Hora</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Manutenção</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Descrição</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600 dark:text-gray-300">Responsável</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                `;
                
                if (this.data.schedules.length === 0) {
                    html += `
                        <tr>
                            <td colspan="7" class="px-4 py-2 text-sm text-center text-gray-500">Nenhum agendamento encontrado</td>
                        </tr>
                    `;
                } else {
                    // Ordenar por data (mais próxima primeiro)
                    const sortedSchedules = [...this.data.schedules].sort((a, b) => 
                        new Date(a.date) - new Date(b.date)
                    );
                    
                    sortedSchedules.forEach(schedule => {
                        // Formatar data
                        let dataFormatada = '';
                        if (schedule.date) {
                            const data = new Date(schedule.date);
                            dataFormatada = data.toLocaleDateString('pt-BR');
                        }
                        
                        // Formatar tipo de manutenção
                        let tipoFormatado = '';
                        switch(schedule.type) {
                            case 'preventiva': tipoFormatado = 'Preventiva'; break;
                            case 'corretiva': tipoFormatado = 'Corretiva'; break;
                            case 'revisao': tipoFormatado = 'Revisão Geral'; break;
                            case 'troca-oleo': tipoFormatado = 'Troca de Óleo'; break;
                            case 'reforma': tipoFormatado = 'Reforma'; break;
                            default: tipoFormatado = 'Outro';
                        }
                        
                        html += `
                            <tr>
                                <td class="px-4 py-2 text-sm">${schedule.equipment || '-'}</td>
                                <td class="px-4 py-2 text-sm">${schedule.equipmentType || '-'}</td>
                                <td class="px-4 py-2 text-sm">${dataFormatada || '-'}</td>
                                <td class="px-4 py-2 text-sm">${schedule.time || '-'}</td>
                                <td class="px-4 py-2 text-sm">${tipoFormatado || '-'}</td>
                                <td class="px-4 py-2 text-sm">${schedule.description || '-'}</td>
                                <td class="px-4 py-2 text-sm">${schedule.responsible || '-'}</td>
                            </tr>
                        `;
                    });
                }
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML do dashboard para impressão
            generateDashboardHTML() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contar equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                const other = totalEquipments - operational - maintenance - reform;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                return `
                    <div class="mb-6">
                        <h2 class="text-lg font-bold mb-3">Resumo da Frota</h2>
                        <div class="grid grid-cols-3 gap-4 mb-4">
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Total de Equipamentos</p>
                                <p class="text-xl font-bold">${totalEquipments}</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Disponibilidade</p>
                                <p class="text-xl font-bold">${availability}%</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Em Manutenção</p>
                                <p class="text-xl font-bold">${maintenance}</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-4 gap-4 mb-6">
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Operacionais</p>
                                <p class="text-xl font-bold text-green-600">${operational}</p>
                                <p class="text-xs text-gray-500">${Math.round((operational / totalEquipments) * 100)}% do total</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Em Manutenção</p>
                                <p class="text-xl font-bold text-yellow-600">${maintenance}</p>
                                <p class="text-xs text-gray-500">${Math.round((maintenance / totalEquipments) * 100)}% do total</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Em Reforma</p>
                                <p class="text-xl font-bold text-red-600">${reform}</p>
                                <p class="text-xs text-gray-500">${Math.round((reform / totalEquipments) * 100)}% do total</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <p class="text-sm text-gray-500 mb-1">Outros</p>
                                <p class="text-xl font-bold text-gray-600">${other}</p>
                                <p class="text-xs text-gray-500">${Math.round((other / totalEquipments) * 100)}% do total</p>
                            </div>
                        </div>
                        
                        <h2 class="text-lg font-bold mb-3">Detalhamento por Categoria</h2>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="font-medium mb-2">Reboques</h3>
                                <p class="mb-1">Total: <span class="font-medium">${this.data.reboques.length}</span></p>
                                <p class="mb-1">Operacionais: <span class="font-medium text-green-600">${this.data.reboques.filter(r => r.status === 'Operacional').length}</span></p>
                                <p class="mb-1">Em Manutenção: <span class="font-medium text-yellow-600">${this.data.reboques.filter(r => r.status === 'Em manutenção').length}</span></p>
                            </div>
                            
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="font-medium mb-2">Caminhões Próprios</h3>
                                <p class="mb-1">Total: <span class="font-medium">${this.data.caminhoesProps.length}</span></p>
                                <p class="mb-1">Operacionais: <span class="font-medium text-green-600">${this.data.caminhoesProps.filter(c => c.status === 'Operacional').length}</span></p>
                                <p class="mb-1">Em Manutenção: <span class="font-medium text-yellow-600">${this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length}</span></p>
                            </div>
                            
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="font-medium mb-2">Frente 4001</h3>
                                <p class="mb-1">Total: <span class="font-medium">${this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length}</span></p>
                                <p class="mb-1">Operacionais: <span class="font-medium text-green-600">${
                                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length
                                }</span></p>
                                <p class="mb-1">Em Manutenção: <span class="font-medium text-yellow-600">${
                                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length
                                }</span></p>
                            </div>
                            
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="font-medium mb-2">Frente 4002</h3>
                                <p class="mb-1">Total: <span class="font-medium">${this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length}</span></p>
                                <p class="mb-1">Operacionais: <span class="font-medium text-green-600">${
                                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length
                                }</span></p>
                                <p class="mb-1">Em Manutenção: <span class="font-medium text-yellow-600">${
                                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length
                                }</span></p>
                            </div>
                        </div>
                        
                        <!-- Equipamentos em manutenção -->
                        ${this.generateMaintenanceListHTML()}
                        
                        <!-- Próximas manutenções -->
                        ${this.generateUpcomingMaintenanceHTML()}
                    </div>
                `;
            },
            
            // Gerar HTML do dashboard detalhado para impressão
            generateDetailedDashboardHTML() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contar equipamentos operacionais
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const operationalPercentage = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                // Contar total de manutenções em andamento
                const totalMaintenances = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                return `
                    <div class="mb-6">
                        <h2 class="text-lg font-bold mb-4">Dashboard Detalhado</h2>
                        
                        <div class="grid grid-cols-3 gap-4 mb-6">
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="text-sm font-medium text-gray-500 mb-1">Total de Equipamentos</h3>
                                <p class="text-2xl font-bold">${totalEquipments}</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="text-sm font-medium text-gray-500 mb-1">Disponibilidade Geral</h3>
                                <p class="text-2xl font-bold">${operationalPercentage}%</p>
                            </div>
                            <div class="border border-gray-300 rounded-md p-3">
                                <h3 class="text-sm font-medium text-gray-500 mb-1">Em Manutenção</h3>
                                <p class="text-2xl font-bold">${totalMaintenances}</p>
                            </div>
                        </div>
                        
                        <h3 class="text-lg font-medium mb-4">Análise por Categoria</h3>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <!-- Reboques -->
                            <div class="border border-gray-300 rounded-md p-3">
                                <div class="flex items-center mb-2">
                                    <h4 class="font-medium">Reboques</h4>
                                    <p class="text-sm text-gray-500 ml-2">Total: ${this.data.reboques.length}</p>
                                    <p class="ml-auto text-lg font-bold">
                                        ${this.data.reboques.length > 0 ? 
                                            Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / this.data.reboques.length) * 100) : 0}%
                                    </p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500">Disponibilidade</span>
                                        <span class="text-sm font-medium">
                                            ${this.data.reboques.length > 0 ? 
                                                Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / this.data.reboques.length) * 100) : 0}%
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Caminhões Próprios -->
                            <div class="border border-gray-300 rounded-md p-3">
                                <div class="flex items-center mb-2">
                                    <h4 class="font-medium">Caminhões Próprios</h4>
                                    <p class="text-sm text-gray-500 ml-2">Total: ${this.data.caminhoesProps.length}</p>
                                    <p class="ml-auto text-lg font-bold">
                                        ${this.data.caminhoesProps.length > 0 ? 
                                            Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / this.data.caminhoesProps.length) * 100) : 0}%
                                    </p>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-500">Disponibilidade</span>
                                        <span class="text-sm font-medium">
                                            ${this.data.caminhoesProps.length > 0 ? 
                                                Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / this.data.caminhoesProps.length) * 100) : 0}%
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <!-- Frente 4001 -->
                            <div class="border border-gray-300 rounded-md p-3">
                                <div class="flex items-center mb-2">
                                    <h4 class="font-medium">Frente 4001</h4>
                                    <p class="text-sm text-gray-500 ml-2">
                                        Total: ${this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length}
                                    </p>
                                    <p class="ml-auto text-lg font-bold">
                                        ${(this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length) > 0 ? 
                                            Math.round(((this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                                                        this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length) / 
                                                        (this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length)) * 100) : 0}%
                                    </p>
                                </div>
                                <div class="mt-2 grid grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500">Colhedoras: ${this.data.frente4001Colhedoras.length}</p>
                                        <p class="text-sm text-gray-500">Operacionais: ${this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Trações: ${this.data.frente4001Tracoes.length}</p>
                                        <p class="text-sm text-gray-500">Operacionais: ${this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Frente 4002 -->
                            <div class="border border-gray-300 rounded-md p-3">
                                <div class="flex items-center mb-2">
                                    <h4 class="font-medium">Frente 4002</h4>
                                    <p class="text-sm text-gray-500 ml-2">
                                        Total: ${this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length}
                                    </p>
                                    <p class="ml-auto text-lg font-bold">
                                        ${(this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length) > 0 ? 
                                            Math.round(((this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                                                        this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length) / 
                                                        (this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length)) * 100) : 0}%
                                    </p>
                                </div>
                                <div class="mt-2 grid grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-500">Colhedoras: ${this.data.frente4002Colhedoras.length}</p>
                                        <p class="text-sm text-gray-500">Operacionais: ${this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-500">Trações: ${this.data.frente4002Tracoes.length}</p>
                                        <p class="text-sm text-gray-500">Operacionais: ${this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Indicadores -->
                        <div class="border border-gray-300 rounded-md p-4 mb-6">
                            <h3 class="text-lg font-medium mb-4">Indicadores de Desempenho</h3>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-500">MTBF (Tempo Médio Entre Falhas)</h4>
                                    <p class="text-xl font-bold mt-1">-</p>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-500">MTTR (Tempo Médio Para Reparo)</h4>
                                    <p class="text-xl font-bold mt-1">-</p>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-500">OEE (Eficácia Global do Equipamento)</h4>
                                    <p class="text-xl font-bold mt-1">-</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            // Gerar HTML do resumo para relatório
            generateSummaryHTML() {
                // Contagem total de equipamentos
                const totalEquipments = 
                    this.data.reboques.length +
                    this.data.caminhoesProps.length +
                    this.data.caminhoesTerc.length +
                    this.data.frente4001Colhedoras.length +
                    this.data.frente4001Tracoes.length +
                    this.data.frente4002Colhedoras.length +
                    this.data.frente4002Tracoes.length;
                
                // Contar equipamentos por status
                const operational = 
                    this.data.reboques.filter(r => r.status === 'Operacional').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Operacional').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const maintenance = 
                    this.data.reboques.filter(r => r.status === 'Em manutenção').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                const reform = 
                    this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Inoperante' || r.status === 'Aguardando reforma').length +
                    this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length +
                    this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Inoperante' || c.status === 'Aguardando reforma').length +
                    this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Inoperante' || t.status === 'Aguardando reforma').length;
                
                const other = totalEquipments - operational - maintenance - reform;
                
                // Calcular disponibilidade
                const availability = totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0;
                
                return `
                    <h2 class="text-xl font-bold mb-4">Resumo da Frota</h2>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="border border-gray-300 rounded-md p-4">
                            <h3 class="font-medium mb-2">Visão Geral</h3>
                            <p class="mb-1">Total de Equipamentos: <span class="font-medium">${totalEquipments}</span></p>
                            <p class="mb-1">Disponibilidade Geral: <span class="font-medium">${availability}%</span></p>
                        </div>
                        
                        <div class="border border-gray-300 rounded-md p-4">
                            <h3 class="font-medium mb-2">Distribuição por Status</h3>
                            <p class="mb-1">Operacionais: <span class="font-medium">${operational} (${totalEquipments > 0 ? Math.round((operational / totalEquipments) * 100) : 0}%)</span></p>
                            <p class="mb-1">Em Manutenção: <span class="font-medium">${maintenance} (${totalEquipments > 0 ? Math.round((maintenance / totalEquipments) * 100) : 0}%)</span></p>
                            <p class="mb-1">Em Reforma/Inoperantes: <span class="font-medium">${reform} (${totalEquipments > 0 ? Math.round((reform / totalEquipments) * 100) : 0}%)</span></p>
                            <p class="mb-1">Outros: <span class="font-medium">${other} (${totalEquipments > 0 ? Math.round((other / totalEquipments) * 100) : 0}%)</span></p>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-medium mb-3">Detalhamento por Categoria</h3>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="border border-gray-300 rounded-md p-4">
                            <h4 class="font-medium mb-2">Reboques</h4>
                            <p class="mb-1">Total: <span class="font-medium">${this.data.reboques.length}</span></p>
                            <p class="mb-1">Operacionais: <span class="font-medium">${this.data.reboques.filter(r => r.status === 'Operacional').length}</span></p>
                            <p class="mb-1">Em Manutenção: <span class="font-medium">${this.data.reboques.filter(r => r.status === 'Em manutenção').length}</span></p>
                            <p class="mb-1">Disponibilidade: <span class="font-medium">
                                ${this.data.reboques.length > 0 ? 
                                    Math.round((this.data.reboques.filter(r => r.status === 'Operacional').length / this.data.reboques.length) * 100) : 0}%
                            </span></p>
                        </div>
                        
                        <div class="border border-gray-300 rounded-md p-4">
                            <h4 class="font-medium mb-2">Caminhões Próprios</h4>
                            <p class="mb-1">Total: <span class="font-medium">${this.data.caminhoesProps.length}</span></p>
                            <p class="mb-1">Operacionais: <span class="font-medium">${this.data.caminhoesProps.filter(c => c.status === 'Operacional').length}</span></p>
                            <p class="mb-1">Em Manutenção: <span class="font-medium">${this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length}</span></p>
                            <p class="mb-1">Disponibilidade: <span class="font-medium">
                                ${this.data.caminhoesProps.length > 0 ? 
                                    Math.round((this.data.caminhoesProps.filter(c => c.status === 'Operacional').length / this.data.caminhoesProps.length) * 100) : 0}%
                            </span></p>
                        </div>
                        
                        <div class="border border-gray-300 rounded-md p-4">
                            <h4 class="font-medium mb-2">Caminhões Terceiros</h4>
                            <p class="mb-1">Total: <span class="font-medium">${this.data.caminhoesTerc.length}</span></p>
                            <p class="mb-1">Operacionais: <span class="font-medium">${this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length}</span></p>
                            <p class="mb-1">Em Manutenção: <span class="font-medium">${this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length}</span></p>
                            <p class="mb-1">Disponibilidade: <span class="font-medium">
                                ${this.data.caminhoesTerc.length > 0 ? 
                                    Math.round((this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length / this.data.caminhoesTerc.length) * 100) : 0}%
                            </span></p>
                        </div>
                        
                        <div class="border border-gray-300 rounded-md p-4">
                            <h4 class="font-medium mb-2">Frente 4001 e 4002</h4>
                            <p class="mb-1">Total: <span class="font-medium">
                                ${this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length + 
                                   this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length}
                            </span></p>
                            <p class="mb-1">Operacionais: <span class="font-medium">
                                ${this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                  this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                                  this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                  this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length}
                            </span></p>
                            <p class="mb-1">Em Manutenção: <span class="font-medium">
                                ${this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                  this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                                  this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                  this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length}
                            </span></p>
                            <p class="mb-1">Disponibilidade: <span class="font-medium">
                                ${(this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length + 
                                   this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length) > 0 ? 
                                    Math.round(((this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                               this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length +
                                               this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                               this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length) / 
                                              (this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length + 
                                               this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length)) * 100) : 0}%
                            </span></p>
                        </div>
                    </div>
                `;
            },
            
            // Gerar HTML da lista de equipamentos em manutenção
            generateMaintenanceListHTML() {
                // Encontrar todos os equipamentos em manutenção
                const inMaintenance = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção').map(r => ({
                        id: r.frota,
                        type: 'Reboque',
                        date: r.dataParada,
                        reason: r.motivo
                    })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Próprio',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.caminhao,
                        type: 'Caminhão Terceiro',
                        date: null,
                        reason: c.motivo
                    })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4001',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4001',
                        date: t.data,
                        reason: t.motivo
                    })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({
                        id: c.codigo,
                        type: 'Colhedora F4002',
                        date: c.data,
                        reason: c.motivo
                    })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({
                        id: t.codigo,
                        type: 'Tração F4002',
                        date: t.data,
                        reason: t.motivo
                    }))
                ];
                
                if (inMaintenance.length === 0) {
                    return `
                        <div class="border border-gray-300 rounded-md p-4 mb-6">
                            <h3 class="font-medium mb-3">Equipamentos em Manutenção</h3>
                            <p class="text-sm text-gray-500">Nenhum equipamento em manutenção no momento.</p>
                        </div>
                    `;
                }
                
                // Ordenar por data (mais recente primeiro)
                inMaintenance.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    return new Date(b.date) - new Date(a.date);
                });
                
                let html = `
                    <div class="border border-gray-300 rounded-md p-4 mb-6">
                        <h3 class="font-medium mb-3">Equipamentos em Manutenção (${inMaintenance.length})</h3>
                        <table class="min-w-full border border-gray-300">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Equipamento</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Motivo</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                `;
                
                inMaintenance.forEach(item => {
                    // Formatar data
                    let dataFormatada = '';
                    if (item.date) {
                        const data = new Date(item.date);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr>
                            <td class="px-4 py-2 text-sm font-medium">${item.id}</td>
                            <td class="px-4 py-2 text-sm">${item.type}</td>
                            <td class="px-4 py-2 text-sm">${dataFormatada || 'Não informada'}</td>
                            <td class="px-4 py-2 text-sm">${item.reason || 'Sem informação'}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Gerar HTML da lista de manutenções agendadas
            generateUpcomingMaintenanceHTML() {
                // Filtrar agendamentos futuros
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcoming = this.data.schedules.filter(s => {
                    const scheduleDate = new Date(s.date);
                    return scheduleDate >= today;
                });
                
                if (upcoming.length === 0) {
                    return `
                        <div class="border border-gray-300 rounded-md p-4 mb-6">
                            <h3 class="font-medium mb-3">Próximas Manutenções Agendadas</h3>
                            <p class="text-sm text-gray-500">Nenhuma manutenção agendada.</p>
                        </div>
                    `;
                }
                
                // Ordenar por data (mais próxima primeiro)
                upcoming.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                let html = `
                    <div class="border border-gray-300 rounded-md p-4 mb-6">
                        <h3 class="font-medium mb-3">Próximas Manutenções Agendadas (${upcoming.length})</h3>
                        <table class="min-w-full border border-gray-300">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Equipamento</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Tipo</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Data</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Descrição</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                `;
                
                // Mostrar os 5 mais próximos
                upcoming.slice(0, 10).forEach(item => {
                    // Formatar data
                    const data = new Date(item.date);
                    const dataFormatada = data.toLocaleDateString('pt-BR');
                    
                    // Formatar tipo de manutenção
                    let tipoFormatado = '';
                    switch(item.type) {
                        case 'preventiva': tipoFormatado = 'Preventiva'; break;
                        case 'corretiva': tipoFormatado = 'Corretiva'; break;
                        case 'revisao': tipoFormatado = 'Revisão Geral'; break;
                        case 'troca-oleo': tipoFormatado = 'Troca de Óleo'; break;
                        case 'reforma': tipoFormatado = 'Reforma'; break;
                        default: tipoFormatado = 'Outro';
                    }
                    
                    html += `
                        <tr>
                            <td class="px-4 py-2 text-sm font-medium">${item.equipment}</td>
                            <td class="px-4 py-2 text-sm">${tipoFormatado}</td>
                            <td class="px-4 py-2 text-sm">${dataFormatada} ${item.time}</td>
                            <td class="px-4 py-2 text-sm">${item.description}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                return html;
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = 'notification bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4 mb-2 w-72';
                
                // Definir cor com base no tipo
                let iconClass, titleClass, borderClass;
                
                switch(type) {
                    case 'success':
                        iconClass = 'fas fa-check-circle text-green-500';
                        titleClass = 'text-green-600 dark:text-green-400';
                        borderClass = 'border-l-4 border-green-500';
                        break;
                    case 'error':
                        iconClass = 'fas fa-exclamation-circle text-red-500';
                        titleClass = 'text-red-600 dark:text-red-400';
                        borderClass = 'border-l-4 border-red-500';
                        break;
                    case 'warning':
                        iconClass = 'fas fa-exclamation-triangle text-yellow-500';
                        titleClass = 'text-yellow-600 dark:text-yellow-400';
                        borderClass = 'border-l-4 border-yellow-500';
                        break;
                    case 'info':
                    default:
                        iconClass = 'fas fa-info-circle text-blue-500';
                        titleClass = 'text-blue-600 dark:text-blue-400';
                        borderClass = 'border-l-4 border-blue-500';
                }
                
                // Adicionar classes
                notification.classList.add(borderClass);
                
                // Definir conteúdo
                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="${iconClass} text-xl mr-3"></i>
                        <div class="flex-1">
                            <h4 class="font-medium ${titleClass}">${title}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${message}</p>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 ml-3">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                // Adicionar ao container
                container.appendChild(notification);
                
                // Configurar botão de fechar
                const closeBtn = notification.querySelector('button');
                closeBtn.addEventListener('click', () => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateY(-20px)';
                    
                    setTimeout(() => {
                        container.removeChild(notification);
                    }, 300);
                });
                
                // Auto-remover após 5 segundos
                setTimeout(() => {
                    if (notification.parentNode === container) {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateY(-20px)';
                        
                        setTimeout(() => {
                            if (notification.parentNode === container) {
                                container.removeChild(notification);
                            }
                        }, 300);
                    }
                }, 5000);
            }
        };
        
        // Inicializar a aplicação quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            APP.init();
        });
    </script>
</body>
</html>
