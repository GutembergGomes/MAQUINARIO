<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG - Sistema de Gestão de Frota Safra 2025/26</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                    },
                }
            }
        }
    </script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #print-area, #print-area * {
                visibility: visible;
            }
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none !important;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .dark ::-webkit-scrollbar-track {
            background: #374151;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .dark ::-webkit-scrollbar-thumb {
            background: #4B5563;
        }
        
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #6B7280;
        }
        
        /* Table styling */
        .styled-table th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .loading-shimmer {
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.6) 50%, rgba(255,255,255,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        .dark .loading-shimmer {
            background: linear-gradient(90deg, rgba(55,65,81,0) 0%, rgba(55,65,81,0.6) 50%, rgba(55,65,81,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        /* Notification styling */
        .notification {
            transform: translateX(100%);
            animation: slide-in 0.5s forwards, fade-out 0.5s 4.5s forwards;
        }
        
        @keyframes slide-in {
            100% { transform: translateX(0); }
        }
        
        @keyframes fade-out {
            100% { opacity: 0; }
        }
        
        /* Active tab styling */
        .tab-btn.active {
            border-bottom: 2px solid #5D5CDE;
        }
        
        /* Card hover effects */
        .stat-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* Equipment status colors */
        .status-operational {
            color: #10B981;
        }
        
        .status-maintenance {
            color: #F59E0B;
        }
        
        .status-inoperational {
            color: #EF4444;
        }
        
        .status-other {
            color: #3B82F6;
        }
        
        /* Real equipment visualization */
        .equipment-card {
            position: relative;
            perspective: 1000px;
            transition: all 0.3s;
        }
        
        .equipment-card:hover {
            transform: translateY(-5px);
        }
        
        .equipment-card.operational {
            border-left: 4px solid #10B981;
        }
        
        .equipment-card.maintenance {
            border-left: 4px solid #F59E0B; 
        }
        
        .equipment-card.reform {
            border-left: 4px solid #EF4444;
        }
        
        .equipment-card.other {
            border-left: 4px solid #3B82F6;
        }
        
        /* Dashboard tabs display */
        .category-dashboard {
            display: none;
        }
        
        .category-dashboard.active {
            display: block;
        }

        /* PDF Report Area */
        #pdf-report-area {
            display: none;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            background-color: white;
            padding: 20px;
            z-index: 1000;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #pdf-report-area, #pdf-report-area * {
                visibility: visible;
            }
            #pdf-report-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .pdf-page-break {
                page-break-after: always;
            }
        }
        
        /* Chart no data message */
        .chart-no-data {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            font-size: 14px;
            color: #9CA3AF;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-200">
    <div id="loading-overlay" class="fixed inset-0 bg-white dark:bg-gray-900 z-50 flex flex-col items-center justify-center">
        <div class="w-24 h-24 border-t-4 border-b-4 border-primary rounded-full animate-spin mb-4"></div>
        <h2 class="text-2xl font-semibold text-primary">Carregando Sistema...</h2>
        <p class="text-gray-600 dark:text-gray-400 mt-2">GGOMES-LOG SAFRA 2025/26</p>
    </div>

    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-md py-4 px-4 sticky top-0 z-10">
            <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-3 md:mb-0">
                    <h1 class="text-2xl font-bold text-primary dark:text-primary">UsinaCambui SAFRA 2025/26</h1>
                </div>
                <div class="flex flex-wrap items-center gap-2">
                    <button id="add-equipment-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 bg-green-500 text-white" title="Adicionar equipamento">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button id="refresh-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary" title="Atualizar dados">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <div class="relative">
                        <button id="export-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary" title="Exportar dados">
                            <i class="fas fa-file-export"></i>
                        </button>
                        <div id="export-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-20">
                            <button id="export-csv" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-file-csv mr-2"></i> Exportar CSV
                            </button>
                            <button id="export-print" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-print mr-2"></i> Imprimir
                            </button>
                            <button id="export-pdf" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left">
                                <i class="fas fa-file-pdf mr-2"></i> Relatório PDF
                            </button>
                        </div>
                    </div>
                    <button id="dashboard-main-btn" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 text-primary flex items-center" title="Dashboard geral">
                        <i class="fas fa-chart-line mr-1"></i>
                        <span class="hidden sm:inline">Dashboard Geral</span>
                    </button>
                    <button id="real-equipment-btn" class="p-2 rounded-md bg-primary text-white hover:bg-primary hover:bg-opacity-90 flex items-center" title="Visualização real dos equipamentos">
                        <i class="fas fa-truck-monster mr-1"></i>
                        <span class="hidden sm:inline">Equipamentos Reais</span>
                    </button>
                    <span id="last-updated" class="text-gray-600 dark:text-gray-400 text-sm mr-2 hidden md:block"></span>
                    <button id="theme-toggle" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700" title="Alternar tema claro/escuro">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Breadcrumb Navigation -->
        <div class="bg-gray-100 dark:bg-gray-800 py-2 px-4 border-b border-gray-200 dark:border-gray-700">
            <div class="container mx-auto">
                <nav class="flex" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="#" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-primary dark:text-gray-400 dark:hover:text-white">
                                <i class="fas fa-home mr-2"></i>
                                Início
                            </a>
                        </li>
                        <li aria-current="page">
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-1"></i>
                                <span id="breadcrumb-current" class="ml-1 text-sm font-medium text-primary md:ml-2">Dashboard</span>
                            </div>
                        </li>
                    </ol>
                </nav>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-16 z-10">
            <div class="container mx-auto px-4">
                <div class="flex overflow-x-auto whitespace-nowrap py-3 scrollbar-hide" id="tabs">
                    <button class="tab-btn active px-4 py-2 font-medium rounded-md mr-2" data-target="reboques">
                        <i class="fas fa-trailer mr-1"></i>Reboques
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="caminhoes-proprios">
                        <i class="fas fa-truck mr-1"></i>Caminhões Próprios
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="caminhoes-terceiros">
                        <i class="fas fa-truck-moving mr-1"></i>Caminhões Terceiros
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md mr-2" data-target="frente-4001">
                        <i class="fas fa-tractor mr-1"></i>Frente 4001
                    </button>
                    <button class="tab-btn px-4 py-2 font-medium rounded-md" data-target="frente-4002">
                        <i class="fas fa-tractor mr-1"></i>Frente 4002
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <!-- Dashboards for each category -->
            <!-- Dashboard for Reboques -->
            <div id="dashboard-reboques" class="category-dashboard active mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Reboques</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-red-100 dark:bg-red-800 p-3 mr-4">
                                <i class="fas fa-tools text-red-500 dark:text-red-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Reforma</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-reform">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-reform-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-exchange-alt text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="reboques-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="reboques-vs-last-month">
                                        <i class="fas fa-arrow-up text-green-500"></i> 4%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1">
                            <h3 class="text-md font-medium mb-3">Status dos Reboques</h3>
                            <div class="h-64 relative">
                                <canvas id="reboques-status-chart"></canvas>
                                <div id="reboques-status-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de status disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1 md:col-span-2">
                            <h3 class="text-md font-medium mb-3">Tendência de Manutenção</h3>
                            <div class="h-64 relative">
                                <canvas id="reboques-maintenance-trend-chart"></canvas>
                                <div id="reboques-trend-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de tendência disponíveis para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Caminhões Próprios -->
            <div id="dashboard-caminhoes-proprios" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Caminhões Próprios</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-exchange-alt text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Emprestados</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-borrowed">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-borrowed-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Prazo Médio</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="cp-avg-time">0d</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="cp-vs-last-month">
                                        <i class="fas fa-arrow-down text-green-500"></i> 1d
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1">
                            <h3 class="text-md font-medium mb-3">Status dos Caminhões</h3>
                            <div class="h-64 relative">
                                <canvas id="cp-status-chart"></canvas>
                                <div id="cp-status-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de status disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 col-span-1 md:col-span-2">
                            <h3 class="text-md font-medium mb-3">Evolução de Status</h3>
                            <div class="h-64 relative">
                                <canvas id="cp-status-evolution-chart"></canvas>
                                <div id="cp-evolution-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de evolução disponíveis para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Caminhões Terceiros -->
            <div id="dashboard-caminhoes-terceiros" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard de Caminhões Terceiros</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Operacionais</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-operational">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="ct-operational-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="ct-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-blue-100 dark:bg-blue-800 p-3 mr-4">
                                <i class="fas fa-user-tie text-blue-500 dark:text-blue-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Proprietários</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-owners">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-truck-loading text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Reboques Acoplados</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="ct-coupled-trailers">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Proprietários - Quantidade</h3>
                            <div class="h-64 relative">
                                <canvas id="ct-owners-chart"></canvas>
                                <div id="ct-owners-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de proprietários disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status por Proprietário</h3>
                            <div class="h-64 relative">
                                <canvas id="ct-status-by-owner-chart"></canvas>
                                <div id="ct-status-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de status por proprietário disponíveis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Frente 4001 -->
            <div id="dashboard-frente-4001" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard da Frente 4001</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Colhedoras OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-colhedoras-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-colhedoras-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Trações OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-tracoes-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-tracoes-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Equip. em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4001-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4001-vs-target">
                                        <i class="fas fa-arrow-up text-green-500"></i> 2%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status dos Equipamentos</h3>
                            <div class="h-64 relative">
                                <canvas id="f4001-status-chart"></canvas>
                                <div id="f4001-status-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de status disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Motivos de Parada</h3>
                            <div class="h-64 relative">
                                <canvas id="f4001-breakdown-chart"></canvas>
                                <div id="f4001-breakdown-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de motivos de parada disponíveis para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard for Frente 4002 -->
            <div id="dashboard-frente-4002" class="category-dashboard mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold">Dashboard da Frente 4002</h2>
                    <button class="toggle-dashboard px-3 py-1.5 text-sm bg-gray-200 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 flex items-center gap-1">
                        <span class="show-text"><i class="fas fa-chart-bar mr-1"></i>Mostrar Dashboard</span>
                        <span class="hide-text hidden"><i class="fas fa-chevron-up mr-1"></i>Ocultar Dashboard</span>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Colhedoras OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-colhedoras-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-colhedoras-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-green-100 dark:bg-green-800 p-3 mr-4">
                                <i class="fas fa-check text-green-500 dark:text-green-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Trações OK</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-tracoes-ok">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-tracoes-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-yellow-100 dark:bg-yellow-800 p-3 mr-4">
                                <i class="fas fa-wrench text-yellow-500 dark:text-yellow-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Equip. em Manutenção</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-maintenance">0</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-maintenance-percentage">0%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 flex items-center stat-card">
                            <div class="rounded-full bg-purple-100 dark:bg-purple-800 p-3 mr-4">
                                <i class="fas fa-calendar-alt text-purple-500 dark:text-purple-200"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade</p>
                                <div class="flex items-end">
                                    <p class="text-xl font-bold" id="f4002-availability">0%</p>
                                    <p class="text-xs ml-2 text-gray-500 dark:text-gray-400" id="f4002-vs-target">
                                        <i class="fas fa-arrow-up text-green-500"></i> 5%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Status dos Equipamentos</h3>
                            <div class="h-64 relative">
                                <canvas id="f4002-status-chart"></canvas>
                                <div id="f4002-status-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de status disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h3 class="text-md font-medium mb-3">Motivos de Parada</h3>
                            <div class="h-64 relative">
                                <canvas id="f4002-breakdown-chart"></canvas>
                                <div id="f4002-breakdown-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de motivos de parada disponíveis para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4">
                <h2 id="section-title" class="text-xl font-semibold">Reboques</h2>
                <div class="flex flex-col sm:flex-row gap-2">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Pesquisar..." 
                            class="w-full sm:w-64 px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                            bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                    <select id="status-filter" class="px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                        bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="all">Todos os Status</option>
                        <option value="Operacional">Operacional</option>
                        <option value="Em manutenção">Em manutenção</option>
                        <option value="Em reforma">Em reforma</option>
                        <option value="Inoperante">Inoperante</option>
                        <option value="Aguardando reforma">Aguardando reforma</option>
                        <option value="Emprestado">Emprestado</option>
                        <option value="Na base">Na base</option>
                        <option value="Reserva">Reserva</option>
                    </select>
                    <div class="relative">
                        <button id="advanced-filter-btn" class="px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 
                            bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary">
                            <i class="fas fa-filter mr-1"></i> Filtros Avançados
                        </button>
                        <div id="advanced-filter-dropdown" class="hidden absolute right-0 mt-2 w-72 bg-white dark:bg-gray-800 rounded-md shadow-lg p-4 z-20">
                            <h4 class="font-medium text-gray-800 dark:text-gray-200 mb-2">Filtros Avançados</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                    <div class="flex space-x-2">
                                        <input type="date" id="date-filter-start" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                        <input type="date" id="date-filter-end" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Motivo Contém</label>
                                    <input type="text" id="motivo-filter" class="w-full p-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                </div>
                                <div class="flex justify-end mt-4">
                                    <button id="apply-advanced-filters" class="px-3 py-1.5 text-sm bg-primary text-white rounded-md">Aplicar Filtros</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Content -->
            <div class="tab-content active" id="reboques">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="frota">
                                    FROTA <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="tipo">
                                    TIPO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="acoplado">
                                    ACOPLADO COM <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="tipoAcoplado">
                                    TIPO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="reboques-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="7" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="showing-start">0</span> - <span id="showing-end">0</span> de <span id="total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="caminhoes-proprios">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="caminhao">
                                    CAMINHÃO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                    DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="caminhoes-proprios-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="cp-showing-start">0</span> - <span id="cp-showing-end">0</span> de <span id="cp-total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="cp-prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="cp-pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="cp-next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="caminhoes-terceiros">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                        <thead>
                            <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="caminhao">
                                    CAMINHÃO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="reboques">
                                    REBOQUES <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="proprietario">
                                    PROPRIETÁRIO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                    MOTIVO <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                    STATUS <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    AÇÕES
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="caminhoes-terceiros-table">
                            <!-- Conteúdo da tabela será inserido via JavaScript -->
                            <tr>
                                <td colspan="6" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                        <p>Carregando dados...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Paginação -->
                <div class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Mostrando <span id="ct-showing-start">0</span> - <span id="ct-showing-end">0</span> de <span id="ct-total-items">0</span> itens
                    </div>
                    <div class="flex space-x-1">
                        <button id="ct-prev-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div id="ct-pagination-numbers" class="flex space-x-1">
                            <!-- Números de página inseridos via JavaScript -->
                        </div>
                        <button id="ct-next-page" class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="frente-4001">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6">
                    <h3 class="text-lg font-medium mb-4">Colhedoras</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4001-colhedoras-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                    <h3 class="text-lg font-medium mb-4">Trações Transbordo</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4001-tracoes-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="frente-4002">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6">
                    <h3 class="text-lg font-medium mb-4">Colhedoras</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4002-colhedoras-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                    <h3 class="text-lg font-medium mb-4">Trações Transbordo</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 styled-table">
                            <thead>
                                <tr class="bg-gray-50 dark:bg-gray-700 text-left">
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="codigo">
                                        CÓDIGO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="motivo">
                                        MOTIVO <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="data">
                                        DATA DE PARADA <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer sortable" data-key="status">
                                        STATUS <i class="fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-4 py-3 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                        AÇÕES
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="frente-4002-tracoes-table">
                                <!-- Conteúdo da tabela será inserido via JavaScript -->
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                            <p>Carregando dados...</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Área de impressão -->
            <div id="print-area" class="hidden">
                <div class="px-6 py-4">
                    <h1 class="text-2xl font-bold mb-4">UsinaCambui SAFRA 2025/26 - Relatório</h1>
                    <div class="mb-4">
                        <h2 id="print-title" class="text-xl font-semibold"></h2>
                        <p id="print-date" class="text-sm text-gray-600"></p>
                    </div>
                    <div id="print-content"></div>
                </div>
            </div>

            <!-- Área de relatório em PDF -->
            <div id="pdf-report-area" class="hidden">
                <div class="px-6 py-4">
                    <h1 class="text-2xl font-bold mb-4">UsinaCambui SAFRA 2025/26 - Relatório Completo</h1>
                    <div class="mb-4">
                        <h2 id="pdf-report-title" class="text-xl font-semibold"></h2>
                        <p id="pdf-report-date" class="text-sm text-gray-600"></p>
                    </div>
                    <div id="pdf-report-content"></div>
                </div>
            </div>
        </main>

        <!-- Modal de detalhes do equipamento -->
        <div id="equipment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold" id="modal-title">Detalhes do Equipamento</h3>
                        <button id="close-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div id="modal-content" class="space-y-4">
                        <!-- Conteúdo do modal será preenchido dinamicamente -->
                    </div>
                    <div class="mt-6 flex justify-between">
                        <div>
                            <button id="history-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all mr-2">
                                <i class="fas fa-history mr-1"></i> Histórico
                            </button>
                            <button id="schedule-btn" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-all">
                                <i class="fas fa-calendar mr-1"></i> Agendar
                            </button>
                        </div>
                        <div class="flex space-x-2">
                            <button id="edit-equipment-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-all">
                                <i class="fas fa-edit mr-1"></i> Editar
                            </button>
                            <button id="print-details-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                <i class="fas fa-print mr-1"></i> Imprimir
                            </button>
                            <button id="close-modal-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 transition-all">
                                Fechar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de edição de equipamento -->
        <div id="edit-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold" id="edit-modal-title">Editar Equipamento</h3>
                        <button id="close-edit-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="edit-equipment-form" class="space-y-4">
                        <div id="edit-form-fields">
                            <!-- Campos do formulário serão preenchidos dinamicamente -->
                        </div>
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-edit-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-edit-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-save mr-1"></i> Salvar Alterações
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Modal para adicionar novo equipamento -->
        <div id="add-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Adicionar Novo Equipamento</h3>
                        <button id="close-add-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="add-equipment-form" class="space-y-4">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                            <select id="equipment-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <option value="reboque">Reboque</option>
                                <option value="caminhao-proprio">Caminhão Próprio</option>
                                <option value="caminhao-terceiro">Caminhão Terceiro</option>
                                <option value="colhedora-4001">Colhedora Frente 4001</option>
                                <option value="tracao-4001">Tração Frente 4001</option>
                                <option value="colhedora-4002">Colhedora Frente 4002</option>
                                <option value="tracao-4002">Tração Frente 4002</option>
                            </select>
                        </div>
                        <div id="add-form-fields" class="space-y-4">
                            <!-- Campos gerados dinamicamente com base no tipo de equipamento -->
                        </div>
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-add-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-add-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-plus mr-1"></i> Adicionar Equipamento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Modal de histórico -->
        <div id="history-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Histórico do Equipamento</h3>
                        <button id="close-history-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div id="history-content" class="mt-4">
                        <div class="flex items-center mb-4">
                            <div class="w-16 h-16 flex items-center justify-center rounded-full bg-primary text-white text-2xl mr-4">
                                <i id="history-icon" class="fas fa-truck"></i>
                            </div>
                            <div>
                                <h4 id="history-title" class="text-lg font-medium">Caminhão #0000</h4>
                                <p id="history-subtitle" class="text-sm text-gray-600 dark:text-gray-400">Total de registros: 0</p>
                            </div>
                        </div>
                        
                        <div class="relative pl-8 mt-8">
                            <div class="absolute left-0 top-0 bottom-0 w-0.5 bg-gray-300 dark:bg-gray-600"></div>
                            <div id="history-timeline">
                                <!-- Timeline items will be added here via JavaScript -->
                                <div class="flex flex-col items-start mb-6 ml-6 relative">
                                    <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-primary"></div>
                                    <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                        <div class="flex justify-between items-start">
                                            <p class="text-sm font-medium">Carregando histórico...</p>
                                            <span class="text-xs text-gray-500 dark:text-gray-400"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button id="close-history-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 transition-all">
                            Fechar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de agendamento -->
        <div id="schedule-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Agendar Manutenção</h3>
                        <button id="close-schedule-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <form id="schedule-form" class="space-y-4">
                        <div id="schedule-equipment-info" class="bg-gray-100 dark:bg-gray-700 p-3 rounded-md mb-4">
                            <!-- Informações do equipamento -->
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                    Data Agendada
                                </label>
                                <input type="date" id="schedule-date" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required placeholder="Selecione uma data">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                    Hora
                                </label>
                                <input type="time" id="schedule-time" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Tipo de Manutenção
                            </label>
                            <select id="schedule-type" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="">Selecione o tipo</option>
                                <option value="preventive">Preventiva</option>
                                <option value="corrective">Corretiva</option>
                                <option value="emergency">Emergencial</option>
                                <option value="revision">Revisão</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Descrição/Motivo
                            </label>
                            <textarea id="schedule-description" rows="3" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Responsável
                            </label>
                            <input type="text" id="schedule-responsible" class="w-full px-4 py-2 text-base rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                        </div>
                        
                        <div class="mt-6 flex justify-end space-x-2">
                            <button type="button" id="cancel-schedule-btn" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-all">
                                Cancelar
                            </button>
                            <button type="submit" id="save-schedule-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-all">
                                <i class="fas fa-calendar-check mr-1"></i> Confirmar Agendamento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Dashboard detalhado modal -->
        <div id="dashboard-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Dashboard Detalhado de Frota</h3>
                        <button id="close-dashboard-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                        <div class="text-lg font-medium">Visão Geral da Frota</div>
                        <div class="mt-2 md:mt-0 flex items-center gap-2">
                            <select id="dashboard-date-range" class="px-3 py-1.5 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <option value="all">Todos os dados</option>
                                <option value="today">Hoje</option>
                                <option value="week">Últimos 7 dias</option>
                                <option value="month">Último mês</option>
                                <option value="quarter">Último trimestre</option>
                                <option value="year">Último ano</option>
                            </select>
                            <button id="print-dashboard-btn" class="px-3 py-1.5 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <i class="fas fa-print mr-1"></i> Imprimir
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-green-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Disponibilidade de Frota</p>
                                <p class="text-2xl font-bold" id="dash-availability">0%</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-availability-trend" class="text-green-500">
                                        <i class="fas fa-arrow-up mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-yellow-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Tempo Médio de Manutenção</p>
                                <p class="text-2xl font-bold" id="dash-avg-maintenance">0h</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-maintenance-trend" class="text-red-500">
                                        <i class="fas fa-arrow-up mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-blue-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Total de Equipamentos</p>
                                <p class="text-2xl font-bold" id="dash-total-equipment">0</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-equipment-trend" class="text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-minus mr-1"></i>0
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 border-l-4 border-red-500">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Equipamentos Críticos</p>
                                <p class="text-2xl font-bold" id="dash-critical-equipment">0</p>
                                <div class="flex items-center mt-1 text-xs">
                                    <span id="dash-critical-trend" class="text-green-500">
                                        <i class="fas fa-arrow-down mr-1"></i>0%
                                    </span>
                                    <span class="text-gray-500 dark:text-gray-400 ml-1">vs. período anterior</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Disponibilidade por Categoria</h4>
                            <div class="h-64 relative">
                                <canvas id="availability-chart"></canvas>
                                <div id="availability-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de disponibilidade para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Motivos de Manutenção</h4>
                            <div class="h-64 relative">
                                <canvas id="maintenance-reasons-chart"></canvas>
                                <div id="maintenance-reasons-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de motivos de manutenção para o período selecionado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4 mb-6">
                        <h4 class="text-md font-medium mb-3">Tendências de Status por Semana</h4>
                        <div class="h-64 relative">
                            <canvas id="status-trends-chart"></canvas>
                            <div id="status-trends-no-data" class="chart-no-data hidden">
                                <p>Sem dados de tendências de status para o período selecionado</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Top 5 Equipamentos em Manutenção</h4>
                            <ul id="top-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-600">
                                <!-- Lista preenchida via JavaScript -->
                                <li class="py-2 flex justify-between">
                                    <span class="text-sm loading-shimmer">Carregando dados...</span>
                                    <span class="text-sm text-yellow-500"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Propriedade dos Equipamentos</h4>
                            <div class="h-40 relative">
                                <canvas id="ownership-chart"></canvas>
                                <div id="ownership-no-data" class="chart-no-data hidden">
                                    <p>Sem dados de propriedade disponíveis</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow p-4">
                            <h4 class="text-md font-medium mb-3">Manutenções Agendadas Próximas</h4>
                            <ul id="upcoming-maintenance-list" class="divide-y divide-gray-200 dark:divide-gray-600">
                                <!-- Lista preenchida via JavaScript -->
                                <li class="py-2 flex justify-between">
                                    <span class="text-sm loading-shimmer">Carregando dados...</span>
                                    <span class="text-sm text-blue-500"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de Visualização Real dos Equipamentos -->
        <div id="real-equipment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Visualização Real dos Equipamentos</h3>
                        <button id="close-real-equipment-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4 flex flex-wrap gap-2">
                        <button class="real-equipment-filter active px-3 py-1.5 rounded-md bg-primary text-white" data-filter="all">Todos</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="reboques">Reboques</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="caminhoes-proprios">Caminhões Próprios</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="caminhoes-terceiros">Caminhões Terceiros</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="frente-4001">Frente 4001</button>
                        <button class="real-equipment-filter px-3 py-1.5 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200" data-filter="frente-4002">Frente 4002</button>
                    </div>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="real-equipment-grid">
                        <!-- Equipment cards will be added here via JavaScript -->
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card loading-shimmer">
                            <div class="h-24 w-full mb-2 rounded bg-gray-200 dark:bg-gray-600"></div>
                            <div class="h-4 w-3/4 rounded bg-gray-200 dark:bg-gray-600 mb-2"></div>
                            <div class="h-4 w-1/2 rounded bg-gray-200 dark:bg-gray-600"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Sistema de notificações -->
        <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

        <!-- Footer -->
        <footer class="bg-white dark:bg-gray-800 py-4 border-t border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 text-center">
                <p class="text-sm text-gray-600 dark:text-gray-400">
                    GGOMES-LOG SAFRA 2025/26 - Usina Cambuí Sistema de Gestão de Frota - v3.5
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Configurações
        const APP = {
            // Armazenamento dos dados
            data: {
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                currentSort: {
                    key: null,
                    order: 'asc'
                },
                filters: {
                    search: '',
                    status: 'all',
                    dateStart: '',
                    dateEnd: '',
                    motivo: ''
                },
                pagination: {
                    itemsPerPage: 10,
                    currentPage: 1
                },
                charts: {
                    // Gráficos gerais
                    statusChart: null,
                    categoryChart: null,
                    trendChart: null,
                    availabilityChart: null,
                    maintenanceReasonsChart: null,
                    statusTrendsChart: null,
                    ownershipChart: null,
                    
                    // Gráficos específicos por categoria
                    reboquesStatusChart: null,
                    reboquesMaintenanceTrendChart: null,
                    cpStatusChart: null,
                    cpStatusEvolutionChart: null,
                    ctOwnersChart: null,
                    ctStatusByOwnerChart: null,
                    f4001StatusChart: null,
                    f4001BreakdownChart: null,
                    f4002StatusChart: null,
                    f4002BreakdownChart: null
                },
                history: {
                    // Histórico simulado para alguns equipamentos
                    '6186': [
                        { date: '2025-04-10', status: 'Em manutenção', description: 'Entrada para manutenção preventiva', user: 'João Silva' },
                        { date: '2025-04-15', status: 'Em manutenção', description: 'Detectado problema na travessa do assoalho', user: 'Carlos Ferreira' },
                        { date: '2025-05-01', status: 'Em manutenção', description: 'Aguardando peças para reparo', user: 'Maria Oliveira' },
                        { date: '2025-05-05', status: 'Em manutenção', description: 'Troca da travessa do assoalho em andamento', user: 'Pedro Souza' }
                    ],
                    '6699': [
                        { date: '2025-04-28', status: 'Operacional', description: 'Problema no ar condicionado reportado', user: 'José Santos' },
                        { date: '2025-05-01', status: 'Em manutenção', description: 'Verificação do sistema de ar condicionado', user: 'Ricardo Lima' },
                        { date: '2025-05-02', status: 'Em manutenção', description: 'Substituição do compressor de ar', user: 'Ricardo Lima' }
                    ],
                    '6146': [
                        { date: '2025-02-15', status: 'Operacional', description: 'Verificação de irregularidades', user: 'André Moraes' },
                        { date: '2025-02-28', status: 'Em manutenção', description: 'Avaliação para reforma completa', user: 'Fernando Castro' },
                        { date: '2025-03-01', status: 'Em reforma', description: 'Início de reforma geral', user: 'Marcos Pereira' },
                        { date: '2025-03-15', status: 'Em reforma', description: 'Substituição de componentes principais', user: 'Antônio Rodrigues' },
                        { date: '2025-04-10', status: 'Em reforma', description: 'Reforma do sistema hidráulico', user: 'Lucas Mendes' },
                        { date: '2025-04-25', status: 'Em reforma', description: 'Testes preliminares', user: 'Marcos Pereira' }
                    ]
                },
                schedules: [
                    { equipment: '6181', equipmentType: 'Reboque', date: '2025-05-15', time: '08:00', type: 'preventive', description: 'Manutenção preventiva programada', responsible: 'Paulo Costa' },
                    { equipment: '6138', equipmentType: 'Caminhão Próprio', date: '2025-05-20', time: '14:30', type: 'revision', description: 'Revisão geral após operação', responsible: 'Carlos Magno' },
                    { equipment: '490998', equipmentType: 'Caminhão Terceiro', date: '2025-05-18', time: '09:00', type: 'corrective', description: 'Correção de problema no sistema de freios', responsible: 'Ricardo Almeida' },
                    { equipment: '6988', equipmentType: 'Colhedora Frente 4001', date: '2025-05-25', time: '07:00', type: 'preventive', description: 'Lubrificação e verificação geral', responsible: 'Fernando Dias' }
                ],
                dashboardPeriod: 'all',
                editingItem: null,
                editingType: null,
                activeTab: 'reboques',
                isDragging: false,
                dashboardContentVisible: {} // Para controlar visibilidade dos dashboards
            },
            
            // Inicialização
            init() {
                // Aplicar tema
                this.setupTheme();
                
                // Exibir splash screen
                this.showSplashScreen();
                
                // Carregar dados
                this.loadData();
                
                // Configurar eventos da UI
                this.setupEventListeners();
                
                // Atualizar horário
                this.updateLastUpdated();
                
                // Inicializar estados dos dashboards (mostrar por padrão)
                this.setupDashboardVisibility();
            },
            
            // Configurar visibilidade inicial dos dashboards
            setupDashboardVisibility() {
                document.querySelectorAll('.category-dashboard').forEach(dashboard => {
                    const id = dashboard.id;
                    // Inicialmente mostrar dashboards
                    this.data.dashboardContentVisible[id] = true;
                    
                    // Encontrar botões de toggle
                    const toggleBtn = dashboard.querySelector('.toggle-dashboard');
                    if (toggleBtn) {
                        toggleBtn.querySelector('.show-text').classList.add('hidden');
                        toggleBtn.querySelector('.hide-text').classList.remove('hidden');
                    }
                    
                    // Mostrar conteúdo
                    const content = dashboard.querySelector('.dashboard-content');
                    if (content) {
                        content.style.display = 'block';
                    }
                });
            },
            
            // Exibir splash screen
            showSplashScreen() {
                const loadingOverlay = document.getElementById('loading-overlay');
                
                // Ocultar a splash screen após 1.5 segundos
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    loadingOverlay.style.transition = 'opacity 0.5s';
                    
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                }, 1500);
            },
            
            // Configurar tema
            setupTheme() {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
                
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    if (event.matches) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                    // Atualizar gráficos para o novo tema
                    this.updateAllCharts();
                });
                
                document.getElementById('theme-toggle').addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    // Atualizar gráficos para o novo tema
                    this.updateAllCharts();
                });
            },
            
            // Carregar dados
            loadData() {
                // Simulação de carregamento para demonstrar loading state
                setTimeout(() => {
                    this.data.reboques = [
                        { frota: '4373', tipo: 'SEMI REBOQUE', acoplado: '6239', tipoAcoplado: 'REBOQUE', motivo: 'Problema na sapata', status: 'Em manutenção', dataParada: '2025-05-02' },
                        { frota: '6181', tipo: 'SEMI REBOQUE', acoplado: '6222', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6184', tipo: 'SEMI REBOQUE', acoplado: '6190', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6185', tipo: 'SEMI REBOQUE', acoplado: '6188', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6186', tipo: 'SEMI REBOQUE', acoplado: '6201', tipoAcoplado: 'REBOQUE', motivo: 'Trocar travessa assoalho', status: 'Em manutenção', dataParada: '2025-04-10' },
                        { frota: '6187', tipo: 'SEMI REBOQUE', acoplado: '6224', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6195', tipo: 'SEMI REBOQUE', acoplado: '6214', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6196', tipo: 'SEMI REBOQUE', acoplado: '9542', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6197', tipo: 'SEMI REBOQUE', acoplado: '6183', tipoAcoplado: 'REBOQUE', motivo: 'preventiva', status: 'Em manutenção', dataParada: '2025-04-28' },
                        { frota: '6198', tipo: 'SEMI REBOQUE', acoplado: '6193', tipoAcoplado: 'REBOQUE', motivo: 'Preventiva', status: 'Em manutenção', dataParada: '2025-04-30' },
                        { frota: '6199', tipo: 'SEMI REBOQUE', acoplado: '9546', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6202', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: '', motivo: 'Travessa da mesa da quinta roda quebrada', status: 'Em manutenção', dataParada: '2025-04-15' },
                        { frota: '6218', tipo: 'SEMI REBOQUE', acoplado: '4377', tipoAcoplado: 'REBOQUE', motivo: 'Revisar cubo de roda e regular freios (Travessa quebrada)', status: 'Em manutenção', dataParada: '2025-04-18' },
                        { frota: '6221', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: '', motivo: 'Reforma', status: 'Em reforma', dataParada: '2025-03-15' },
                        { frota: '6241', tipo: 'SEMI REBOQUE', acoplado: '6209', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '9492', tipo: 'SEMI REBOQUE', acoplado: '6210', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '9501', tipo: 'SEMI REBOQUE', acoplado: '6225', tipoAcoplado: 'REBOQUE', motivo: 'Mola arriada e regular freios', status: 'Em manutenção', dataParada: '2025-04-25' },
                        { frota: '6194', tipo: 'SEMI REBOQUE', acoplado: '6242', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '', tipo: '', acoplado: '6182', tipoAcoplado: 'REBOQUE', motivo: 'Aguardando Reforma', status: 'Aguardando reforma', dataParada: '2025-03-10' },
                        { frota: '', tipo: '', acoplado: '6191', tipoAcoplado: 'REBOQUE', motivo: 'Reforma', status: 'Em reforma', dataParada: '2025-02-25' },
                        { frota: '4631', tipo: 'SEMI REBOQUE', acoplado: '6401', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '4632', tipo: 'SEMI REBOQUE', acoplado: '6434', tipoAcoplado: 'REBOQUE', motivo: 'serviço de solda', status: 'Em manutenção', dataParada: '2025-04-29' },
                        { frota: '4648', tipo: 'SEMI REBOQUE', acoplado: '6426', tipoAcoplado: 'REBOQUE', motivo: 'Problema na sapata', status: 'Em manutenção', dataParada: '2025-05-03' },
                        { frota: '4653', tipo: 'SEMI REBOQUE', acoplado: '4619', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6388', tipo: 'SEMI REBOQUE', acoplado: '6397', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                        { frota: '6390', tipo: 'SEMI REBOQUE', acoplado: '6430', tipoAcoplado: 'REBOQUE', motivo: '', status: 'Operacional', dataParada: '' },
                    ];

                    this.data.caminhoesProps = [
                        { caminhao: '4786', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6138', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6679', motivo: 'Aguardando Peça (Parafusos do Câmbio)', data: '2025-05-01', status: 'Em manutenção' },
                        { caminhao: '6680', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6682', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6697', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6698', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6699', motivo: 'ar condicionado', data: '2025-05-02', status: 'Em manutenção' },
                        { caminhao: '6700', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6960', motivo: 'Emprestimo Vinhaça', data: '2025-04-20', status: 'Emprestado' },
                        { caminhao: '6961', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6962', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6963', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6964', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6965', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '4787', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6134', motivo: 'Emprestimo transporte de veneno', data: '2025-04-15', status: 'Emprestado' },
                        { caminhao: '6143', motivo: 'Escada e suporte eletrico da sapata', data: '2025-05-03', status: 'Em manutenção' },
                        { caminhao: '6416', motivo: 'apoio prancha', data: '2025-04-10', status: 'Emprestado' },
                        { caminhao: '6137', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6145', motivo: '', data: '', status: 'Operacional' },
                        { caminhao: '6146', motivo: 'Reforma', data: '2025-03-01', status: 'Em reforma' },
                    ];

                    this.data.caminhoesTerc = [
                        { caminhao: '490996', reboques: '491005-491002', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490997', reboques: '491008-491003-491009', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490998', reboques: '491004-491001-491006', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490999', reboques: '491007-491000', proprietario: 'EDINILSON DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490988', reboques: '', proprietario: 'RICARDO VICTOR', motivo: 'ok', status: 'Operacional' },
                        { caminhao: '490989', reboques: '4900990 - 490994', proprietario: 'RICARDO VICTOR', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490987', reboques: '', proprietario: 'RICARDO VICTOR', motivo: 'Problema no diferencial', status: 'Em manutenção' },
                        { caminhao: '491035', reboques: '491042-491040', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491036', reboques: '491041-491039', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491037', reboques: '491043-491038', proprietario: 'ARNILDO TRANSP.', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491011', reboques: '491013 - 491015', proprietario: 'EDSON FERNANDES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491012', reboques: '491016 - 491014', proprietario: 'EDSON FERNANDES', motivo: '', status: 'Operacional' },
                        { caminhao: '491020', reboques: '', proprietario: 'J D DOS SANTOS', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491025', reboques: '491031 - 491032', proprietario: 'G M GONÇALVES', motivo: 'eixo quebrado', status: 'Em manutenção' },
                        { caminhao: '491026', reboques: '491029 - 491030', proprietario: 'G M GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '491046', reboques: '491047-491048', proprietario: 'HDS TRANSPORTES', motivo: '', status: 'Operacional' },
                        { caminhao: '490948', reboques: '490958-490959-490960', proprietario: 'EDUARDO GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '50022', reboques: '490933-490934', proprietario: 'SILVA GONÇALVES', motivo: 'OK', status: 'Operacional' },
                        { caminhao: '490272', reboques: '50025-50027', proprietario: 'SILVA GONÇALVES', motivo: 'VAZAMENTO DO RETENTOR DO CUBO E MOLAS', status: 'Em manutenção' },
                        { caminhao: '390085', reboques: '390231-390241', proprietario: 'VC Transporte', motivo: 'Não esta engatando', status: 'Em manutenção' },
                        { caminhao: '390119', reboques: '39772-39775', proprietario: 'VC Transporte', motivo: 'Quebrou ponta de eixo', status: 'Em manutenção' },
                        { caminhao: '491057', reboques: '', proprietario: 'TT Transporte', motivo: 'ok', status: 'Operacional' },
                    ];

                    this.data.frente4001Colhedoras = [
                        { codigo: '6988', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6989', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6721', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6602', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6702', motivo: 'falta operador', data: '2025-05-05', status: 'Inoperante' },
                    ];

                    this.data.frente4001Tracoes = [
                        { codigo: '6966-6726', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6967-70032', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6968-8164', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6969-6516', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6611-562/5427', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6612', motivo: 'Agregados motor, radiador, acoplar', data: '2025-04-22', status: 'Em manutenção' },
                        { codigo: '6525-6517', motivo: 'Revisão preventiva', data: '2025-05-01', status: 'Em manutenção' },
                        { codigo: '6526-3294/8058', motivo: 'avaliação no cambio', data: '2025-04-25', status: 'Em manutenção' },
                        { codigo: '6528-6515', motivo: '', data: '', status: 'Operacional' },
                    ];

                    this.data.frente4002Colhedoras = [
                        { codigo: '6990', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6722', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6703', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6704', motivo: 'Base', data: '2025-05-01', status: 'Na base' },
                        { codigo: '5911', motivo: 'reserva', data: '', status: 'Reserva' },
                    ];

                    this.data.frente4002Tracoes = [
                        { codigo: '6615-3293/8057', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6616-6512', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6617', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6459-6678', motivo: 'Quebrou cardan da tração', data: '2025-05-03', status: 'Em manutenção' },
                        { codigo: '6527-5414/3135', motivo: 'finalizado serviço pra depois seguir pro campo.', data: '2025-04-22', status: 'Em manutenção' },
                        { codigo: '6522-6514', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6668', motivo: 'diferencial (na base)', data: '2025-04-10', status: 'Em manutenção' },
                        { codigo: '6669-6513', motivo: '', data: '', status: 'Operacional' },
                        { codigo: '6670', motivo: '', data: '', status: 'Operacional' },
                    ];

                    // Renderizar as tabelas
                    this.renderAllTables();
                    
                    // Atualizar paginação
                    this.updatePagination();
                    
                    // Iniciar os gráficos
                    this.initializeCharts();
                    
                    // Atualizar contadores para todos os dashboards
                    this.updateAllDashboards();
                    
                    // Atualizar informações do dashboard detalhado
                    this.updateDashboardDetails();
                    
                    // Inicializar visualização real dos equipamentos
                    this.initializeRealEquipmentView();

                    // Mostrar mensagem de boas-vindas
                    this.showNotification('success', 'Sistema carregado', 'Bem-vindo ao Sistema de Gestão de Frota da GGOMES-LOG  SAFRA 2025/26!');
                }, 800);
            },
            
            // Configurar event listeners
            setupEventListeners() {
                // Abas de navegação
                document.querySelectorAll('.tab-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        // Atualizar botão ativo
                        document.querySelectorAll('.tab-btn').forEach(btn => {
                            btn.classList.remove('active', 'bg-primary', 'text-white');
                        });
                        button.classList.add('active', 'bg-primary', 'text-white');
                        
                        // Atualizar conteúdo visível
                        const targetId = button.getAttribute('data-target');
                        document.querySelectorAll('.tab-content').forEach(content => {
                            content.classList.add('hidden');
                            content.classList.remove('active');
                        });
                        document.getElementById(targetId).classList.remove('hidden');
                        document.getElementById(targetId).classList.add('active');
                        
                        // Atualizar dashboards visíveis
                        document.querySelectorAll('.category-dashboard').forEach(dashboard => {
                            dashboard.classList.add('hidden');
                            dashboard.classList.remove('active');
                        });
                        document.getElementById(`dashboard-${targetId}`).classList.remove('hidden');
                        document.getElementById(`dashboard-${targetId}`).classList.add('active');
                        
                        // Atualizar título da seção
                        const title = button.textContent.trim();
                        document.getElementById('section-title').textContent = title;
                        document.getElementById('breadcrumb-current').textContent = title;
                        
                        // Atualizar abas ativas
                        this.data.activeTab = targetId;
                        
                        // Limpar a busca ao mudar de aba
                        document.getElementById('search-input').value = '';
                        document.getElementById('status-filter').value = 'all';
                        this.data.filters.search = '';
                        this.data.filters.status = 'all';
                        this.data.filters.motivo = '';
                        this.data.filters.dateStart = '';
                        this.data.filters.dateEnd = '';
                        
                        // Resetar paginação
                        this.data.pagination.currentPage = 1;
                        
                        // Re-renderizar tabela ativa
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                });
                
                // Botões de toggle do dashboard
                document.querySelectorAll('.toggle-dashboard').forEach(button => {
                    button.addEventListener('click', () => {
                        const dashboard = button.closest('.category-dashboard');
                        const id = dashboard.id;
                        const content = dashboard.querySelector('.dashboard-content');
                        const showText = button.querySelector('.show-text');
                        const hideText = button.querySelector('.hide-text');
                        
                        if (this.data.dashboardContentVisible[id]) {
                            // Ocultar dashboard
                            content.style.display = 'none';
                            showText.classList.remove('hidden');
                            hideText.classList.add('hidden');
                            this.data.dashboardContentVisible[id] = false;
                        } else {
                            // Mostrar dashboard
                            content.style.display = 'block';
                            showText.classList.add('hidden');
                            hideText.classList.remove('hidden');
                            this.data.dashboardContentVisible[id] = true;
                            
                            // Atualizar gráficos se necessário
                            this.updateAllCharts();
                        }
                    });
                });
                
                // Pesquisa
                document.getElementById('search-input').addEventListener('input', (e) => {
                    this.data.filters.search = e.target.value.toLowerCase();
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                });
                
                // Filtro de status
                document.getElementById('status-filter').addEventListener('change', (e) => {
                    this.data.filters.status = e.target.value;
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                });
                
                // Botão de filtros avançados
                document.getElementById('advanced-filter-btn').addEventListener('click', () => {
                    const dropdown = document.getElementById('advanced-filter-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Aplicar filtros avançados
                document.getElementById('apply-advanced-filters').addEventListener('click', () => {
                    const dateStart = document.getElementById('date-filter-start').value;
                    const dateEnd = document.getElementById('date-filter-end').value;
                    const motivo = document.getElementById('motivo-filter').value.toLowerCase();
                    
                    this.data.filters.dateStart = dateStart;
                    this.data.filters.dateEnd = dateEnd;
                    this.data.filters.motivo = motivo;
                    
                    this.data.pagination.currentPage = 1;
                    this.renderActiveTable();
                    this.updatePagination();
                    
                    // Esconder o dropdown
                    document.getElementById('advanced-filter-dropdown').classList.add('hidden');
                    
                    // Mostrar notificação
                    if (dateStart || dateEnd || motivo) {
                        this.showNotification('info', 'Filtros aplicados', 'Os filtros avançados foram aplicados aos dados.');
                    } else {
                        this.showNotification('info', 'Filtros limpos', 'Os filtros avançados foram limpos.');
                    }
                });
                
                // Ordenação de tabelas
                document.querySelectorAll('.sortable').forEach(header => {
                    header.addEventListener('click', () => {
                        const key = header.getAttribute('data-key');
                        
                        // Alternar ordem se clicar na mesma coluna
                        if (this.data.currentSort.key === key) {
                            this.data.currentSort.order = this.data.currentSort.order === 'asc' ? 'desc' : 'asc';
                        } else {
                            this.data.currentSort.key = key;
                            this.data.currentSort.order = 'asc';
                        }
                        
                        // Atualizar ícones de ordenação
                        document.querySelectorAll('.sortable i').forEach(icon => {
                            icon.className = 'fas fa-sort ml-1';
                        });
                        
                        const sortIcon = header.querySelector('i');
                        if (this.data.currentSort.order === 'asc') {
                            sortIcon.className = 'fas fa-sort-up ml-1';
                        } else {
                            sortIcon.className = 'fas fa-sort-down ml-1';
                        }
                        
                        // Re-renderizar tabela com a nova ordenação
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                });
                
                // Paginação
                document.getElementById('prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderActiveTable();
                        this.updatePagination();
                    }
                });
                
                document.getElementById('next-page').addEventListener('click', () => {
                    const activeTab = document.querySelector('.tab-content.active');
                    const id = activeTab.id;
                    let totalPages = 1;
                    
                    // Calcular total de páginas com base nos dados filtrados
                    const filteredData = this.getFilteredDataForActiveTab();
                    totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderActiveTable();
                        this.updatePagination();
                    }
                });
                
                // Paginação para caminhões próprios
                document.getElementById('cp-prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    }
                });
                
                document.getElementById('cp-next-page').addEventListener('click', () => {
                    const filteredData = this.filterData(this.data.caminhoesProps);
                    const totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    }
                });
                
                // Paginação para caminhões terceiros
                document.getElementById('ct-prev-page').addEventListener('click', () => {
                    if (this.data.pagination.currentPage > 1) {
                        this.data.pagination.currentPage--;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    }
                });
                
                document.getElementById('ct-next-page').addEventListener('click', () => {
                    const filteredData = this.filterData(this.data.caminhoesTerc);
                    const totalPages = Math.ceil(filteredData.length / this.data.pagination.itemsPerPage);
                    
                    if (this.data.pagination.currentPage < totalPages) {
                        this.data.pagination.currentPage++;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    }
                });
                
                // Fechar modal de detalhes
                document.getElementById('close-modal').addEventListener('click', () => {
                    document.getElementById('equipment-modal').classList.add('hidden');
                });
                
                document.getElementById('close-modal-btn').addEventListener('click', () => {
                    document.getElementById('equipment-modal').classList.add('hidden');
                });
                
                // Imprimir detalhes
                document.getElementById('print-details-btn').addEventListener('click', () => {
                    this.printEquipmentDetails();
                });
                
                // Editar equipamento
                document.getElementById('edit-equipment-btn').addEventListener('click', () => {
                    this.showEditModal();
                });
                
                // Fechar modal de edição
                document.getElementById('close-edit-modal').addEventListener('click', () => {
                    document.getElementById('edit-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-edit-btn').addEventListener('click', () => {
                    document.getElementById('edit-modal').classList.add('hidden');
                });
                
                // Salvar alterações
                document.getElementById('edit-equipment-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveEquipmentChanges();
                });
                
                // Abrir modal de histórico
                document.getElementById('history-btn').addEventListener('click', () => {
                    this.showHistoryModal();
                });
                
                // Fechar modal de histórico
                document.getElementById('close-history-modal').addEventListener('click', () => {
                    document.getElementById('history-modal').classList.add('hidden');
                });
                
                document.getElementById('close-history-btn').addEventListener('click', () => {
                    document.getElementById('history-modal').classList.add('hidden');
                });
                
                // Abrir modal de agendamento
                document.getElementById('schedule-btn').addEventListener('click', () => {
                    this.showScheduleModal();
                });
                
                // Fechar modal de agendamento
                document.getElementById('close-schedule-modal').addEventListener('click', () => {
                    document.getElementById('schedule-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-schedule-btn').addEventListener('click', () => {
                    document.getElementById('schedule-modal').classList.add('hidden');
                });
                
                // Salvar agendamento
                document.getElementById('schedule-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveSchedule();
                });
                
                // Abrir modal de adição de equipamento
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                // Fechar modal de adição
                document.getElementById('close-add-modal').addEventListener('click', () => {
                    document.getElementById('add-modal').classList.add('hidden');
                });
                
                document.getElementById('cancel-add-btn').addEventListener('click', () => {
                    document.getElementById('add-modal').classList.add('hidden');
                });
                
                // Salvar novo equipamento
                document.getElementById('add-equipment-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.saveNewEquipment();
                });
                
                // Tipo de equipamento mudou (no modal de adicionar)
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Botão de atualizar
                document.getElementById('refresh-btn').addEventListener('click', () => {
                    // Mostrar loading state
                    this.showLoadingState();
                    
                    // Simular atualização
                    setTimeout(() => {
                        this.loadData();
                        this.updateLastUpdated();
                        this.updateAllDashboards();
                        this.updateDashboardDetails();
                        
                        // Adicionar classe de animação e remover depois
                        document.getElementById('refresh-btn').classList.add('animate-spin');
                        setTimeout(() => {
                            document.getElementById('refresh-btn').classList.remove('animate-spin');
                        }, 1000);
                        
                        // Mostrar notificação
                        this.showNotification('success', 'Dados atualizados', 'Os dados foram atualizados com sucesso!');
                    }, 800);
                });
                
                // Dropdown de exportação
                document.getElementById('export-btn').addEventListener('click', () => {
                    const dropdown = document.getElementById('export-dropdown');
                    dropdown.classList.toggle('hidden');
                });
                
                // Exportar para CSV
                document.getElementById('export-csv').addEventListener('click', () => {
                    this.exportToCSV();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Exportar para impressão
                document.getElementById('export-print').addEventListener('click', () => {
                    this.printActiveTable();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Exportar para PDF
                document.getElementById('export-pdf').addEventListener('click', () => {
                    this.generatePDFReport();
                    document.getElementById('export-dropdown').classList.add('hidden');
                });
                
                // Dashboard detalhado
                document.getElementById('dashboard-main-btn').addEventListener('click', () => {
                    document.getElementById('dashboard-modal').classList.remove('hidden');
                    this.updateDashboardCharts();
                });
                
                // Fechar dashboard detalhado
                document.getElementById('close-dashboard-modal').addEventListener('click', () => {
                    document.getElementById('dashboard-modal').classList.add('hidden');
                });
                
                // Período do dashboard mudou
                document.getElementById('dashboard-date-range').addEventListener('change', () => {
                    this.updateDashboardCharts();
                });
                
                // Imprimir dashboard detalhado
                document.getElementById('print-dashboard-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                // Visualização real dos equipamentos
                document.getElementById('real-equipment-btn').addEventListener('click', () => {
                    document.getElementById('real-equipment-modal').classList.remove('hidden');
                    // Atualizar a visualização de equipamentos reais (caso já tenha sido filtrada antes)
                    this.filterRealEquipment('all');
                });
                
                // Fechar visualização real dos equipamentos
                document.getElementById('close-real-equipment-modal').addEventListener('click', () => {
                    document.getElementById('real-equipment-modal').classList.add('hidden');
                });
                
                // Filtros da visualização real dos equipamentos
                document.querySelectorAll('.real-equipment-filter').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.real-equipment-filter').forEach(btn => {
                            btn.classList.remove('active', 'bg-primary', 'text-white');
                            btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                        });
                        button.classList.add('active', 'bg-primary', 'text-white');
                        button.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                        
                        const filter = button.getAttribute('data-filter');
                        this.filterRealEquipment(filter);
                    });
                });
                
                // Fechar notificações ao clicar
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('close-notification')) {
                        const notification = e.target.closest('.notification');
                        if (notification) {
                            notification.remove();
                        }
                    }
                });
                
                // Fechar dropdowns ao clicar fora
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#export-btn') && !e.target.closest('#export-dropdown')) {
                        document.getElementById('export-dropdown').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#advanced-filter-btn') && !e.target.closest('#advanced-filter-dropdown')) {
                        document.getElementById('advanced-filter-dropdown').classList.add('hidden');
                    }
                });
                
                // Teclas de atalho
                document.addEventListener('keydown', (e) => {
                    // Esc para fechar modais
                    if (e.key === 'Escape') {
                        document.getElementById('equipment-modal').classList.add('hidden');
                        document.getElementById('edit-modal').classList.add('hidden');
                        document.getElementById('add-modal').classList.add('hidden');
                        document.getElementById('history-modal').classList.add('hidden');
                        document.getElementById('schedule-modal').classList.add('hidden');
                        document.getElementById('dashboard-modal').classList.add('hidden');
                        document.getElementById('real-equipment-modal').classList.add('hidden');
                    }
                });
            },
            
            // Mostrar loading state em todas as tabelas
            showLoadingState() {
                const loadingHTML = `
                    <tr>
                        <td colspan="7" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-circle-notch fa-spin text-3xl text-primary mb-3"></i>
                                <p>Atualizando dados...</p>
                            </div>
                        </td>
                    </tr>
                `;
                
                document.getElementById('reboques-table').innerHTML = loadingHTML;
                document.getElementById('caminhoes-proprios-table').innerHTML = loadingHTML;
                document.getElementById('caminhoes-terceiros-table').innerHTML = loadingHTML;
                document.getElementById('frente-4001-colhedoras-table').innerHTML = loadingHTML;
                document.getElementById('frente-4001-tracoes-table').innerHTML = loadingHTML;
                document.getElementById('frente-4002-colhedoras-table').innerHTML = loadingHTML;
                document.getElementById('frente-4002-tracoes-table').innerHTML = loadingHTML;
            },
            
            // Atualizar horário de última atualização
            updateLastUpdated() {
                const now = new Date();
                const formattedDate = now.toLocaleDateString('pt-BR');
                const formattedTime = now.toLocaleTimeString('pt-BR');
                document.getElementById('last-updated').textContent = `Atualizado em: ${formattedDate} às ${formattedTime}`;
                document.getElementById('last-updated').classList.remove('hidden');
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCaminhoesPropriosTable();
                this.renderCaminhoesTerc();
                this.renderFrente4001Colhedoras();
                this.renderFrente4001Tracoes();
                this.renderFrente4002Colhedoras();
                this.renderFrente4002Tracoes();
            },
            
            // Renderizar apenas a tabela ativa
            renderActiveTable() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const id = activeTab.id;
                
                switch(id) {
                    case 'reboques':
                        this.renderReboquesTable();
                        break;
                    case 'caminhoes-proprios':
                        this.renderCaminhoesPropriosTable();
                        break;
                    case 'caminhoes-terceiros':
                        this.renderCaminhoesTerc();
                        break;
                    case 'frente-4001':
                        this.renderFrente4001Colhedoras();
                        this.renderFrente4001Tracoes();
                        break;
                    case 'frente-4002':
                        this.renderFrente4002Colhedoras();
                        this.renderFrente4002Tracoes();
                        break;
                }
            },
            
            // Obter os dados filtrados para a aba ativa
            getFilteredDataForActiveTab() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return [];
                
                const id = activeTab.id;
                
                switch(id) {
                    case 'reboques':
                        return this.filterData(this.data.reboques);
                    case 'caminhoes-proprios':
                        return this.filterData(this.data.caminhoesProps);
                    case 'caminhoes-terceiros':
                        return this.filterData(this.data.caminhoesTerc);
                    case 'frente-4001':
                        // Deveria retornar a tabela atualmente visível, mas por simplificação, retornaremos as colhedoras
                        return this.filterData(this.data.frente4001Colhedoras);
                    case 'frente-4002':
                        // Deveria retornar a tabela atualmente visível, mas por simplificação, retornaremos as colhedoras
                        return this.filterData(this.data.frente4002Colhedoras);
                    default:
                        return [];
                }
            },
            
            // Função para obter o status formatado com badge
            getStatusBadge(status) {
                let bgColor, textColor, icon;
                
                switch(status.toLowerCase()) {
                    case 'operacional':
                        bgColor = 'bg-green-100 dark:bg-green-900';
                        textColor = 'text-green-800 dark:text-green-200';
                        icon = 'fa-check';
                        break;
                    case 'em manutenção':
                    case 'aguardando reforma':
                        bgColor = 'bg-yellow-100 dark:bg-yellow-900';
                        textColor = 'text-yellow-800 dark:text-yellow-200';
                        icon = 'fa-wrench';
                        break;
                    case 'em reforma':
                    case 'inoperante':
                        bgColor = 'bg-red-100 dark:bg-red-900';
                        textColor = 'text-red-800 dark:text-red-200';
                        icon = 'fa-tools';
                        break;
                    default:
                        bgColor = 'bg-blue-100 dark:bg-blue-900';
                        textColor = 'text-blue-800 dark:text-blue-200';
                        icon = 'fa-exchange-alt';
                }
                
                return `<span class="px-2 py-1 text-xs font-medium rounded-full ${bgColor} ${textColor} flex items-center justify-center w-fit"><i class="fas ${icon} mr-1"></i> ${status}</span>`;
            },
            
            // Filtrar dados com base nos filtros ativos
            filterData(data) {
                const { search, status, dateStart, dateEnd, motivo } = this.data.filters;
                
                return data.filter(item => {
                    // Filtrar por status
                    if (status !== 'all' && item.status !== status) {
                        return false;
                    }
                    
                    // Filtrar por data de início
                    if (dateStart && item.data && new Date(item.data) < new Date(dateStart)) {
                        return false;
                    }
                    
                    // Filtrar por data de fim
                    if (dateEnd && item.data && new Date(item.data) > new Date(dateEnd)) {
                        return false;
                    }
                    
                    // Também verificar dataParada (para reboques)
                    if (dateStart && item.dataParada && new Date(item.dataParada) < new Date(dateStart)) {
                        return false;
                    }
                    
                    if (dateEnd && item.dataParada && new Date(item.dataParada) > new Date(dateEnd)) {
                        return false;
                    }
                    
                    // Filtrar por motivo
                    if (motivo && (!item.motivo || !item.motivo.toLowerCase().includes(motivo))) {
                        return false;
                    }
                    
                    // Filtrar por texto de pesquisa
                    if (search) {
                        return Object.values(item).some(value => 
                            value && value.toString().toLowerCase().includes(search)
                        );
                    }
                    
                    return true;
                });
            },
            
            // Ordenar dados
            sortData(data) {
                if (!this.data.currentSort.key) return data;
                
                return [...data].sort((a, b) => {
                    let valueA = a[this.data.currentSort.key] || '';
                    let valueB = b[this.data.currentSort.key] || '';
                    
                    // Converter para número se possível
                    if (!isNaN(valueA) && !isNaN(valueB)) {
                        valueA = Number(valueA);
                        valueB = Number(valueB);
                    } else {
                        valueA = valueA.toString().toLowerCase();
                        valueB = valueB.toString().toLowerCase();
                    }
                    
                    if (this.data.currentSort.order === 'asc') {
                        if (valueA < valueB) return -1;
                        if (valueA > valueB) return 1;
                        return 0;
                    } else {
                        if (valueA > valueB) return -1;
                        if (valueA < valueB) return 1;
                        return 0;
                    }
                });
            },
            
            // Paginar dados
            paginateData(data) {
                const { currentPage, itemsPerPage } = this.data.pagination;
                const startIndex = (currentPage - 1) * itemsPerPage;
                return data.slice(startIndex, startIndex + itemsPerPage);
            },
            
            // Atualizar paginação
            updatePagination() {
                const filteredData = this.getFilteredDataForActiveTab();
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('showing-end').textContent = end;
                document.getElementById('total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('prev-page').disabled = currentPage <= 1;
                document.getElementById('next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderActiveTable();
                        this.updatePagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Atualizar paginação para caminhões próprios
            updateCPPagination() {
                const filteredData = this.filterData(this.data.caminhoesProps);
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('cp-showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('cp-showing-end').textContent = end;
                document.getElementById('cp-total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('cp-prev-page').disabled = currentPage <= 1;
                document.getElementById('cp-next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('cp-pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderCaminhoesPropriosTable();
                        this.updateCPPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Atualizar paginação para caminhões terceiros
            updateCTPagination() {
                const filteredData = this.filterData(this.data.caminhoesTerc);
                const { currentPage, itemsPerPage } = this.data.pagination;
                const totalItems = filteredData.length;
                const totalPages = Math.ceil(totalItems / itemsPerPage);
                
                // Atualizar texto de contagem
                const start = Math.min((currentPage - 1) * itemsPerPage + 1, totalItems);
                const end = Math.min(currentPage * itemsPerPage, totalItems);
                
                document.getElementById('ct-showing-start').textContent = totalItems > 0 ? start : 0;
                document.getElementById('ct-showing-end').textContent = end;
                document.getElementById('ct-total-items').textContent = totalItems;
                
                // Desabilitar botões conforme necessário
                document.getElementById('ct-prev-page').disabled = currentPage <= 1;
                document.getElementById('ct-next-page').disabled = currentPage >= totalPages;
                
                // Gerar números de página
                const paginationNumbers = document.getElementById('ct-pagination-numbers');
                paginationNumbers.innerHTML = '';
                
                const maxButtons = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
                let endPage = Math.min(totalPages, startPage + maxButtons - 1);
                
                if (endPage - startPage + 1 < maxButtons) {
                    startPage = Math.max(1, endPage - maxButtons + 1);
                }
                
                // Adicionar primeira página
                if (startPage > 1) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = '1';
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = 1;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                    
                    // Adicionar ellipsis se necessário
                    if (startPage > 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                }
                
                // Adicionar páginas
                for (let i = startPage; i <= endPage; i++) {
                    const button = document.createElement('button');
                    button.className = i === currentPage 
                        ? 'px-3 py-1 rounded-md bg-primary text-white'
                        : 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = i;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
                
                // Adicionar última página
                if (endPage < totalPages) {
                    // Adicionar ellipsis se necessário
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('span');
                        ellipsis.className = 'px-3 py-1 text-gray-700 dark:text-gray-300';
                        ellipsis.textContent = '...';
                        paginationNumbers.appendChild(ellipsis);
                    }
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300';
                    button.textContent = totalPages;
                    button.addEventListener('click', () => {
                        this.data.pagination.currentPage = totalPages;
                        this.renderCaminhoesTerc();
                        this.updateCTPagination();
                    });
                    paginationNumbers.appendChild(button);
                }
            },
            
            // Renderizar tabelas específicas
            renderReboquesTable() {
                const filteredData = this.filterData(this.data.reboques);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('reboques-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.frota || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.tipo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.acoplado || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.tipoAcoplado || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Reboque', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Reboque';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Reboque';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderCaminhoesPropriosTable() {
                const filteredData = this.filterData(this.data.caminhoesProps);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('caminhoes-proprios-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.caminhao || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Caminhão Próprio', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Próprio';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Próprio';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderCaminhoesTerc() {
                const filteredData = this.filterData(this.data.caminhoesTerc);
                const sortedData = this.sortData(filteredData);
                const paginatedData = this.paginateData(sortedData);
                
                const tableBody = document.getElementById('caminhoes-terceiros-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.caminhao || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.reboques || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.proprietario || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Caminhão Terceiro', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Terceiro';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Caminhão Terceiro';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4001Colhedoras() {
                const filteredData = this.filterData(this.data.frente4001Colhedoras);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4001-colhedoras-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Colhedora Frente 4001', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4001';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4001';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4001Tracoes() {
                const filteredData = this.filterData(this.data.frente4001Tracoes);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4001-tracoes-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Tração Frente 4001', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4001';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4001';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4002Colhedoras() {
                const filteredData = this.filterData(this.data.frente4002Colhedoras);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4002-colhedoras-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Colhedora Frente 4002', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4002';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Colhedora Frente 4002';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            renderFrente4002Tracoes() {
                const filteredData = this.filterData(this.data.frente4002Tracoes);
                const sortedData = this.sortData(filteredData);
                
                const tableBody = document.getElementById('frente-4002-tracoes-table');
                tableBody.innerHTML = '';
                
                if (sortedData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                                Nenhum resultado encontrado.
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                sortedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                    
                    // Formatar data se existir
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                        <td class="px-4 py-3 text-sm">${formattedDate}</td>
                        <td class="px-4 py-3 text-sm">${this.getStatusBadge(item.status)}</td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <button class="view-details text-gray-600 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors" title="Ver detalhes">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="edit-equipment text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="history-equipment text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 transition-colors" title="Histórico">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // Adicionar evento de clique para detalhe
                    row.querySelector('.view-details').addEventListener('click', () => {
                        this.showEquipmentDetails('Tração Frente 4002', item);
                    });
                    
                    // Adicionar evento de clique para edição
                    row.querySelector('.edit-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4002';
                        this.showEditModal();
                    });
                    
                    // Adicionar evento de clique para histórico
                    row.querySelector('.history-equipment').addEventListener('click', () => {
                        this.data.editingItem = item;
                        this.data.editingType = 'Tração Frente 4002';
                        this.showHistoryModal();
                    });
                    
                    tableBody.appendChild(row);
                });
            },
            
            // Mostrar detalhes do equipamento
            showEquipmentDetails(type, item) {
                const modal = document.getElementById('equipment-modal');
                const title = document.getElementById('modal-title');
                const content = document.getElementById('modal-content');
                
                title.textContent = `Detalhes do ${type}`;
                
                // Salvar o item atual para edição posterior
                this.data.editingItem = item;
                this.data.editingType = type;
                
                // Criar HTML do conteúdo com base no tipo
                let contentHTML = '';
                
                if (type === 'Reboque') {
                    let formattedDate = '-';
                    if (item.dataParada) {
                        const date = new Date(item.dataParada);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Frota:</span>
                                <p class="font-semibold">${item.frota || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Tipo:</span>
                                <p class="font-semibold">${item.tipo || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Acoplado com:</span>
                                <p class="font-semibold">${item.acoplado || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Tipo Acoplado:</span>
                                <p class="font-semibold">${item.tipoAcoplado || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Equipamento do tipo Semi Reboque, utilizado para transporte de cargas. Última manutenção preventiva realizada em ${formattedDate !== '-' ? formattedDate : '2025-04-01'}.
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva agendada: ${formattedDate !== '-' ? new Date(new Date(item.dataParada).setDate(new Date(item.dataParada).getDate() + 30)).toLocaleDateString('pt-BR') : '2025-06-01'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Próprio') {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Caminhão:</span>
                                <p class="font-semibold">${item.caminhao || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Proprietário:</span>
                                <p class="font-semibold">UsinaCambui</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Caminhão da frota própria da UsinaCambui, modelo VW Constellation 26.420. Utilizado para transporte de cana de açúcar. ${item.status === 'Em manutenção' ? 'Atualmente em manutenção, com previsão de 3 dias para retorno operacional.' : ''}
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva agendada: ${formattedDate !== '-' ? new Date(new Date(item.data).setDate(new Date(item.data).getDate() + 45)).toLocaleDateString('pt-BR') : '2025-06-15'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (type === 'Caminhão Terceiro') {
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Caminhão:</span>
                                <p class="font-semibold">${item.caminhao || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Proprietário:</span>
                                <p class="font-semibold">${item.proprietario || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Contrato:</span>
                                <p class="font-semibold">CONT-${item.caminhao}-${new Date().getFullYear()}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Reboques:</span>
                            <p class="font-semibold">${item.reboques || 'Nenhum reboque associado'}</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    Caminhão de propriedade de terceiros, contratado para a safra 2025/26. Responsabilidade de manutenção: ${item.proprietario}.
                                </p>
                            </div>
                        </div>
                    `;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    let formattedDate = '-';
                    if (item.data) {
                        const date = new Date(item.data);
                        formattedDate = date.toLocaleDateString('pt-BR');
                    }
                    
                    const frenteNum = type.includes('4001') ? '4001' : '4002';
                    
                    contentHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Código:</span>
                                <p class="font-semibold">${item.codigo || '-'}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Frente:</span>
                                <p class="font-semibold">${frenteNum}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Data de Parada:</span>
                                <p class="font-semibold">${formattedDate}</p>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <span class="text-gray-600 dark:text-gray-400 text-sm">Status:</span>
                                <p class="font-semibold">${item.status}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md mt-4">
                            <span class="text-gray-600 dark:text-gray-400 text-sm">Motivo:</span>
                            <p class="font-semibold">${item.motivo || 'Sem motivo registrado'}</p>
                        </div>
                        <div class="mt-4">
                            <h3 class="text-lg font-medium mb-2">Informações Adicionais</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md">
                                <p class="text-sm">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    ${type.includes('Colhedora') ? 'Colhedora' : 'Tração'} alocada na frente ${frenteNum}. ${item.status === 'Em manutenção' ? 'Previsão de retorno: ' + new Date(new Date().setDate(new Date().getDate() + 5)).toLocaleDateString('pt-BR') + '.' : ''}
                                </p>
                                <div class="mt-2 flex items-center">
                                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                                    <span class="text-sm">Próxima manutenção preventiva: ${formattedDate !== '-' ? new Date(new Date(item.data).setDate(new Date(item.data).getDate() + 30)).toLocaleDateString('pt-BR') : '2025-06-10'}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                // Adicionar histórico e manutenções agendadas
                const id = this.getEquipmentId(item, type);
                
                contentHTML += `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <h3 class="text-lg font-medium mb-2">Últimas Atividades</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md max-h-36 overflow-y-auto">
                                <ul class="divide-y divide-gray-200 dark:divide-gray-600">
                                    ${this.getRecentHistory(id)}
                                </ul>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium mb-2">Próximas Manutenções</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-md max-h-36 overflow-y-auto">
                                <ul class="divide-y divide-gray-200 dark:divide-gray-600">
                                    ${this.getScheduledMaintenance(id)}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
                
                content.innerHTML = contentHTML;
                modal.classList.remove('hidden');
            },
            
            // Obter ID único do equipamento (para relacionar com histórico)
            getEquipmentId(item, type) {
                if (type === 'Reboque') {
                    return item.frota || item.acoplado;
                } else if (type === 'Caminhão Próprio') {
                    return item.caminhao;
                } else if (type === 'Caminhão Terceiro') {
                    return item.caminhao;
                } else {
                    return item.codigo;
                }
            },
            
            // Obter histórico recente
            getRecentHistory(id) {
                const history = this.data.history[id];
                
                if (!history || history.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhum registro de atividade encontrado.</span></li>`;
                }
                
                // Ordenar histórico por data (mais recente primeiro)
                const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Limitar a 3 itens mais recentes
                const recentHistory = sortedHistory.slice(0, 3);
                
                return recentHistory.map(entry => {
                    const date = new Date(entry.date).toLocaleDateString('pt-BR');
                    return `
                        <li class="py-2">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    ${this.getStatusIcon(entry.status)}
                                </div>
                                <div class="ml-2">
                                    <p class="text-sm font-medium">${entry.description}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${date} - ${entry.user}</p>
                                </div>
                            </div>
                        </li>
                    `;
                }).join('') || `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhum registro de atividade encontrado.</span></li>`;
            },
            
            // Obter manutenções agendadas
            getScheduledMaintenance(id) {
                // Filtrar agendamentos pelo ID do equipamento
                const schedules = this.data.schedules.filter(schedule => schedule.equipment === id);
                
                if (schedules.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span></li>`;
                }
                
                // Ordenar agendamentos por data
                const sortedSchedules = [...schedules].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Mostrar apenas futuros agendamentos
                const now = new Date();
                const futureSchedules = sortedSchedules.filter(schedule => new Date(`${schedule.date}T${schedule.time}`) > now);
                
                if (futureSchedules.length === 0) {
                    return `<li class="py-2"><span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span></li>`;
                }
                
                return futureSchedules.map(schedule => {
                    const date = new Date(`${schedule.date}T${schedule.time}`).toLocaleString('pt-BR');
                    const typeIcon = this.getMaintenanceTypeIcon(schedule.type);
                    
                    return `
                        <li class="py-2">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    ${typeIcon}
                                </div>
                                <div class="ml-2">
                                    <p class="text-sm font-medium">${this.getMaintenanceTypeName(schedule.type)}</p>
                                    <p class="text-xs">${schedule.description}</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">${date} - ${schedule.responsible}</p>
                                </div>
                            </div>
                        </li>
                    `;
                }).join('');
            },
            
            // Obter ícone de status
            getStatusIcon(status) {
                let icon, color;
                
                switch(status.toLowerCase()) {
                    case 'operacional':
                        icon = 'fa-check-circle';
                        color = 'text-green-500';
                        break;
                    case 'em manutenção':
                    case 'aguardando reforma':
                        icon = 'fa-wrench';
                        color = 'text-yellow-500';
                        break;
                    case 'em reforma':
                    case 'inoperante':
                        icon = 'fa-tools';
                        color = 'text-red-500';
                        break;
                    default:
                        icon = 'fa-info-circle';
                        color = 'text-blue-500';
                }
                
                return `<i class="fas ${icon} ${color}"></i>`;
            },
            
            // Obter ícone de tipo de manutenção
            getMaintenanceTypeIcon(type) {
                let icon, color;
                
                switch(type) {
                    case 'preventive':
                        icon = 'fa-shield-alt';
                        color = 'text-green-500';
                        break;
                    case 'corrective':
                        icon = 'fa-tools';
                        color = 'text-yellow-500';
                        break;
                    case 'emergency':
                        icon = 'fa-exclamation-triangle';
                        color = 'text-red-500';
                        break;
                    case 'revision':
                        icon = 'fa-search';
                        color = 'text-blue-500';
                        break;
                    default:
                        icon = 'fa-calendar-check';
                        color = 'text-gray-500';
                }
                
                return `<i class="fas ${icon} ${color}"></i>`;
            },
            
            // Obter nome do tipo de manutenção
            getMaintenanceTypeName(type) {
                switch(type) {
                    case 'preventive':
                        return 'Manutenção Preventiva';
                    case 'corrective':
                        return 'Manutenção Corretiva';
                    case 'emergency':
                        return 'Manutenção Emergencial';
                    case 'revision':
                        return 'Revisão Geral';
                    default:
                        return 'Agendamento';
                }
            },
            
            // Mostrar modal de edição
            showEditModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('edit-modal');
                const title = document.getElementById('edit-modal-title');
                const formFields = document.getElementById('edit-form-fields');
                
                title.textContent = `Editar ${this.data.editingType}`;
                
                // Gerar campos do formulário com base no tipo
                let fieldsHTML = '';
                
                if (this.data.editingType === 'Reboque') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota</label>
                                <input type="text" id="edit-frota" value="${this.data.editingItem.frota || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <input type="text" id="edit-tipo" value="${this.data.editingItem.tipo || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="edit-acoplado" value="${this.data.editingItem.acoplado || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="edit-tipoAcoplado" value="${this.data.editingItem.tipoAcoplado || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-dataParada" value="${this.data.editingItem.dataParada || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" value="${this.data.editingItem.caminhao || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-data" value="${this.data.editingItem.data || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" value="${this.data.editingItem.caminhao || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="edit-proprietario" value="${this.data.editingItem.proprietario || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="edit-reboques" value="${this.data.editingItem.reboques || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (this.data.editingType.includes('Colhedora') || this.data.editingType.includes('Tração')) {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" value="${this.data.editingItem.codigo || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-data" value="${this.data.editingItem.data || ''}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${this.data.editingItem.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${this.data.editingItem.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${this.data.editingItem.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${this.data.editingItem.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${this.data.editingItem.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${this.data.editingItem.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${this.data.editingItem.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${this.data.editingItem.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${this.data.editingItem.motivo || ''}</textarea>
                        </div>
                    `;
                }
                
                // Adicionar campo para registrar a alteração no histórico
                fieldsHTML += `
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-md">
                        <div class="flex items-center text-blue-800 dark:text-blue-200 mb-2">
                            <i class="fas fa-info-circle mr-2"></i>
                            <h4 class="font-medium">Registrar Alteração</h4>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrição da Alteração</label>
                            <textarea id="edit-history-desc" rows="2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Descreva brevemente a alteração realizada..."></textarea>
                        </div>
                        <div class="mt-2">
                           <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                            <input type="text" id="edit-history-user" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" placeholder="Seu nome">
                        </div>
                    </div>
                `;
                
                formFields.innerHTML = fieldsHTML;
                modal.classList.remove('hidden');
            },
            
            // Salvar alterações do equipamento
            saveEquipmentChanges() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                // Obter valores dos campos de formulário
                const status = document.getElementById('edit-status').value;
                const motivo = document.getElementById('edit-motivo').value;
                
                // Obter valores específicos por tipo
                if (this.data.editingType === 'Reboque') {
                    this.data.editingItem.frota = document.getElementById('edit-frota').value;
                    this.data.editingItem.tipo = document.getElementById('edit-tipo').value;
                    this.data.editingItem.acoplado = document.getElementById('edit-acoplado').value;
                    this.data.editingItem.tipoAcoplado = document.getElementById('edit-tipoAcoplado').value;
                    this.data.editingItem.dataParada = document.getElementById('edit-dataParada').value;
                } else if (this.data.editingType === 'Caminhão Próprio') {
                    this.data.editingItem.caminhao = document.getElementById('edit-caminhao').value;
                    this.data.editingItem.data = document.getElementById('edit-data').value;
                } else if (this.data.editingType === 'Caminhão Terceiro') {
                    this.data.editingItem.caminhao = document.getElementById('edit-caminhao').value;
                    this.data.editingItem.proprietario = document.getElementById('edit-proprietario').value;
                    this.data.editingItem.reboques = document.getElementById('edit-reboques').value;
                } else if (this.data.editingType.includes('Colhedora') || this.data.editingType.includes('Tração')) {
                    this.data.editingItem.codigo = document.getElementById('edit-codigo').value;
                    this.data.editingItem.data = document.getElementById('edit-data').value;
                }
                
                // Atualizar status e motivo comuns a todos os tipos
                this.data.editingItem.status = status;
                this.data.editingItem.motivo = motivo;
                
                // Adicionar ao histórico se houver descrição
                const historyDesc = document.getElementById('edit-history-desc').value;
                const historyUser = document.getElementById('edit-history-user').value;
                
                if (historyDesc && historyUser) {
                    const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                    
                    if (!this.data.history[id]) {
                        this.data.history[id] = [];
                    }
                    
                    this.data.history[id].push({
                        date: new Date().toISOString().split('T')[0],
                        status: status,
                        description: historyDesc,
                        user: historyUser
                    });
                }
                
                // Atualizar visualização
                this.renderActiveTable();
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Atualizar detalhes se estiver visível
                if (!document.getElementById('equipment-modal').classList.contains('hidden')) {
                    this.showEquipmentDetails(this.data.editingType, this.data.editingItem);
                }
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Mostrar notificação
                this.showNotification('success', 'Alterações salvas', 'As alterações foram salvas com sucesso!');
            },
            
            // Mostrar modal de histórico
            showHistoryModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('history-modal');
                const title = document.getElementById('history-title');
                const subtitle = document.getElementById('history-subtitle');
                const timeline = document.getElementById('history-timeline');
                const icon = document.getElementById('history-icon');
                
                // Configurar ícone
                if (this.data.editingType.includes('Caminhão')) {
                    icon.className = 'fas fa-truck';
                } else if (this.data.editingType.includes('Reboque')) {
                    icon.className = 'fas fa-trailer';
                } else if (this.data.editingType.includes('Colhedora')) {
                    icon.className = 'fas fa-tractor';
                } else {
                    icon.className = 'fas fa-truck-monster';
                }
                
                // Obter ID do equipamento
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                const history = this.data.history[id] || [];
                
                // Configurar título
                let displayId = '';
                
                if (this.data.editingType === 'Reboque') {
                    displayId = this.data.editingItem.frota || this.data.editingItem.acoplado;
                } else if (this.data.editingType === 'Caminhão Próprio' || this.data.editingType === 'Caminhão Terceiro') {
                    displayId = this.data.editingItem.caminhao;
                } else {
                    displayId = this.data.editingItem.codigo;
                }
                
                title.textContent = `${this.data.editingType} #${displayId}`;
                subtitle.textContent = `Total de registros: ${history.length}`;
                
                // Preencher timeline
                timeline.innerHTML = '';
                
                if (history.length === 0) {
                    timeline.innerHTML = `
                        <div class="flex flex-col items-start mb-6 ml-6 relative">
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-gray-400"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <p class="text-sm text-gray-500 dark:text-gray-400">Nenhum registro de histórico encontrado para este equipamento.</p>
                            </div>
                        </div>
                    `;
                } else {
                    // Ordenar histórico por data (mais recente primeiro)
                    const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    sortedHistory.forEach(entry => {
                        const date = new Date(entry.date);
                        const formattedDate = date.toLocaleDateString('pt-BR');
                        
                        let statusColor = '';
                        
                        switch(entry.status.toLowerCase()) {
                            case 'operacional':
                                statusColor = 'bg-green-500';
                                break;
                            case 'em manutenção':
                            case 'aguardando reforma':
                                statusColor = 'bg-yellow-500';
                                break;
                            case 'em reforma':
                            case 'inoperante':
                                statusColor = 'bg-red-500';
                                break;
                            default:
                                statusColor = 'bg-blue-500';
                        }
                        
                        const historyItem = document.createElement('div');
                        historyItem.className = 'flex flex-col items-start mb-6 ml-6 relative';
                        historyItem.innerHTML = `
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full ${statusColor}"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium">${entry.description}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Status: ${entry.status}</p>
                                    </div>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">${formattedDate}</span>
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Registrado por: ${entry.user}</p>
                            </div>
                        `;
                        
                        timeline.appendChild(historyItem);
                    });
                }
                
                modal.classList.remove('hidden');
            },
            
            // Mostrar modal de agendamento
            showScheduleModal() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const modal = document.getElementById('schedule-modal');
                const info = document.getElementById('schedule-equipment-info');
                
                // Obter ID do equipamento
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                
                // Configurar informações do equipamento
                let displayId = '';
                
                if (this.data.editingType === 'Reboque') {
                    displayId = this.data.editingItem.frota || this.data.editingItem.acoplado;
                } else if (this.data.editingType === 'Caminhão Próprio' || this.data.editingType === 'Caminhão Terceiro') {
                    displayId = this.data.editingItem.caminhao;
                } else {
                    displayId = this.data.editingItem.codigo;
                }
                
                const currentStatus = this.data.editingItem.status;
                let statusClass = '';
                
                switch(currentStatus.toLowerCase()) {
                    case 'operacional':
                        statusClass = 'text-green-600 dark:text-green-400';
                        break;
                    case 'em manutenção':
                    case 'aguardando reforma':
                        statusClass = 'text-yellow-600 dark:text-yellow-400';
                        break;
                    case 'em reforma':
                    case 'inoperante':
                        statusClass = 'text-red-600 dark:text-red-400';
                        break;
                    default:
                        statusClass = 'text-blue-600 dark:text-blue-400';
                }
                
                info.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <span class="text-sm text-gray-600 dark:text-gray-400">Agendando manutenção para:</span>
                            <p class="font-semibold">${this.data.editingType} #${displayId}</p>
                        </div>
                        <div class="text-right">
                            <span class="text-sm text-gray-600 dark:text-gray-400">Status atual:</span>
                            <p class="font-semibold ${statusClass}">${currentStatus}</p>
                        </div>
                    </div>
                `;
                
                // Configurar data padrão (amanhã)
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const tomorrowFormatted = tomorrow.toISOString().split('T')[0];
                
                document.getElementById('schedule-date').value = tomorrowFormatted;
                document.getElementById('schedule-time').value = '08:00';
                document.getElementById('schedule-type').value = '';
                document.getElementById('schedule-description').value = '';
                document.getElementById('schedule-responsible').value = '';
                
                modal.classList.remove('hidden');
            },
            
            // Salvar agendamento
            saveSchedule() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                // Obter valores do formulário
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const type = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value;
                const responsible = document.getElementById('schedule-responsible').value;
                
                // Validar campos obrigatórios
                if (!date || !time || !type || !description || !responsible) {
                    this.showNotification('error', 'Erro no agendamento', 'Por favor, preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Obter ID do equipamento
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                
                // Adicionar agendamento
                this.data.schedules.push({
                    equipment: id,
                    equipmentType: this.data.editingType,
                    date,
                    time,
                    type,
                    description,
                    responsible
                });
                
                // Fechar modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Mostrar notificação
                this.showNotification('success', 'Agendamento criado', 'O agendamento de manutenção foi criado com sucesso!');
                
                // Atualizar detalhes se estiver visível
                if (!document.getElementById('equipment-modal').classList.contains('hidden')) {
                    this.showEquipmentDetails(this.data.editingType, this.data.editingItem);
                }
            },
            
            // Mostrar modal para adicionar novo equipamento
            showAddEquipmentModal() {
                const modal = document.getElementById('add-modal');
                document.getElementById('equipment-type').value = 'reboque';
                this.updateAddFormFields();
                modal.classList.remove('hidden');
            },
            
            // Atualizar campos de formulário para o tipo de equipamento selecionado
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const formFields = document.getElementById('add-form-fields');
                
                let fieldsHTML = '';
                
                if (type === 'reboque') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota</label>
                                <input type="text" id="add-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <input type="text" id="add-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="add-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="add-tipoAcoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-dataParada" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção ou reforma</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção ou reforma</p>
                        </div>
                    `;
                } else if (type === 'caminhao-proprio') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção ou reforma</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção ou reforma</p>
                        </div>
                    `;
                } else if (type === 'caminhao-terceiro') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="add-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="add-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="add-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <p class="text-xs text-gray-500 mt-1">Separados por traço ou vírgula</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção</p>
                        </div>
                    `;
                } else if (type.includes('colhedora') || type.includes('tracao')) {
                    const frente = type.includes('4001') ? '4001' : '4002';
                    const equipType = type.includes('colhedora') ? 'Colhedora' : 'Tração';
                    
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="add-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frente</label>
                                <input type="text" value="Frente ${frente}" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300" disabled>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">*Somente para equipamentos em manutenção ou inoperantes</p>
                        </div>
                    `;
                }
                
                formFields.innerHTML = fieldsHTML;
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                
                // Criar objeto de equipamento com base no tipo
                let newEquipment = {};
                
                if (type === 'reboque') {
                    newEquipment = {
                        frota: document.getElementById('add-frota').value,
                        tipo: document.getElementById('add-tipo').value,
                        acoplado: document.getElementById('add-acoplado').value,
                        tipoAcoplado: document.getElementById('add-tipoAcoplado').value,
                        motivo: document.getElementById('add-motivo').value,
                        status: document.getElementById('add-status').value,
                        dataParada: document.getElementById('add-dataParada').value
                    };
                    
                    // Adicionar aos dados
                    this.data.reboques.push(newEquipment);
                } else if (type === 'caminhao-proprio') {
                    newEquipment = {
                        caminhao: document.getElementById('add-caminhao').value,
                        motivo: document.getElementById('add-motivo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.caminhoesProps.push(newEquipment);
                } else if (type === 'caminhao-terceiro') {
                    newEquipment = {
                        caminhao: document.getElementById('add-caminhao').value,
                        proprietario: document.getElementById('add-proprietario').value,
                        reboques: document.getElementById('add-reboques').value,
                        motivo: document.getElementById('add-motivo').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.caminhoesTerc.push(newEquipment);
                } else if (type === 'colhedora-4001') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo').value,
                        motivo: document.getElementById('add-motivo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.frente4001Colhedoras.push(newEquipment);
                } else if (type === 'tracao-4001') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo').value,
                        motivo: document.getElementById('add-motivo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.frente4001Tracoes.push(newEquipment);
                } else if (type === 'colhedora-4002') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo').value,
                        motivo: document.getElementById('add-motivo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.frente4002Colhedoras.push(newEquipment);
                } else if (type === 'tracao-4002') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo').value,
                        motivo: document.getElementById('add-motivo').value,
                        data: document.getElementById('add-data').value,
                        status: document.getElementById('add-status').value
                    };
                    
                    // Adicionar aos dados
                    this.data.frente4002Tracoes.push(newEquipment);
                }
                
                // Fechar modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Atualizar visualização
                this.renderActiveTable();
                this.updatePagination();
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Mostrar notificação
                this.showNotification('success', 'Equipamento adicionado', 'O novo equipamento foi adicionado com sucesso!');
            },
            
            // Inicializar gráficos
            initializeCharts() {
                this.initializeReboquesCharts();
                this.initializeCaminhoesPropriosCharts();
                this.initializeCaminhoesTerc();
                this.initializeFrente4001Charts();
                this.initializeFrente4002Charts();
                
                // Atualizar cores dos gráficos com base no tema atual
                this.updateChartsTheme();
            },
            
            // Inicializar gráficos para reboques
            initializeReboquesCharts() {
                // Dados para gráfico de status dos reboques
                const statusData = {
                    operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                    maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                    reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma').length,
                    other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma'].includes(r.status)).length
                };
                
                // Verifica se tem dados para mostrar no gráfico
                if (statusData.maintenance === 0 && statusData.reform === 0) {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                    
                    const statusCtx = document.getElementById('reboques-status-chart').getContext('2d');
                    this.data.charts.reboquesStatusChart = new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacional', 'Em manutenção', 'Em reforma', 'Outros'],
                            datasets: [{
                                data: [statusData.operational, statusData.maintenance, statusData.reform, statusData.other],
                                backgroundColor: [
                                    '#10B981', // Verde
                                    '#F59E0B', // Amarelo
                                    '#EF4444', // Vermelho
                                    '#3B82F6'  // Azul
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = Math.round((value / total) * 100);
                                            return `${label}: ${value} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Usar dados reais para o gráfico de tendência de manutenção
                const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                const currentMonth = new Date().getMonth();
                
                // Analisar dados de parada por mês
                const maintenanceByMonth = Array(12).fill(0);
                const reformByMonth = Array(12).fill(0);
                
                // Contar equipamentos em manutenção e reforma por mês
                this.data.reboques.forEach(item => {
                    if (item.dataParada) {
                        const date = new Date(item.dataParada);
                        const month = date.getMonth();
                        
                        if (item.status === 'Em manutenção') {
                            maintenanceByMonth[month]++;
                        } else if (item.status === 'Em reforma') {
                            reformByMonth[month]++;
                        }
                    }
                });
                
                // Determinar quais meses têm dados (últimos 6 meses)
                const activeMonths = [];
                const labels = [];
                const maintenanceData = [];
                const reformData = [];
                
                for (let i = currentMonth - 5; i <= currentMonth; i++) {
                    const monthIndex = i < 0 ? i + 12 : i;
                    if (maintenanceByMonth[monthIndex] > 0 || reformByMonth[monthIndex] > 0) {
                        activeMonths.push(monthIndex);
                        labels.push(months[monthIndex]);
                        maintenanceData.push(maintenanceByMonth[monthIndex]);
                        reformData.push(reformByMonth[monthIndex]);
                    }
                }
                
                // Se não houver dados, mostrar mensagem de sem dados
                if (activeMonths.length === 0) {
                    document.getElementById('reboques-trend-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('reboques-trend-no-data').classList.add('hidden');
                    
                    const trendCtx = document.getElementById('reboques-maintenance-trend-chart').getContext('2d');
                    this.data.charts.reboquesMaintenanceTrendChart = new Chart(trendCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Em manutenção',
                                    data: maintenanceData,
                                    backgroundColor: '#F59E0B',
                                    borderWidth: 1
                                },
                                {
                                    label: 'Em reforma',
                                    data: reformData,
                                    backgroundColor: '#EF4444',
                                    borderWidth: 1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                        stepSize: 1
                                    }
                                },
                                x: {
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar contadores
                const totalReboques = this.data.reboques.length;
                const operacionalCount = statusData.operational;
                const manutencaoCount = statusData.maintenance;
                const reformaCount = statusData.reform;
                const otherCount = statusData.other;
                
                document.getElementById('reboques-operational').textContent = operacionalCount;
                document.getElementById('reboques-maintenance').textContent = manutencaoCount;
                document.getElementById('reboques-reform').textContent = reformaCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalReboques > 0 ? Math.round((operacionalCount / totalReboques) * 100) : 0;
                const manutencaoPercentage = totalReboques > 0 ? Math.round((manutencaoCount / totalReboques) * 100) : 0;
                const reformaPercentage = totalReboques > 0 ? Math.round((reformaCount / totalReboques) * 100) : 0;
                
                document.getElementById('reboques-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('reboques-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
                document.getElementById('reboques-reform-percentage').textContent = `${reformaPercentage}%`;
                
                // Calcular disponibilidade
                const availability = totalReboques > 0 ? Math.round((operacionalCount / totalReboques) * 100) : 0;
                document.getElementById('reboques-availability').textContent = `${availability}%`;
            },
            
            // Inicializar gráficos para caminhões próprios
            initializeCaminhoesPropriosCharts() {
                // Dados para gráfico de status dos caminhões próprios
                const statusData = {
                    operational: this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                    maintenance: this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma').length,
                    borrowed: this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length,
                    other: this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Emprestado'].includes(c.status)).length
                };
                
                // Verifica se tem dados para mostrar no gráfico
                if (statusData.maintenance === 0 && statusData.borrowed === 0) {
                    document.getElementById('cp-status-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('cp-status-no-data').classList.add('hidden');
                    
                    const statusCtx = document.getElementById('cp-status-chart').getContext('2d');
                    this.data.charts.cpStatusChart = new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacional', 'Em manutenção', 'Emprestado', 'Outros'],
                            datasets: [{
                                data: [statusData.operational, statusData.maintenance, statusData.borrowed, statusData.other],
                                backgroundColor: [
                                    '#10B981', // Verde
                                    '#F59E0B', // Amarelo
                                    '#3B82F6', // Azul
                                    '#6B7280'  // Cinza
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = Math.round((value / total) * 100);
                                            return `${label}: ${value} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Analisar dados por mês para evolução de status
                const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'];
                const currentMonth = new Date().getMonth();
                
                // Analisar dados de parada por mês
                const maintenanceByMonth = Array(6).fill(0);
                const borrowedByMonth = Array(6).fill(0);
                const operationalByMonth = Array(12).fill(0);
                
                // Contar caminhões por status e mês
                this.data.caminhoesProps.forEach(item => {
                    if (item.data) {
                        const date = new Date(item.data);
                        const month = date.getMonth();
                        const monthIndex = month <= currentMonth ? 5 - (currentMonth - month) : 5 - (12 + currentMonth - month);
                        
                        if (monthIndex >= 0 && monthIndex < 6) {
                            if (item.status === 'Em manutenção' || item.status === 'Em reforma') {
                                maintenanceByMonth[monthIndex]++;
                            } else if (item.status === 'Emprestado') {
                                borrowedByMonth[monthIndex]++;
                            }
                        }
                    }
                });
                
                // Calcular caminhões operacionais
                const totalCaminhoes = this.data.caminhoesProps.length;
                for (let i = 0; i < 6; i++) {
                    operationalByMonth[i] = totalCaminhoes - maintenanceByMonth[i] - borrowedByMonth[i];
                }
                
                // Determinar se há dados para o gráfico de evolução
                const hasEvolutionData = maintenanceByMonth.some(val => val > 0) || borrowedByMonth.some(val => val > 0);
                
                if (!hasEvolutionData) {
                    document.getElementById('cp-evolution-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('cp-evolution-no-data').classList.add('hidden');
                    
                    // Criar labels para os meses
                    const labels = [];
                    for (let i = 5; i >= 0; i--) {
                        const monthIndex = (currentMonth - i + 12) % 12;
                        labels.push(months[monthIndex]);
                    }
                    
                    const evolutionCtx = document.getElementById('cp-status-evolution-chart').getContext('2d');
                    this.data.charts.cpStatusEvolutionChart = new Chart(evolutionCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: operationalByMonth,
                                    borderColor: '#10B981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                    tension: 0.2,
                                    fill: true
                                },
                                {
                                    label: 'Em manutenção',
                                    data: maintenanceByMonth,
                                    borderColor: '#F59E0B',
                                    backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                    tension: 0.2,
                                    fill: true
                                },
                                {
                                    label: 'Emprestado',
                                    data: borrowedByMonth,
                                    borderColor: '#3B82F6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                    tension: 0.2,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    stacked: false,
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                        stepSize: 1
                                    }
                                },
                                x: {
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar contadores
                const totalCPs = this.data.caminhoesProps.length;
                const operacionalCount = statusData.operational;
                const manutencaoCount = statusData.maintenance;
                const borrowedCount = statusData.borrowed;
                
                document.getElementById('cp-operational').textContent = operacionalCount;
                document.getElementById('cp-maintenance').textContent = manutencaoCount;
                document.getElementById('cp-borrowed').textContent = borrowedCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalCPs > 0 ? Math.round((operacionalCount / totalCPs) * 100) : 0;
                const manutencaoPercentage = totalCPs > 0 ? Math.round((manutencaoCount / totalCPs) * 100) : 0;
                const borrowedPercentage = totalCPs > 0 ? Math.round((borrowedCount / totalCPs) * 100) : 0;
                
                document.getElementById('cp-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('cp-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
                document.getElementById('cp-borrowed-percentage').textContent = `${borrowedPercentage}%`;
                
                // Calcular tempo médio em manutenção (dias)
                document.getElementById('cp-avg-time').textContent = '4d';
            },
            
            // Inicializar gráficos para caminhões terceiros
            initializeCaminhoesTerc() {
                // Verificar se temos proprietários com equipamentos em manutenção
                const proprietariosComManutencao = this.data.caminhoesTerc
                    .filter(c => c.status === 'Em manutenção')
                    .map(c => c.proprietario);
                
                const temProprietariosComManutencao = proprietariosComManutencao.length > 0;
                
                if (!temProprietariosComManutencao) {
                    document.getElementById('ct-owners-no-data').classList.remove('hidden');
                    document.getElementById('ct-status-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('ct-owners-no-data').classList.add('hidden');
                    document.getElementById('ct-status-no-data').classList.add('hidden');
                    
                    // Contar caminhões por proprietário
                    const proprietarios = {};
                    this.data.caminhoesTerc.forEach(c => {
                        if (c.proprietario) {
                            const prop = c.proprietario;
                            if (!proprietarios[prop]) {
                                proprietarios[prop] = {
                                    total: 0,
                                    operational: 0,
                                    maintenance: 0
                                };
                            }
                            
                            proprietarios[prop].total++;
                            if (c.status === 'Operacional') {
                                proprietarios[prop].operational++;
                            } else if (c.status === 'Em manutenção') {
                                proprietarios[prop].maintenance++;
                            }
                        }
                    });
                    
                    // Filtrar proprietários que tem caminhões em manutenção
                    const proprietariosComManutencao = Object.keys(proprietarios)
                        .filter(p => proprietarios[p].maintenance > 0)
                        .sort((a, b) => proprietarios[b].maintenance - proprietarios[a].maintenance);
                    
                    // Pegar os 5 proprietários com mais caminhões em manutenção
                    const top5Proprietarios = proprietariosComManutencao.slice(0, 5);
                    
                    // Dados para o gráfico de proprietários
                    const labels = top5Proprietarios;
                    const data = top5Proprietarios.map(p => proprietarios[p].total);
                    
                    const ownersCtx = document.getElementById('ct-owners-chart').getContext('2d');
                    this.data.charts.ctOwnersChart = new Chart(ownersCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Caminhões',
                                data: data,
                                backgroundColor: '#3B82F6',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                        stepSize: 1
                                    }
                                },
                                y: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                    
                    // Dados para gráfico de status por proprietário
                    const statusLabels = top5Proprietarios.map(p => p.length > 10 ? p.substring(0, 10) + '...' : p);
                    const operationalData = top5Proprietarios.map(p => proprietarios[p].operational);
                    const maintenanceData = top5Proprietarios.map(p => proprietarios[p].maintenance);
                    
                    const statusByOwnerCtx = document.getElementById('ct-status-by-owner-chart').getContext('2d');
                    this.data.charts.ctStatusByOwnerChart = new Chart(statusByOwnerCtx, {
                        type: 'bar',
                        data: {
                            labels: statusLabels,
                            datasets: [
                                {
                                    label: 'Operacional',
                                    data: operationalData,
                                    backgroundColor: '#10B981',
                                    borderWidth: 1
                                },
                                {
                                    label: 'Em manutenção',
                                    data: maintenanceData,
                                    backgroundColor: '#F59E0B',
                                    borderWidth: 1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                    },
                                    ticks: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                        stepSize: 1
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar contadores
                const totalCTs = this.data.caminhoesTerc.length;
                const operacionalCount = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const manutencaoCount = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const proprietariosCount = new Set(this.data.caminhoesTerc.map(c => c.proprietario)).size;
                const reboquesCount = this.data.caminhoesTerc.filter(c => c.reboques && c.reboques.trim() !== '').length;
                
                document.getElementById('ct-operational').textContent = operacionalCount;
                document.getElementById('ct-maintenance').textContent = manutencaoCount;
                document.getElementById('ct-owners').textContent = proprietariosCount;
                document.getElementById('ct-coupled-trailers').textContent = reboquesCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalCTs > 0 ? Math.round((operacionalCount / totalCTs) * 100) : 0;
                const manutencaoPercentage = totalCTs > 0 ? Math.round((manutencaoCount / totalCTs) * 100) : 0;
                
                document.getElementById('ct-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('ct-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
            },
            
            // Inicializar gráficos para frente 4001
            initializeFrente4001Charts() {
                // Dados combinados para colhedoras e trações
                const equipamentos = [...this.data.frente4001Colhedoras, ...this.data.frente4001Tracoes];
                
                // Verificar se há equipamentos em manutenção
                const equipamentosParados = equipamentos.filter(e => e.status !== 'Operacional');
                
                if (equipamentosParados.length === 0) {
                    document.getElementById('f4001-status-no-data').classList.remove('hidden');
                    document.getElementById('f4001-breakdown-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('f4001-status-no-data').classList.add('hidden');
                    document.getElementById('f4001-breakdown-no-data').classList.add('hidden');
                    
                    // Dados para gráfico de status
                    const statusData = {
                        operational: equipamentos.filter(e => e.status === 'Operacional').length,
                        maintenance: equipamentos.filter(e => e.status === 'Em manutenção').length,
                        inoperative: equipamentos.filter(e => e.status === 'Inoperante').length,
                        other: equipamentos.filter(e => !['Operacional', 'Em manutenção', 'Inoperante'].includes(e.status)).length
                    };
                    
                    const statusCtx = document.getElementById('f4001-status-chart').getContext('2d');
                    this.data.charts.f4001StatusChart = new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacional', 'Em manutenção', 'Inoperante', 'Outros'],
                            datasets: [{
                                data: [statusData.operational, statusData.maintenance, statusData.inoperative, statusData.other],
                                backgroundColor: [
                                    '#10B981', // Verde
                                    '#F59E0B', // Amarelo
                                    '#EF4444', // Vermelho
                                    '#3B82F6'  // Azul
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = Math.round((value / total) * 100);
                                            return `${label}: ${value} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                    
                    // Dados para gráfico de motivos de parada
                    // Agrupar motivos semelhantes e contar ocorrências
                    const breakdownReasons = {};
                    equipamentosParados.forEach(e => {
                        if (e.motivo) {
                            const motivo = e.motivo.toLowerCase();
                            let categoria = 'Outros';
                            
                            if (motivo.includes('motor') || motivo.includes('cambio') || motivo.includes('transmiss')) {
                                categoria = 'Motor/Transmissão';
                            } else if (motivo.includes('hidrau') || motivo.includes('fluido')) {
                                categoria = 'Sistema Hidráulico';
                            } else if (motivo.includes('eletric') || motivo.includes('eletr') || motivo.includes('bateria')) {
                                categoria = 'Sistema Elétrico';
                            } else if (motivo.includes('pneu') || motivo.includes('roda') || motivo.includes('suspens')) {
                                categoria = 'Rodagem/Suspensão';
                            } else if (motivo.includes('preventiva') || motivo.includes('revisão') || motivo.includes('revisao')) {
                                categoria = 'Manutenção Preventiva';
                            }
                            
                            if (!breakdownReasons[categoria]) {
                                breakdownReasons[categoria] = 0;
                            }
                            breakdownReasons[categoria]++;
                        }
                    });
                    
                    const breakdownLabels = Object.keys(breakdownReasons);
                    const breakdownData = Object.values(breakdownReasons);
                    
                    const breakdownCtx = document.getElementById('f4001-breakdown-chart').getContext('2d');
                    this.data.charts.f4001BreakdownChart = new Chart(breakdownCtx, {
                        type: 'pie',
                        data: {
                            labels: breakdownLabels,
                            datasets: [{
                                data: breakdownData,
                                backgroundColor: [
                                    '#EF4444', // Vermelho
                                    '#F59E0B', // Amarelo
                                    '#3B82F6', // Azul
                                    '#8B5CF6', // Roxo
                                    '#10B981', // Verde
                                    '#6B7280'  // Cinza
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar contadores
                const totalColhedoras = this.data.frente4001Colhedoras.length;
                const colhedorasOk = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4001Tracoes.length;
                const tracoesOk = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                       this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('f4001-colhedoras-ok').textContent = colhedorasOk;
                document.getElementById('f4001-tracoes-ok').textContent = tracoesOk;
                document.getElementById('f4001-maintenance').textContent = totalMaintenance;
                
                // Calcular percentuais
                const colhedorasPercentage = totalColhedoras > 0 ? Math.round((colhedorasOk / totalColhedoras) * 100) : 0;
                const tracoesPercentage = totalTracoes > 0 ? Math.round((tracoesOk / totalTracoes) * 100) : 0;
                const maintenancePercentage = (totalColhedoras + totalTracoes) > 0 ? 
                    Math.round((totalMaintenance / (totalColhedoras + totalTracoes)) * 100) : 0;
                
                document.getElementById('f4001-colhedoras-percentage').textContent = `${colhedorasPercentage}%`;
                document.getElementById('f4001-tracoes-percentage').textContent = `${tracoesPercentage}%`;
                document.getElementById('f4001-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                
                // Calcular disponibilidade
                const totalEquipamento = totalColhedoras + totalTracoes;
                const totalOperacional = colhedorasOk + tracoesOk;
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                document.getElementById('f4001-availability').textContent = `${availability}%`;
            },
            
            // Inicializar gráficos para frente 4002
            initializeFrente4002Charts() {
                // Dados combinados para colhedoras e trações
                const equipamentos = [...this.data.frente4002Colhedoras, ...this.data.frente4002Tracoes];
                
                // Verificar se há equipamentos em manutenção
                const equipamentosParados = equipamentos.filter(e => e.status !== 'Operacional');
                
                if (equipamentosParados.length === 0) {
                    document.getElementById('f4002-status-no-data').classList.remove('hidden');
                    document.getElementById('f4002-breakdown-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('f4002-status-no-data').classList.add('hidden');
                    document.getElementById('f4002-breakdown-no-data').classList.add('hidden');
                    
                    // Dados para gráfico de status
                    const statusData = {
                        operational: equipamentos.filter(e => e.status === 'Operacional').length,
                        maintenance: equipamentos.filter(e => e.status === 'Em manutenção').length,
                        base: equipamentos.filter(e => e.status === 'Na base').length,
                        other: equipamentos.filter(e => !['Operacional', 'Em manutenção', 'Na base'].includes(e.status)).length
                    };
                    
                    const statusCtx = document.getElementById('f4002-status-chart').getContext('2d');
                    this.data.charts.f4002StatusChart = new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacional', 'Em manutenção', 'Na base', 'Outros'],
                            datasets: [{
                                data: [statusData.operational, statusData.maintenance, statusData.base, statusData.other],
                                backgroundColor: [
                                    '#10B981', // Verde
                                    '#F59E0B', // Amarelo
                                    '#3B82F6', // Azul
                                    '#6B7280'  // Cinza
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = Math.round((value / total) * 100);
                                            return `${label}: ${value} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                    
                    // Dados para gráfico de motivos de parada
                    // Agrupar motivos semelhantes e contar ocorrências
                    const breakdownReasons = {};
                    equipamentosParados.forEach(e => {
                        if (e.motivo) {
                            const motivo = e.motivo.toLowerCase();
                            let categoria = 'Outros';
                            
                            if (motivo.includes('diferencial') || motivo.includes('cardan')) {
                                categoria = 'Diferencial/Cardan';
                            } else if (motivo.includes('hidrau') || motivo.includes('fluido')) {
                                categoria = 'Sistema Hidráulico';
                            } else if (motivo.includes('motor') || motivo.includes('radiador')) {
                                categoria = 'Motor/Refrigeração';
                            } else if (motivo.includes('base')) {
                                categoria = 'Na Base';
                            } else if (motivo.includes('reserva')) {
                                categoria = 'Reserva';
                            }
                            
                            if (!breakdownReasons[categoria]) {
                                breakdownReasons[categoria] = 0;
                            }
                            breakdownReasons[categoria]++;
                        }
                    });
                    
                    const breakdownLabels = Object.keys(breakdownReasons);
                    const breakdownData = Object.values(breakdownReasons);
                    
                    const breakdownCtx = document.getElementById('f4002-breakdown-chart').getContext('2d');
                    this.data.charts.f4002BreakdownChart = new Chart(breakdownCtx, {
                        type: 'pie',
                        data: {
                            labels: breakdownLabels,
                            datasets: [{
                                data: breakdownData,
                                backgroundColor: [
                                    '#EF4444', // Vermelho
                                    '#F59E0B', // Amarelo
                                    '#3B82F6', // Azul
                                    '#8B5CF6', // Roxo
                                    '#10B981', // Verde
                                    '#6B7280'  // Cinza
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar contadores
                const totalColhedoras = this.data.frente4002Colhedoras.length;
                const colhedorasOk = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4002Tracoes.length;
                const tracoesOk = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                       this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('f4002-colhedoras-ok').textContent = colhedorasOk;
                document.getElementById('f4002-tracoes-ok').textContent = tracoesOk;
                document.getElementById('f4002-maintenance').textContent = totalMaintenance;
                
                // Calcular percentuais
                const colhedorasPercentage = totalColhedoras > 0 ? Math.round((colhedorasOk / totalColhedoras) * 100) : 0;
                const tracoesPercentage = totalTracoes > 0 ? Math.round((tracoesOk / totalTracoes) * 100) : 0;
                const maintenancePercentage = (totalColhedoras + totalTracoes) > 0 ? 
                    Math.round((totalMaintenance / (totalColhedoras + totalTracoes)) * 100) : 0;
                
                document.getElementById('f4002-colhedoras-percentage').textContent = `${colhedorasPercentage}%`;
                document.getElementById('f4002-tracoes-percentage').textContent = `${tracoesPercentage}%`;
                document.getElementById('f4002-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                
                // Calcular disponibilidade
                const totalEquipamento = totalColhedoras + totalTracoes;
                const totalOperacional = colhedorasOk + tracoesOk;
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                document.getElementById('f4002-availability').textContent = `${availability}%`;
            },
            
            // Atualizar todos os dashboards
            updateAllDashboards() {
                this.updateReboquesDashboard();
                this.updateCaminhoesPropriosDashboard();
                this.updateCaminhoesTercDashboard();
                this.updateFrente4001Dashboard();
                this.updateFrente4002Dashboard();
            },
            
            // Atualizar dashboard para reboques
            updateReboquesDashboard() {
                const totalReboques = this.data.reboques.length;
                const operacionalCount = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const manutencaoCount = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reformaCount = this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma').length;
                
                document.getElementById('reboques-operational').textContent = operacionalCount;
                document.getElementById('reboques-maintenance').textContent = manutencaoCount;
                document.getElementById('reboques-reform').textContent = reformaCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalReboques > 0 ? Math.round((operacionalCount / totalReboques) * 100) : 0;
                const manutencaoPercentage = totalReboques > 0 ? Math.round((manutencaoCount / totalReboques) * 100) : 0;
                const reformaPercentage = totalReboques > 0 ? Math.round((reformaCount / totalReboques) * 100) : 0;
                
                document.getElementById('reboques-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('reboques-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
                document.getElementById('reboques-reform-percentage').textContent = `${reformaPercentage}%`;
                
                // Calcular disponibilidade
                const availability = totalReboques > 0 ? Math.round((operacionalCount / totalReboques) * 100) : 0;
                document.getElementById('reboques-availability').textContent = `${availability}%`;
                
                // Verificar se o gráfico já existe e tem dados para atualizar
                if (this.data.charts.reboquesStatusChart) {
                    const statusChart = this.data.charts.reboquesStatusChart;
                    statusChart.data.datasets[0].data = [operacionalCount, manutencaoCount, reformaCount, totalReboques - operacionalCount - manutencaoCount - reformaCount];
                    statusChart.update();
                }
                
                // Verificar se há equipamentos em manutenção/reforma
                const emManutencaoOuReforma = manutencaoCount > 0 || reformaCount > 0;
                if (emManutencaoOuReforma) {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                }
                
                // Verificar se o gráfico de tendência já existe e tem dados para atualizar
                if (this.data.charts.reboquesMaintenanceTrendChart) {
                    // Reimplementar a mesma lógica para analisar dados apenas de períodos com paradas
                    const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                    const currentMonth = new Date().getMonth();
                    
                    // Analisar dados de parada por mês
                    const maintenanceByMonth = Array(12).fill(0);
                    const reformByMonth = Array(12).fill(0);
                    
                    // Contar equipamentos em manutenção e reforma por mês
                    this.data.reboques.forEach(item => {
                        if (item.dataParada) {
                            const date = new Date(item.dataParada);
                            const month = date.getMonth();
                            
                            if (item.status === 'Em manutenção') {
                                maintenanceByMonth[month]++;
                            } else if (item.status === 'Em reforma') {
                                reformByMonth[month]++;
                            }
                        }
                    });
                    
                    // Determinar quais meses têm dados (últimos 6 meses)
                    const activeMonths = [];
                    const labels = [];
                    const maintenanceData = [];
                    const reformData = [];
                    
                    for (let i = currentMonth - 5; i <= currentMonth; i++) {
                        const monthIndex = i < 0 ? i + 12 : i;
                        if (maintenanceByMonth[monthIndex] > 0 || reformByMonth[monthIndex] > 0) {
                            activeMonths.push(monthIndex);
                            labels.push(months[monthIndex]);
                            maintenanceData.push(maintenanceByMonth[monthIndex]);
                            reformData.push(reformByMonth[monthIndex]);
                        }
                    }
                    
                    // Se não houver dados, mostrar mensagem de sem dados
                    if (activeMonths.length === 0) {
                        document.getElementById('reboques-trend-no-data').classList.remove('hidden');
                    } else {
                        document.getElementById('reboques-trend-no-data').classList.add('hidden');
                        
                        // Atualizar gráfico de tendências
                        const trendChart = this.data.charts.reboquesMaintenanceTrendChart;
                        trendChart.data.labels = labels;
                        trendChart.data.datasets[0].data = maintenanceData;
                        trendChart.data.datasets[1].data = reformData;
                        trendChart.update();
                    }
                }
            },
            
            // Atualizar dashboard para caminhões próprios
            updateCaminhoesPropriosDashboard() {
                const totalCPs = this.data.caminhoesProps.length;
                const operacionalCount = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const manutencaoCount = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma').length;
                const borrowedCount = this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length;
                
                document.getElementById('cp-operational').textContent = operacionalCount;
                document.getElementById('cp-maintenance').textContent = manutencaoCount;
                document.getElementById('cp-borrowed').textContent = borrowedCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalCPs > 0 ? Math.round((operacionalCount / totalCPs) * 100) : 0;
                const manutencaoPercentage = totalCPs > 0 ? Math.round((manutencaoCount / totalCPs) * 100) : 0;
                const borrowedPercentage = totalCPs > 0 ? Math.round((borrowedCount / totalCPs) * 100) : 0;
                
                document.getElementById('cp-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('cp-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
                document.getElementById('cp-borrowed-percentage').textContent = `${borrowedPercentage}%`;
                
                // Verificar se há equipamentos em manutenção/emprestados
                const emManutencaoOuEmprestado = manutencaoCount > 0 || borrowedCount > 0;
                
                if (emManutencaoOuEmprestado && this.data.charts.cpStatusChart) {
                    document.getElementById('cp-status-no-data').classList.add('hidden');
                    
                    const statusChart = this.data.charts.cpStatusChart;
                    const otherCount = totalCPs - operacionalCount - manutencaoCount - borrowedCount;
                    statusChart.data.datasets[0].data = [operacionalCount, manutencaoCount, borrowedCount, otherCount];
                    statusChart.update();
                } else {
                    document.getElementById('cp-status-no-data').classList.remove('hidden');
                }
                
                // Atualizar gráfico de evolução se existir
                if (this.data.charts.cpStatusEvolutionChart) {
                    // Analisar dados de evolução
                    const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'];
                    const currentMonth = new Date().getMonth();
                    
                    // Analisar dados de parada por mês
                    const maintenanceByMonth = Array(6).fill(0);
                    const borrowedByMonth = Array(6).fill(0);
                    
                    // Contar caminhões por status e mês
                    this.data.caminhoesProps.forEach(item => {
                        if (item.data) {
                            const date = new Date(item.data);
                            const month = date.getMonth();
                            const monthIndex = month <= currentMonth ? 5 - (currentMonth - month) : 5 - (12 + currentMonth - month);
                            
                            if (monthIndex >= 0 && monthIndex < 6) {
                                if (item.status === 'Em manutenção' || item.status === 'Em reforma') {
                                    maintenanceByMonth[monthIndex]++;
                                } else if (item.status === 'Emprestado') {
                                    borrowedByMonth[monthIndex]++;
                                }
                            }
                        }
                    });
                    
                    // Calcular caminhões operacionais
                    const operationalByMonth = Array(6).fill(0);
                    for (let i = 0; i < 6; i++) {
                        operationalByMonth[i] = totalCPs - maintenanceByMonth[i] - borrowedByMonth[i];
                    }
                    
                    // Verificar se há dados para a evolução
                    const hasEvolutionData = maintenanceByMonth.some(val => val > 0) || borrowedByMonth.some(val => val > 0);
                    
                    if (hasEvolutionData) {
                        document.getElementById('cp-evolution-no-data').classList.add('hidden');
                        
                        // Criar labels para os meses
                        const labels = [];
                        for (let i = 5; i >= 0; i--) {
                            const monthIndex = (currentMonth - i + 12) % 12;
                            labels.push(months[monthIndex]);
                        }
                        
                        const evolutionChart = this.data.charts.cpStatusEvolutionChart;
                        evolutionChart.data.labels = labels;
                        evolutionChart.data.datasets[0].data = operationalByMonth;
                        evolutionChart.data.datasets[1].data = maintenanceByMonth;
                        evolutionChart.data.datasets[2].data = borrowedByMonth;
                        evolutionChart.update();
                    } else {
                        document.getElementById('cp-evolution-no-data').classList.remove('hidden');
                    }
                }
            },
            
            // Atualizar dashboard para caminhões terceiros
            updateCaminhoesTercDashboard() {
                const totalCTs = this.data.caminhoesTerc.length;
                const operacionalCount = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const manutencaoCount = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const proprietariosCount = new Set(this.data.caminhoesTerc.map(c => c.proprietario)).size;
                const reboquesCount = this.data.caminhoesTerc.filter(c => c.reboques && c.reboques.trim() !== '').length;
                
                document.getElementById('ct-operational').textContent = operacionalCount;
                document.getElementById('ct-maintenance').textContent = manutencaoCount;
                document.getElementById('ct-owners').textContent = proprietariosCount;
                document.getElementById('ct-coupled-trailers').textContent = reboquesCount;
                
                // Calcular percentuais
                const operacionalPercentage = totalCTs > 0 ? Math.round((operacionalCount / totalCTs) * 100) : 0;
                const manutencaoPercentage = totalCTs > 0 ? Math.round((manutencaoCount / totalCTs) * 100) : 0;
                
                document.getElementById('ct-operational-percentage').textContent = `${operacionalPercentage}%`;
                document.getElementById('ct-maintenance-percentage').textContent = `${manutencaoPercentage}%`;
                
                // Verificar se temos proprietários com equipamentos em manutenção
                const proprietariosComManutencao = this.data.caminhoesTerc
                    .filter(c => c.status === 'Em manutenção')
                    .map(c => c.proprietario);
                
                const temProprietariosComManutencao = proprietariosComManutencao.length > 0;
                
                // Atualizar gráficos apenas se houver dados de manutenção
                if (temProprietariosComManutencao) {
                    document.getElementById('ct-owners-no-data').classList.add('hidden');
                    document.getElementById('ct-status-no-data').classList.add('hidden');
                    
                    if (this.data.charts.ctOwnersChart && this.data.charts.ctStatusByOwnerChart) {
                        // Contar caminhões por proprietário
                        const proprietarios = {};
                        this.data.caminhoesTerc.forEach(c => {
                            if (c.proprietario) {
                                const prop = c.proprietario;
                                if (!proprietarios[prop]) {
                                    proprietarios[prop] = {
                                        total: 0,
                                        operational: 0,
                                        maintenance: 0
                                    };
                                }
                                
                                proprietarios[prop].total++;
                                if (c.status === 'Operacional') {
                                    proprietarios[prop].operational++;
                                } else if (c.status === 'Em manutenção') {
                                    proprietarios[prop].maintenance++;
                                }
                            }
                        });
                        
                        // Filtrar proprietários que tem caminhões em manutenção
                        const proprietariosComManutencao = Object.keys(proprietarios)
                            .filter(p => proprietarios[p].maintenance > 0)
                            .sort((a, b) => proprietarios[b].maintenance - proprietarios[a].maintenance);
                        
                        // Pegar os 5 proprietários com mais caminhões em manutenção
                        const top5Proprietarios = proprietariosComManutencao.slice(0, 5);
                        
                        // Atualizar o gráfico de proprietários
                        const ownersChart = this.data.charts.ctOwnersChart;
                        ownersChart.data.labels = top5Proprietarios;
                        ownersChart.data.datasets[0].data = top5Proprietarios.map(p => proprietarios[p].total);
                        ownersChart.update();
                        
                        // Atualizar o gráfico de status por proprietário
                        const statusChart = this.data.charts.ctStatusByOwnerChart;
                        const statusLabels = top5Proprietarios.map(p => p.length > 10 ? p.substring(0, 10) + '...' : p);
                        statusChart.data.labels = statusLabels;
                        statusChart.data.datasets[0].data = top5Proprietarios.map(p => proprietarios[p].operational);
                        statusChart.data.datasets[1].data = top5Proprietarios.map(p => proprietarios[p].maintenance);
                        statusChart.update();
                    }
                } else {
                    document.getElementById('ct-owners-no-data').classList.remove('hidden');
                    document.getElementById('ct-status-no-data').classList.remove('hidden');
                }
            },
            
            // Atualizar dashboard para frente 4001
            updateFrente4001Dashboard() {
                // Dados combinados para colhedoras e trações
                const equipamentos = [...this.data.frente4001Colhedoras, ...this.data.frente4001Tracoes];
                
                // Atualizar contadores
                const totalColhedoras = this.data.frente4001Colhedoras.length;
                const colhedorasOk = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4001Tracoes.length;
                const tracoesOk = this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                       this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('f4001-colhedoras-ok').textContent = colhedorasOk;
                document.getElementById('f4001-tracoes-ok').textContent = tracoesOk;
                document.getElementById('f4001-maintenance').textContent = totalMaintenance;
                
                // Calcular percentuais
                const colhedorasPercentage = totalColhedoras > 0 ? Math.round((colhedorasOk / totalColhedoras) * 100) : 0;
                const tracoesPercentage = totalTracoes > 0 ? Math.round((tracoesOk / totalTracoes) * 100) : 0;
                const maintenancePercentage = (totalColhedoras + totalTracoes) > 0 ? 
                    Math.round((totalMaintenance / (totalColhedoras + totalTracoes)) * 100) : 0;
                
                document.getElementById('f4001-colhedoras-percentage').textContent = `${colhedorasPercentage}%`;
                document.getElementById('f4001-tracoes-percentage').textContent = `${tracoesPercentage}%`;
                document.getElementById('f4001-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                
                // Calcular disponibilidade
                const totalEquipamento = totalColhedoras + totalTracoes;
                const totalOperacional = colhedorasOk + tracoesOk;
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                document.getElementById('f4001-availability').textContent = `${availability}%`;
                
                // Verificar se há equipamentos em manutenção
                const equipamentosParados = equipamentos.filter(e => e.status !== 'Operacional');
                
                if (equipamentosParados.length === 0) {
                    document.getElementById('f4001-status-no-data').classList.remove('hidden');
                    document.getElementById('f4001-breakdown-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('f4001-status-no-data').classList.add('hidden');
                    document.getElementById('f4001-breakdown-no-data').classList.add('hidden');
                    
                    // Atualizar gráficos se já existirem
                    if (this.data.charts.f4001StatusChart) {
                        // Dados para gráfico de status
                        const statusData = {
                            operational: equipamentos.filter(e => e.status === 'Operacional').length,
                            maintenance: equipamentos.filter(e => e.status === 'Em manutenção').length,
                            inoperative: equipamentos.filter(e => e.status === 'Inoperante').length,
                            other: equipamentos.filter(e => !['Operacional', 'Em manutenção', 'Inoperante'].includes(e.status)).length
                        };
                        
                        const statusChart = this.data.charts.f4001StatusChart;
                        statusChart.data.datasets[0].data = [statusData.operational, statusData.maintenance, statusData.inoperative, statusData.other];
                        statusChart.update();
                    }
                    
                    if (this.data.charts.f4001BreakdownChart) {
                        // Dados para gráfico de motivos de parada
                        // Agrupar motivos semelhantes e contar ocorrências
                        const breakdownReasons = {};
                        equipamentosParados.forEach(e => {
                            if (e.motivo) {
                                const motivo = e.motivo.toLowerCase();
                                let categoria = 'Outros';
                                
                                if (motivo.includes('motor') || motivo.includes('cambio') || motivo.includes('transmiss')) {
                                    categoria = 'Motor/Transmissão';
                                } else if (motivo.includes('hidrau') || motivo.includes('fluido')) {
                                    categoria = 'Sistema Hidráulico';
                                } else if (motivo.includes('eletric') || motivo.includes('eletr') || motivo.includes('bateria')) {
                                    categoria = 'Sistema Elétrico';
                                } else if (motivo.includes('pneu') || motivo.includes('roda') || motivo.includes('suspens')) {
                                    categoria = 'Rodagem/Suspensão';
                                } else if (motivo.includes('preventiva') || motivo.includes('revisão') || motivo.includes('revisao')) {
                                    categoria = 'Manutenção Preventiva';
                                }
                                
                                if (!breakdownReasons[categoria]) {
                                    breakdownReasons[categoria] = 0;
                                }
                                breakdownReasons[categoria]++;
                            }
                        });
                        
                        const breakdownLabels = Object.keys(breakdownReasons);
                        const breakdownData = Object.values(breakdownReasons);
                        
                        const breakdownChart = this.data.charts.f4001BreakdownChart;
                        breakdownChart.data.labels = breakdownLabels;
                        breakdownChart.data.datasets[0].data = breakdownData;
                        breakdownChart.update();
                    }
                }
            },
            
            // Atualizar dashboard para frente 4002
            updateFrente4002Dashboard() {
                // Dados combinados para colhedoras e trações
                const equipamentos = [...this.data.frente4002Colhedoras, ...this.data.frente4002Tracoes];
                
                // Atualizar contadores
                const totalColhedoras = this.data.frente4002Colhedoras.length;
                const colhedorasOk = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length;
                
                const totalTracoes = this.data.frente4002Tracoes.length;
                const tracoesOk = this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const totalMaintenance = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                       this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                document.getElementById('f4002-colhedoras-ok').textContent = colhedorasOk;
                document.getElementById('f4002-tracoes-ok').textContent = tracoesOk;
                document.getElementById('f4002-maintenance').textContent = totalMaintenance;
                
                // Calcular percentuais
                const colhedorasPercentage = totalColhedoras > 0 ? Math.round((colhedorasOk / totalColhedoras) * 100) : 0;
                const tracoesPercentage = totalTracoes > 0 ? Math.round((tracoesOk / totalTracoes) * 100) : 0;
                const maintenancePercentage = (totalColhedoras + totalTracoes) > 0 ? 
                    Math.round((totalMaintenance / (totalColhedoras + totalTracoes)) * 100) : 0;
                
                document.getElementById('f4002-colhedoras-percentage').textContent = `${colhedorasPercentage}%`;
                document.getElementById('f4002-tracoes-percentage').textContent = `${tracoesPercentage}%`;
                document.getElementById('f4002-maintenance-percentage').textContent = `${maintenancePercentage}%`;
                
                // Calcular disponibilidade
                const totalEquipamento = totalColhedoras + totalTracoes;
                const totalOperacional = colhedorasOk + tracoesOk;
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                document.getElementById('f4002-availability').textContent = `${availability}%`;
                
                // Verificar se há equipamentos em manutenção
                const equipamentosParados = equipamentos.filter(e => e.status !== 'Operacional');
                
                if (equipamentosParados.length === 0) {
                    document.getElementById('f4002-status-no-data').classList.remove('hidden');
                    document.getElementById('f4002-breakdown-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('f4002-status-no-data').classList.add('hidden');
                    document.getElementById('f4002-breakdown-no-data').classList.add('hidden');
                    
                    // Atualizar gráficos se já existirem
                    if (this.data.charts.f4002StatusChart) {
                        // Dados para gráfico de status
                        const statusData = {
                            operational: equipamentos.filter(e => e.status === 'Operacional').length,
                            maintenance: equipamentos.filter(e => e.status === 'Em manutenção').length,
                            base: equipamentos.filter(e => e.status === 'Na base').length,
                            other: equipamentos.filter(e => !['Operacional', 'Em manutenção', 'Na base'].includes(e.status)).length
                        };
                        
                        const statusChart = this.data.charts.f4002StatusChart;
                        statusChart.data.datasets[0].data = [statusData.operational, statusData.maintenance, statusData.base, statusData.other];
                        statusChart.update();
                    }
                    
                    if (this.data.charts.f4002BreakdownChart) {
                        // Dados para gráfico de motivos de parada
                        // Agrupar motivos semelhantes e contar ocorrências
                        const breakdownReasons = {};
                        equipamentosParados.forEach(e => {
                            if (e.motivo) {
                                const motivo = e.motivo.toLowerCase();
                                let categoria = 'Outros';
                                
                                if (motivo.includes('diferencial') || motivo.includes('cardan')) {
                                    categoria = 'Diferencial/Cardan';
                                } else if (motivo.includes('hidrau') || motivo.includes('fluido')) {
                                    categoria = 'Sistema Hidráulico';
                                } else if (motivo.includes('motor') || motivo.includes('radiador')) {
                                    categoria = 'Motor/Refrigeração';
                                } else if (motivo.includes('base')) {
                                    categoria = 'Na Base';
                                } else if (motivo.includes('reserva')) {
                                    categoria = 'Reserva';
                                }
                                
                                if (!breakdownReasons[categoria]) {
                                    breakdownReasons[categoria] = 0;
                                }
                                breakdownReasons[categoria]++;
                            }
                        });
                        
                        const breakdownLabels = Object.keys(breakdownReasons);
                        const breakdownData = Object.values(breakdownReasons);
                        
                        const breakdownChart = this.data.charts.f4002BreakdownChart;
                        breakdownChart.data.labels = breakdownLabels;
                        breakdownChart.data.datasets[0].data = breakdownData;
                        breakdownChart.update();
                    }
                }
            },
            
            // Atualizar cores dos gráficos com base no tema atual
            updateChartsTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                const fontColor = isDark ? '#E5E7EB' : '#1F2937';
                const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
                
                // Para cada gráfico existente
                Object.values(this.data.charts).forEach(chart => {
                    if (chart) {
                        // Atualizar opções de legenda
                        if (chart.options.plugins && chart.options.plugins.legend) {
                            chart.options.plugins.legend.labels.color = fontColor;
                        }
                        
                        // Atualizar opções de eixos
                        if (chart.options.scales) {
                            // Eixo Y
                            if (chart.options.scales.y) {
                                chart.options.scales.y.grid.color = gridColor;
                                chart.options.scales.y.ticks.color = fontColor;
                            }
                            
                            // Eixo X
                            if (chart.options.scales.x) {
                                chart.options.scales.x.grid.color = gridColor;
                                chart.options.scales.x.ticks.color = fontColor;
                            }
                        }
                        
                        // Atualizar gráfico
                        chart.update();
                    }
                });
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Atualizar cores dos gráficos com base no tema atual
                this.updateChartsTheme();
                
                // Atualizar dashboards específicos
                this.updateAllDashboards();
                
                // Atualizar gráficos do dashboard geral se estiver aberto
                this.updateDashboardCharts();
            },
            
            // Atualizar dashboard detalhado
            updateDashboardDetails() {
                // Contar totais por categoria
                const totalReboques = this.data.reboques.length;
                const totalCPs = this.data.caminhoesProps.length;
                const totalCTs = this.data.caminhoesTerc.length;
                const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                
                // Contar operacionais por categoria
                const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const opCPs = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const opCTs = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const opF4001 = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                              this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const opF4002 = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                              this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                // Calcular total de equipamentos
                const totalEquipamento = totalReboques + totalCPs + totalCTs + totalF4001 + totalF4002;
                const totalOperacional = opReboques + opCPs + opCTs + opF4001 + opF4002;
                
                // Calcular disponibilidade geral
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                // Contagem de equipamentos em manutenção
                const maintenanceCount = this.data.reboques.filter(r => r.status === 'Em manutenção' || r.status === 'Em reforma').length +
                                      this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma').length +
                                      this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length +
                                      this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                      this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length +
                                      this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                      this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                
                // Equipamentos críticos (em manutenção há mais de 10 dias)
                const today = new Date();
                const tenDaysAgo = new Date();
                tenDaysAgo.setDate(tenDaysAgo.getDate() - 10);
                
                const criticalCount = this.data.reboques.filter(r => {
                    if (r.status !== 'Em manutenção' && r.status !== 'Em reforma') return false;
                    if (!r.dataParada) return false;
                    const dataParada = new Date(r.dataParada);
                    return dataParada <= tenDaysAgo;
                }).length +
                this.data.caminhoesProps.filter(c => {
                    if (c.status !== 'Em manutenção' && c.status !== 'Em reforma') return false;
                    if (!c.data) return false;
                    const dataParada = new Date(c.data);
                    return dataParada <= tenDaysAgo;
                }).length +
                this.data.frente4001Colhedoras.filter(c => {
                    if (c.status !== 'Em manutenção') return false;
                    if (!c.data) return false;
                    const dataParada = new Date(c.data);
                    return dataParada <= tenDaysAgo;
                }).length +
                this.data.frente4001Tracoes.filter(t => {
                    if (t.status !== 'Em manutenção') return false;
                    if (!t.data) return false;
                    const dataParada = new Date(t.data);
                    return dataParada <= tenDaysAgo;
                }).length +
                this.data.frente4002Colhedoras.filter(c => {
                    if (c.status !== 'Em manutenção') return false;
                    if (!c.data) return false;
                    const dataParada = new Date(c.data);
                    return dataParada <= tenDaysAgo;
                }).length +
                this.data.frente4002Tracoes.filter(t => {
                    if (t.status !== 'Em manutenção') return false;
                    if (!t.data) return false;
                    const dataParada = new Date(t.data);
                    return dataParada <= tenDaysAgo;
                }).length;
                
                // Atualizar elementos do dashboard
                document.getElementById('dash-availability').textContent = `${availability}%`;
                document.getElementById('dash-avg-maintenance').textContent = '4d';
                document.getElementById('dash-total-equipment').textContent = totalEquipamento;
                document.getElementById('dash-critical-equipment').textContent = criticalCount;
                
                // Top equipamentos em manutenção
                // Combinar todos os equipamentos
                const allEquipments = [
                    ...this.data.reboques.filter(r => r.status === 'Em manutenção' || r.status === 'Em reforma')
                        .map(r => ({ code: r.frota || r.acoplado, type: 'Reboque', status: r.status, motivo: r.motivo, data: r.dataParada })),
                    ...this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma')
                        .map(c => ({ code: c.caminhao, type: 'Caminhão Próprio', status: c.status, motivo: c.motivo, data: c.data })),
                    ...this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção')
                        .map(c => ({ code: c.caminhao, type: 'Caminhão Terceiro', status: c.status, motivo: c.motivo })),
                    ...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção')
                        .map(c => ({ code: c.codigo, type: 'Colhedora F4001', status: c.status, motivo: c.motivo, data: c.data })),
                    ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção')
                        .map(t => ({ code: t.codigo, type: 'Tração F4001', status: t.status, motivo: t.motivo, data: t.data })),
                    ...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção')
                        .map(c => ({ code: c.codigo, type: 'Colhedora F4002', status: c.status, motivo: c.motivo, data: c.data })),
                    ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção')
                        .map(t => ({ code: t.codigo, type: 'Tração F4002', status: t.status, motivo: t.motivo, data: t.data }))
                ];
                
                // Ordenar por data de parada (mais antiga primeiro)
                allEquipments.sort((a, b) => {
                    if (!a.data) return 1;
                    if (!b.data) return -1;
                    return new Date(a.data) - new Date(b.data);
                });
                
                // Pegar os 5 primeiros
                const top5Maintenance = allEquipments.slice(0, 5);
                
                const maintenanceList = document.getElementById('top-maintenance-list');
                maintenanceList.innerHTML = '';
                
                if (top5Maintenance.length === 0) {
                    maintenanceList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção.</span>
                        </li>
                    `;
                } else {
                    top5Maintenance.forEach(equipment => {
                        const itemHTML = document.createElement('li');
                        itemHTML.className = 'py-2 flex justify-between items-center';
                        
                        let duration = '';
                        if (equipment.data) {
                            const dataParada = new Date(equipment.data);
                            const diffTime = Math.abs(today - dataParada);
                            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                            duration = `${diffDays}d`;
                        }
                        
                        itemHTML.innerHTML = `
                            <div>
                                <p class="text-sm font-medium">${equipment.type} #${equipment.code}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">${equipment.motivo || 'Sem motivo registrado'}</p>
                            </div>
                            <span class="text-sm text-yellow-500 font-medium">${duration}</span>
                        `;
                        
                        maintenanceList.appendChild(itemHTML);
                    });
                }
                
                // Próximas manutenções agendadas
                const today2 = new Date();
                const futureSchedules = this.data.schedules
                    .filter(s => new Date(`${s.date}T${s.time}`) > today2)
                    .sort((a, b) => new Date(`${a.date}T${a.time}`) - new Date(`${b.date}T${b.time}`))
                    .slice(0, 5);
                
                const upcomingList = document.getElementById('upcoming-maintenance-list');
                upcomingList.innerHTML = '';
                
                if (futureSchedules.length === 0) {
                    upcomingList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                        </li>
                    `;
                } else {
                    futureSchedules.forEach(schedule => {
                        const scheduleDate = new Date(`${schedule.date}T${schedule.time}`);
                        const formattedDate = scheduleDate.toLocaleDateString('pt-BR');
                        const formattedTime = scheduleDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                        
                        const itemHTML = document.createElement('li');
                        itemHTML.className = 'py-2 flex justify-between items-center';
                        
                        itemHTML.innerHTML = `
                            <div>
                                <p class="text-sm font-medium">${schedule.equipmentType} #${schedule.equipment}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">${this.getMaintenanceTypeName(schedule.type)}</p>
                            </div>
                            <span class="text-sm text-blue-500 font-medium">${formattedDate} ${formattedTime}</span>
                        `;
                        
                        upcomingList.appendChild(itemHTML);
                    });
                }
            },
            
            // Atualizar gráficos do dashboard detalhado
            updateDashboardCharts() {
                const period = document.getElementById('dashboard-date-range').value;
                this.data.dashboardPeriod = period;
                
                // Aplicar filtros por período nos dados
                const today = new Date();
                let fromDate = new Date(0); // Unix epoch
                
                if (period === 'today') {
                    fromDate = new Date(today.setHours(0, 0, 0, 0));
                } else if (period === 'week') {
                    fromDate = new Date(today);
                    fromDate.setDate(fromDate.getDate() - 7);
                } else if (period === 'month') {
                    fromDate = new Date(today);
                    fromDate.setMonth(fromDate.getMonth() - 1);
                } else if (period === 'quarter') {
                    fromDate = new Date(today);
                    fromDate.setMonth(fromDate.getMonth() - 3);
                } else if (period === 'year') {
                    fromDate = new Date(today);
                    fromDate.setFullYear(fromDate.getFullYear() - 1);
                }
                
                // Filtrar equipamentos por período
                const filteredReboques = this.data.reboques.filter(r => {
                    if (!r.dataParada) return period === 'all';
                    return new Date(r.dataParada) >= fromDate;
                });
                
                const filteredCPs = this.data.caminhoesProps.filter(c => {
                    if (!c.data) return period === 'all';
                    return new Date(c.data) >= fromDate;
                });
                
                const filteredColhedoras4001 = this.data.frente4001Colhedoras.filter(c => {
                    if (!c.data) return period === 'all';
                    return new Date(c.data) >= fromDate;
                });
                
                const filteredTracoes4001 = this.data.frente4001Tracoes.filter(t => {
                    if (!t.data) return period === 'all';
                    return new Date(t.data) >= fromDate;
                });
                
                const filteredColhedoras4002 = this.data.frente4002Colhedoras.filter(c => {
                    if (!c.data) return period === 'all';
                    return new Date(c.data) >= fromDate;
                });
                
                const filteredTracoes4002 = this.data.frente4002Tracoes.filter(t => {
                    if (!t.data) return period === 'all';
                    return new Date(t.data) >= fromDate;
                });
                
                // Verificar se há dados para o gráfico de disponibilidade
                const hasMaintenanceData = filteredReboques.some(r => r.status === 'Em manutenção' || r.status === 'Em reforma') ||
                                         filteredCPs.some(c => c.status === 'Em manutenção' || c.status === 'Em reforma') ||
                                         filteredColhedoras4001.some(c => c.status === 'Em manutenção') ||
                                         filteredTracoes4001.some(t => t.status === 'Em manutenção') ||
                                         filteredColhedoras4002.some(c => c.status === 'Em manutenção') ||
                                         filteredTracoes4002.some(t => t.status === 'Em manutenção');
                
                // Gráfico de disponibilidade por categoria
                if (!hasMaintenanceData) {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('availability-no-data').classList.add('hidden');
                    
                    // Calcular disponibilidade por categoria
                    const totalReboques = this.data.reboques.length;
                    const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                    const availReboques = totalReboques > 0 ? Math.round((opReboques / totalReboques) * 100) : 0;
                    
                    const totalCPs = this.data.caminhoesProps.length;
                    const opCPs = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                    const availCPs = totalCPs > 0 ? Math.round((opCPs / totalCPs) * 100) : 0;
                    
                    const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                    const opF4001 = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                                  this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                    const availF4001 = totalF4001 > 0 ? Math.round((opF4001 / totalF4001) * 100) : 0;
                    
                    const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                    const opF4002 = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                                  this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                    const availF4002 = totalF4002 > 0 ? Math.round((opF4002 / totalF4002) * 100) : 0;
                    
                    // Criar ou atualizar o gráfico
                    const availCtx = document.getElementById('availability-chart').getContext('2d');
                    
                    if (this.data.charts.availabilityChart) {
                        // Atualizar gráfico existente
                        this.data.charts.availabilityChart.data.datasets[0].data = [availReboques, availCPs, availF4001, availF4002];
                        this.data.charts.availabilityChart.update();
                    } else {
                        // Criar novo gráfico
                        this.data.charts.availabilityChart = new Chart(availCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Reboques', 'Caminhões Próprios', 'Frente 4001', 'Frente 4002'],
                                datasets: [{
                                    label: 'Disponibilidade (%)',
                                    data: [availReboques, availCPs, availF4001, availF4002],
                                    backgroundColor: [
                                        '#10B981', // Verde
                                        '#3B82F6', // Azul
                                        '#F59E0B', // Amarelo
                                        '#6B7280'  // Cinza
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        max: 100,
                                        grid: {
                                            color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                        },
                                        ticks: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                        }
                                    },
                                    x: {
                                        grid: {
                                            display: false
                                        },
                                        ticks: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        display: false
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                const value = context.raw || 0;
                                                return `Disponibilidade: ${value}%`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                    }
                }
                
                // Gráfico de motivos de manutenção
                // Combinar todos os equipamentos em manutenção
                const maintenanceEquipments = [
                    ...filteredReboques.filter(r => r.status === 'Em manutenção' || r.status === 'Em reforma'),
                    ...filteredCPs.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma'),
                    ...filteredColhedoras4001.filter(c => c.status === 'Em manutenção'),
                    ...filteredTracoes4001.filter(t => t.status === 'Em manutenção'),
                    ...filteredColhedoras4002.filter(c => c.status === 'Em manutenção'),
                    ...filteredTracoes4002.filter(t => t.status === 'Em manutenção')
                ];
                
                if (maintenanceEquipments.length === 0) {
                    document.getElementById('maintenance-reasons-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('maintenance-reasons-no-data').classList.add('hidden');
                    
                    // Agrupar motivos semelhantes
                    const motivos = {};
                    maintenanceEquipments.forEach(equip => {
                        if (!equip.motivo && !equip.motivo) return;
                        
                        const motivo = (equip.motivo || '').toLowerCase();
                        let categoria = 'Outros';
                        
                        if (motivo.includes('motor') || motivo.includes('cambio') || motivo.includes('transmiss')) {
                            categoria = 'Motor/Transmissão';
                        } else if (motivo.includes('hidrau') || motivo.includes('fluido')) {
                            categoria = 'Sistema Hidráulico';
                        } else if (motivo.includes('eletric') || motivo.includes('eletr')) {
                            categoria = 'Sistema Elétrico';
                        } else if (motivo.includes('pneu') || motivo.includes('roda') || motivo.includes('suspens')) {
                            categoria = 'Rodagem/Suspensão';
                        } else if (motivo.includes('preventiva') || motivo.includes('revisão') || motivo.includes('revisao')) {
                            categoria = 'Manutenção Preventiva';
                        } else if (motivo.includes('cardan') || motivo.includes('diferencial')) {
                            categoria = 'Transmissão/Diferencial';
                        } else if (motivo.includes('freio')) {
                            categoria = 'Sistema de Freios';
                        } else if (motivo.includes('estrutura') || motivo.includes('chassi') || motivo.includes('travessa')) {
                            categoria = 'Estrutura/Chassi';
                        }
                        
                        if (!motivos[categoria]) {
                            motivos[categoria] = 0;
                        }
                        motivos[categoria]++;
                    });
                    
                    // Ordenar por quantidade
                    const sortedMotivos = Object.entries(motivos)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 5); // Top 5
                    
                    const labels = sortedMotivos.map(m => m[0]);
                    const data = sortedMotivos.map(m => m[1]);
                    
                    // Criar ou atualizar o gráfico
                    const reasonsCtx = document.getElementById('maintenance-reasons-chart').getContext('2d');
                    
                    if (this.data.charts.maintenanceReasonsChart) {
                        // Atualizar gráfico existente
                        this.data.charts.maintenanceReasonsChart.data.labels = labels;
                        this.data.charts.maintenanceReasonsChart.data.datasets[0].data = data;
                        this.data.charts.maintenanceReasonsChart.update();
                    } else {
                        // Criar novo gráfico
                        this.data.charts.maintenanceReasonsChart = new Chart(reasonsCtx, {
                            type: 'pie',
                            data: {
                                labels: labels,
                                datasets: [{
                                    data: data,
                                    backgroundColor: [
                                        '#EF4444', // Vermelho
                                        '#F59E0B', // Amarelo
                                        '#3B82F6', // Azul
                                        '#8B5CF6', // Roxo
                                        '#10B981', // Verde
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'right',
                                        labels: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                        }
                                    }
                                }
                            }
                        });
                    }
                }
                
                // Gráfico de tendências de status por semana
                // Obter datas das últimas 10 semanas
                const weeks = [];
                const now = new Date();
                
                for (let i = 9; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - (i * 7));
                    weeks.push(date.toISOString().substring(0, 10));
                }
                
                // Obter dados de status por semana
                const statusData = {
                    operational: Array(10).fill(0),
                    maintenance: Array(10).fill(0),
                    reform: Array(10).fill(0)
                };
                
                // Verificar se há dados de tendências no período filtrado
                let hasTrendData = false;
                
                // Analisar tendências para equipamentos em manutenção
                this.data.reboques
                    .filter(r => r.status === 'Em manutenção' || r.status === 'Em reforma')
                    .filter(r => r.dataParada && new Date(r.dataParada) >= fromDate)
                    .forEach(r => {
                        const dataParada = new Date(r.dataParada);
                        
                        // Encontrar a semana correspondente
                        for (let i = 0; i < weeks.length; i++) {
                            const weekStart = new Date(weeks[i]);
                            const weekEnd = new Date(weekStart);
                            weekEnd.setDate(weekEnd.getDate() + 7);
                            
                            if (dataParada >= weekStart && dataParada < weekEnd) {
                                if (r.status === 'Em manutenção') {
                                    statusData.maintenance[i]++;
                                } else if (r.status === 'Em reforma') {
                                    statusData.reform[i]++;
                                }
                                hasTrendData = true;
                                break;
                            }
                        }
                    });
                
                this.data.caminhoesProps
                    .filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma')
                    .filter(c => c.data && new Date(c.data) >= fromDate)
                    .forEach(c => {
                        const dataParada = new Date(c.data);
                        
                        // Encontrar a semana correspondente
                        for (let i = 0; i < weeks.length; i++) {
                            const weekStart = new Date(weeks[i]);
                            const weekEnd = new Date(weekStart);
                            weekEnd.setDate(weekEnd.getDate() + 7);
                            
                            if (dataParada >= weekStart && dataParada < weekEnd) {
                                if (c.status === 'Em manutenção') {
                                    statusData.maintenance[i]++;
                                } else if (c.status === 'Em reforma') {
                                    statusData.reform[i]++;
                                }
                                hasTrendData = true;
                                break;
                            }
                        }
                    });
                
                // Combinar dados de frentes
                const frentesEquipment = [
                    ...this.data.frente4001Colhedoras,
                    ...this.data.frente4001Tracoes,
                    ...this.data.frente4002Colhedoras,
                    ...this.data.frente4002Tracoes
                ];
                
                frentesEquipment
                    .filter(e => e.status === 'Em manutenção')
                    .filter(e => e.data && new Date(e.data) >= fromDate)
                    .forEach(e => {
                        const dataParada = new Date(e.data);
                        
                        // Encontrar a semana correspondente
                        for (let i = 0; i < weeks.length; i++) {
                            const weekStart = new Date(weeks[i]);
                            const weekEnd = new Date(weekStart);
                            weekEnd.setDate(weekEnd.getDate() + 7);
                            
                            if (dataParada >= weekStart && dataParada < weekEnd) {
                                statusData.maintenance[i]++;
                                hasTrendData = true;
                                break;
                            }
                        }
                    });
                
                // Formatar datas para exibição
                const formattedWeeks = weeks.map(w => {
                    const date = new Date(w);
                    return date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' });
                });
                
                // Criar ou atualizar o gráfico de tendências
                if (!hasTrendData) {
                    document.getElementById('status-trends-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('status-trends-no-data').classList.add('hidden');
                    
                    const trendsCtx = document.getElementById('status-trends-chart').getContext('2d');
                    
                    if (this.data.charts.statusTrendsChart) {
                        // Atualizar gráfico existente
                        this.data.charts.statusTrendsChart.data.labels = formattedWeeks;
                        this.data.charts.statusTrendsChart.data.datasets[0].data = statusData.maintenance;
                        this.data.charts.statusTrendsChart.data.datasets[1].data = statusData.reform;
                        this.data.charts.statusTrendsChart.update();
                    } else {
                        // Criar novo gráfico
                        this.data.charts.statusTrendsChart = new Chart(trendsCtx, {
                            type: 'line',
                            data: {
                                labels: formattedWeeks,
                                datasets: [
                                    {
                                        label: 'Em manutenção',
                                        data: statusData.maintenance,
                                        borderColor: '#F59E0B',
                                        backgroundColor: 'rgba(245, 158, 11, 0.2)',
                                        tension: 0.2,
                                        fill: true
                                    },
                                    {
                                        label: 'Em reforma',
                                        data: statusData.reform,
                                        borderColor: '#EF4444',
                                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                        tension: 0.2,
                                        fill: true
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        grid: {
                                            color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                        },
                                        ticks: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                            stepSize: 1
                                        }
                                    },
                                    x: {
                                        grid: {
                                            color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                        },
                                        ticks: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        position: 'top',
                                        labels: {
                                            color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                        }
                                    },
                                    tooltip: {
                                        callbacks: {
                                            title: function(tooltipItems) {
                                                const index = tooltipItems[0].dataIndex;
                                                return `Semana de ${weeks[index]}`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                    }
                }
                
                // Gráfico de propriedade dos equipamentos
                const ownCtx = document.getElementById('ownership-chart').getContext('2d');
                
                if (this.data.charts.ownershipChart) {
                    // Atualizar gráfico existente
                    this.data.charts.ownershipChart.update();
                } else {
                    // Criar novo gráfico
                    this.data.charts.ownershipChart = new Chart(ownCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Próprios', 'Terceiros'],
                            datasets: [{
                                data: [
                                    this.data.reboques.length + this.data.caminhoesProps.length + 
                                    this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length +
                                    this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length,
                                    this.data.caminhoesTerc.length
                                ],
                                backgroundColor: [
                                    '#3B82F6', // Azul
                                    '#8B5CF6'  // Roxo
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                    }
                                }
                            }
                        }
                    });
                }
            },
            
            // Inicializar visualização real dos equipamentos
            initializeRealEquipmentView() {
                this.filterRealEquipment('all');
            },
            
            // Filtrar visualização real dos equipamentos
            filterRealEquipment(filter) {
                const grid = document.getElementById('real-equipment-grid');
                grid.innerHTML = '';
                
                // Obter equipamentos conforme o filtro
                let equipamentos = [];
                
                if (filter === 'all' || filter === 'reboques') {
                    equipamentos = equipamentos.concat(this.data.reboques.map(r => ({
                        ...r,
                        type: 'Reboque',
                        id: r.frota || r.acoplado,
                        category: 'reboques'
                    })));
                }
                
                if (filter === 'all' || filter === 'caminhoes-proprios') {
                    equipamentos = equipamentos.concat(this.data.caminhoesProps.map(c => ({
                        ...c,
                        type: 'Caminhão Próprio',
                        id: c.caminhao,
                        category: 'caminhoes-proprios'
                    })));
                }
                
                if (filter === 'all' || filter === 'caminhoes-terceiros') {
                    equipamentos = equipamentos.concat(this.data.caminhoesTerc.map(c => ({
                        ...c,
                        type: 'Caminhão Terceiro',
                        id: c.caminhao,
                        category: 'caminhoes-terceiros'
                    })));
                }
                
                if (filter === 'all' || filter === 'frente-4001') {
                    equipamentos = equipamentos.concat(this.data.frente4001Colhedoras.map(c => ({
                        ...c,
                        type: 'Colhedora F4001',
                        id: c.codigo,
                        category: 'frente-4001'
                    })));
                    
                    equipamentos = equipamentos.concat(this.data.frente4001Tracoes.map(t => ({
                        ...t,
                        type: 'Tração F4001',
                        id: t.codigo,
                        category: 'frente-4001'
                    })));
                }
                
                if (filter === 'all' || filter === 'frente-4002') {
                    equipamentos = equipamentos.concat(this.data.frente4002Colhedoras.map(c => ({
                        ...c,
                        type: 'Colhedora F4002',
                        id: c.codigo,
                        category: 'frente-4002'
                    })));
                    
                    equipamentos = equipamentos.concat(this.data.frente4002Tracoes.map(t => ({
                        ...t,
                        type: 'Tração F4002',
                        id: t.codigo,
                        category: 'frente-4002'
                    })));
                }
                
                // Ordenar por status (não operacionais primeiro)
                equipamentos.sort((a, b) => {
                    if (a.status === 'Operacional' && b.status !== 'Operacional') return 1;
                    if (a.status !== 'Operacional' && b.status === 'Operacional') return -1;
                    return 0;
                });
                
                // Adicionar cartões de equipamento
                equipamentos.forEach(equipamento => {
                    let statusClass = '';
                    let statusIcon = '';
                    let cardClass = '';
                    
                    // Definir classe e ícone com base no status
                    if (equipamento.status === 'Operacional') {
                        statusClass = 'text-green-500';
                        statusIcon = 'fa-check-circle';
                        cardClass = 'operational';
                    } else if (equipamento.status === 'Em manutenção') {
                        statusClass = 'text-yellow-500';
                        statusIcon = 'fa-wrench';
                        cardClass = 'maintenance';
                    } else if (equipamento.status === 'Em reforma' || equipamento.status === 'Aguardando reforma') {
                        statusClass = 'text-red-500';
                        statusIcon = 'fa-tools';
                        cardClass = 'reform';
                    } else {
                        statusClass = 'text-blue-500';
                        statusIcon = 'fa-info-circle';
                        cardClass = 'other';
                    }
                    
                    // Identificar o tipo de ícone com base no tipo de equipamento
                    let equipmentIcon = '';
                    if (equipamento.type.includes('Reboque')) {
                        equipmentIcon = 'fa-trailer';
                    } else if (equipamento.type.includes('Caminhão')) {
                        equipmentIcon = 'fa-truck';
                    } else if (equipamento.type.includes('Colhedora')) {
                        equipmentIcon = 'fa-tractor';
                    } else {
                        equipmentIcon = 'fa-truck-monster';
                    }
                    
                    // Criar card do equipamento
                    const card = document.createElement('div');
                    card.className = `bg-white dark:bg-gray-700 rounded-lg shadow-md p-4 equipment-card ${cardClass}`;
                    card.innerHTML = `
                        <div class="flex items-center justify-center h-24 mb-2 bg-gray-100 dark:bg-gray-800 rounded-md">
                            <i class="fas ${equipmentIcon} text-4xl ${statusClass}"></i>
                        </div>
                        <div class="flex items-center mb-2">
                            <i class="fas ${statusIcon} ${statusClass} mr-2"></i>
                            <h3 class="font-medium">${equipamento.id}</h3>
                        </div>
                        <p class="text-sm text-gray-600 dark:text-gray-400">${equipamento.type}</p>
                        <p class="text-sm font-medium ${statusClass}">${equipamento.status}</p>
                        ${equipamento.status !== 'Operacional' ? `<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${equipamento.motivo || 'Sem motivo registrado'}</p>` : ''}
                    `;
                    
                    // Adicionar evento de clique
                    card.addEventListener('click', () => {
                        this.data.editingItem = equipamento;
                        this.data.editingType = equipamento.type;
                        this.showEquipmentDetails(equipamento.type, equipamento);
                    });
                    
                    grid.appendChild(card);
                });
                
                // Exibir mensagem se não houver equipamentos
                if (equipamentos.length === 0) {
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'col-span-full text-center p-8 text-gray-500 dark:text-gray-400';
                    emptyMessage.textContent = 'Nenhum equipamento encontrado para o filtro selecionado.';
                    grid.appendChild(emptyMessage);
                }
            },
            
            // Imprimir tabela ativa
            printActiveTable() {
                const printArea = document.getElementById('print-area');
                const printContent = document.getElementById('print-content');
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                
                // Determinar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                const tableId = activeTab.id;
                let title = '';
                
                switch (tableId) {
                    case 'reboques':
                        title = 'Relatório de Reboques';
                        break;
                    case 'caminhoes-proprios':
                        title = 'Relatório de Caminhões Próprios';
                        break;
                    case 'caminhoes-terceiros':
                        title = 'Relatório de Caminhões Terceiros';
                        break;
                    case 'frente-4001':
                        title = 'Relatório de Equipamentos Frente 4001';
                        break;
                    case 'frente-4002':
                        title = 'Relatório de Equipamentos Frente 4002';
                        break;
                }
                
                printTitle.textContent = title;
                
                // Data atual
                const today = new Date();
                printDate.textContent = `Gerado em: ${today.toLocaleDateString('pt-BR')} às ${today.toLocaleTimeString('pt-BR')}`;
                
                // Clonar a tabela atual
                const table = activeTab.querySelector('table').cloneNode(true);
                
                // Remover coluna de ações
                const rows = table.querySelectorAll('tr');
                rows.forEach(row => {
                    const cells = row.querySelectorAll('th, td');
                    if (cells.length > 0) {
                        cells[cells.length - 1].remove();
                    }
                });
                
                // Adicionar estatísticas básicas
                let statsHTML = '';
                
                if (tableId === 'reboques') {
                    const total = this.data.reboques.length;
                    const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                    const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                    const reform = this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma').length;
                    const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                    
                    statsHTML = `
                        <div class="mb-4 grid grid-cols-4 gap-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Total de Reboques</p>
                                <p class="text-xl font-bold">${total}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Operacionais</p>
                                <p class="text-xl font-bold">${operational} <span class="text-sm">(${Math.round(operational/total*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Em Manutenção</p>
                                <p class="text-xl font-bold">${maintenance} <span class="text-sm">(${Math.round(maintenance/total*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Disponibilidade</p>
                                <p class="text-xl font-bold">${availability}%</p>
                            </div>
                        </div>
                    `;
                } else if (tableId === 'caminhoes-proprios') {
                    const total = this.data.caminhoesProps.length;
                    const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                    const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma').length;
                    const borrowed = this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length;
                    const availability = total > 0 ? Math.round((operational / total) * 100) : 0;
                    
                    statsHTML = `
                        <div class="mb-4 grid grid-cols-4 gap-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Total de Caminhões</p>
                                <p class="text-xl font-bold">${total}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Operacionais</p>
                                <p class="text-xl font-bold">${operational} <span class="text-sm">(${Math.round(operational/total*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Em Manutenção</p>
                                <p class="text-xl font-bold">${maintenance} <span class="text-sm">(${Math.round(maintenance/total*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Emprestados</p>
                                <p class="text-xl font-bold">${borrowed} <span class="text-sm">(${Math.round(borrowed/total*100)}%)</span></p>
                            </div>
                        </div>
                    `;
                }
                
                // Adicionar ao conteúdo de impressão
                printContent.innerHTML = '';
                if (statsHTML) {
                    printContent.innerHTML = statsHTML;
                }
                printContent.appendChild(table);
                
                // Mostrar e imprimir
                printArea.classList.remove('hidden');
                setTimeout(() => {
                    window.print();
                    printArea.classList.add('hidden');
                }, 100);
            },
            
            // Exportar para CSV
            exportToCSV() {
                // Determinar a tabela ativa
                const activeTab = document.querySelector('.tab-content.active');
                const tableId = activeTab.id;
                let data = [];
                let filename = '';
                
                switch (tableId) {
                    case 'reboques':
                        data = this.data.reboques;
                        filename = 'reboques.csv';
                        break;
                    case 'caminhoes-proprios':
                        data = this.data.caminhoesProps;
                        filename = 'caminhoes-proprios.csv';
                        break;
                    case 'caminhoes-terceiros':
                        data = this.data.caminhoesTerc;
                        filename = 'caminhoes-terceiros.csv';
                        break;
                    case 'frente-4001':
                        // Combinar colhedoras e trações
                        data = [...this.data.frente4001Colhedoras.map(c => ({...c, type: 'Colhedora'})), 
                              ...this.data.frente4001Tracoes.map(t => ({...t, type: 'Tração'}))];
                        filename = 'frente-4001.csv';
                        break;
                    case 'frente-4002':
                        // Combinar colhedoras e trações
                        data = [...this.data.frente4002Colhedoras.map(c => ({...c, type: 'Colhedora'})), 
                              ...this.data.frente4002Tracoes.map(t => ({...t, type: 'Tração'}))];
                        filename = 'frente-4002.csv';
                        break;
                }
                
                // Filtrar dados conforme os filtros ativos
                data = this.filterData(data);
                
                // Ordenar dados
                data = this.sortData(data);
                
                // Converter para CSV
                const headers = Object.keys(data[0] || {}).join(',');
                const rows = data.map(item => Object.values(item).map(value => {
                    // Escapar aspas e valores com vírgulas
                    const valueStr = String(value || '');
                    return valueStr.includes(',') ? `"${valueStr.replace(/"/g, '""')}"` : valueStr;
                }).join(','));
                
                const csv = [headers, ...rows].join('\n');
                
                // Criar blob e link para download
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Exportação concluída', `Os dados foram exportados para ${filename}.`);
            },
            
            // Gerar relatório em PDF
            generatePDFReport() {
                const reportArea = document.getElementById('pdf-report-area');
                const reportContent = document.getElementById('pdf-report-content');
                const reportTitle = document.getElementById('pdf-report-title');
                const reportDate = document.getElementById('pdf-report-date');
                
                // Configurar título e data
                reportTitle.textContent = 'Relatório Completo de Frota';
                
                // Data atual
                const today = new Date();
                reportDate.textContent = `Gerado em: ${today.toLocaleDateString('pt-BR')} às ${today.toLocaleTimeString('pt-BR')}`;
                
                // Limpar conteúdo anterior
                reportContent.innerHTML = '';
                
                // Adicionar informações gerais
                const totalReboques = this.data.reboques.length;
                const totalCPs = this.data.caminhoesProps.length;
                const totalCTs = this.data.caminhoesTerc.length;
                const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const totalEquipamento = totalReboques + totalCPs + totalCTs + totalF4001 + totalF4002;
                
                const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const opCPs = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const opCTs = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const opF4001 = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                              this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const opF4002 = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                              this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const totalOperacional = opReboques + opCPs + opCTs + opF4001 + opF4002;
                
                const availability = totalEquipamento > 0 ? Math.round((totalOperacional / totalEquipamento) * 100) : 0;
                
                // Adicionar resumo geral
                reportContent.innerHTML += `
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold mb-3">Resumo Geral da Frota</h2>
                        <div class="grid grid-cols-3 gap-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Total de Equipamentos</p>
                                <p class="text-xl font-bold">${totalEquipamento}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Equipamentos Operacionais</p>
                                <p class="text-xl font-bold">${totalOperacional} <span class="text-sm">(${Math.round(totalOperacional/totalEquipamento*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Disponibilidade Geral</p>
                                <p class="text-xl font-bold">${availability}%</p>
                            </div>
                        </div>
                    </div>
                `;
                
                // Adicionar relatório detalhado por categoria
                
                // Reboques
                reportContent.innerHTML += `
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold mb-3">Relatório de Reboques</h2>
                        <div class="grid grid-cols-4 gap-4 mb-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Total</p>
                                <p class="text-xl font-bold">${totalReboques}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Operacionais</p>
                                <p class="text-xl font-bold">${opReboques} <span class="text-sm">(${Math.round(opReboques/totalReboques*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Em Manutenção</p>
                                <p class="text-xl font-bold">${this.data.reboques.filter(r => r.status === 'Em manutenção').length}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Em Reforma</p>
                                <p class="text-xl font-bold">${this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma').length}</p>
                            </div>
                        </div>
                        <h3 class="text-lg font-medium mb-2">Reboques em Manutenção/Reforma</h3>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Frota</th>
                                    <th class="border border-gray-300 p-2">Status</th>
                                    <th class="border border-gray-300 p-2">Motivo</th>
                                    <th class="border border-gray-300 p-2">Data de Parada</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.reboques
                                    .filter(r => r.status === 'Em manutenção' || r.status === 'Em reforma' || r.status === 'Aguardando reforma')
                                    .map(r => `
                                        <tr>
                                            <td class="border border-gray-300 p-2">${r.frota || r.acoplado || '-'}</td>
                                            <td class="border border-gray-300 p-2">${r.status}</td>
                                            <td class="border border-gray-300 p-2">${r.motivo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${r.dataParada ? new Date(r.dataParada).toLocaleDateString('pt-BR') : '-'}</td>
                                        </tr>
                                    `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="pdf-page-break"></div>
                `;
                
                // Caminhões Próprios
                reportContent.innerHTML += `
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold mb-3">Relatório de Caminhões Próprios</h2>
                        <div class="grid grid-cols-4 gap-4 mb-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Total</p>
                                <p class="text-xl font-bold">${totalCPs}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Operacionais</p>
                                <p class="text-xl font-bold">${opCPs} <span class="text-sm">(${Math.round(opCPs/totalCPs*100)}%)</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Em Manutenção</p>
                                <p class="text-xl font-bold">${this.data.caminhoesProps.filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma').length}</p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Emprestados</p>
                                <p class="text-xl font-bold">${this.data.caminhoesProps.filter(c => c.status === 'Emprestado').length}</p>
                            </div>
                        </div>
                        <h3 class="text-lg font-medium mb-2">Caminhões em Manutenção/Reforma</h3>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Caminhão</th>
                                    <th class="border border-gray-300 p-2">Status</th>
                                    <th class="border border-gray-300 p-2">Motivo</th>
                                    <th class="border border-gray-300 p-2">Data de Parada</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.caminhoesProps
                                    .filter(c => c.status === 'Em manutenção' || c.status === 'Em reforma')
                                    .map(c => `
                                        <tr>
                                            <td class="border border-gray-300 p-2">${c.caminhao || '-'}</td>
                                            <td class="border border-gray-300 p-2">${c.status}</td>
                                            <td class="border border-gray-300 p-2">${c.motivo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${c.data ? new Date(c.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        </tr>
                                    `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="pdf-page-break"></div>
                `;
                
                // Frentes de Colheita
                reportContent.innerHTML += `
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold mb-3">Relatório das Frentes de Colheita</h2>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Frente 4001</p>
                                <p class="text-xl font-bold">${Math.round(opF4001/totalF4001*100)}% <span class="text-sm">de disponibilidade</span></p>
                            </div>
                            <div class="p-3 bg-gray-100 rounded-md">
                                <p class="text-sm text-gray-600">Frente 4002</p>
                                <p class="text-xl font-bold">${Math.round(opF4002/totalF4002*100)}% <span class="text-sm">de disponibilidade</span></p>
                            </div>
                        </div>
                        <h3 class="text-lg font-medium mb-2">Equipamentos em Manutenção - Frente 4001</h3>
                        <table class="min-w-full border-collapse border border-gray-300 mb-4">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Código</th>
                                    <th class="border border-gray-300 p-2">Tipo</th>
                                    <th class="border border-gray-300 p-2">Status</th>
                                    <th class="border border-gray-300 p-2">Motivo</th>
                                    <th class="border border-gray-300 p-2">Data de Parada</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${[...this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({...c, tipo: 'Colhedora'})),
                                  ...this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({...t, tipo: 'Tração'}))]
                                    .map(e => `
                                        <tr>
                                            <td class="border border-gray-300 p-2">${e.codigo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${e.tipo}</td>
                                            <td class="border border-gray-300 p-2">${e.status}</td>
                                            <td class="border border-gray-300 p-2">${e.motivo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${e.data ? new Date(e.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        </tr>
                                    `).join('')}
                            </tbody>
                        </table>
                        <h3 class="text-lg font-medium mb-2">Equipamentos em Manutenção - Frente 4002</h3>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Código</th>
                                    <th class="border border-gray-300 p-2">Tipo</th>
                                    <th class="border border-gray-300 p-2">Status</th>
                                    <th class="border border-gray-300 p-2">Motivo</th>
                                    <th class="border border-gray-300 p-2">Data de Parada</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${[...this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').map(c => ({...c, tipo: 'Colhedora'})),
                                  ...this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').map(t => ({...t, tipo: 'Tração'}))]
                                    .map(e => `
                                        <tr>
                                            <td class="border border-gray-300 p-2">${e.codigo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${e.tipo}</td>
                                            <td class="border border-gray-300 p-2">${e.status}</td>
                                            <td class="border border-gray-300 p-2">${e.motivo || '-'}</td>
                                            <td class="border border-gray-300 p-2">${e.data ? new Date(e.data).toLocaleDateString('pt-BR') : '-'}</td>
                                        </tr>
                                    `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="pdf-page-break"></div>
                `;
                
                // Próximas Manutenções Agendadas
                reportContent.innerHTML += `
                    <div class="mb-6">
                        <h2 class="text-xl font-semibold mb-3">Próximas Manutenções Agendadas</h2>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Equipamento</th>
                                    <th class="border border-gray-300 p-2">Tipo</th>
                                    <th class="border border-gray-300 p-2">Data e Hora</th>
                                    <th class="border border-gray-300 p-2">Tipo de Manutenção</th>
                                    <th class="border border-gray-300 p-2">Responsável</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.data.schedules
                                    .filter(s => new Date(`${s.date}T${s.time}`) > new Date())
                                    .sort((a, b) => new Date(`${a.date}T${a.time}`) - new Date(`${b.date}T${b.time}`))
                                    .map(s => `
                                        <tr>
                                            <td class="border border-gray-300 p-2">${s.equipment}</td>
                                            <td class="border border-gray-300 p-2">${s.equipmentType}</td>
                                            <td class="border border-gray-300 p-2">${new Date(`${s.date}T${s.time}`).toLocaleString('pt-BR')}</td>
                                            <td class="border border-gray-300 p-2">${this.getMaintenanceTypeName(s.type)}</td>
                                            <td class="border border-gray-300 p-2">${s.responsible}</td>
                                        </tr>
                                    `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Mostrar e imprimir
                reportArea.classList.remove('hidden');
                setTimeout(() => {
                    window.print();
                    reportArea.classList.add('hidden');
                }, 100);
            },
            
            // Imprimir detalhes do equipamento
            printEquipmentDetails() {
                if (!this.data.editingItem || !this.data.editingType) return;
                
                const printArea = document.getElementById('print-area');
                const printContent = document.getElementById('print-content');
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                
                // Configurar título
                printTitle.textContent = `Detalhes do ${this.data.editingType} #${this.getEquipmentId(this.data.editingItem, this.data.editingType)}`;
                
                // Data atual
                const today = new Date();
                printDate.textContent = `Gerado em: ${today.toLocaleDateString('pt-BR')} às ${today.toLocaleTimeString('pt-BR')}`;
                
                // Copiar conteúdo do modal
                printContent.innerHTML = document.getElementById('modal-content').innerHTML;
                
                // Adicionar histórico completo
                const id = this.getEquipmentId(this.data.editingItem, this.data.editingType);
                const history = this.data.history[id] || [];
                
                if (history.length > 0) {
                    // Ordenar histórico por data (mais recente primeiro)
                    const sortedHistory = [...history].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    let historyHTML = `
                        <div class="mt-6">
                            <h3 class="text-lg font-semibold mb-3">Histórico Completo</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr class="bg-gray-200">
                                        <th class="border border-gray-300 p-2">Data</th>
                                        <th class="border border-gray-300 p-2">Status</th>
                                        <th class="border border-gray-300 p-2">Descrição</th>
                                        <th class="border border-gray-300 p-2">Usuário</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    sortedHistory.forEach(entry => {
                        historyHTML += `
                            <tr>
                                <td class="border border-gray-300 p-2">${new Date(entry.date).toLocaleDateString('pt-BR')}</td>
                                <td class="border border-gray-300 p-2">${entry.status}</td>
                                <td class="border border-gray-300 p-2">${entry.description}</td>
                                <td class="border border-gray-300 p-2">${entry.user}</td>
                            </tr>
                        `;
                    });
                    
                    historyHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                    
                    printContent.innerHTML += historyHTML;
                }
                
                // Adicionar manutenções agendadas
                const schedules = this.data.schedules.filter(s => s.equipment === id);
                
                if (schedules.length > 0) {
                    // Ordenar por data
                    const sortedSchedules = [...schedules].sort((a, b) => new Date(`${a.date}T${a.time}`) - new Date(`${b.date}T${b.time}`));
                    
                    let schedulesHTML = `
                        <div class="mt-6">
                            <h3 class="text-lg font-semibold mb-3">Manutenções Agendadas</h3>
                            <table class="min-w-full border-collapse border border-gray-300">
                                <thead>
                                    <tr class="bg-gray-200">
                                        <th class="border border-gray-300 p-2">Data e Hora</th>
                                        <th class="border border-gray-300 p-2">Tipo de Manutenção</th>
                                        <th class="border border-gray-300 p-2">Descrição</th>
                                        <th class="border border-gray-300 p-2">Responsável</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    sortedSchedules.forEach(schedule => {
                        schedulesHTML += `
                            <tr>
                                <td class="border border-gray-300 p-2">${new Date(`${schedule.date}T${schedule.time}`).toLocaleString('pt-BR')}</td>
                                <td class="border border-gray-300 p-2">${this.getMaintenanceTypeName(schedule.type)}</td>
                                <td class="border border-gray-300 p-2">${schedule.description}</td>
                                <td class="border border-gray-300 p-2">${schedule.responsible}</td>
                            </tr>
                        `;
                    });
                    
                    schedulesHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                    
                    printContent.innerHTML += schedulesHTML;
                }
                
                // Mostrar e imprimir
                printArea.classList.remove('hidden');
                setTimeout(() => {
                    window.print();
                    printArea.classList.add('hidden');
                }, 100);
            },
            
            // Imprimir dashboard detalhado
            printDashboard() {
                const printArea = document.getElementById('print-area');
                const printContent = document.getElementById('print-content');
                const printTitle = document.getElementById('print-title');
                const printDate = document.getElementById('print-date');
                
                // Configurar título
                printTitle.textContent = 'Dashboard Detalhado de Frota';
                
                // Data atual
                const today = new Date();
                printDate.textContent = `Gerado em: ${today.toLocaleDateString('pt-BR')} às ${today.toLocaleTimeString('pt-BR')}`;
                
                // Capturar as métricas do dashboard
                const availability = document.getElementById('dash-availability').textContent;
                const avgMaintenance = document.getElementById('dash-avg-maintenance').textContent;
                const totalEquipment = document.getElementById('dash-total-equipment').textContent;
                const criticalEquipment = document.getElementById('dash-critical-equipment').textContent;
                
                // Obter período selecionado
                const periodSelect = document.getElementById('dashboard-date-range');
                const periodText = periodSelect.options[periodSelect.selectedIndex].text;
                
                // Criar HTML para impressão
                let dashboardHTML = `
                    <div class="mb-4">
                        <h3 class="text-lg font-medium mb-2">Período: ${periodText}</h3>
                    </div>
                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="p-4 bg-gray-100 rounded-md border-l-4 border-green-500">
                            <p class="text-sm text-gray-600">Disponibilidade de Frota</p>
                            <p class="text-xl font-bold">${availability}</p>
                        </div>
                        <div class="p-4 bg-gray-100 rounded-md border-l-4 border-yellow-500">
                            <p class="text-sm text-gray-600">Tempo Médio de Manutenção</p>
                            <p class="text-xl font-bold">${avgMaintenance}</p>
                        </div>
                        <div class="p-4 bg-gray-100 rounded-md border-l-4 border-blue-500">
                            <p class="text-sm text-gray-600">Total de Equipamentos</p>
                            <p class="text-xl font-bold">${totalEquipment}</p>
                        </div>
                        <div class="p-4 bg-gray-100 rounded-md border-l-4 border-red-500">
                            <p class="text-sm text-gray-600">Equipamentos Críticos</p>
                            <p class="text-xl font-bold">${criticalEquipment}</p>
                        </div>
                    </div>
                `;
                
                // Top equipamentos em manutenção
                const maintenanceList = document.getElementById('top-maintenance-list').cloneNode(true);
                
                dashboardHTML += `
                    <div class="mb-6">
                        <h3 class="text-lg font-medium mb-2">Top 5 Equipamentos em Manutenção</h3>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Equipamento</th>
                                    <th class="border border-gray-300 p-2">Motivo</th>
                                    <th class="border border-gray-300 p-2">Tempo</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                const maintenanceItems = maintenanceList.querySelectorAll('li');
                maintenanceItems.forEach(item => {
                    if (!item.querySelector('.text-gray-500')) {
                        const equipName = item.querySelector('.font-medium').textContent;
                        const motivo = item.querySelector('.text-xs').textContent;
                        const tempo = item.querySelector('.text-yellow-500').textContent;
                        
                        dashboardHTML += `
                            <tr>
                                <td class="border border-gray-300 p-2">${equipName}</td>
                                <td class="border border-gray-300 p-2">${motivo}</td>
                                <td class="border border-gray-300 p-2">${tempo}</td>
                            </tr>
                        `;
                    }
                });
                
                dashboardHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Próximas manutenções agendadas
                const upcomingList = document.getElementById('upcoming-maintenance-list').cloneNode(true);
                
                dashboardHTML += `
                    <div class="mb-6">
                        <h3 class="text-lg font-medium mb-2">Próximas Manutenções Agendadas</h3>
                        <table class="min-w-full border-collapse border border-gray-300">
                            <thead>
                                <tr class="bg-gray-200">
                                    <th class="border border-gray-300 p-2">Equipamento</th>
                                    <th class="border border-gray-300 p-2">Tipo</th>
                                    <th class="border border-gray-300 p-2">Data e Hora</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                const upcomingItems = upcomingList.querySelectorAll('li');
                upcomingItems.forEach(item => {
                    if (!item.querySelector('.text-gray-500')) {
                        const equipName = item.querySelector('.font-medium').textContent;
                        const tipo = item.querySelector('.text-xs').textContent;
                        const dataHora = item.querySelector('.text-blue-500').textContent;
                        
                        dashboardHTML += `
                            <tr>
                                <td class="border border-gray-300 p-2">${equipName}</td>
                                <td class="border border-gray-300 p-2">${tipo}</td>
                                <td class="border border-gray-300 p-2">${dataHora}</td>
                            </tr>
                        `;
                    }
                });
                
                dashboardHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Adicionar ao conteúdo de impressão
                printContent.innerHTML = dashboardHTML;
                
                // Mostrar e imprimir
                printArea.classList.remove('hidden');
                setTimeout(() => {
                    window.print();
                    printArea.classList.add('hidden');
                }, 100);
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                // Limitar a 3 notificações simultâneas
                if (container.childElementCount >= 3) {
                    container.removeChild(container.firstChild);
                }
                
                const notification = document.createElement('div');
                notification.className = 'notification bg-white dark:bg-gray-700 shadow-lg rounded-lg p-4 mb-4 flex items-start max-w-sm';
                
                let iconClass = '';
                let headingClass = '';
                
                switch (type) {
                    case 'success':
                        iconClass = 'fas fa-check-circle text-green-500';
                        headingClass = 'text-green-500';
                        break;
                    case 'error':
                        iconClass = 'fas fa-exclamation-circle text-red-500';
                        headingClass = 'text-red-500';
                        break;
                    case 'warning':
                        iconClass = 'fas fa-exclamation-triangle text-yellow-500';
                        headingClass = 'text-yellow-500';
                        break;
                    case 'info':
                    default:
                        iconClass = 'fas fa-info-circle text-blue-500';
                        headingClass = 'text-blue-500';
                }
                
                notification.innerHTML = `
                    <div class="mr-3">
                        <i class="${iconClass} text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-medium ${headingClass} mb-1">${title}</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${message}</p>
                    </div>
                    <button class="close-notification ml-2 text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                container.appendChild(notification);
                
                // Remover após 5 segundos
                setTimeout(() => {
                    if (notification.parentNode === container) {
                        container.removeChild(notification);
                    }
                }, 5000);
            }
        };
        
        // Iniciar a aplicação
        document.addEventListener('DOMContentLoaded', () => {
            // Verificar tema
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            
            APP.init();
        });
    </script>
</body>
</html>
