<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Frota v4.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            
            .print-area, .print-area * {
                visibility: visible;
            }
            
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .no-print {
                display: none !important;
            }
            
            .pdf-page-break {
                page-break-after: always;
            }
            
            :root {
                --primary-color: #5D5CDE;
            }
            
            @page {
                size: A4;
                margin: 1cm;
            }
            
            .print-header {
                position: fixed;
                top: 0;
                width: 100%;
                border-bottom: 1px solid #ddd;
                padding-bottom: 5mm;
                margin-bottom: 5mm;
            }
            
            .print-footer {
                position: fixed;
                bottom: 0;
                width: 100%;
                border-top: 1px solid #ddd;
                padding-top: 5mm;
                font-size: 9pt;
                text-align: center;
                color: #666;
            }
            
            .print-content {
                margin-top: 25mm;
                margin-bottom: 20mm;
            }
            
            .report-chart {
                page-break-inside: avoid;
                height: 10cm !important;
            }
        }
        
        .notification {
            animation: slideIn 0.3s ease-in-out;
        }
        
        @keyframes slideIn {
            0% {
                transform: translateY(-100%);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .active-menu {
            border-left-color: var(--primary-color, #5D5CDE);
            color: var(--primary-color, #5D5CDE);
            background-color: rgba(93, 92, 222, 0.1);
        }
        
        .dark .active-menu {
            background-color: rgba(93, 92, 222, 0.2);
        }
        
        .card-icon {
            height: 40px;
            width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        
        .close-notification {
            cursor: pointer;
        }
        
        .equipment-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .equipment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        :root {
            --primary-color: #5D5CDE;
            --primary-dark: #4B48C7;
        }
        
        .bg-primary {
            background-color: var(--primary-color);
        }
        
        .bg-primary-dark {
            background-color: var(--primary-dark);
        }
        
        .text-primary {
            color: var(--primary-color);
        }
        
        .text-primary-dark {
            color: var(--primary-dark);
        }
        
        .border-primary {
            border-color: var(--primary-color);
        }
        
        .hover\:bg-primary:hover {
            background-color: var(--primary-color);
        }
        
        .hover\:text-primary:hover {
            color: var(--primary-color);
        }
        
        .hover\:text-primary-dark:hover {
            color: var(--primary-dark);
        }
        
        .hover\:border-primary:hover {
            border-color: var(--primary-color);
        }
        
        /* Indicadores de status */
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        
        .status-operational {
            background-color: #10B981;
        }
        
        .status-maintenance {
            background-color: #F59E0B;
        }
        
        .status-reform {
            background-color: #EF4444;
        }
        
        .status-other {
            background-color: #6B7280;
        }
        
        /* Badge de status */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-badge-operational {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }
        
        .dark .status-badge-operational {
            background-color: rgba(16, 185, 129, 0.2);
        }
        
        .status-badge-maintenance {
            background-color: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }
        
        .dark .status-badge-maintenance {
            background-color: rgba(245, 158, 11, 0.2);
        }
        
        .status-badge-reform {
            background-color: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }
        
        .dark .status-badge-reform {
            background-color: rgba(239, 68, 68, 0.2);
        }
        
        .status-badge-other {
            background-color: rgba(107, 114, 128, 0.1);
            color: #6B7280;
        }
        
        .dark .status-badge-other {
            background-color: rgba(107, 114, 128, 0.2);
        }

        /* Drag and drop para upload */
        .file-drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .file-drop-area.active {
            border-color: #5D5CDE;
            background-color: rgba(93, 92, 222, 0.05);
        }
        
        /* Animação de backup */
        @keyframes backup-animation {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .backup-animation {
            animation: backup-animation 1s ease-in-out;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4B48C7'
                    }
                }
            }
        };
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <div id="app" class="flex flex-col min-h-screen">
        <!-- Cabeçalho -->
        <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiIgZmlsbD0ibm9uZSI+PHBhdGggZD0iTTI2LjI1IDMuNzVIMTguNzVWMTEuMjVIMjYuMjVWMy43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMjYuMjUgMTEuMjVIMTguNzVWMTguNzVIMjYuMjVWMTEuMjVaIiBmaWxsPSIjNUQ1Q0RFIi8+PHBhdGggZD0iTTE4Ljc1IDExLjI1SDExLjI1VjE4Ljc1SDE4Ljc1VjExLjI1WiIgZmlsbD0iIzVENUNERSIvPjxwYXRoIGQ9Ik0xOC43NSAxOC43NUgxMS4yNVYyNi4yNUgxOC43NVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMTEuMjUgMTguNzVIMy43NVYyNi4yNUgxMS4yNVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48L3N2Zz4=" alt="Logo" class="h-8 w-8 mr-3">
                        <h1 class="text-xl font-bold text-primary">Sistema de Gestão de Frota</h1>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <button id="db-actions-btn" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-primary">
                                <i class="fas fa-database"></i>
                            </button>
                            <div id="db-actions-menu" class="absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-50">
                                <a href="#" id="backup-db-btn" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-download mr-2 text-primary"></i> Exportar Backup
                                </a>
                                <a href="#" id="import-db-btn" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-upload mr-2 text-primary"></i> Importar Dados
                                </a>
                                <a href="#" id="reset-db-btn" class="flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-trash-alt mr-2"></i> Limpar Base de Dados
                                </a>
                            </div>
                        </div>
                        
                        <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
                            <i class="fas fa-moon text-gray-600 dark:text-gray-300 dark:hidden"></i>
                            <i class="fas fa-sun text-gray-300 hidden dark:block"></i>
                        </button>
                        
                        <div class="relative">
                            <button id="user-menu-button" class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center">
                                    <i class="fas fa-user"></i>
                                </div>
                                <span class="hidden md:block">Administrador</span>
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            
                            <div id="user-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-50">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-user-circle mr-2"></i> Perfil
                                </a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-cog mr-2"></i> Configurações
                                </a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-sign-out-alt mr-2"></i> Sair
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Conteúdo Principal -->
        <div class="flex-1 flex">
            <!-- Menu Lateral -->
            <nav class="w-16 md:w-64 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hidden md:block">
                <div class="p-4">
                    <ul class="space-y-1">
                        <li>
                            <a href="#dashboard" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent active-menu" id="dashboard-menu">
                                <i class="fas fa-tachometer-alt w-6"></i>
                                <span class="hidden md:block ml-3">Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="#reboques" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="reboques-menu">
                                <i class="fas fa-trailer w-6"></i>
                                <span class="hidden md:block ml-3">Reboques</span>
                            </a>
                        </li>
                        <li>
                            <a href="#caminhoes-proprios" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="cp-menu">
                                <i class="fas fa-truck w-6"></i>
                                <span class="hidden md:block ml-3">Caminhões Próprios</span>
                            </a>
                        </li>
                        <li>
                            <a href="#caminhoes-terceiros" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="ct-menu">
                                <i class="fas fa-truck-moving w-6"></i>
                                <span class="hidden md:block ml-3">Caminhões Terceiros</span>
                            </a>
                        </li>
                        <li>
                            <a href="#frente-4001" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="f4001-menu">
                                <i class="fas fa-tractor w-6"></i>
                                <span class="hidden md:block ml-3">Frente 4001</span>
                            </a>
                        </li>
                        <li>
                            <a href="#frente-4002" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="f4002-menu">
                                <i class="fas fa-truck-monster w-6"></i>
                                <span class="hidden md:block ml-3">Frente 4002</span>
                            </a>
                        </li>
                        <li>
                            <a href="#visualizacao-real" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="real-view-menu">
                                <i class="fas fa-eye w-6"></i>
                                <span class="hidden md:block ml-3">Visualização Real</span>
                            </a>
                        </li>
                        <li>
                            <a href="#dashboard-detalhado" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="detailed-dashboard-menu">
                                <i class="fas fa-chart-line w-6"></i>
                                <span class="hidden md:block ml-3">Dashboard Detalhado</span>
                            </a>
                        </li>
                    </ul>
                    
                    <div class="mt-8 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 hidden md:block mb-2">Controles</div>
                        <ul class="space-y-1">
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="add-equipment-btn">
                                    <i class="fas fa-plus-circle w-6"></i>
                                    <span class="hidden md:block ml-3">Adicionar Equipamento</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 border-l-4 border-transparent" id="settings-btn">
                                    <i class="fas fa-cog w-6"></i>
                                    <span class="hidden md:block ml-3">Configurações</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            
            <!-- Menu Mobile -->
            <div class="fixed bottom-0 left-0 w-full bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 md:hidden z-40">
                <div class="flex justify-around">
                    <a href="#dashboard" class="flex flex-col items-center py-3 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary">
                        <i class="fas fa-tachometer-alt text-lg"></i>
                        <span class="text-xs mt-1">Dashboard</span>
                    </a>
                    <a href="#visualizacao-real" class="flex flex-col items-center py-3 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary">
                        <i class="fas fa-eye text-lg"></i>
                        <span class="text-xs mt-1">Visualizar</span>
                    </a>
                    <a href="#" class="flex flex-col items-center py-3 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" id="mobile-menu-btn">
                        <i class="fas fa-bars text-lg"></i>
                        <span class="text-xs mt-1">Menu</span>
                    </a>
                    <a href="#" class="flex flex-col items-center py-3 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" id="mobile-add-btn">
                        <i class="fas fa-plus-circle text-lg"></i>
                        <span class="text-xs mt-1">Adicionar</span>
                    </a>
                    <a href="#" class="flex flex-col items-center py-3 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" id="mobile-options-btn">
                        <i class="fas fa-ellipsis-h text-lg"></i>
                        <span class="text-xs mt-1">Opções</span>
                    </a>
                </div>
            </div>
            
            <!-- Mobile Menu Modal -->
            <div id="mobile-menu-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-end hidden">
                <div class="bg-white dark:bg-gray-800 rounded-t-xl w-full max-w-md max-h-[80vh] overflow-y-auto">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h3 class="text-lg font-semibold">Menu</h3>
                        <button id="close-mobile-menu" class="text-gray-600 dark:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <ul class="space-y-2">
                            <li>
                                <a href="#dashboard" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-tachometer-alt mr-3 text-primary"></i>
                                    Dashboard
                                </a>
                            </li>
                            <li>
                                <a href="#reboques" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-trailer mr-3 text-primary"></i>
                                    Reboques
                                </a>
                            </li>
                            <li>
                                <a href="#caminhoes-proprios" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-truck mr-3 text-primary"></i>
                                    Caminhões Próprios
                                </a>
                            </li>
                            <li>
                                <a href="#caminhoes-terceiros" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-truck-moving mr-3 text-primary"></i>
                                    Caminhões Terceiros
                                </a>
                            </li>
                            <li>
                                <a href="#frente-4001" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-tractor mr-3 text-primary"></i>
                                    Frente 4001
                                </a>
                            </li>
                            <li>
                                <a href="#frente-4002" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-truck-monster mr-3 text-primary"></i>
                                    Frente 4002
                                </a>
                            </li>
                            <li>
                                <a href="#visualizacao-real" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-eye mr-3 text-primary"></i>
                                    Visualização Real
                                </a>
                            </li>
                            <li>
                                <a href="#dashboard-detalhado" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <i class="fas fa-chart-line mr-3 text-primary"></i>
                                    Dashboard Detalhado
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Options Modal -->
            <div id="mobile-options-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-end hidden">
                <div class="bg-white dark:bg-gray-800 rounded-t-xl w-full max-w-md">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                        <h3 class="text-lg font-semibold">Opções</h3>
                        <button id="close-mobile-options" class="text-gray-600 dark:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <ul class="space-y-2">
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700" id="mobile-export-btn">
                                    <i class="fas fa-file-export mr-3 text-primary"></i>
                                    Exportar CSV
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700" id="mobile-print-btn">
                                    <i class="fas fa-print mr-3 text-primary"></i>
                                    Imprimir Relatório
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700" id="mobile-pdf-btn">
                                    <i class="fas fa-file-pdf mr-3 text-primary"></i>
                                    Gerar PDF
                                </a>
                            </li>
                            <li>
                                <a href="#" class="flex items-center px-4 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700" id="mobile-theme-btn">
                                    <i class="fas fa-moon mr-3 text-primary dark:hidden"></i>
                                    <i class="fas fa-sun mr-3 text-primary hidden dark:inline-block"></i>
                                    <span class="dark:hidden">Modo Escuro</span>
                                    <span class="hidden dark:inline-block">Modo Claro</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo Principal -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 pb-16 md:pb-0">
                <!-- Área de conteúdo -->
                <div class="container mx-auto px-4 py-6">
                    <!-- Dashboard -->
                    <div id="dashboard" class="tab-content active">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Dashboard</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="refresh-btn">
                                    <i class="fas fa-sync-alt mr-2"></i> Atualizar
                                </button>
                                <button class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700" id="dashboard-print-btn">
                                    <i class="fas fa-print mr-2"></i> Imprimir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Resumo visual do status -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <div class="flex flex-wrap items-center">
                                <div class="flex items-center mr-6 mb-2">
                                    <div class="w-3 h-3 rounded-full bg-green-500 mr-2"></div>
                                    <span class="text-sm">Operacionais: <strong id="dash-summary-operational">0</strong></span>
                                </div>
                                <div class="flex items-center mr-6 mb-2">
                                    <div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                                    <span class="text-sm">Em Manutenção: <strong id="dash-summary-maintenance">0</strong></span>
                                </div>
                                <div class="flex items-center mr-6 mb-2">
                                    <div class="w-3 h-3 rounded-full bg-red-500 mr-2"></div>
                                    <span class="text-sm">Em Reforma: <strong id="dash-summary-reform">0</strong></span>
                                </div>
                                <div class="flex items-center mr-6 mb-2">
                                    <div class="w-3 h-3 rounded-full bg-purple-500 mr-2"></div>
                                    <span class="text-sm">Emprestados: <strong id="dash-summary-borrowed">0</strong></span>
                                </div>
                                <div class="flex items-center mr-6 mb-2">
                                    <div class="w-3 h-3 rounded-full bg-blue-500 mr-2"></div>
                                    <span class="text-sm">Outros: <strong id="dash-summary-other">0</strong></span>
                                </div>
                                <div class="flex items-center mb-2 ml-auto">
                                    <span class="text-sm font-medium">Disponibilidade geral:</span>
                                    <span class="ml-2 text-sm px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full" id="dash-summary-availability">0%</span>
                                </div>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2">
                                <div class="bg-green-500 h-2.5 rounded-full" id="dash-availability-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                            <!-- Card 1 -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Caminhões Próprios</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="dash-cp-count">0</p>
                                            <p class="ml-2 text-sm text-gray-500 dark:text-gray-400">unidades</p>
                                        </div>
                                    </div>
                                    <div class="card-icon bg-blue-100 dark:bg-blue-900 text-blue-500">
                                        <i class="fas fa-truck"></i>
                                    </div>
                                </div>
                                <div class="flex items-center mt-4">
                                    <span class="flex items-center text-sm text-green-500">
                                        <i class="fas fa-check-circle mr-1"></i> <span id="dash-cp-operational">0</span> operacionais
                                    </span>
                                    <span class="flex items-center text-sm text-yellow-500 ml-4">
                                        <i class="fas fa-wrench mr-1"></i> <span id="dash-cp-maintenance">0</span> em manutenção
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div class="bg-green-500 h-1.5 rounded-full" id="dash-cp-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Card 2 -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Reboques</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="dash-reboques-count">0</p>
                                            <p class="ml-2 text-sm text-gray-500 dark:text-gray-400">unidades</p>
                                        </div>
                                    </div>
                                    <div class="card-icon bg-green-100 dark:bg-green-900 text-green-500">
                                        <i class="fas fa-trailer"></i>
                                    </div>
                                </div>
                                <div class="flex items-center mt-4">
                                    <span class="flex items-center text-sm text-green-500">
                                        <i class="fas fa-check-circle mr-1"></i> <span id="dash-reboques-operational">0</span> operacionais
                                    </span>
                                    <span class="flex items-center text-sm text-yellow-500 ml-4">
                                        <i class="fas fa-wrench mr-1"></i> <span id="dash-reboques-maintenance">0</span> em manutenção
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div class="bg-green-500 h-1.5 rounded-full" id="dash-reboques-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Card 3 -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Frente 4001</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="dash-f4001-count">0</p>
                                            <p class="ml-2 text-sm text-gray-500 dark:text-gray-400">unidades</p>
                                        </div>
                                    </div>
                                    <div class="card-icon bg-yellow-100 dark:bg-yellow-900 text-yellow-500">
                                        <i class="fas fa-tractor"></i>
                                    </div>
                                </div>
                                <div class="flex items-center mt-4">
                                    <span class="flex items-center text-sm text-green-500">
                                        <i class="fas fa-check-circle mr-1"></i> <span id="dash-f4001-operational">0</span> operacionais
                                    </span>
                                    <span class="flex items-center text-sm text-yellow-500 ml-4">
                                        <i class="fas fa-wrench mr-1"></i> <span id="dash-f4001-maintenance">0</span> em manutenção
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div class="bg-green-500 h-1.5 rounded-full" id="dash-f4001-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Card 4 -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Frente 4002</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="dash-f4002-count">0</p>
                                            <p class="ml-2 text-sm text-gray-500 dark:text-gray-400">unidades</p>
                                        </div>
                                    </div>
                                    <div class="card-icon bg-red-100 dark:bg-red-900 text-red-500">
                                        <i class="fas fa-truck-monster"></i>
                                    </div>
                                </div>
                                <div class="flex items-center mt-4">
                                    <span class="flex items-center text-sm text-green-500">
                                        <i class="fas fa-check-circle mr-1"></i> <span id="dash-f4002-operational">0</span> operacionais
                                    </span>
                                    <span class="flex items-center text-sm text-yellow-500 ml-4">
                                        <i class="fas fa-wrench mr-1"></i> <span id="dash-f4002-maintenance">0</span> em manutenção
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div class="bg-green-500 h-1.5 rounded-full" id="dash-f4002-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <!-- Status por Categoria -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Status por Categoria</h3>
                                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                </div>
                                <div class="h-64 relative">
                                    <canvas id="status-by-category-chart"></canvas>
                                    <div id="status-category-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90 hidden">
                                        <div class="text-center">
                                            <i class="fas fa-chart-bar text-gray-300 dark:text-gray-600 text-4xl mb-2"></i>
                                            <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Disponibilidade -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Disponibilidade da Frota</h3>
                                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                </div>
                                <div class="h-64 relative">
                                    <canvas id="availability-chart"></canvas>
                                    <div id="availability-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90 hidden">
                                        <div class="text-center">
                                            <i class="fas fa-chart-pie text-gray-300 dark:text-gray-600 text-4xl mb-2"></i>
                                            <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Status Global -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Status Global</h3>
                                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                </div>
                                <div class="grid grid-cols-2 gap-4 mb-4">
                                    <div class="text-center p-3 bg-green-50 dark:bg-green-900 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-300">Operacionais</p>
                                        <p class="text-xl font-bold text-green-500 dark:text-green-400" id="dash-global-operational">0</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400" id="dash-global-operational-percent">0%</p>
                                    </div>
                                    <div class="text-center p-3 bg-yellow-50 dark:bg-yellow-900 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-300">Em Manutenção</p>
                                        <p class="text-xl font-bold text-yellow-500 dark:text-yellow-400" id="dash-global-maintenance">0</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400" id="dash-global-maintenance-percent">0%</p>
                                    </div>
                                    <div class="text-center p-3 bg-red-50 dark:bg-red-900 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-300">Em Reforma</p>
                                        <p class="text-xl font-bold text-red-500 dark:text-red-400" id="dash-global-reform">0</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400" id="dash-global-reform-percent">0%</p>
                                    </div>
                                    <div class="text-center p-3 bg-blue-50 dark:bg-blue-900 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-300">Outros</p>
                                        <p class="text-xl font-bold text-blue-500 dark:text-blue-400" id="dash-global-other">0</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400" id="dash-global-other-percent">0%</p>
                                    </div>
                                </div>
                                <div class="flex items-center justify-center mt-2">
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Total de equipamentos: <span id="dash-global-total">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Manutenções Recentes -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Equipamentos em Manutenção</h3>
                                    <a href="#" class="text-sm text-primary hover:text-primary-dark">
                                        Ver todos
                                    </a>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="equipment-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Próximas Manutenções -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Manutenções Agendadas</h3>
                                    <a href="#" class="text-sm text-primary hover:text-primary-dark">
                                        Agendar
                                    </a>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="upcoming-maintenance-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Avisos e Notificações -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Avisos e Notificações</h3>
                                    <button class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                <ul class="divide-y divide-gray-200 dark:divide-gray-700" id="notification-list">
                                    <li class="py-2">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma notificação disponível. O sistema mostrará alertas importantes aqui.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Status do Banco de Dados -->
                        <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
                            <h3 class="text-lg font-semibold mb-4">Status do Banco de Dados</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="p-4 border rounded-lg">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-400">Último Backup</h4>
                                            <p class="text-lg font-semibold" id="last-backup-date">Nunca</p>
                                        </div>
                                        <div class="p-2 bg-blue-100 dark:bg-blue-900 rounded-lg text-blue-500">
                                            <i class="fas fa-database"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-400">Tamanho dos Dados</h4>
                                            <p class="text-lg font-semibold" id="db-size">0 KB</p>
                                        </div>
                                        <div class="p-2 bg-green-100 dark:bg-green-900 rounded-lg text-green-500">
                                            <i class="fas fa-hdd"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 border rounded-lg">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-400">Ações</h4>
                                        </div>
                                        <div class="flex space-x-2">
                                            <button id="quick-backup-btn" class="px-2 py-1 bg-primary text-white rounded hover:bg-primary-dark text-sm">
                                                <i class="fas fa-save mr-1"></i> Backup Rápido
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Reboques -->
                    <div id="reboques" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Reboques</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="add-reboque-btn">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                                <div class="relative">
                                    <button id="reboques-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="reboques-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="reboques-export-btn">
                                            <i class="fas fa-file-export mr-2"></i> Exportar CSV
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="reboques-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Relatório
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <!-- Cards com métricas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="reboques-operational">0</p>
                                            <p class="ml-2 text-sm text-green-500" id="reboques-operational-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-green-100 dark:bg-green-900 text-green-500">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="reboques-maintenance">0</p>
                                            <p class="ml-2 text-sm text-yellow-500" id="reboques-maintenance-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-500">
                                        <i class="fas fa-wrench"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Reforma/Inoperantes</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="reboques-reform">0</p>
                                            <p class="ml-2 text-sm text-red-500" id="reboques-reform-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-red-100 dark:bg-red-900 text-red-500">
                                        <i class="fas fa-tools"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-lg font-semibold">Disponibilidade da Frota</h3>
                                    <div class="text-2xl font-bold text-green-500" id="reboques-availability">0%</div>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2">
                                    <div class="bg-green-500 h-2.5 rounded-full" id="reboques-availability-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <!-- Gráfico de Status -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Status dos Reboques</h3>
                                </div>
                                <div class="h-60 relative">
                                    <canvas id="reboques-status-chart"></canvas>
                                    <div id="reboques-status-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90 hidden">
                                        <div class="text-center">
                                            <i class="fas fa-chart-pie text-gray-300 dark:text-gray-600 text-4xl mb-2"></i>
                                            <p class="text-gray-500 dark:text-gray-400">Sem dados disponíveis</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Gráfico de Tendência de Manutenção -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Tendência de Manutenção</h3>
                                </div>
                                <div class="h-60 relative">
                                    <canvas id="reboques-maintenance-trend-chart"></canvas>
                                    <div id="reboques-trend-no-data" class="absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-90 dark:bg-opacity-90">
                                        <div class="text-center">
                                            <i class="fas fa-chart-line text-gray-300 dark:text-gray-600 text-4xl mb-2"></i>
                                            <p class="text-gray-500 dark:text-gray-400">Dados históricos serão exibidos aqui</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                    <h3 class="text-lg font-semibold">Lista de Reboques</h3>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <div class="relative">
                                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="reboque-search" placeholder="Buscar reboque..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 w-full md:w-64">
                                        </div>
                                        
                                        <select id="reboque-status-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                            <option value="todos">Todos os status</option>
                                            <option value="Operacional">Operacional</option>
                                            <option value="Em manutenção">Em manutenção</option>
                                            <option value="Em reforma">Em reforma</option>
                                            <option value="Inoperante">Inoperante</option>
                                            <option value="Aguardando reforma">Aguardando reforma</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-800">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="frota">
                                                    Frota
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Tipo
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="acoplado">
                                                    Acoplado
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="status">
                                                    Status
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Data/Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="reboques-table-body">
                                        <tr>
                                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                                <div class="flex flex-col items-center justify-center py-4">
                                                    <i class="fas fa-truck-loading text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                                    <p class="text-gray-500 dark:text-gray-400">Nenhum reboque cadastrado</p>
                                                    <button class="mt-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                                                        <i class="fas fa-plus mr-2"></i> Adicionar Reboque
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Caminhões Próprios -->
                    <div id="caminhoes-proprios" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Caminhões Próprios</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="add-cp-btn">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                                <div class="relative">
                                    <button id="cp-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="cp-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="cp-export-btn">
                                            <i class="fas fa-file-export mr-2"></i> Exportar CSV
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="cp-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Relatório
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <!-- Cards com métricas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="cp-operational">0</p>
                                            <p class="ml-2 text-sm text-green-500" id="cp-operational-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-green-100 dark:bg-green-900 text-green-500">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="cp-maintenance">0</p>
                                            <p class="ml-2 text-sm text-yellow-500" id="cp-maintenance-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-500">
                                        <i class="fas fa-wrench"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Em Reforma/Inoperantes</p>
                                        <div class="flex items-baseline">
                                            <p class="text-2xl font-bold" id="cp-reform">0</p>
                                            <p class="ml-2 text-sm text-red-500" id="cp-reform-percentage">0%</p>
                                        </div>
                                    </div>
                                    <div class="rounded-full p-2 bg-red-100 dark:bg-red-900 text-red-500">
                                        <i class="fas fa-tools"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-lg font-semibold">Disponibilidade da Frota</h3>
                                    <div class="text-2xl font-bold text-green-500" id="cp-availability">0%</div>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2">
                                    <div class="bg-green-500 h-2.5 rounded-full" id="cp-availability-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                    <h3 class="text-lg font-semibold">Lista de Caminhões Próprios</h3>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <div class="relative">
                                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="cp-search" placeholder="Buscar caminhão..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 w-full md:w-64">
                                        </div>
                                        
                                        <select id="cp-status-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                            <option value="todos">Todos os status</option>
                                            <option value="Operacional">Operacional</option>
                                            <option value="Em manutenção">Em manutenção</option>
                                            <option value="Em reforma">Em reforma</option>
                                            <option value="Inoperante">Inoperante</option>
                                            <option value="Aguardando reforma">Aguardando reforma</option>
                                            <option value="Emprestado">Emprestado</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-800">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="caminhao">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="status">
                                                    Status
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Data
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="cp-table-body">
                                        <tr>
                                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                                <div class="flex flex-col items-center justify-center py-4">
                                                    <i class="fas fa-truck text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão próprio cadastrado</p>
                                                    <button class="mt-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                                                        <i class="fas fa-plus mr-2"></i> Adicionar Caminhão
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Caminhões Terceiros -->
                    <div id="caminhoes-terceiros" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Caminhões Terceiros</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="add-ct-btn">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                                <div class="relative">
                                    <button id="ct-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="ct-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="ct-export-btn">
                                            <i class="fas fa-file-export mr-2"></i> Exportar CSV
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="ct-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Relatório
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                    <h3 class="text-lg font-semibold">Lista de Caminhões Terceiros</h3>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <div class="relative">
                                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="ct-search" placeholder="Buscar caminhão..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 w-full md:w-64">
                                        </div>
                                        
                                        <select id="ct-status-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                            <option value="todos">Todos os status</option>
                                            <option value="Operacional">Operacional</option>
                                            <option value="Em manutenção">Em manutenção</option>
                                            <option value="Inoperante">Inoperante</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-800">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="caminhao">
                                                    Caminhão
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="proprietario">
                                                    Proprietário
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Reboques
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="status">
                                                    Status
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="ct-table-body">
                                        <tr>
                                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                                <div class="flex flex-col items-center justify-center py-4">
                                                    <i class="fas fa-truck-moving text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão terceiro cadastrado</p>
                                                    <button class="mt-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                                                        <i class="fas fa-plus mr-2"></i> Adicionar Caminhão
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4001 -->
                    <div id="frente-4001" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Frente 4001</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="add-f4001-btn">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                                <div class="relative">
                                    <button id="f4001-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="f4001-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="f4001-export-btn">
                                            <i class="fas fa-file-export mr-2"></i> Exportar CSV
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="f4001-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Relatório
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 mb-6">
                            <div class="flex flex-col md:flex-row justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold mb-2">Disponibilidade da Frente</h3>
                                    <div class="w-full md:w-96 bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                        <div class="bg-green-500 h-2.5 rounded-full" id="f4001-availability-bar" style="width: 0%"></div>
                                    </div>
                                    <div class="flex justify-between mt-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade: <span id="f4001-availability" class="font-semibold">0%</span></span>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="f4001-total" class="font-semibold">0</span> equipamentos</span>
                                    </div>
                                </div>
                                
                                <div class="flex mt-4 md:mt-0">
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <p class="text-lg font-bold text-green-500" id="f4001-operational">0</p>
                                    </div>
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <p class="text-lg font-bold text-yellow-500" id="f4001-maintenance">0</p>
                                    </div>
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Em Reforma</p>
                                        <p class="text-lg font-bold text-red-500" id="f4001-reform">0</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                    <h3 class="text-lg font-semibold">Equipamentos da Frente 4001</h3>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <div class="relative">
                                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="f4001-search" placeholder="Buscar equipamento..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 w-full md:w-64">
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <select id="f4001-type-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                                <option value="todos">Todos os tipos</option>
                                                <option value="colhedora">Colhedora</option>
                                                <option value="tracao">Tração</option>
                                            </select>
                                            
                                            <select id="f4001-status-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                                <option value="todos">Todos os status</option>
                                                <option value="Operacional">Operacional</option>
                                                <option value="Em manutenção">Em manutenção</option>
                                                <option value="Em reforma">Em reforma</option>
                                                <option value="Inoperante">Inoperante</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-800">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="type">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="codigo">
                                                    Código
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="status">
                                                    Status
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Data
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4001-table-body">
                                        <tr>
                                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                                <div class="flex flex-col items-center justify-center py-4">
                                                    <i class="fas fa-tractor text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento cadastrado na Frente 4001</p>
                                                    <button class="mt-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                                                        <i class="fas fa-plus mr-2"></i> Adicionar Equipamento
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frente 4002 -->
                    <div id="frente-4002" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Frente 4002</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="add-f4002-btn">
                                    <i class="fas fa-plus mr-2"></i> Adicionar
                                </button>
                                <div class="relative">
                                    <button id="f4002-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="f4002-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="f4002-export-btn">
                                            <i class="fas fa-file-export mr-2"></i> Exportar CSV
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="f4002-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Relatório
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 mb-6">
                            <div class="flex flex-col md:flex-row justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold mb-2">Disponibilidade da Frente</h3>
                                    <div class="w-full md:w-96 bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                        <div class="bg-green-500 h-2.5 rounded-full" id="f4002-availability-bar" style="width: 0%"></div>
                                    </div>
                                    <div class="flex justify-between mt-1">
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Disponibilidade: <span id="f4002-availability" class="font-semibold">0%</span></span>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Total: <span id="f4002-total" class="font-semibold">0</span> equipamentos</span>
                                    </div>
                                </div>
                                
                                <div class="flex mt-4 md:mt-0">
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Operacionais</p>
                                        <p class="text-lg font-bold text-green-500" id="f4002-operational">0</p>
                                    </div>
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Em Manutenção</p>
                                        <p class="text-lg font-bold text-yellow-500" id="f4002-maintenance">0</p>
                                    </div>
                                    <div class="text-center mx-2">
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Em Reforma</p>
                                        <p class="text-lg font-bold text-red-500" id="f4002-reform">0</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                    <h3 class="text-lg font-semibold">Equipamentos da Frente 4002</h3>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <div class="relative">
                                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="f4002-search" placeholder="Buscar equipamento..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 w-full md:w-64">
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <select id="f4002-type-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                                <option value="todos">Todos os tipos</option>
                                                <option value="colhedora">Colhedora</option>
                                                <option value="tracao">Tração</option>
                                            </select>
                                            
                                            <select id="f4002-status-filter" class="pl-4 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                                <option value="todos">Todos os status</option>
                                                <option value="Operacional">Operacional</option>
                                                <option value="Em manutenção">Em manutenção</option>
                                                <option value="Em reforma">Em reforma</option>
                                                <option value="Inoperante">Inoperante</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-800">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="type">
                                                    Tipo
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="codigo">
                                                    Código
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                <div class="flex items-center cursor-pointer" data-sort="status">
                                                    Status
                                                    <i class="fas fa-sort ml-1"></i>
                                                </div>
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Data
                                            </th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Motivo
                                            </th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Ações
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="f4002-table-body">
                                        <tr>
                                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                                <div class="flex flex-col items-center justify-center py-4">
                                                    <i class="fas fa-truck-monster text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento cadastrado na Frente 4002</p>
                                                    <button class="mt-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                                                        <i class="fas fa-plus mr-2"></i> Adicionar Equipamento
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Visualização Real -->
                    <div id="visualizacao-real" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Visualização Real</h2>
                            <div class="flex space-x-2">
                                <div class="relative">
                                    <button id="real-view-options-btn" class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    
                                    <div id="real-view-options-menu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden z-10">
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="real-view-print-btn">
                                            <i class="fas fa-print mr-2"></i> Imprimir Visualização
                                        </a>
                                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" id="generate-pdf-btn">
                                            <i class="fas fa-file-pdf mr-2"></i> Gerar Relatório PDF
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 mb-6">
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                                <div>
                                    <h3 class="text-lg font-semibold">Visão Geral da Frota</h3>
                                    <p class="text-sm text-gray-500 dark:text-gray-400" id="real-equipment-count">0 equipamentos</p>
                                </div>
                                
                                <div class="flex flex-wrap gap-2 mt-4 sm:mt-0">
                                    <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-primary text-white" data-filter="all">
                                        Todos
                                    </button>
                                    <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="operational">
                                        Operacionais
                                    </button>
                                    <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="maintenance">
                                        Em Manutenção
                                    </button>
                                    <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="reform">
                                        Em Reforma
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-5 mb-6">
                            <div class="flex flex-wrap gap-2 mb-4">
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="reboques">
                                    <i class="fas fa-trailer mr-1"></i> Reboques
                                </button>
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="caminhoes">
                                    <i class="fas fa-truck mr-1"></i> Caminhões
                                </button>
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="colhedoras">
                                    <i class="fas fa-tractor mr-1"></i> Colhedoras
                                </button>
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="tracoes">
                                    <i class="fas fa-truck-monster mr-1"></i> Trações
                                </button>
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="frente4001">
                                    Frente 4001
                                </button>
                                <button class="equipment-category-filter px-3 py-1 text-sm rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-filter="frente4002">
                                    Frente 4002
                                </button>
                            </div>
                            
                            <div id="real-equipment-container">
                                <!-- Conteúdo preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dashboard Detalhado -->
                    <div id="dashboard-detalhado" class="tab-content hidden">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Dashboard Detalhado</h2>
                            <div class="flex space-x-2">
                                <button class="btn-primary px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark" id="refresh-detailed-btn">
                                    <i class="fas fa-sync-alt mr-2"></i> Atualizar
                                </button>
                                <button class="px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700" id="pdf-report-btn">
                                    <i class="fas fa-file-pdf mr-2"></i> Relatório Completo
                                </button>
                            </div>
                        </div>
                        
                        <!-- Conteúdo será adicionado posteriormente -->
                    </div>
                </div>
            </main>
        </div>
        
        <!-- Rodapé -->
        <footer class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-4 hidden md:block">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center">
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Sistema de Gestão de Frota v4.0 &copy; 2023
                    </div>
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        Dados salvos localmente | <span id="footer-storage-info">0 KB utilizados</span>
                    </div>
                </div>
            </div>
        </footer>
        
        <!-- Área de Modal para Edição de Equipamento -->
        <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-2xl mx-4">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-lg font-semibold" id="modal-title">Editar Equipamento</h3>
                    <button class="close-modal text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-5" id="modal-content">
                    <div id="edit-form-fields"></div>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                    <button class="close-modal px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-400 dark:hover:bg-gray-600 mr-2">
                        Cancelar
                    </button>
                    <button id="save-equipment-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Área de Modal para Histórico de Equipamento -->
        <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800">
                    <div class="flex items-center">
                        <div class="w-10 h-10 flex items-center justify-center rounded-full bg-primary text-white mr-3">
                            <i id="history-icon" class="fas fa-truck"></i>
                        </div>
                        <div>
                            <h4 class="font-medium" id="history-title">Histórico do Equipamento</h4>
                            <p class="text-xs text-gray-600 dark:text-gray-400" id="history-subtitle">Total de registros: 0</p>
                        </div>
                    </div>
                    <button class="close-modal text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-5">
                    <div class="relative pl-10 border-l-2 border-primary" id="history-timeline">
                        <div class="flex flex-col items-start mb-6 ml-6 relative">
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-gray-400"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-medium">Nenhum histórico encontrado para este equipamento.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end sticky bottom-0 bg-white dark:bg-gray-800">
                    <button class="close-modal px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Área de Modal para Agendamento de Manutenção -->
        <div id="schedule-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-lg mx-4">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-lg font-semibold">Agendar Manutenção</h3>
                    <button class="close-modal text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-5">
                    <div id="schedule-equipment-info" class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700">
                        <!-- Informações do equipamento serão inseridas aqui -->
                    </div>
                    
                    <form id="schedule-form">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="schedule-date" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hora</label>
                                <input type="time" id="schedule-time" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Manutenção</label>
                            <select id="schedule-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                                <option value="preventiva">Manutenção Preventiva</option>
                                <option value="corretiva">Manutenção Corretiva</option>
                                <option value="revisao">Revisão Geral</option>
                                <option value="troca-oleo">Troca de Óleo</option>
                                <option value="reforma">Reforma</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrição</label>
                            <textarea id="schedule-description" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Responsável</label>
                            <input type="text" id="schedule-responsible" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                        </div>
                    </form>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                    <button class="close-modal px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-400 dark:hover:bg-gray-600 mr-2">
                        Cancelar
                    </button>
                    <button id="save-schedule-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                        Agendar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Área de Modal para Adicionar Equipamento -->
        <div id="add-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800">
                    <h3 class="text-lg font-semibold">Adicionar Novo Equipamento</h3>
                    <button class="close-modal text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-5">
                    <form id="add-equipment-form">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                            <select id="equipment-type" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <option value="reboque">Reboque</option>
                                <option value="caminhao-proprio">Caminhão Próprio</option>
                                <option value="caminhao-terceiro">Caminhão Terceiro</option>
                                <option value="colhedora-4001">Colhedora Frente 4001</option>
                                <option value="tracao-4001">Tração Frente 4001</option>
                                <option value="colhedora-4002">Colhedora Frente 4002</option>
                                <option value="tracao-4002">Tração Frente 4002</option>
                            </select>
                        </div>
                        
                        <div id="add-form-fields">
                            <!-- Os campos serão gerados dinamicamente baseados no tipo selecionado -->
                        </div>
                    </form>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end sticky bottom-0 bg-white dark:bg-gray-800">
                    <button class="close-modal px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-400 dark:hover:bg-gray-600 mr-2">
                        Cancelar
                    </button>
                    <button id="save-new-equipment-btn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark">
                        Adicionar Equipamento
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal de confirmação de exclusão -->
        <div id="delete-confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md mx-4">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold text-red-600 dark:text-red-400">Confirmar Exclusão</h3>
                </div>
                <div class="p-5">
                    <p class="text-gray-700 dark:text-gray-300" id="delete-confirm-message">Tem certeza que deseja excluir este equipamento? Esta ação não pode ser desfeita.</p>
                    <div class="mt-3 p-3 bg-red-50 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-md text-sm">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        <span id="delete-item-details">Detalhes do equipamento a ser excluído</span>
                    </div>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                    <button id="cancel-delete-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 mr-2">
                        Cancelar
                    </button>
                    <button id="confirm-delete-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal de gestão de banco de dados -->
        <div id="database-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-2xl mx-4">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-lg font-semibold">Gerenciamento de Dados</h3>
                    <button class="close-modal text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-5">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Backup -->
                        <div class="bg-white dark:bg-gray-700 border rounded-lg p-5">
                            <h4 class="text-lg font-medium mb-4 flex items-center">
                                <i class="fas fa-download text-primary mr-2"></i> Exportar Backup
                            </h4>
                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">
                                Exporte todos os dados para um arquivo JSON que pode ser importado posteriormente.
                            </p>
                            <button id="export-backup-btn" class="w-full px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark flex items-center justify-center">
                                <i class="fas fa-file-export mr-2"></i> Exportar Dados
                            </button>
                        </div>
                        
                        <!-- Importar -->
                        <div class="bg-white dark:bg-gray-700 border rounded-lg p-5">
                            <h4 class="text-lg font-medium mb-4 flex items-center">
                                <i class="fas fa-upload text-primary mr-2"></i> Importar Dados
                            </h4>
                            <div id="file-drop-area" class="file-drop-area border-dashed border-2 border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center mb-3">
                                <i class="fas fa-file-import text-gray-400 text-3xl mb-2"></i>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Arraste e solte o arquivo de backup aqui</p>
                                <p class="text-xs text-gray-400">ou</p>
                                <label class="mt-2 inline-block px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 cursor-pointer">
                                    <input type="file" id="import-file-input" class="hidden" accept=".json">
                                    Selecionar Arquivo
                                </label>
                            </div>
                            <div id="file-details" class="hidden mb-3 p-2 bg-gray-100 dark:bg-gray-600 rounded text-sm">
                                <p id="file-name-display" class="text-gray-700 dark:text-gray-300"></p>
                                <p id="file-size-display" class="text-gray-500 dark:text-gray-400 text-xs"></p>
                            </div>
                            <div class="flex space-x-2">
                                <button id="import-backup-btn" class="flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark flex items-center justify-center" disabled>
                                    <i class="fas fa-upload mr-2"></i> Importar
                                </button>
                                <select id="import-mode" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300">
                                    <option value="merge">Mesclar</option>
                                    <option value="replace">Substituir</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informações e Reset -->
                    <div class="bg-white dark:bg-gray-700 border rounded-lg p-5 mb-4">
                        <h4 class="text-lg font-medium mb-4">Informações do Armazenamento</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div class="p-3 bg-gray-100 dark:bg-gray-600 rounded-lg">
                                <p class="text-sm text-gray-500 dark:text-gray-400">Tamanho Total</p>
                                <p class="text-lg font-bold" id="storage-size">0 KB</p>
                            </div>
                            <div class="p-3 bg-gray-100 dark:bg-gray-600 rounded-lg">
                                <p class="text-sm text-gray-500 dark:text-gray-400">Equipamentos</p>
                                <p class="text-lg font-bold" id="equipment-count">0</p>
                            </div>
                            <div class="p-3 bg-gray-100 dark:bg-gray-600 rounded-lg">
                                <p class="text-sm text-gray-500 dark:text-gray-400">Último Backup</p>
                                <p class="text-lg font-bold" id="last-backup">Nunca</p>
                            </div>
                        </div>
                        
                        <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center">
                                <h5 class="font-medium text-red-600 dark:text-red-400">Zona de Perigo</h5>
                                <button id="open-reset-confirm-btn" class="px-4 py-2 bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 rounded-md hover:bg-red-200 dark:hover:bg-red-800 flex items-center">
                                    <i class="fas fa-trash-alt mr-2"></i> Limpar Todos os Dados
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                    <button class="close-modal px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-400 dark:hover:bg-gray-600">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal de confirmação de reset -->
        <div id="reset-confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md mx-4">
                <div class="p-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold text-red-600 dark:text-red-400">Atenção: Operação Irreversível</h3>
                </div>
                <div class="p-5">
                    <div class="mb-4">
                        <i class="fas fa-exclamation-triangle text-red-500 text-3xl block text-center mb-3"></i>
                        <p class="text-gray-700 dark:text-gray-300 font-bold mb-2">Você está prestes a apagar TODOS os dados do sistema.</p>
                        <p class="text-gray-600 dark:text-gray-400 text-sm">Esta ação irá:
                            <ul class="list-disc pl-5 mt-2 text-sm">
                                <li>Excluir todos os equipamentos cadastrados</li>
                                <li>Excluir todo o histórico e agendamentos</li>
                                <li>Resetar todas as configurações</li>
                            </ul>
                        </p>
                        <div class="bg-red-50 dark:bg-red-900 p-3 rounded-md mt-3">
                            <p class="text-red-700 dark:text-red-300 text-sm">Esta ação não pode ser desfeita. Recomendamos fazer um backup antes de continuar.</p>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="reset-confirm-check" class="form-checkbox h-4 w-4 text-red-600 rounded border-gray-300 dark:border-gray-600">
                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Eu entendo que todos os dados serão perdidos permanentemente.</span>
                        </label>
                    </div>
                </div>
                <div class="p-5 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                    <button id="cancel-reset-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 mr-2">
                        Cancelar
                    </button>
                    <button id="confirm-reset-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 opacity-50 cursor-not-allowed" disabled>
                        Limpar Todos os Dados
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Área de impressão -->
        <div id="print-area" class="hidden print-area">
            <div class="print-header">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiIgZmlsbD0ibm9uZSI+PHBhdGggZD0iTTI2LjI1IDMuNzVIMTguNzVWMTEuMjVIMjYuMjVWMy43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMjYuMjUgMTEuMjVIMTguNzVWMTguNzVIMjYuMjVWMTEuMjVaIiBmaWxsPSIjNUQ1Q0RFIi8+PHBhdGggZD0iTTE4Ljc1IDExLjI1SDExLjI1VjE4Ljc1SDE4Ljc1VjExLjI1WiIgZmlsbD0iIzVENUNERSIvPjxwYXRoIGQ9Ik0xOC43NSAxOC43NUgxMS4yNVYyNi4yNUgxOC43NVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMTEuMjUgMTguNzVIMy43NVYyNi4yNUgxMS4yNVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48L3N2Zz4=" alt="Logo" class="h-12 w-12 mr-3">
                        <div>
                            <h1 class="text-2xl font-bold" id="print-title">Relatório</h1>
                            <p class="text-sm text-gray-600" id="print-date">Gerado em: 01/01/2023</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-sm font-medium">Sistema de Gestão de Frota v4.0</span>
                        <span class="text-xs text-gray-600">Relatório Oficial</span>
                    </div>
                </div>
            </div>
            
            <div class="print-content" id="print-content"></div>
            
            <div class="print-footer">
                <p>Página <span class="pageNumber"></span> de <span class="totalPages"></span> | Sistema de Gestão de Frota v4.0 &copy; 2023 | Documento gerado em <span id="print-timestamp"></span></p>
            </div>
        </div>
        
        <!-- Área de relatório PDF -->
        <div id="pdf-report-area" class="hidden print-area">
            <div class="print-header">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiIgZmlsbD0ibm9uZSI+PHBhdGggZD0iTTI2LjI1IDMuNzVIMTguNzVWMTEuMjVIMjYuMjVWMy43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMjYuMjUgMTEuMjVIMTguNzVWMTguNzVIMjYuMjVWMTEuMjVaIiBmaWxsPSIjNUQ1Q0RFIi8+PHBhdGggZD0iTTE4Ljc1IDExLjI1SDExLjI1VjE4Ljc1SDE4Ljc1VjExLjI1WiIgZmlsbD0iIzVENUNERSIvPjxwYXRoIGQ9Ik0xOC43NSAxOC43NUgxMS4yNVYyNi4yNUgxOC43NVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48cGF0aCBkPSJNMTEuMjUgMTguNzVIMy43NVYyNi4yNUgxMS4yNVYxOC43NVoiIGZpbGw9IiM1RDVDREUiLz48L3N2Zz4=" alt="Logo" class="h-12 w-12 mr-3">
                        <div>
                            <h1 class="text-2xl font-bold" id="pdf-report-title">Relatório Completo</h1>
                            <p class="text-sm text-gray-600" id="pdf-report-date">Gerado em: 01/01/2023</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-sm font-medium">Relatório Detalhado</span>
                        <span class="text-xs text-gray-600">Confidencial</span>
                    </div>
                </div>
            </div>
            
            <div class="print-content" id="pdf-report-content"></div>
            
            <div class="print-footer">
                <p>Página <span class="pageNumber"></span> de <span class="totalPages"></span> | Sistema de Gestão de Frota v4.0 &copy; 2023 | Documento gerado em <span id="pdf-timestamp"></span></p>
            </div>
        </div>
        
        <!-- Área de notificações -->
        <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>
    </div>
    
    <script>
        // Aplicativo principal
        const APP = {
            // Dados da aplicação
            data: {
                // Listas de equipamentos
                reboques: [],
                caminhoesProps: [],
                caminhoesTerc: [],
                frente4001Colhedoras: [],
                frente4001Tracoes: [],
                frente4002Colhedoras: [],
                frente4002Tracoes: [],
                
                // Dados de edição
                editingItem: null,
                editingType: null,
                
                // Dados de exclusão
                deletingItem: null,
                deletingType: null,
                deletingId: null,
                deletingIndex: null,
                deletingArray: null,
                
                // Histórico de alterações
                history: {},
                
                // Agendamentos de manutenção
                schedules: [],
                
                // Gráficos
                charts: {},
                
                // Filtros e ordenação
                sortField: '',
                sortDirection: 'asc',
                searchTerm: '',
                statusFilter: 'todos',
                
                // Dados de armazenamento local
                storage: {
                    lastBackup: null,
                    version: '4.0'
                }
            },
            
            // Inicializar aplicativo
            init() {
                this.loadDataFromLocalStorage();
                this.setupEventListeners();
                this.setupTabs();
                this.renderAllTables();
                this.initializeCharts();
                this.initializeRealEquipmentView();
                this.updateAllDashboards();
                this.updateStorageInfo();
                
                // Mostrar notificação inicial
                this.showNotification('info', 'Sistema inicializado', 'Bem-vindo ao Sistema de Gestão de Frota v4.0');
            },
            
            // Salvar dados no localStorage
            saveDataToLocalStorage() {
                try {
                    const data = {
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules,
                        storage: {
                            ...this.data.storage,
                            lastSaved: new Date().toISOString()
                        }
                    };
                    
                    localStorage.setItem('fleetSystemData', JSON.stringify(data));
                    this.updateStorageInfo();
                    return true;
                } catch (error) {
                    console.error("Erro ao salvar dados no localStorage:", error);
                    this.showNotification('error', 'Erro ao salvar dados', 'Não foi possível salvar os dados localmente.');
                    return false;
                }
            },
            
            // Carregar dados do localStorage
            loadDataFromLocalStorage() {
                try {
                    const saved = localStorage.getItem('fleetSystemData');
                    if (saved) {
                        const data = JSON.parse(saved);
                        
                        // Usar os dados salvos ou manter os valores padrão
                        this.data.reboques = data.reboques || [];
                        this.data.caminhoesProps = data.caminhoesProps || [];
                        this.data.caminhoesTerc = data.caminhoesTerc || [];
                        this.data.frente4001Colhedoras = data.frente4001Colhedoras || [];
                        this.data.frente4001Tracoes = data.frente4001Tracoes || [];
                        this.data.frente4002Colhedoras = data.frente4002Colhedoras || [];
                        this.data.frente4002Tracoes = data.frente4002Tracoes || [];
                        this.data.history = data.history || {};
                        this.data.schedules = data.schedules || [];
                        this.data.storage = data.storage || {
                            lastBackup: null,
                            version: '4.0'
                        };
                        
                        this.showNotification('success', 'Dados carregados', 'Dados carregados com sucesso do armazenamento local.');
                        return true;
                    } else {
                        // Se não houver dados salvos, usar dados de exemplo
                        this.addMockData();
                        return false;
                    }
                } catch (error) {
                    console.error("Erro ao carregar dados do localStorage:", error);
                    this.showNotification('error', 'Erro ao carregar dados', 'Não foi possível carregar os dados salvos. Utilizando dados de exemplo.');
                    this.addMockData();
                    return false;
                }
            },
            
            // Atualizar informações de armazenamento
            updateStorageInfo() {
                try {
                    // Calcular tamanho dos dados
                    const dataString = localStorage.getItem('fleetSystemData') || '{}';
                    const dataSize = new Blob([dataString]).size;
                    
                    // Converter para KB ou MB
                    let formattedSize;
                    if (dataSize < 1024 * 1024) {
                        formattedSize = (dataSize / 1024).toFixed(2) + ' KB';
                    } else {
                        formattedSize = (dataSize / (1024 * 1024)).toFixed(2) + ' MB';
                    }
                    
                    // Atualizar elementos na interface
                    document.getElementById('storage-size').textContent = formattedSize;
                    document.getElementById('db-size').textContent = formattedSize;
                    document.getElementById('footer-storage-info').textContent = formattedSize + ' utilizados';
                    
                    // Contar equipamentos
                    const equipmentCount = 
                        this.data.reboques.length +
                        this.data.caminhoesProps.length +
                        this.data.caminhoesTerc.length +
                        this.data.frente4001Colhedoras.length +
                        this.data.frente4001Tracoes.length +
                        this.data.frente4002Colhedoras.length +
                        this.data.frente4002Tracoes.length;
                    
                    document.getElementById('equipment-count').textContent = equipmentCount;
                    
                    // Exibir data do último backup
                    const lastBackup = this.data.storage.lastBackup ? 
                        new Date(this.data.storage.lastBackup).toLocaleString() : 'Nunca';
                    document.getElementById('last-backup').textContent = lastBackup;
                    document.getElementById('last-backup-date').textContent = lastBackup;
                    
                } catch (error) {
                    console.error("Erro ao atualizar informações de armazenamento:", error);
                }
            },
            
            // Exportar backup
            exportBackup() {
                try {
                    // Preparar os dados
                    const backupData = {
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules,
                        metadata: {
                            version: this.data.storage.version,
                            exportDate: new Date().toISOString(),
                            equipmentCount: 
                                this.data.reboques.length +
                                this.data.caminhoesProps.length +
                                this.data.caminhoesTerc.length +
                                this.data.frente4001Colhedoras.length +
                                this.data.frente4001Tracoes.length +
                                this.data.frente4002Colhedoras.length +
                                this.data.frente4002Tracoes.length
                        }
                    };
                    
                    // Criar blob e link para download
                    const backupBlob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
                    const backupURL = URL.createObjectURL(backupBlob);
                    
                    // Criar nome para o arquivo baseado na data atual
                    const date = new Date();
                    const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
                    const filename = `frota_backup_${formattedDate}.json`;
                    
                    // Criar link para download
                    const downloadLink = document.createElement('a');
                    downloadLink.href = backupURL;
                    downloadLink.download = filename;
                    downloadLink.style.display = 'none';
                    document.body.appendChild(downloadLink);
                    
                    // Simular clique e remover o link
                    downloadLink.click();
                    document.body.removeChild(downloadLink);
                    
                    // Registrar a data do backup
                    this.data.storage.lastBackup = new Date().toISOString();
                    this.saveDataToLocalStorage();
                    
                    // Atualizar a UI
                    this.updateStorageInfo();
                    
                    // Animar o ícone de backup
                    const backupIcon = document.querySelector("#export-backup-btn i");
                    backupIcon.classList.add("backup-animation");
                    setTimeout(() => {
                        backupIcon.classList.remove("backup-animation");
                    }, 1000);
                    
                    this.showNotification('success', 'Backup exportado', `O arquivo ${filename} foi baixado com sucesso.`);
                    return true;
                } catch (error) {
                    console.error("Erro ao exportar backup:", error);
                    this.showNotification('error', 'Erro ao exportar backup', 'Não foi possível gerar o arquivo de backup.');
                    return false;
                }
            },
            
            // Importar backup
            importBackup(file, mode = 'merge') {
                try {
                    const reader = new FileReader();
                    
                    reader.onload = (event) => {
                        try {
                            const importedData = JSON.parse(event.target.result);
                            
                            // Verificar se os dados são válidos
                            if (!importedData.reboques || !importedData.caminhoesProps) {
                                throw new Error("O arquivo não contém dados de frota válidos");
                            }
                            
                            // Se modo for substituir, usar os dados importados diretamente
                            if (mode === 'replace') {
                                this.data.reboques = importedData.reboques || [];
                                this.data.caminhoesProps = importedData.caminhoesProps || [];
                                this.data.caminhoesTerc = importedData.caminhoesTerc || [];
                                this.data.frente4001Colhedoras = importedData.frente4001Colhedoras || [];
                                this.data.frente4001Tracoes = importedData.frente4001Tracoes || [];
                                this.data.frente4002Colhedoras = importedData.frente4002Colhedoras || [];
                                this.data.frente4002Tracoes = importedData.frente4002Tracoes || [];
                                this.data.history = importedData.history || {};
                                this.data.schedules = importedData.schedules || [];
                            } 
                            // Se modo for mesclar, adicionar os novos dados aos existentes
                            else {
                                // Função para mesclar arrays evitando duplicatas
                                const mergeArrays = (currentArray, importedArray, idField) => {
                                    if (!importedArray || !Array.isArray(importedArray)) return currentArray;
                                    
                                    const result = [...currentArray];
                                    const existingIds = new Set(currentArray.map(item => item[idField]));
                                    
                                    importedArray.forEach(item => {
                                        if (!item[idField]) return; // Ignorar itens sem ID
                                        
                                        // Se o item já existe, atualizar
                                        if (existingIds.has(item[idField])) {
                                            const index = result.findIndex(existing => existing[idField] === item[idField]);
                                            if (index !== -1) {
                                                result[index] = item;
                                            }
                                        } 
                                        // Se for novo, adicionar
                                        else {
                                            result.push(item);
                                            existingIds.add(item[idField]);
                                        }
                                    });
                                    
                                    return result;
                                };
                                
                                // Mesclar arrays com os campos de ID apropriados
                                this.data.reboques = mergeArrays(this.data.reboques, importedData.reboques, 'frota');
                                this.data.caminhoesProps = mergeArrays(this.data.caminhoesProps, importedData.caminhoesProps, 'caminhao');
                                this.data.caminhoesTerc = mergeArrays(this.data.caminhoesTerc, importedData.caminhoesTerc, 'caminhao');
                                this.data.frente4001Colhedoras = mergeArrays(this.data.frente4001Colhedoras, importedData.frente4001Colhedoras, 'codigo');
                                this.data.frente4001Tracoes = mergeArrays(this.data.frente4001Tracoes, importedData.frente4001Tracoes, 'codigo');
                                this.data.frente4002Colhedoras = mergeArrays(this.data.frente4002Colhedoras, importedData.frente4002Colhedoras, 'codigo');
                                this.data.frente4002Tracoes = mergeArrays(this.data.frente4002Tracoes, importedData.frente4002Tracoes, 'codigo');
                                
                                // Mesclar histórico e agendamentos
                                if (importedData.history) {
                                    this.data.history = { ...this.data.history, ...importedData.history };
                                }
                                
                                if (importedData.schedules && Array.isArray(importedData.schedules)) {
                                    // Usar Set para eliminar duplicatas baseado em equipment+date+time
                                    const allSchedules = [...this.data.schedules, ...importedData.schedules];
                                    const uniqueKeys = new Set();
                                    this.data.schedules = allSchedules.filter(schedule => {
                                        const key = `${schedule.equipment}-${schedule.date}-${schedule.time}`;
                                        if (uniqueKeys.has(key)) return false;
                                        uniqueKeys.add(key);
                                        return true;
                                    });
                                }
                            }
                            
                            // Salvar os dados
                            this.saveDataToLocalStorage();
                            
                            // Atualizar UI
                            this.renderAllTables();
                            this.updateAllDashboards();
                            this.updateAllCharts();
                            this.initializeRealEquipmentView();
                            
                            // Limpar UI de importação
                            document.getElementById('file-details').classList.add('hidden');
                            document.getElementById('import-backup-btn').disabled = true;
                            document.getElementById('import-file-input').value = '';
                            
                            // Fechar modal
                            document.getElementById('database-modal').classList.add('hidden');
                            
                            // Contabilizar itens importados
                            let totalImported = 0;
                            if (importedData.reboques) totalImported += importedData.reboques.length;
                            if (importedData.caminhoesProps) totalImported += importedData.caminhoesProps.length;
                            if (importedData.caminhoesTerc) totalImported += importedData.caminhoesTerc.length;
                            if (importedData.frente4001Colhedoras) totalImported += importedData.frente4001Colhedoras.length;
                            if (importedData.frente4001Tracoes) totalImported += importedData.frente4001Tracoes.length;
                            if (importedData.frente4002Colhedoras) totalImported += importedData.frente4002Colhedoras.length;
                            if (importedData.frente4002Tracoes) totalImported += importedData.frente4002Tracoes.length;
                            
                            this.showNotification(
                                'success', 
                                'Dados importados', 
                                `${totalImported} equipamentos importados no modo ${mode === 'replace' ? 'substituição' : 'mesclagem'}.`
                            );
                            
                        } catch (error) {
                            console.error("Erro ao processar dados importados:", error);
                            this.showNotification('error', 'Erro na importação', 'O arquivo não contém dados válidos para importação.');
                        }
                    };
                    
                    reader.onerror = () => {
                        this.showNotification('error', 'Erro na leitura', 'Não foi possível ler o arquivo selecionado.');
                    };
                    
                    reader.readAsText(file);
                    
                } catch (error) {
                    console.error("Erro ao importar backup:", error);
                    this.showNotification('error', 'Erro ao importar backup', 'Não foi possível processar o arquivo de backup.');
                    return false;
                }
            },
            
            // Resetar banco de dados
            resetDatabase() {
                try {
                    // Criar backup automático antes de resetar
                    const backupData = {
                        reboques: this.data.reboques,
                        caminhoesProps: this.data.caminhoesProps,
                        caminhoesTerc: this.data.caminhoesTerc,
                        frente4001Colhedoras: this.data.frente4001Colhedoras,
                        frente4001Tracoes: this.data.frente4001Tracoes,
                        frente4002Colhedoras: this.data.frente4002Colhedoras,
                        frente4002Tracoes: this.data.frente4002Tracoes,
                        history: this.data.history,
                        schedules: this.data.schedules,
                        metadata: {
                            version: this.data.storage.version,
                            exportDate: new Date().toISOString(),
                            backupType: 'auto_before_reset'
                        }
                    };
                    
                    // Salvar backup automático no localStorage
                    localStorage.setItem('fleetSystemAutoBackup', JSON.stringify(backupData));
                    
                    // Limpar dados
                    this.data.reboques = [];
                    this.data.caminhoesProps = [];
                    this.data.caminhoesTerc = [];
                    this.data.frente4001Colhedoras = [];
                    this.data.frente4001Tracoes = [];
                    this.data.frente4002Colhedoras = [];
                    this.data.frente4002Tracoes = [];
                    this.data.history = {};
                    this.data.schedules = [];
                    this.data.storage = {
                        lastBackup: null,
                        version: '4.0'
                    };
                    
                    // Salvar as alterações
                    this.saveDataToLocalStorage();
                    
                    // Atualizar UI
                    this.renderAllTables();
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.initializeRealEquipmentView();
                    
                    // Fechar modal
                    document.getElementById('reset-confirm-modal').classList.add('hidden');
                    
                    this.showNotification('info', 'Banco de dados limpo', 'Todos os dados foram excluídos. Um backup automático foi criado antes da exclusão.');
                    return true;
                } catch (error) {
                    console.error("Erro ao resetar banco de dados:", error);
                    this.showNotification('error', 'Erro ao limpar dados', 'Ocorreu um erro ao tentar limpar o banco de dados.');
                    return false;
                }
            },
            
            // Adicionar dados de exemplo
            addMockData() {
                // Reboques
                this.data.reboques = [
                    { frota: '1001', tipo: 'SEMI REBOQUE', acoplado: '101', tipoAcoplado: 'REBOQUE', status: 'Operacional' },
                    { frota: '1002', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: 'REBOQUE', status: 'Em manutenção', dataParada: '2023-05-10', motivo: 'Problema no sistema de freios' },
                    { frota: '1003', tipo: 'SEMI REBOQUE', acoplado: '103', tipoAcoplado: 'REBOQUE', status: 'Operacional' },
                    { frota: '1004', tipo: 'SEMI REBOQUE', acoplado: '', tipoAcoplado: 'REBOQUE', status: 'Em reforma', dataParada: '2023-04-15', motivo: 'Reforma geral programada' },
                    { frota: '1005', tipo: 'SEMI REBOQUE', acoplado: '105', tipoAcoplado: 'REBOQUE', status: 'Operacional' }
                ];
                
                // Caminhões próprios
                this.data.caminhoesProps = [
                    { caminhao: '2001', status: 'Operacional' },
                    { caminhao: '2002', status: 'Em manutenção', data: '2023-05-15', motivo: 'Troca de óleo e filtros' },
                    { caminhao: '2003', status: 'Operacional' },
                    { caminhao: '2004', status: 'Emprestado', data: '2023-05-01', motivo: 'Emprestado para filial de SP' },
                    { caminhao: '2005', status: 'Operacional' }
                ];
                
                // Caminhões terceiros
                this.data.caminhoesTerc = [
                    { caminhao: '3001', proprietario: 'Transportes Silva', reboques: '1101-1102', status: 'Operacional' },
                    { caminhao: '3002', proprietario: 'Logística Express', reboques: '1103', status: 'Em manutenção', motivo: 'Manutenção preventiva' },
                    { caminhao: '3003', proprietario: 'Transportes Silva', reboques: '1104-1105', status: 'Operacional' },
                    { caminhao: '3004', proprietario: 'TransRápido', reboques: '1106', status: 'Operacional' },
                    { caminhao: '3005', proprietario: 'Logística Express', reboques: '1107-1108', status: 'Operacional' }
                ];
                
                // Colhedoras Frente 4001
                this.data.frente4001Colhedoras = [
                    { codigo: 'C4001-1', status: 'Operacional' },
                    { codigo: 'C4001-2', status: 'Em manutenção', data: '2023-05-20', motivo: 'Problema hidráulico' },
                    { codigo: 'C4001-3', status: 'Operacional' }
                ];
                
                // Trações Frente 4001
                this.data.frente4001Tracoes = [
                    { codigo: 'T4001-1', status: 'Operacional' },
                    { codigo: 'T4001-2', status: 'Operacional' },
                    { codigo: 'T4001-3', status: 'Em manutenção', data: '2023-05-18', motivo: 'Problema elétrico' }
                ];
                
                // Colhedoras Frente 4002
                this.data.frente4002Colhedoras = [
                    { codigo: 'C4002-1', status: 'Operacional' },
                    { codigo: 'C4002-2', status: 'Operacional' },
                    { codigo: 'C4002-3', status: 'Em manutenção', data: '2023-05-19', motivo: 'Manutenção preventiva' }
                ];
                
                // Trações Frente 4002
                this.data.frente4002Tracoes = [
                    { codigo: 'T4002-1', status: 'Operacional' },
                    { codigo: 'T4002-2', status: 'Em manutenção', data: '2023-05-17', motivo: 'Problema mecânico' },
                    { codigo: 'T4002-3', status: 'Operacional' }
                ];
                
                // Adicionar histórico de exemplo para alguns equipamentos
                this.data.history = {
                    '1002': [
                        { date: '2023-05-10', status: 'Em manutenção', description: 'Status alterado de Operacional para Em manutenção', user: 'João Silva' },
                        { date: '2023-04-15', status: 'Operacional', description: 'Status alterado de Em manutenção para Operacional', user: 'Maria Oliveira' }
                    ],
                    '2002': [
                        { date: '2023-05-15', status: 'Em manutenção', description: 'Status alterado de Operacional para Em manutenção', user: 'Carlos Santos' },
                        { date: '2023-03-20', status: 'Operacional', description: 'Status alterado de Em reforma para Operacional', user: 'Pedro Souza' },
                        { date: '2023-02-10', status: 'Em reforma', description: 'Status alterado de Operacional para Em reforma', user: 'Ana Pereira' }
                    ]
                };
                
                // Adicionar agendamentos de exemplo
                this.data.schedules = [
                    { equipment: '1003', equipmentType: 'Reboque', date: '2023-06-15', time: '09:00', type: 'preventiva', description: 'Manutenção preventiva programada', responsible: 'Equipe A' },
                    { equipment: '2001', equipmentType: 'Caminhão Próprio', date: '2023-06-20', time: '14:00', type: 'troca-oleo', description: 'Troca de óleo e filtros', responsible: 'Equipe B' },
                    { equipment: 'C4001-1', equipmentType: 'Colhedora Frente 4001', date: '2023-06-25', time: '08:30', type: 'revisao', description: 'Revisão geral de 500 horas', responsible: 'Equipe C' }
                ];
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
            },
            
            // Configurar event listeners
            setupEventListeners() {
                // Eventos de tabs
                document.querySelectorAll('a[href^="#"]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const target = link.getAttribute('href').substring(1);
                        this.showTab(target);
                    });
                });
                
                // Eventos de menu
                document.getElementById('user-menu-button').addEventListener('click', () => {
                    document.getElementById('user-menu').classList.toggle('hidden');
                });
                
                // Evento para alternar tema claro/escuro
                document.getElementById('theme-toggle').addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    
                    // Atualizar os gráficos para refletir o novo tema
                    this.updateAllCharts();
                });
                
                // Evento para tema no mobile
                document.getElementById('mobile-theme-btn').addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    document.getElementById('mobile-options-modal').classList.add('hidden');
                    
                    // Atualizar os gráficos para refletir o novo tema
                    this.updateAllCharts();
                });
                
                // Eventos de menu mobile
                document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                    document.getElementById('mobile-menu-modal').classList.remove('hidden');
                });
                
                document.getElementById('close-mobile-menu').addEventListener('click', () => {
                    document.getElementById('mobile-menu-modal').classList.add('hidden');
                });
                
                document.getElementById('mobile-options-btn').addEventListener('click', () => {
                    document.getElementById('mobile-options-modal').classList.remove('hidden');
                });
                
                document.getElementById('close-mobile-options').addEventListener('click', () => {
                    document.getElementById('mobile-options-modal').classList.add('hidden');
                });
                
                document.getElementById('mobile-add-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                // Eventos para modal de edição
                document.querySelectorAll('.close-modal').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.fixed.inset-0.bg-black.bg-opacity-50').forEach(modal => {
                            modal.classList.add('hidden');
                        });
                    });
                });
                
                // Evento para salvar alterações no equipamento
                document.getElementById('save-equipment-btn').addEventListener('click', () => {
                    this.saveEquipmentChanges();
                });
                
                // Evento para salvar agendamento
                document.getElementById('save-schedule-btn').addEventListener('click', () => {
                    this.saveSchedule();
                });
                
                // Eventos para opções dos reboques
                document.getElementById('reboques-options-btn').addEventListener('click', () => {
                    document.getElementById('reboques-options-menu').classList.toggle('hidden');
                });
                
                document.getElementById('reboques-export-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.exportToCSV();
                    document.getElementById('reboques-options-menu').classList.add('hidden');
                });
                
                document.getElementById('reboques-print-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.printActiveTable();
                    document.getElementById('reboques-options-menu').classList.add('hidden');
                });
                
                // Evento para atualização
                document.getElementById('refresh-btn').addEventListener('click', () => {
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.showNotification('success', 'Atualizado', 'Todos os dados foram atualizados.');
                });
                
                // Eventos para adicionar reboque
                document.getElementById('add-reboque-btn').addEventListener('click', () => {
                    document.getElementById('equipment-type').value = 'reboque';
                    this.updateAddFormFields();
                    document.getElementById('add-modal').classList.remove('hidden');
                });
                
                // Evento para adicionar equipamento
                document.getElementById('add-equipment-btn').addEventListener('click', () => {
                    this.showAddEquipmentModal();
                });
                
                // Evento para salvar novo equipamento
                document.getElementById('save-new-equipment-btn').addEventListener('click', () => {
                    this.saveNewEquipment();
                });
                
                // Evento para mudar campos do formulário de adição
                document.getElementById('equipment-type').addEventListener('change', () => {
                    this.updateAddFormFields();
                });
                
                // Eventos para exclusão
                document.getElementById('cancel-delete-btn').addEventListener('click', () => {
                    document.getElementById('delete-confirm-modal').classList.add('hidden');
                });
                
                document.getElementById('confirm-delete-btn').addEventListener('click', () => {
                    this.deleteEquipment();
                });
                
                // Eventos para banco de dados
                document.getElementById('db-actions-btn').addEventListener('click', () => {
                    document.getElementById('db-actions-menu').classList.toggle('hidden');
                });
                
                document.getElementById('backup-db-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('db-actions-menu').classList.add('hidden');
                    document.getElementById('database-modal').classList.remove('hidden');
                });
                
                document.getElementById('import-db-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('db-actions-menu').classList.add('hidden');
                    document.getElementById('database-modal').classList.remove('hidden');
                });
                
                document.getElementById('reset-db-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('db-actions-menu').classList.add('hidden');
                    document.getElementById('reset-confirm-modal').classList.remove('hidden');
                });
                
                // Botões de gestão de banco de dados
                document.getElementById('export-backup-btn').addEventListener('click', () => {
                    this.exportBackup();
                });
                
                document.getElementById('quick-backup-btn').addEventListener('click', () => {
                    this.exportBackup();
                });
                
                // Importação de arquivo
                const fileInput = document.getElementById('import-file-input');
                const dropArea = document.getElementById('file-drop-area');
                
                fileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        this.handleImportFile(file);
                    }
                });
                
                // Drag & Drop
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    }, false);
                });
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropArea.addEventListener(eventName, () => {
                        dropArea.classList.add('active');
                    }, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, () => {
                        dropArea.classList.remove('active');
                    }, false);
                });
                
                dropArea.addEventListener('drop', (e) => {
                    const file = e.dataTransfer.files[0];
                    if (file) {
                        this.handleImportFile(file);
                    }
                }, false);
                
                // Botão de importar
                document.getElementById('import-backup-btn').addEventListener('click', () => {
                    const file = fileInput.files[0];
                    if (file) {
                        const mode = document.getElementById('import-mode').value;
                        this.importBackup(file, mode);
                    } else {
                        this.showNotification('error', 'Nenhum arquivo selecionado', 'Por favor, selecione um arquivo de backup para importar.');
                    }
                });
                
                // Reset confirmação
                document.getElementById('reset-confirm-check').addEventListener('change', (e) => {
                    document.getElementById('confirm-reset-btn').disabled = !e.target.checked;
                    document.getElementById('confirm-reset-btn').classList.toggle('opacity-50', !e.target.checked);
                    document.getElementById('confirm-reset-btn').classList.toggle('cursor-not-allowed', !e.target.checked);
                });
                
                document.getElementById('confirm-reset-btn').addEventListener('click', () => {
                    if (document.getElementById('reset-confirm-check').checked) {
                        this.resetDatabase();
                    }
                });
                
                document.getElementById('cancel-reset-btn').addEventListener('click', () => {
                    document.getElementById('reset-confirm-modal').classList.add('hidden');
                });
                
                document.getElementById('open-reset-confirm-btn').addEventListener('click', () => {
                    document.getElementById('database-modal').classList.add('hidden');
                    document.getElementById('reset-confirm-modal').classList.remove('hidden');
                });
                
                // Eventos para visualização real
                document.querySelectorAll('.equipment-category-filter').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.equipment-category-filter').forEach(b => {
                            b.classList.remove('bg-primary', 'text-white');
                            b.classList.add('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                        });
                        
                        button.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                        button.classList.add('bg-primary', 'text-white');
                        
                        const filter = button.getAttribute('data-filter');
                        this.filterRealEquipment(filter);
                    });
                });
                
                // Eventos para visualização real
                document.getElementById('real-view-options-btn').addEventListener('click', () => {
                    document.getElementById('real-view-options-menu').classList.toggle('hidden');
                });
                
                document.getElementById('real-view-print-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    window.print();
                    document.getElementById('real-view-options-menu').classList.add('hidden');
                });
                
                // Evento para gerar PDF
                document.getElementById('generate-pdf-btn').addEventListener('click', () => {
                    this.generatePDFReport();
                });
                
                // Evento para impressão do dashboard
                document.getElementById('dashboard-print-btn').addEventListener('click', () => {
                    this.printDashboard();
                });
                
                // Eventos de busca e filtros
                document.getElementById('reboque-search').addEventListener('input', (e) => {
                    this.data.searchTerm = e.target.value;
                    this.renderReboquesTable();
                });
                
                document.getElementById('reboque-status-filter').addEventListener('change', (e) => {
                    this.data.statusFilter = e.target.value;
                    this.renderReboquesTable();
                });
                
                // Eventos de ordenação
                document.querySelectorAll('.cursor-pointer[data-sort]').forEach(header => {
                    header.addEventListener('click', () => {
                        const field = header.getAttribute('data-sort');
                        
                        if (this.data.sortField === field) {
                            // Inverter direção se clicar no mesmo campo
                            this.data.sortDirection = this.data.sortDirection === 'asc' ? 'desc' : 'asc';
                        } else {
                            // Nova coluna para ordenar
                            this.data.sortField = field;
                            this.data.sortDirection = 'asc';
                        }
                        
                        // Renderizar a tabela ativa
                        this.renderActiveTable();
                    });
                });
                
                // Evento para fechar notificações
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('close-notification') || e.target.closest('.close-notification')) {
                        const notification = e.target.closest('.notification');
                        if (notification) {
                            notification.remove();
                        }
                    }
                });
                
                // Eventos para remover menus quando clicado fora
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#user-menu-button') && !e.target.closest('#user-menu')) {
                        document.getElementById('user-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#db-actions-btn') && !e.target.closest('#db-actions-menu')) {
                        document.getElementById('db-actions-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#reboques-options-btn') && !e.target.closest('#reboques-options-menu')) {
                        document.getElementById('reboques-options-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#cp-options-btn') && !e.target.closest('#cp-options-menu')) {
                        document.getElementById('cp-options-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#ct-options-btn') && !e.target.closest('#ct-options-menu')) {
                        document.getElementById('ct-options-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#f4001-options-btn') && !e.target.closest('#f4001-options-menu')) {
                        document.getElementById('f4001-options-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#f4002-options-btn') && !e.target.closest('#f4002-options-menu')) {
                        document.getElementById('f4002-options-menu').classList.add('hidden');
                    }
                    
                    if (!e.target.closest('#real-view-options-btn') && !e.target.closest('#real-view-options-menu')) {
                        document.getElementById('real-view-options-menu').classList.add('hidden');
                    }
                });
            },
            
            // Tratar arquivo de importação
            handleImportFile(file) {
                if (file.type !== 'application/json') {
                    this.showNotification('error', 'Tipo de arquivo inválido', 'Por favor, selecione um arquivo .json válido.');
                    return;
                }
                
                // Exibir detalhes do arquivo
                const fileDetails = document.getElementById('file-details');
                const fileNameDisplay = document.getElementById('file-name-display');
                const fileSizeDisplay = document.getElementById('file-size-display');
                
                fileNameDisplay.textContent = file.name;
                
                // Formatando o tamanho do arquivo
                let size;
                if (file.size < 1024) {
                    size = file.size + ' bytes';
                } else if (file.size < 1024 * 1024) {
                    size = (file.size / 1024).toFixed(2) + ' KB';
                } else {
                    size = (file.size / (1024 * 1024)).toFixed(2) + ' MB';
                }
                
                fileSizeDisplay.textContent = `Tamanho: ${size}`;
                fileDetails.classList.remove('hidden');
                
                // Habilitar botão de importação
                document.getElementById('import-backup-btn').disabled = false;
            },
            
            // Configurar sistema de tabs
            setupTabs() {
                // Identificar a tab ativa da URL
                const hash = window.location.hash || '#dashboard';
                const tabId = hash.substring(1);
                
                this.showTab(tabId);
                
                // Atualizar URL quando mudar de tab
                window.addEventListener('hashchange', () => {
                    const hash = window.location.hash || '#dashboard';
                    const tabId = hash.substring(1);
                    this.showTab(tabId);
                });
            },
            
            // Mostrar tab específica
            showTab(tabId) {
                // Esconder todas as tabs
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.add('hidden');
                    tab.classList.remove('active');
                });
                
                // Mostrar a tab alvo
                const targetTab = document.getElementById(tabId);
                if (targetTab) {
                    targetTab.classList.remove('hidden');
                    targetTab.classList.add('active');
                } else {
                    // Fallback para dashboard se a tab não existir
                    document.getElementById('dashboard').classList.remove('hidden');
                    document.getElementById('dashboard').classList.add('active');
                }
                
                // Atualizar o menu ativo
                document.querySelectorAll('a[href^="#"]').forEach(link => {
                    link.classList.remove('active-menu');
                });
                
                const activeMenuItem = document.querySelector(`a[href="#${tabId}"]`);
                if (activeMenuItem) {
                    activeMenuItem.classList.add('active-menu');
                }
            },
            
            // Renderizar todas as tabelas
            renderAllTables() {
                this.renderReboquesTable();
                this.renderCPTable();
                this.renderCTTable();
                this.renderF4001Table();
                this.renderF4002Table();
            },
            
            // Renderizar a tabela ativa
            renderActiveTable() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const id = activeTab.id;
                
                switch(id) {
                    case 'reboques':
                        this.renderReboquesTable();
                        break;
                    case 'caminhoes-proprios':
                        this.renderCPTable();
                        break;
                    case 'caminhoes-terceiros':
                        this.renderCTTable();
                        break;
                    case 'frente-4001':
                        this.renderF4001Table();
                        break;
                    case 'frente-4002':
                        this.renderF4002Table();
                        break;
                }
            },
            
            // Filtrar dados com base nos filtros atuais
            filterData(data) {
                let filtered = [...data];
                
                // Aplicar filtro de busca
                if (this.data.searchTerm) {
                    const searchTerm = this.data.searchTerm.toLowerCase();
                    filtered = filtered.filter(item => {
                        return Object.values(item).some(value => {
                            if (value === null || value === undefined) return false;
                            return value.toString().toLowerCase().includes(searchTerm);
                        });
                    });
                }
                
                // Aplicar filtro de status
                if (this.data.statusFilter && this.data.statusFilter !== 'todos') {
                    filtered = filtered.filter(item => item.status === this.data.statusFilter);
                }
                
                // Aplicar filtro de tipo para frentes
                if (this.data.typeFilter && this.data.typeFilter !== 'todos') {
                    if (this.data.typeFilter === 'colhedora') {
                        filtered = filtered.filter(item => item.type && item.type.includes('Colhedora'));
                    } else if (this.data.typeFilter === 'tracao') {
                        filtered = filtered.filter(item => item.type && item.type.includes('Tração'));
                    }
                }
                
                return filtered;
            },
            
            // Ordenar dados com base no campo e direção atual
            sortData(data) {
                if (!this.data.sortField) return data;
                
                return [...data].sort((a, b) => {
                    const aValue = a[this.data.sortField] || '';
                    const bValue = b[this.data.sortField] || '';
                    
                    let comparison = 0;
                    
                    if (aValue < bValue) {
                        comparison = -1;
                    } else if (aValue > bValue) {
                        comparison = 1;
                    }
                    
                    return this.data.sortDirection === 'asc' ? comparison : -comparison;
                });
            },
            
            // Renderizar tabela de reboques
            renderReboquesTable() {
                const tableBody = document.getElementById('reboques-table-body');
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.reboques);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum reboque encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((reboque, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(reboque.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Aguardando reforma':
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (reboque.dataParada) {
                        const data = new Date(reboque.dataParada);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${reboque.frota || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.tipo || '-'}</td>
                            <td class="px-4 py-3 text-sm">${reboque.acoplado || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${reboque.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">
                                ${reboque.status !== 'Operacional' ? 
                                    `${dataFormatada}<br><span class="text-xs text-gray-500 dark:text-gray-400">${reboque.motivo || '-'}</span>` 
                                    : '-'}
                            </td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${reboque.frota || reboque.acoplado}" data-type="Reboque" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${reboque.frota || reboque.acoplado}" data-type="Reboque" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${reboque.frota || reboque.acoplado}" data-type="Reboque" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${reboque.frota || reboque.acoplado}" data-type="Reboque" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index);
                    });
                });
            },
            
            // Renderizar tabela de caminhões próprios
            renderCPTable() {
                const tableBody = document.getElementById('cp-table-body');
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesProps);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão próprio encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Em reforma':
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        case 'Emprestado':
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (caminhao.data) {
                        const data = new Date(caminhao.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Próprio" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index);
                    });
                });
            },
            
            // Renderizar tabela de caminhões terceiros
            renderCTTable() {
                const tableBody = document.getElementById('ct-table-body');
                
                // Filtrar dados
                let filteredData = this.filterData(this.data.caminhoesTerc);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum caminhão terceirizado encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((caminhao, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(caminhao.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${caminhao.caminhao || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.proprietario || '-'}</td>
                            <td class="px-4 py-3 text-sm">${caminhao.reboques || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${caminhao.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${caminhao.caminhao}" data-type="Caminhão Terceiro" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        this.confirmDeleteEquipment(type, id, index);
                    });
                });
            },
            
            // Renderizar tabela da frente 4001
            renderF4001Table() {
                const tableBody = document.getElementById('f4001-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4001Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4001Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4001Colhedoras' : 'frente4001Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4001" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4001" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        const dataArray = button.getAttribute('data-array');
                        this.confirmDeleteEquipment(type, id, index, dataArray);
                    });
                });
            },
            
            // Renderizar tabela da frente 4002
            renderF4002Table() {
                const tableBody = document.getElementById('f4002-table-body');
                
                // Combinar colhedoras e trações
                let combinedData = [
                    ...this.data.frente4002Colhedoras.map(item => ({
                        ...item,
                        type: 'Colhedora'
                    })),
                    ...this.data.frente4002Tracoes.map(item => ({
                        ...item,
                        type: 'Tração'
                    }))
                ];
                
                // Filtrar dados
                let filteredData = this.filterData(combinedData);
                
                // Ordenar dados
                filteredData = this.sortData(filteredData);
                
                if (filteredData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-sm text-center text-gray-500 dark:text-gray-400">
                                <div class="flex flex-col items-center justify-center py-4">
                                    <i class="fas fa-search text-gray-300 dark:text-gray-600 text-4xl mb-3"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Nenhum equipamento encontrado</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                
                filteredData.forEach((item, index) => {
                    // Determinar cor do status
                    let statusClass = '';
                    switch(item.status) {
                        case 'Operacional':
                            statusClass = 'status-badge-operational';
                            break;
                        case 'Em manutenção':
                            statusClass = 'status-badge-maintenance';
                            break;
                        case 'Inoperante':
                            statusClass = 'status-badge-reform';
                            break;
                        default:
                            statusClass = 'status-badge-other';
                    }
                    
                    // Formatar data
                    let dataFormatada = '';
                    if (item.data) {
                        const data = new Date(item.data);
                        dataFormatada = data.toLocaleDateString('pt-BR');
                    }
                    
                    // Determinar o array correto para o índice
                    const dataArray = item.type === 'Colhedora' ? 'frente4002Colhedoras' : 'frente4002Tracoes';
                    
                    html += `
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-750">
                            <td class="px-4 py-3 text-sm">${item.type}</td>
                            <td class="px-4 py-3 text-sm">${item.codigo || '-'}</td>
                            <td class="px-4 py-3 text-sm">
                                <span class="status-badge ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm">${dataFormatada || '-'}</td>
                            <td class="px-4 py-3 text-sm">${item.motivo || '-'}</td>
                            <td class="px-4 py-3 text-sm text-right">
                                <div class="flex justify-end items-center space-x-2">
                                    <button class="view-history-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="schedule-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Agendar manutenção">
                                        <i class="fas fa-calendar-plus"></i>
                                    </button>
                                    <button class="edit-btn text-primary hover:text-primary-dark" data-id="${item.codigo}" data-type="${item.type} Frente 4002" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300" data-id="${item.codigo}" data-type="${item.type} Frente 4002" data-array="${dataArray}" data-index="${index}" title="Excluir">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tableBody.innerHTML = html;
                
                // Adicionar event listeners para os botões
                tableBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.editEquipment(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.view-history-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.viewEquipmentHistory(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.schedule-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        this.scheduleEquipmentMaintenance(type, id);
                    });
                });
                
                tableBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const id = button.getAttribute('data-id');
                        const type = button.getAttribute('data-type');
                        const index = parseInt(button.getAttribute('data-index'));
                        const dataArray = button.getAttribute('data-array');
                        this.confirmDeleteEquipment(type, id, index, dataArray);
                    });
                });
            },
            
            // Editar equipamento
            editEquipment(type, id) {
                // Encontrar o equipamento por ID e tipo
                let item = null;
                
                if (type === 'Reboque') {
                    item = this.data.reboques.find(r => r.frota === id || r.acoplado === id);
                } else if (type === 'Caminhão Próprio') {
                    item = this.data.caminhoesProps.find(c => c.caminhao === id);
                } else if (type === 'Caminhão Terceiro') {
                    item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                } else if (type.includes('Colhedora Frente 4001')) {
                    item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4001')) {
                    item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                } else if (type.includes('Colhedora Frente 4002')) {
                    item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4002')) {
                    item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                }
                
                if (!item) {
                    this.showNotification('error', 'Equipamento não encontrado', 'Não foi possível encontrar o equipamento para edição.');
                    return;
                }
                
                // Armazenar o item e tipo para uso posterior
                this.data.editingItem = item;
                this.data.editingType = type;
                
                // Configurar o título do modal
                let displayId = '';
                if (type === 'Reboque') {
                    displayId = item.frota || item.acoplado;
                } else if (type.includes('Caminhão')) {
                    displayId = item.caminhao;
                } else {
                    displayId = item.codigo;
                }
                
                document.getElementById('modal-title').textContent = `Editar ${type} #${displayId}`;
                
                // Preencher o formulário com os dados do equipamento
                const formFields = document.getElementById('edit-form-fields');
                let fieldsHTML = '';
                
                if (type === 'Reboque') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota</label>
                                <input type="text" id="edit-frota" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.frota || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <input type="text" id="edit-tipo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.tipo || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="edit-acoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.acoplado || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="edit-tipoAcoplado" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.tipoAcoplado || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${item.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${item.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-dataParada" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.dataParada || ''}">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type === 'Caminhão Próprio') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                    <option value="Emprestado" ${item.status === 'Emprestado' ? 'selected' : ''}>Emprestado</option>
                                    <option value="Na base" ${item.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                    <option value="Reserva" ${item.status === 'Reserva' ? 'selected' : ''}>Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type === 'Caminhão Terceiro') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="edit-caminhao" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.caminhao || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="edit-proprietario" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.proprietario || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="edit-reboques" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.reboques || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Na base" ${item.status === 'Na base' ? 'selected' : ''}>Na base</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${item.motivo || ''}</textarea>
                        </div>
                    `;
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="edit-codigo" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.codigo || ''}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="edit-status" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <<option value="Operacional" ${item.status === 'Operacional' ? 'selected' : ''}>Operacional</option>
                                    <option value="Em manutenção" ${item.status === 'Em manutenção' ? 'selected' : ''}>Em manutenção</option>
                                    <option value="Em reforma" ${item.status === 'Em reforma' ? 'selected' : ''}>Em reforma</option>
                                    <option value="Inoperante" ${item.status === 'Inoperante' ? 'selected' : ''}>Inoperante</option>
                                    <option value="Aguardando reforma" ${item.status === 'Aguardando reforma' ? 'selected' : ''}>Aguardando reforma</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="edit-data" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${item.data || ''}">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="edit-motivo" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">${item.motivo || ''}</textarea>
                        </div>
                    `;
                }
                
                formFields.innerHTML = fieldsHTML;
                
                // Mostrar o modal
                document.getElementById('edit-modal').classList.remove('hidden');
            },
            
            // Salvar alterações no equipamento
            saveEquipmentChanges() {
                const item = this.data.editingItem;
                const type = this.data.editingType;
                
                if (!item || !type) {
                    this.showNotification('error', 'Erro ao salvar', 'Não foi possível identificar o equipamento para salvar as alterações.');
                    return;
                }
                
                // Obter valores do formulário de acordo com o tipo
                if (type === 'Reboque') {
                    const oldStatus = item.status;
                    const newStatus = document.getElementById('edit-status').value;
                    
                    // Capturar todos os valores do formulário
                    item.frota = document.getElementById('edit-frota').value;
                    item.tipo = document.getElementById('edit-tipo').value;
                    item.acoplado = document.getElementById('edit-acoplado').value;
                    item.tipoAcoplado = document.getElementById('edit-tipoAcoplado').value;
                    item.status = newStatus;
                    item.dataParada = document.getElementById('edit-dataParada').value;
                    item.motivo = document.getElementById('edit-motivo').value;
                    
                    // Adicionar ao histórico se o status mudou
                    if (oldStatus !== newStatus) {
                        this.addToHistory(item.frota || item.acoplado, oldStatus, newStatus);
                    }
                    
                } else if (type === 'Caminhão Próprio') {
                    const oldStatus = item.status;
                    const newStatus = document.getElementById('edit-status').value;
                    
                    item.caminhao = document.getElementById('edit-caminhao').value;
                    item.status = newStatus;
                    item.data = document.getElementById('edit-data').value;
                    item.motivo = document.getElementById('edit-motivo').value;
                    
                    // Adicionar ao histórico se o status mudou
                    if (oldStatus !== newStatus) {
                        this.addToHistory(item.caminhao, oldStatus, newStatus);
                    }
                    
                } else if (type === 'Caminhão Terceiro') {
                    const oldStatus = item.status;
                    const newStatus = document.getElementById('edit-status').value;
                    
                    item.caminhao = document.getElementById('edit-caminhao').value;
                    item.proprietario = document.getElementById('edit-proprietario').value;
                    item.reboques = document.getElementById('edit-reboques').value;
                    item.status = newStatus;
                    item.motivo = document.getElementById('edit-motivo').value;
                    
                    // Adicionar ao histórico se o status mudou
                    if (oldStatus !== newStatus) {
                        this.addToHistory(item.caminhao, oldStatus, newStatus);
                    }
                    
                } else if (type.includes('Colhedora') || type.includes('Tração')) {
                    const oldStatus = item.status;
                    const newStatus = document.getElementById('edit-status').value;
                    
                    item.codigo = document.getElementById('edit-codigo').value;
                    item.status = newStatus;
                    item.data = document.getElementById('edit-data').value;
                    item.motivo = document.getElementById('edit-motivo').value;
                    
                    // Adicionar ao histórico se o status mudou
                    if (oldStatus !== newStatus) {
                        this.addToHistory(item.codigo, oldStatus, newStatus);
                    }
                }
                
                // Salvar os dados atualizados no localStorage
                this.saveDataToLocalStorage();
                
                // Fechar o modal
                document.getElementById('edit-modal').classList.add('hidden');
                
                // Renderizar a tabela ativa novamente
                this.renderActiveTable();
                
                // Atualizar dashboards e visualizações
                this.updateAllDashboards();
                this.updateAllCharts();
                this.initializeRealEquipmentView();
                
                // Mostrar notificação de sucesso
                this.showNotification('success', 'Alterações salvas', 'As alterações no equipamento foram salvas com sucesso.');
            },
            
            // Confirmar exclusão de equipamento
            confirmDeleteEquipment(type, id, index, dataArray = null) {
                // Armazenar informações para uso na função de exclusão
                this.data.deletingType = type;
                this.data.deletingId = id;
                this.data.deletingIndex = index;
                this.data.deletingArray = dataArray;
                
                // Determinar qual array usar para obter o item
                let item = null;
                
                if (type === 'Reboque') {
                    item = this.data.reboques.find(r => r.frota === id || r.acoplado === id);
                } else if (type === 'Caminhão Próprio') {
                    item = this.data.caminhoesProps.find(c => c.caminhao === id);
                } else if (type === 'Caminhão Terceiro') {
                    item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                } else if (type.includes('Colhedora Frente 4001')) {
                    item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4001')) {
                    item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                } else if (type.includes('Colhedora Frente 4002')) {
                    item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4002')) {
                    item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                }
                
                if (!item) {
                    this.showNotification('error', 'Equipamento não encontrado', 'Não foi possível encontrar o equipamento para exclusão.');
                    return;
                }
                
                this.data.deletingItem = item;
                
                // Configurar mensagem de confirmação
                document.getElementById('delete-confirm-message').textContent = `Tem certeza que deseja excluir o ${type} #${id}? Esta ação não pode ser desfeita.`;
                
                // Mostrar detalhes do item
                let details = '';
                
                if (type === 'Reboque') {
                    details = `Frota: ${item.frota || '-'}, Tipo: ${item.tipo || '-'}, Status: ${item.status}`;
                } else if (type.includes('Caminhão')) {
                    details = `Caminhão: ${item.caminhao}, Status: ${item.status}`;
                } else {
                    details = `Código: ${item.codigo}, Status: ${item.status}`;
                }
                
                document.getElementById('delete-item-details').textContent = details;
                
                // Mostrar modal de confirmação
                document.getElementById('delete-confirm-modal').classList.remove('hidden');
            },
            
            // Excluir equipamento
            deleteEquipment() {
                const type = this.data.deletingType;
                const id = this.data.deletingId;
                
                if (!type || !id) {
                    this.showNotification('error', 'Erro ao excluir', 'Não foi possível identificar o equipamento para exclusão.');
                    return;
                }
                
                let success = false;
                
                // Remover o equipamento do array apropriado
                if (type === 'Reboque') {
                    // Encontrar o índice do reboque
                    const index = this.data.reboques.findIndex(r => r.frota === id || r.acoplado === id);
                    if (index !== -1) {
                        this.data.reboques.splice(index, 1);
                        success = true;
                    }
                } else if (type === 'Caminhão Próprio') {
                    const index = this.data.caminhoesProps.findIndex(c => c.caminhao === id);
                    if (index !== -1) {
                        this.data.caminhoesProps.splice(index, 1);
                        success = true;
                    }
                } else if (type === 'Caminhão Terceiro') {
                    const index = this.data.caminhoesTerc.findIndex(c => c.caminhao === id);
                    if (index !== -1) {
                        this.data.caminhoesTerc.splice(index, 1);
                        success = true;
                    }
                } else if (type.includes('Colhedora Frente 4001')) {
                    const index = this.data.frente4001Colhedoras.findIndex(c => c.codigo === id);
                    if (index !== -1) {
                        this.data.frente4001Colhedoras.splice(index, 1);
                        success = true;
                    }
                } else if (type.includes('Tração Frente 4001')) {
                    const index = this.data.frente4001Tracoes.findIndex(t => t.codigo === id);
                    if (index !== -1) {
                        this.data.frente4001Tracoes.splice(index, 1);
                        success = true;
                    }
                } else if (type.includes('Colhedora Frente 4002')) {
                    const index = this.data.frente4002Colhedoras.findIndex(c => c.codigo === id);
                    if (index !== -1) {
                        this.data.frente4002Colhedoras.splice(index, 1);
                        success = true;
                    }
                } else if (type.includes('Tração Frente 4002')) {
                    const index = this.data.frente4002Tracoes.findIndex(t => t.codigo === id);
                    if (index !== -1) {
                        this.data.frente4002Tracoes.splice(index, 1);
                        success = true;
                    }
                }
                
                if (success) {
                    // Remover histórico associado
                    if (this.data.history[id]) {
                        delete this.data.history[id];
                    }
                    
                    // Remover agendamentos associados
                    this.data.schedules = this.data.schedules.filter(s => s.equipment !== id);
                    
                    // Salvar os dados atualizados
                    this.saveDataToLocalStorage();
                    
                    // Fechar o modal
                    document.getElementById('delete-confirm-modal').classList.add('hidden');
                    
                    // Renderizar a tabela ativa novamente
                    this.renderActiveTable();
                    
                    // Atualizar dashboards e visualizações
                    this.updateAllDashboards();
                    this.updateAllCharts();
                    this.initializeRealEquipmentView();
                    
                    // Mostrar notificação de sucesso
                    this.showNotification('success', 'Equipamento excluído', `O ${type} #${id} foi excluído com sucesso.`);
                } else {
                    this.showNotification('error', 'Erro ao excluir', 'Não foi possível excluir o equipamento.');
                }
            },
            
            // Visualizar histórico do equipamento
            viewEquipmentHistory(type, id) {
                // Configurar título do modal
                const historyTitle = document.getElementById('history-title');
                historyTitle.textContent = `Histórico do ${type} #${id}`;
                
                // Configurar ícone
                const historyIcon = document.getElementById('history-icon');
                
                if (type === 'Reboque') {
                    historyIcon.className = 'fas fa-trailer';
                } else if (type.includes('Caminhão')) {
                    historyIcon.className = 'fas fa-truck';
                } else if (type.includes('Colhedora')) {
                    historyIcon.className = 'fas fa-tractor';
                } else if (type.includes('Tração')) {
                    historyIcon.className = 'fas fa-truck-monster';
                } else {
                    historyIcon.className = 'fas fa-cog';
                }
                
                // Obter histórico do equipamento
                const history = this.data.history[id] || [];
                
                // Mostrar contagem no subtítulo
                const historySubtitle = document.getElementById('history-subtitle');
                historySubtitle.textContent = `Total de registros: ${history.length}`;
                
                // Gerar timeline do histórico
                const timelineContainer = document.getElementById('history-timeline');
                
                if (history.length === 0) {
                    timelineContainer.innerHTML = `
                        <div class="flex flex-col items-start mb-6 ml-6 relative">
                            <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full bg-gray-400"></div>
                            <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-medium">Nenhum histórico encontrado para este equipamento.</p>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Ordenar histórico por data, mais recentes primeiro
                    history.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    let timelineHTML = '';
                    
                    history.forEach((entry, index) => {
                        // Formatar data para exibição
                        const date = new Date(entry.date);
                        const formattedDate = date.toLocaleDateString('pt-BR');
                        const formattedTime = date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                        
                        // Determinar cor do status
                        let statusColor = '';
                        switch(entry.status) {
                            case 'Operacional':
                                statusColor = 'bg-green-500';
                                break;
                            case 'Em manutenção':
                                statusColor = 'bg-yellow-500';
                                break;
                            case 'Em reforma':
                            case 'Aguardando reforma':
                            case 'Inoperante':
                                statusColor = 'bg-red-500';
                                break;
                            case 'Emprestado':
                                statusColor = 'bg-purple-500';
                                break;
                            default:
                                statusColor = 'bg-blue-500';
                        }
                        
                        timelineHTML += `
                            <div class="flex flex-col items-start mb-6 ml-6 relative">
                                <div class="absolute -left-10 mt-1.5 w-4 h-4 rounded-full ${statusColor}"></div>
                                <div class="bg-white dark:bg-gray-700 p-3 rounded-lg shadow w-full">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-sm font-medium">${entry.description}</p>
                                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${formattedDate} às ${formattedTime}</p>
                                        </div>
                                        <span class="px-2 py-1 text-xs rounded-full bg-opacity-10 ${'bg-' + statusColor.split('-')[1] + '-100 text-' + statusColor.split('-')[1] + '-600'} dark:${'bg-' + statusColor.split('-')[1] + '-900 text-' + statusColor.split('-')[1] + '-300'}">
                                            ${entry.status}
                                        </span>
                                    </div>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Registrado por: ${entry.user || 'Sistema'}</p>
                                </div>
                            </div>
                        `;
                    });
                    
                    timelineContainer.innerHTML = timelineHTML;
                }
                
                // Mostrar o modal
                document.getElementById('history-modal').classList.remove('hidden');
            },
            
            // Adicionar entrada ao histórico
            addToHistory(id, oldStatus, newStatus) {
                if (!id) return;
                
                // Inicializar o histórico para este equipamento se não existir
                if (!this.data.history[id]) {
                    this.data.history[id] = [];
                }
                
                // Obter data e hora atual
                const now = new Date();
                
                // Criar nova entrada no histórico
                const historyEntry = {
                    date: now.toISOString(),
                    status: newStatus,
                    description: oldStatus ? `Status alterado de ${oldStatus} para ${newStatus}` : `Status definido como ${newStatus}`,
                    user: 'Usuário do sistema'
                };
                
                // Adicionar ao histórico
                this.data.history[id].push(historyEntry);
                
                // Limitar o histórico a 100 entradas por equipamento (opcional)
                if (this.data.history[id].length > 100) {
                    this.data.history[id] = this.data.history[id].slice(-100);
                }
            },
            
            // Agendar manutenção de equipamento
            scheduleEquipmentMaintenance(type, id) {
                // Encontrar o equipamento
                let item = null;
                
                if (type === 'Reboque') {
                    item = this.data.reboques.find(r => r.frota === id || r.acoplado === id);
                } else if (type === 'Caminhão Próprio') {
                    item = this.data.caminhoesProps.find(c => c.caminhao === id);
                } else if (type === 'Caminhão Terceiro') {
                    item = this.data.caminhoesTerc.find(c => c.caminhao === id);
                } else if (type.includes('Colhedora Frente 4001')) {
                    item = this.data.frente4001Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4001')) {
                    item = this.data.frente4001Tracoes.find(t => t.codigo === id);
                } else if (type.includes('Colhedora Frente 4002')) {
                    item = this.data.frente4002Colhedoras.find(c => c.codigo === id);
                } else if (type.includes('Tração Frente 4002')) {
                    item = this.data.frente4002Tracoes.find(t => t.codigo === id);
                }
                
                if (!item) {
                    this.showNotification('error', 'Equipamento não encontrado', 'Não foi possível encontrar o equipamento para agendar manutenção.');
                    return;
                }
                
                // Configurar informações do equipamento no modal
                const infoContainer = document.getElementById('schedule-equipment-info');
                
                let statusClass = '';
                switch(item.status) {
                    case 'Operacional':
                        statusClass = 'text-green-500 dark:text-green-400';
                        break;
                    case 'Em manutenção':
                        statusClass = 'text-yellow-500 dark:text-yellow-400';
                        break;
                    case 'Em reforma':
                    case 'Aguardando reforma':
                    case 'Inoperante':
                        statusClass = 'text-red-500 dark:text-red-400';
                        break;
                    default:
                        statusClass = 'text-blue-500 dark:text-blue-400';
                }
                
                let equipmentDetails = '';
                
                if (type === 'Reboque') {
                    equipmentDetails = `
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-primary bg-opacity-10 flex items-center justify-center text-primary mr-3">
                                <i class="fas fa-trailer"></i>
                            </div>
                            <div>
                                <h4 class="font-medium">${type} #${id}</h4>
                                <p class="text-xs ${statusClass}">Status: ${item.status}</p>
                            </div>
                        </div>
                    `;
                } else if (type.includes('Caminhão')) {
                    equipmentDetails = `
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-primary bg-opacity-10 flex items-center justify-center text-primary mr-3">
                                <i class="fas fa-truck"></i>
                            </div>
                            <div>
                                <h4 class="font-medium">${type} #${id}</h4>
                                <p class="text-xs ${statusClass}">Status: ${item.status}</p>
                            </div>
                        </div>
                    `;
                } else if (type.includes('Colhedora')) {
                    equipmentDetails = `
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-primary bg-opacity-10 flex items-center justify-center text-primary mr-3">
                                <i class="fas fa-tractor"></i>
                            </div>
                            <div>
                                <h4 class="font-medium">${type} #${id}</h4>
                                <p class="text-xs ${statusClass}">Status: ${item.status}</p>
                            </div>
                        </div>
                    `;
                } else if (type.includes('Tração')) {
                    equipmentDetails = `
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-primary bg-opacity-10 flex items-center justify-center text-primary mr-3">
                                <i class="fas fa-truck-monster"></i>
                            </div>
                            <div>
                                <h4 class="font-medium">${type} #${id}</h4>
                                <p class="text-xs ${statusClass}">Status: ${item.status}</p>
                            </div>
                        </div>
                    `;
                }
                
                infoContainer.innerHTML = equipmentDetails;
                
                // Configurar data mínima para o agendamento (hoje)
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('schedule-date').min = today;
                
                // Inicializar campos do formulário
                document.getElementById('schedule-date').value = today;
                document.getElementById('schedule-time').value = '08:00';
                document.getElementById('schedule-type').value = 'preventiva';
                document.getElementById('schedule-description').value = '';
                document.getElementById('schedule-responsible').value = '';
                
                // Armazenar informações para uso posterior
                this.data.schedulingType = type;
                this.data.schedulingId = id;
                
                // Mostrar o modal
                document.getElementById('schedule-modal').classList.remove('hidden');
            },
            
            // Salvar agendamento de manutenção
            saveSchedule() {
                const type = this.data.schedulingType;
                const id = this.data.schedulingId;
                
                if (!type || !id) {
                    this.showNotification('error', 'Erro ao agendar', 'Não foi possível identificar o equipamento para agendamento.');
                    return;
                }
                
                // Obter valores do formulário
                const date = document.getElementById('schedule-date').value;
                const time = document.getElementById('schedule-time').value;
                const scheduleType = document.getElementById('schedule-type').value;
                const description = document.getElementById('schedule-description').value;
                const responsible = document.getElementById('schedule-responsible').value;
                
                // Validar campos obrigatórios
                if (!date || !time || !description || !responsible) {
                    this.showNotification('error', 'Campos obrigatórios', 'Por favor, preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Criar novo agendamento
                const newSchedule = {
                    equipment: id,
                    equipmentType: type,
                    date: date,
                    time: time,
                    type: scheduleType,
                    description: description,
                    responsible: responsible,
                    created: new Date().toISOString(),
                    status: 'scheduled'
                };
                
                // Adicionar à lista de agendamentos
                this.data.schedules.push(newSchedule);
                
                // Salvar no localStorage
                this.saveDataToLocalStorage();
                
                // Fechar o modal
                document.getElementById('schedule-modal').classList.add('hidden');
                
                // Atualizar dashboards
                this.updateAllDashboards();
                
                // Mostrar notificação de sucesso
                this.showNotification('success', 'Agendamento criado', `Manutenção agendada para ${new Date(date).toLocaleDateString('pt-BR')} às ${time}.`);
            },
            
            // Obter nome amigável do tipo de manutenção
            getMaintenanceTypeName(type) {
                switch(type) {
                    case 'preventiva': return 'Preventiva';
                    case 'corretiva': return 'Corretiva';
                    case 'revisao': return 'Revisão Geral';
                    case 'troca-oleo': return 'Troca de Óleo';
                    case 'reforma': return 'Reforma';
                    case 'outro': return 'Outro';
                    default: return type;
                }
            },
            
            // Mostrar modal para adicionar equipamento
            showAddEquipmentModal() {
                document.getElementById('equipment-type').value = 'reboque';
                this.updateAddFormFields();
                document.getElementById('add-modal').classList.remove('hidden');
            },
            
            // Atualizar campos do formulário de adição conforme o tipo
            updateAddFormFields() {
                const type = document.getElementById('equipment-type').value;
                const formFields = document.getElementById('add-form-fields');
                let fieldsHTML = '';
                
                if (type === 'reboque') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frota</label>
                                <input type="text" id="add-frota-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                <input type="text" id="add-tipo-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Acoplado Com</label>
                                <input type="text" id="add-acoplado-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo Acoplado</label>
                                <input type="text" id="add-tipoAcoplado-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Parada</label>
                                <input type="date" id="add-dataParada-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo-1" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Necessário apenas para equipamentos não operacionais</p>
                        </div>
                    `;
                } else if (type === 'caminhao-proprio') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="add-caminhao-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status-2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                    <option value="Emprestado">Emprestado</option>
                                    <option value="Na base">Na base</option>
                                    <option value="Reserva">Reserva</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo-2" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Necessário apenas para equipamentos não operacionais</p>
                        </div>
                    `;
                } else if (type === 'caminhao-terceiro') {
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                <input type="text" id="add-caminhao-2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Proprietário</label>
                                <input type="text" id="add-proprietario-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reboques</label>
                                <input type="text" id="add-reboques-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                <p class="text-xs text-gray-500 mt-1">Use hífens para separar múltiplos reboques (ex: 1101-1102)</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status-3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Na base">Na base</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo-3" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Necessário apenas para equipamentos não operacionais</p>
                        </div>
                    `;
                } else if (type === 'colhedora-4001' || type === 'colhedora-4002') {
                    const frente = type === 'colhedora-4001' ? '4001' : '4002';
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="add-codigo-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status-4" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data-2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frente</label>
                                <input type="text" id="add-frente-1" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${frente}" readonly>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo-4" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Necessário apenas para equipamentos não operacionais</p>
                        </div>
                    `;
                } else if (type === 'tracao-4001' || type === 'tracao-4002') {
                    const frente = type === 'tracao-4001' ? '4001' : '4002';
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Código</label>
                                <input type="text" id="add-codigo-2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                <select id="add-status-5" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                                    <option value="Operacional">Operacional</option>
                                    <option value="Em manutenção">Em manutenção</option>
                                    <option value="Em reforma">Em reforma</option>
                                    <option value="Inoperante">Inoperante</option>
                                    <option value="Aguardando reforma">Aguardando reforma</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                <input type="date" id="add-data-3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frente</label>
                                <input type="text" id="add-frente-2" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100" value="${frente}" readonly>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motivo</label>
                            <textarea id="add-motivo-5" rows="3" class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Necessário apenas para equipamentos não operacionais</p>
                        </div>
                    `;
                }
                
                formFields.innerHTML = fieldsHTML;
            },
            
            // Salvar novo equipamento
            saveNewEquipment() {
                const type = document.getElementById('equipment-type').value;
                
                // Criar objeto de acordo com o tipo
                let newEquipment = {};
                
                if (type === 'reboque') {
                    newEquipment = {
                        frota: document.getElementById('add-frota-1').value,
                        tipo: document.getElementById('add-tipo-1').value,
                        acoplado: document.getElementById('add-acoplado-1').value,
                        tipoAcoplado: document.getElementById('add-tipoAcoplado-1').value,
                        status: document.getElementById('add-status-1').value,
                        dataParada: document.getElementById('add-dataParada-1').value,
                        motivo: document.getElementById('add-motivo-1').value
                    };
                    
                    // Adicionar à lista de reboques
                    this.data.reboques.push(newEquipment);
                    
                    // Adicionar ao histórico
                    const id = newEquipment.frota || newEquipment.acoplado;
                    this.addToHistory(id, '', newEquipment.status);
                    
                } else if (type === 'caminhao-proprio') {
                    newEquipment = {
                        caminhao: document.getElementById('add-caminhao-1').value,
                        status: document.getElementById('add-status-2').value,
                        data: document.getElementById('add-data-1').value,
                        motivo: document.getElementById('add-motivo-2').value
                    };
                    
                    // Adicionar à lista de caminhões próprios
                    this.data.caminhoesProps.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.caminhao, '', newEquipment.status);
                    
                } else if (type === 'caminhao-terceiro') {
                    newEquipment = {
                        caminhao: document.getElementById('add-caminhao-2').value,
                        proprietario: document.getElementById('add-proprietario-1').value,
                        reboques: document.getElementById('add-reboques-1').value,
                        status: document.getElementById('add-status-3').value,
                        motivo: document.getElementById('add-motivo-3').value
                    };
                    
                    // Adicionar à lista de caminhões terceiros
                    this.data.caminhoesTerc.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.caminhao, '', newEquipment.status);
                    
                } else if (type === 'colhedora-4001') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo-1').value,
                        status: document.getElementById('add-status-4').value,
                        data: document.getElementById('add-data-2').value,
                        motivo: document.getElementById('add-motivo-4').value
                    };
                    
                    // Adicionar à lista de colhedoras frente 4001
                    this.data.frente4001Colhedoras.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.codigo, '', newEquipment.status);
                    
                } else if (type === 'tracao-4001') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo-2').value,
                        status: document.getElementById('add-status-5').value,
                        data: document.getElementById('add-data-3').value,
                        motivo: document.getElementById('add-motivo-5').value
                    };
                    
                    // Adicionar à lista de trações frente 4001
                    this.data.frente4001Tracoes.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.codigo, '', newEquipment.status);
                    
                } else if (type === 'colhedora-4002') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo-1').value,
                        status: document.getElementById('add-status-4').value,
                        data: document.getElementById('add-data-2').value,
                        motivo: document.getElementById('add-motivo-4').value
                    };
                    
                    // Adicionar à lista de colhedoras frente 4002
                    this.data.frente4002Colhedoras.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.codigo, '', newEquipment.status);
                    
                } else if (type === 'tracao-4002') {
                    newEquipment = {
                        codigo: document.getElementById('add-codigo-2').value,
                        status: document.getElementById('add-status-5').value,
                        data: document.getElementById('add-data-3').value,
                        motivo: document.getElementById('add-motivo-5').value
                    };
                    
                    // Adicionar à lista de trações frente 4002
                    this.data.frente4002Tracoes.push(newEquipment);
                    
                    // Adicionar ao histórico
                    this.addToHistory(newEquipment.codigo, '', newEquipment.status);
                }
                
                // Salvar os dados no localStorage
                this.saveDataToLocalStorage();
                
                // Fechar modal
                document.getElementById('add-modal').classList.add('hidden');
                
                // Re-renderizar a tabela ativa
                this.renderActiveTable();
                
                // Atualizar contadores dos dashboards
                this.updateAllDashboards();
                
                // Atualizar gráficos
                this.updateAllCharts();
                
                // Atualizar visualização real
                this.initializeRealEquipmentView();
                
                // Mostrar notificação
                this.showNotification('success', 'Equipamento adicionado', 'O novo equipamento foi adicionado com sucesso.');
            },
            
            // Atualizar todas as dashboards
            updateAllDashboards() {
                // Dashboard principal
                this.updateMainDashboard();
                
                // Dashboards específicas por categoria
                this.updateReboquesDashboard();
                this.updateCPDashboard();
                this.updateCTDashboard();
                this.updateF4001Dashboard();
                this.updateF4002Dashboard();
                
                // Atualizar listas no dashboard
                this.updateDashboardLists();
            },
            
            // Atualizar dashboard principal
            updateMainDashboard() {
                // Contar status em todos os equipamentos
                const statusCounts = {
                    operational: 0,
                    maintenance: 0,
                    reform: 0,
                    borrowed: 0,
                    other: 0,
                    total: 0
                };
                
                // Função para contar status em uma lista
                const countStatus = (list) => {
                    list.forEach(item => {
                        statusCounts.total++;
                        
                        if (item.status === 'Operacional') {
                            statusCounts.operational++;
                        } else if (item.status === 'Em manutenção') {
                            statusCounts.maintenance++;
                        } else if (item.status === 'Em reforma' || item.status === 'Aguardando reforma' || item.status === 'Inoperante') {
                            statusCounts.reform++;
                        } else if (item.status === 'Emprestado') {
                            statusCounts.borrowed++;
                        } else {
                            statusCounts.other++;
                        }
                    });
                };
                
                // Contar status em todas as listas
                countStatus(this.data.reboques);
                countStatus(this.data.caminhoesProps);
                countStatus(this.data.caminhoesTerc);
                countStatus(this.data.frente4001Colhedoras);
                countStatus(this.data.frente4001Tracoes);
                countStatus(this.data.frente4002Colhedoras);
                countStatus(this.data.frente4002Tracoes);
                
                // Calcular porcentagens
                const operationalPercent = statusCounts.total > 0 ? Math.round((statusCounts.operational / statusCounts.total) * 100) : 0;
                const maintenancePercent = statusCounts.total > 0 ? Math.round((statusCounts.maintenance / statusCounts.total) * 100) : 0;
                const reformPercent = statusCounts.total > 0 ? Math.round((statusCounts.reform / statusCounts.total) * 100) : 0;
                const borrowedPercent = statusCounts.total > 0 ? Math.round((statusCounts.borrowed / statusCounts.total) * 100) : 0;
                const otherPercent = statusCounts.total > 0 ? Math.round((statusCounts.other / statusCounts.total) * 100) : 0;
                
                // Atualizar resumo visual
                document.getElementById('dash-summary-operational').textContent = statusCounts.operational;
                document.getElementById('dash-summary-maintenance').textContent = statusCounts.maintenance;
                document.getElementById('dash-summary-reform').textContent = statusCounts.reform;
                document.getElementById('dash-summary-borrowed').textContent = statusCounts.borrowed;
                document.getElementById('dash-summary-other').textContent = statusCounts.other;
                document.getElementById('dash-summary-availability').textContent = `${operationalPercent}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('dash-availability-bar').style.width = `${operationalPercent}%`;
                
                // Atualizar cards
                
                // Caminhões Próprios
                const cpTotal = this.data.caminhoesProps.length;
                const cpOperational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpMaintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const cpPercent = cpTotal > 0 ? Math.round((cpOperational / cpTotal) * 100) : 0;
                
                document.getElementById('dash-cp-count').textContent = cpTotal;
                document.getElementById('dash-cp-operational').textContent = cpOperational;
                document.getElementById('dash-cp-maintenance').textContent = cpMaintenance;
                document.getElementById('dash-cp-bar').style.width = `${cpPercent}%`;
                
                // Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOperational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesMaintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reboquesPercent = reboquesTotal > 0 ? Math.round((reboquesOperational / reboquesTotal) * 100) : 0;
                
                document.getElementById('dash-reboques-count').textContent = reboquesTotal;
                document.getElementById('dash-reboques-operational').textContent = reboquesOperational;
                document.getElementById('dash-reboques-maintenance').textContent = reboquesMaintenance;
                document.getElementById('dash-reboques-bar').style.width = `${reboquesPercent}%`;
                
                // Frente 4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Operational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                          this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Maintenance = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                          this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                const f4001Percent = f4001Total > 0 ? Math.round((f4001Operational / f4001Total) * 100) : 0;
                
                document.getElementById('dash-f4001-count').textContent = f4001Total;
                document.getElementById('dash-f4001-operational').textContent = f4001Operational;
                document.getElementById('dash-f4001-maintenance').textContent = f4001Maintenance;
                document.getElementById('dash-f4001-bar').style.width = `${f4001Percent}%`;
                
                // Frente 4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Operational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                          this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Maintenance = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                          this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                const f4002Percent = f4002Total > 0 ? Math.round((f4002Operational / f4002Total) * 100) : 0;
                
                document.getElementById('dash-f4002-count').textContent = f4002Total;
                document.getElementById('dash-f4002-operational').textContent = f4002Operational;
                document.getElementById('dash-f4002-maintenance').textContent = f4002Maintenance;
                document.getElementById('dash-f4002-bar').style.width = `${f4002Percent}%`;
                
                // Status global
                document.getElementById('dash-global-operational').textContent = statusCounts.operational;
                document.getElementById('dash-global-operational-percent').textContent = `${operationalPercent}%`;
                document.getElementById('dash-global-maintenance').textContent = statusCounts.maintenance;
                document.getElementById('dash-global-maintenance-percent').textContent = `${maintenancePercent}%`;
                document.getElementById('dash-global-reform').textContent = statusCounts.reform;
                document.getElementById('dash-global-reform-percent').textContent = `${reformPercent}%`;
                document.getElementById('dash-global-other').textContent = statusCounts.borrowed + statusCounts.other;
                document.getElementById('dash-global-other-percent').textContent = `${borrowedPercent + otherPercent}%`;
                document.getElementById('dash-global-total').textContent = statusCounts.total;
            },
            
            // Atualizar dashboard de reboques
            updateReboquesDashboard() {
                const total = this.data.reboques.length;
                const operational = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const maintenance = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                const reform = this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length;
                
                const operationalPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                const maintenancePercent = total > 0 ? Math.round((maintenance / total) * 100) : 0;
                const reformPercent = total > 0 ? Math.round((reform / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('reboques-operational').textContent = operational;
                document.getElementById('reboques-operational-percentage').textContent = `${operationalPercent}%`;
                document.getElementById('reboques-maintenance').textContent = maintenance;
                document.getElementById('reboques-maintenance-percentage').textContent = `${maintenancePercent}%`;
                document.getElementById('reboques-reform').textContent = reform;
                document.getElementById('reboques-reform-percentage').textContent = `${reformPercent}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('reboques-availability').textContent = `${operationalPercent}%`;
                document.getElementById('reboques-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard de caminhões próprios
            updateCPDashboard() {
                if (!document.getElementById('cp-operational')) return;
                
                const total = this.data.caminhoesProps.length;
                const operational = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                const reform = this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length;
                
                const operationalPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                const maintenancePercent = total > 0 ? Math.round((maintenance / total) * 100) : 0;
                const reformPercent = total > 0 ? Math.round((reform / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('cp-operational').textContent = operational;
                document.getElementById('cp-operational-percentage').textContent = `${operationalPercent}%`;
                document.getElementById('cp-maintenance').textContent = maintenance;
                document.getElementById('cp-maintenance-percentage').textContent = `${maintenancePercent}%`;
                document.getElementById('cp-reform').textContent = reform;
                document.getElementById('cp-reform-percentage').textContent = `${reformPercent}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('cp-availability').textContent = `${operationalPercent}%`;
                document.getElementById('cp-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard de caminhões terceiros
            updateCTDashboard() {
                if (!document.getElementById('ct-operational')) return;
                
                const total = this.data.caminhoesTerc.length;
                const operational = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const maintenance = this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length;
                const other = this.data.caminhoesTerc.filter(c => c.status !== 'Operacional' && c.status !== 'Em manutenção').length;
                
                const operationalPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                const maintenancePercent = total > 0 ? Math.round((maintenance / total) * 100) : 0;
                const otherPercent = total > 0 ? Math.round((other / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('ct-operational').textContent = operational;
                document.getElementById('ct-operational-percentage').textContent = `${operationalPercent}%`;
                document.getElementById('ct-maintenance').textContent = maintenance;
                document.getElementById('ct-maintenance-percentage').textContent = `${maintenancePercent}%`;
                document.getElementById('ct-other').textContent = other;
                document.getElementById('ct-other-percentage').textContent = `${otherPercent}%`;
                
                // Atualizar barra de disponibilidade
                document.getElementById('ct-availability').textContent = `${operationalPercent}%`;
                document.getElementById('ct-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard da frente 4001
            updateF4001Dashboard() {
                if (!document.getElementById('f4001-operational')) return;
                
                const total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const operational = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                    this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const maintenance = this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                    this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length;
                const reform = this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length +
                               this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length;
                
                const operationalPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('f4001-operational').textContent = operational;
                document.getElementById('f4001-maintenance').textContent = maintenance;
                document.getElementById('f4001-reform').textContent = reform;
                document.getElementById('f4001-total').textContent = total;
                
                // Atualizar barra de disponibilidade
                document.getElementById('f4001-availability').textContent = `${operationalPercent}%`;
                document.getElementById('f4001-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar dashboard da frente 4002
            updateF4002Dashboard() {
                if (!document.getElementById('f4002-operational')) return;
                
                const total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const operational = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                    this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const maintenance = this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length +
                                    this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length;
                const reform = this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length +
                               this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length;
                
                const operationalPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                // Atualizar contadores
                document.getElementById('f4002-operational').textContent = operational;
                document.getElementById('f4002-maintenance').textContent = maintenance;
                document.getElementById('f4002-reform').textContent = reform;
                document.getElementById('f4002-total').textContent = total;
                
                // Atualizar barra de disponibilidade
                document.getElementById('f4002-availability').textContent = `${operationalPercent}%`;
                document.getElementById('f4002-availability-bar').style.width = `${operationalPercent}%`;
            },
            
            // Atualizar listas no dashboard
            updateDashboardLists() {
                // Lista de equipamentos em manutenção
                const maintenanceList = document.getElementById('equipment-maintenance-list');
                
                // Obter todos os equipamentos em manutenção
                let equipmentsInMaintenance = [];
                
                this.data.reboques.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.frota || item.acoplado,
                            type: 'Reboque',
                            status: item.status,
                            date: item.dataParada,
                            icon: 'fas fa-trailer'
                        });
                    }
                });
                
                this.data.caminhoesProps.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.caminhao,
                            type: 'Caminhão Próprio',
                            status: item.status,
                            date: item.data,
                            icon: 'fas fa-truck'
                        });
                    }
                });
                
                this.data.caminhoesTerc.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.caminhao,
                            type: 'Caminhão Terceiro',
                            status: item.status,
                            date: null,
                            icon: 'fas fa-truck-moving'
                        });
                    }
                });
                
                // Adicionar equipamentos das frentes
                const addFrenteItems = (items, type, icon, frente) => {
                    items.forEach(item => {
                        if (item.status === 'Em manutenção') {
                            equipmentsInMaintenance.push({
                                id: item.codigo,
                                type: `${type} Frente ${frente}`,
                                status: item.status,
                                date: item.data,
                                icon: icon
                            });
                        }
                    });
                };
                
                addFrenteItems(this.data.frente4001Colhedoras, 'Colhedora', 'fas fa-tractor', '4001');
                addFrenteItems(this.data.frente4001Tracoes, 'Tração', 'fas fa-truck-monster', '4001');
                addFrenteItems(this.data.frente4002Colhedoras, 'Colhedora', 'fas fa-tractor', '4002');
                addFrenteItems(this.data.frente4002Tracoes, 'Tração', 'fas fa-truck-monster', '4002');
                
                // Ordenar por data, mais recentes primeiro
                equipmentsInMaintenance.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    
                    const dateA = new Date(a.date);
                    const dateB = new Date(b.date);
                    return dateB - dateA;
                });
                
                // Gerar HTML
                if (equipmentsInMaintenance.length === 0) {
                    maintenanceList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhum equipamento em manutenção no momento.</span>
                        </li>
                    `;
                } else {
                    let html = '';
                    
                    equipmentsInMaintenance.forEach(item => {
                        // Formatar data
                        let dateStr = '';
                        if (item.date) {
                            const date = new Date(item.date);
                            dateStr = date.toLocaleDateString('pt-BR');
                        }
                        
                        html += `
                            <li class="py-2 border-b border-gray-200 dark:border-gray-700 last:border-0">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center text-yellow-500">
                                        <i class="${item.icon}"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium">${item.type} #${item.id}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Em manutenção ${dateStr ? 'desde ' + dateStr : ''}</p>
                                    </div>
                                </div>
                            </li>
                        `;
                    });
                    
                    maintenanceList.innerHTML = html;
                }
                
                // Lista de manutenções agendadas
                const upcomingList = document.getElementById('upcoming-maintenance-list');
                
                // Ordenar por data, mais próximas primeiro
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingSchedules = this.data.schedules
                    .filter(schedule => {
                        const scheduleDate = new Date(schedule.date);
                        scheduleDate.setHours(0, 0, 0, 0);
                        return scheduleDate >= today;
                    })
                    .sort((a, b) => {
                        const dateA = new Date(`${a.date}T${a.time}`);
                        const dateB = new Date(`${b.date}T${b.time}`);
                        return dateA - dateB;
                    });
                
                // Gerar HTML
                if (upcomingSchedules.length === 0) {
                    upcomingList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma manutenção agendada.</span>
                        </li>
                    `;
                } else {
                    let html = '';
                    
                    upcomingSchedules.slice(0, 5).forEach(schedule => {
                        // Calcular diferença de dias
                        const scheduleDate = new Date(schedule.date);
                        scheduleDate.setHours(0, 0, 0, 0);
                        const diffTime = Math.abs(scheduleDate - today);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        // Determinar texto de data
                        let dateText = '';
                        if (diffDays === 0) {
                            dateText = 'Hoje';
                        } else if (diffDays === 1) {
                            dateText = 'Amanhã';
                        } else {
                            dateText = `Em ${diffDays} dias`;
                        }
                        
                        // Formatar hora
                        const timeStr = schedule.time;
                        
                        // Determinar ícone
                        let icon = '';
                        if (schedule.equipmentType.includes('Reboque')) {
                            icon = 'fas fa-trailer';
                        } else if (schedule.equipmentType.includes('Caminhão Próprio')) {
                            icon = 'fas fa-truck';
                        } else if (schedule.equipmentType.includes('Caminhão Terceiro')) {
                            icon = 'fas fa-truck-moving';
                        } else if (schedule.equipmentType.includes('Colhedora')) {
                            icon = 'fas fa-tractor';
                        } else if (schedule.equipmentType.includes('Tração')) {
                            icon = 'fas fa-truck-monster';
                        } else {
                            icon = 'fas fa-cog';
                        }
                        
                        // Determinar classe de urgência
                        let urgencyClass = '';
                        if (diffDays === 0) {
                            urgencyClass = 'text-red-500';
                        } else if (diffDays === 1) {
                            urgencyClass = 'text-orange-500';
                        } else if (diffDays <= 3) {
                            urgencyClass = 'text-yellow-500';
                        } else {
                            urgencyClass = 'text-green-500';
                        }
                        
                        html += `
                            <li class="py-2 border-b border-gray-200 dark:border-gray-700 last:border-0">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-500">
                                        <i class="${icon}"></i>
                                    </div>
                                    <div class="ml-3 flex-1">
                                        <p class="text-sm font-medium">${schedule.equipmentType} #${schedule.equipment}</p>
                                        <p class="text-xs">
                                            <span class="${urgencyClass} font-bold">${dateText}</span>
                                            <span class="text-gray-500 dark:text-gray-400"> às ${timeStr}</span>
                                        </p>
                                    </div>
                                    <div class="text-xs px-2 py-1 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300">
                                        ${this.getMaintenanceTypeName(schedule.type)}
                                    </div>
                                </div>
                            </li>
                        `;
                    });
                    
                    upcomingList.innerHTML = html;
                }
                
                // Lista de avisos e notificações
                this.updateNotificationList();
            },
            
            // Atualizar lista de notificações
            updateNotificationList() {
                const notificationList = document.getElementById('notification-list');
                let notifications = [];
                
                // Verificar equipamentos parados há mais de 7 dias
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                // Função para verificar equipamentos parados
                const checkStoppedEquipment = (items, type, getIdFunc) => {
                    items.forEach(item => {
                        if (item.status !== 'Operacional') {
                            // Verificar se tem data de parada
                            let stopDate = null;
                            if (type === 'Reboque') {
                                stopDate = item.dataParada;
                            } else {
                                stopDate = item.data;
                            }
                            
                            if (stopDate) {
                                const date = new Date(stopDate);
                                date.setHours(0, 0, 0, 0);
                                const diffTime = Math.abs(today - date);
                                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                                
                                if (diffDays > 7) {
                                    const id = getIdFunc(item);
                                    notifications.push({
                                        title: `${type} #${id} parado há ${diffDays} dias`,
                                        message: `O ${type.toLowerCase()} está ${item.status.toLowerCase()} desde ${new Date(stopDate).toLocaleDateString('pt-BR')}.`,
                                        type: 'warning',
                                        priority: diffDays > 30 ? 3 : (diffDays > 14 ? 2 : 1)
                                    });
                                }
                            }
                        }
                    });
                };
                
                // Verificar equipamentos parados por tipo
                checkStoppedEquipment(this.data.reboques, 'Reboque', item => item.frota || item.acoplado);
                checkStoppedEquipment(this.data.caminhoesProps, 'Caminhão Próprio', item => item.caminhao);
                checkStoppedEquipment(this.data.frente4001Colhedoras, 'Colhedora Frente 4001', item => item.codigo);
                checkStoppedEquipment(this.data.frente4001Tracoes, 'Tração Frente 4001', item => item.codigo);
                checkStoppedEquipment(this.data.frente4002Colhedoras, 'Colhedora Frente 4002', item => item.codigo);
                checkStoppedEquipment(this.data.frente4002Tracoes, 'Tração Frente 4002', item => item.codigo);
                
                // Verificar manutenções agendadas para hoje
                const todaySchedules = this.data.schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    scheduleDate.setHours(0, 0, 0, 0);
                    return scheduleDate.getTime() === today.getTime();
                });
                
                todaySchedules.forEach(schedule => {
                    notifications.push({
                        title: `Manutenção agendada para hoje`,
                        message: `${schedule.equipmentType} #${schedule.equipment} às ${schedule.time}.`,
                        type: 'info',
                        priority: 3
                    });
                });
                
                // Verificar manutenções atrasadas
                const lateSchedules = this.data.schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    scheduleDate.setHours(0, 0, 0, 0);
                    return scheduleDate < today;
                });
                
                lateSchedules.forEach(schedule => {
                    const scheduleDate = new Date(schedule.date);
                    scheduleDate.setHours(0, 0, 0, 0);
                    const diffTime = Math.abs(today - scheduleDate);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    notifications.push({
                        title: `Manutenção atrasada há ${diffDays} dias`,
                        message: `${schedule.equipmentType} #${schedule.equipment} deveria ter sido realizada em ${new Date(schedule.date).toLocaleDateString('pt-BR')}.`,
                        type: 'error',
                        priority: 4
                    });
                });
                
                // Verificar níveis de disponibilidade abaixo do esperado
                const allEquipment = [
                    ...this.data.reboques,
                    ...this.data.caminhoesProps,
                    ...this.data.caminhoesTerc,
                    ...this.data.frente4001Colhedoras,
                    ...this.data.frente4001Tracoes,
                    ...this.data.frente4002Colhedoras,
                    ...this.data.frente4002Tracoes
                ];
                
                const totalEquipment = allEquipment.length;
                const operationalEquipment = allEquipment.filter(item => item.status === 'Operacional').length;
                const availabilityPercent = totalEquipment > 0 ? Math.round((operationalEquipment / totalEquipment) * 100) : 0;
                
                if (availabilityPercent < 70) {
                    notifications.push({
                        title: 'Disponibilidade crítica da frota',
                        message: `A disponibilidade atual está em ${availabilityPercent}%, abaixo do nível ideal de 85%.`,
                        type: 'error',
                        priority: 5
                    });
                } else if (availabilityPercent < 85) {
                    notifications.push({
                        title: 'Disponibilidade baixa da frota',
                        message: `A disponibilidade atual está em ${availabilityPercent}%, abaixo do nível ideal de 85%.`,
                        type: 'warning',
                        priority: 3
                    });
                }
                
                // Avisos de backup
                if (!this.data.storage.lastBackup) {
                    notifications.push({
                        title: 'Backup nunca realizado',
                        message: 'É recomendado fazer um backup dos dados regularmente.',
                        type: 'info',
                        priority: 2
                    });
                } else {
                    const lastBackupDate = new Date(this.data.storage.lastBackup);
                    lastBackupDate.setHours(0, 0, 0, 0);
                    const diffTime = Math.abs(today - lastBackupDate);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays > 30) {
                        notifications.push({
                            title: 'Backup desatualizado',
                            message: `O último backup foi realizado há ${diffDays} dias.`,
                            type: 'warning',
                            priority: 2
                        });
                    }
                }
                
                // Ordenar por prioridade (maior primeiro)
                notifications.sort((a, b) => b.priority - a.priority);
                
                // Gerar HTML
                if (notifications.length === 0) {
                    notificationList.innerHTML = `
                        <li class="py-2">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Nenhuma notificação disponível. O sistema mostrará alertas importantes aqui.</span>
                        </li>
                    `;
                } else {
                    let html = '';
                    
                    notifications.slice(0, 5).forEach(notification => {
                        // Definir cor com base no tipo
                        let typeClass = '';
                        let icon = '';
                        
                        switch(notification.type) {
                            case 'info':
                                typeClass = 'bg-blue-100 dark:bg-blue-900 text-blue-500';
                                icon = 'fas fa-info-circle';
                                break;
                            case 'warning':
                                typeClass = 'bg-yellow-100 dark:bg-yellow-900 text-yellow-500';
                                icon = 'fas fa-exclamation-triangle';
                                break;
                            case 'error':
                                typeClass = 'bg-red-100 dark:bg-red-900 text-red-500';
                                icon = 'fas fa-exclamation-circle';
                                break;
                            default:
                                typeClass = 'bg-gray-100 dark:bg-gray-700 text-gray-500';
                                icon = 'fas fa-bell';
                        }
                        
                        html += `
                            <li class="py-2 border-b border-gray-200 dark:border-gray-700 last:border-0">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 h-8 w-8 rounded-full ${typeClass} flex items-center justify-center">
                                        <i class="${icon}"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium">${notification.title}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">${notification.message}</p>
                                    </div>
                                </div>
                            </li>
                        `;
                    });
                    
                    notificationList.innerHTML = html;
                }
            },
            
            // Exportar para CSV
            exportToCSV() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                const id = activeTab.id;
                let data = [];
                let filename = '';
                
                switch(id) {
                    case 'reboques':
                        data = this.data.reboques;
                        filename = 'reboques.csv';
                        break;
                    case 'caminhoes-proprios':
                        data = this.data.caminhoesProps;
                        filename = 'caminhoes_proprios.csv';
                        break;
                    case 'caminhoes-terceiros':
                        data = this.data.caminhoesTerc;
                        filename = 'caminhoes_terceiros.csv';
                        break;
                    case 'frente-4001':
                        // Combinar dados e adicionar tipo
                        data = [
                            ...this.data.frente4001Colhedoras.map(item => ({...item, type: 'Colhedora'})),
                            ...this.data.frente4001Tracoes.map(item => ({...item, type: 'Tração'}))
                        ];
                        filename = 'frente_4001.csv';
                        break;
                    case 'frente-4002':
                        // Combinar dados e adicionar tipo
                        data = [
                            ...this.data.frente4002Colhedoras.map(item => ({...item, type: 'Colhedora'})),
                            ...this.data.frente4002Tracoes.map(item => ({...item, type: 'Tração'}))
                        ];
                        filename = 'frente_4002.csv';
                        break;
                    default:
                        this.showNotification('error', 'Exportação falhou', 'Não há dados para exportar nesta página.');
                        return;
                }
                
                if (data.length === 0) {
                    this.showNotification('error', 'Exportação falhou', 'Não há dados para exportar.');
                    return;
                }
                
                // Aplicar filtros
                data = this.filterData(data);
                
                // Aplicar ordenação
                data = this.sortData(data);
                
                // Obter cabeçalhos
                const headers = Object.keys(data[0]);
                
                // Montar CSV
                let csv = headers.join(',') + '\n';
                
                data.forEach(item => {
                    const values = headers.map(header => {
                        let value = item[header] || '';
                        // Garantir que strings com vírgulas sejam cotadas
                        if (value.toString().includes(',')) {
                            value = `"${value}"`;
                        }
                        return value;
                    });
                    
                    csv += values.join(',') + '\n';
                });
                
                // Criar blob e link para download
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar notificação
                this.showNotification('success', 'Exportação concluída', `Os dados foram exportados para ${filename}.`);
            },
            
            // Inicializar visualização real de equipamentos
            initializeRealEquipmentView() {
                // Implementar visualização em formato de cards para os equipamentos
                // Esta função será chamada quando a tab de visualização real for aberta
                const realViewContainer = document.getElementById('real-equipment-container');
                if (!realViewContainer) return;
                
                // Renderizar todos os equipamentos por padrão
                this.renderRealEquipmentView();
            },
            
            // Renderizar visualização real de equipamentos
            renderRealEquipmentView(filter = 'all') {
                const container = document.getElementById('real-equipment-container');
                if (!container) return;
                
                // Coletar todos os equipamentos
                let allEquipment = [];
                
                // Adicionar reboques
                this.data.reboques.forEach(reboque => {
                    allEquipment.push({
                        id: reboque.frota || reboque.acoplado,
                        type: 'Reboque',
                        status: reboque.status,
                        details: `Tipo: ${reboque.tipo || 'N/A'}`,
                        icon: 'fas fa-trailer',
                        data: reboque
                    });
                });
                
                // Adicionar caminhões próprios
                this.data.caminhoesProps.forEach(caminhao => {
                    allEquipment.push({
                        id: caminhao.caminhao,
                        type: 'Caminhão Próprio',
                        status: caminhao.status,
                        details: caminhao.motivo ? `Motivo: ${caminhao.motivo}` : '',
                        icon: 'fas fa-truck',
                        data: caminhao
                    });
                });
                
                // Adicionar caminhões terceiros
                this.data.caminhoesTerc.forEach(caminhao => {
                    allEquipment.push({
                        id: caminhao.caminhao,
                        type: 'Caminhão Terceiro',
                        status: caminhao.status,
                        details: `Proprietário: ${caminhao.proprietario || 'N/A'}`,
                        icon: 'fas fa-truck-moving',
                        data: caminhao
                    });
                });
                
                // Adicionar colhedoras frente 4001
                this.data.frente4001Colhedoras.forEach(colhedora => {
                    allEquipment.push({
                        id: colhedora.codigo,
                        type: 'Colhedora Frente 4001',
                        status: colhedora.status,
                        details: `Frente: 4001`,
                        icon: 'fas fa-tractor',
                        data: colhedora
                    });
                });
                
                // Adicionar trações frente 4001
                this.data.frente4001Tracoes.forEach(tracao => {
                    allEquipment.push({
                        id: tracao.codigo,
                        type: 'Tração Frente 4001',
                        status: tracao.status,
                        details: `Frente: 4001`,
                        icon: 'fas fa-truck-monster',
                        data: tracao
                    });
                });
                
                // Adicionar colhedoras frente 4002
                this.data.frente4002Colhedoras.forEach(colhedora => {
                    allEquipment.push({
                        id: colhedora.codigo,
                        type: 'Colhedora Frente 4002',
                        status: colhedora.status,
                        details: `Frente: 4002`,
                        icon: 'fas fa-tractor',
                        data: colhedora
                    });
                });
                
                // Adicionar trações frente 4002
                this.data.frente4002Tracoes.forEach(tracao => {
                    allEquipment.push({
                        id: tracao.codigo,
                        type: 'Tração Frente 4002',
                        status: tracao.status,
                        details: `Frente: 4002`,
                        icon: 'fas fa-truck-monster',
                        data: tracao
                    });
                });
                
                // Aplicar filtro
                if (filter !== 'all') {
                    if (filter === 'operational') {
                        allEquipment = allEquipment.filter(item => item.status === 'Operacional');
                    } else if (filter === 'maintenance') {
                        allEquipment = allEquipment.filter(item => item.status === 'Em manutenção');
                    } else if (filter === 'reform') {
                        allEquipment = allEquipment.filter(item => ['Em reforma', 'Aguardando reforma', 'Inoperante'].includes(item.status));
                    } else if (filter === 'other') {
                        allEquipment = allEquipment.filter(item => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(item.status));
                    } else if (filter === 'reboques') {
                        allEquipment = allEquipment.filter(item => item.type === 'Reboque');
                    } else if (filter === 'caminhoes') {
                        allEquipment = allEquipment.filter(item => item.type.includes('Caminhão'));
                    } else if (filter === 'colhedoras') {
                        allEquipment = allEquipment.filter(item => item.type.includes('Colhedora'));
                    } else if (filter === 'tracoes') {
                        allEquipment = allEquipment.filter(item => item.type.includes('Tração'));
                    } else if (filter === 'frente4001') {
                        allEquipment = allEquipment.filter(item => item.type.includes('4001'));
                    } else if (filter === 'frente4002') {
                        allEquipment = allEquipment.filter(item => item.type.includes('4002'));
                    }
                }
                
                // Ordenar por ID
                allEquipment.sort((a, b) => a.id.localeCompare(b.id));
                
                // Gerar HTML
                if (allEquipment.length === 0) {
                    container.innerHTML = `
                        <div class="flex flex-col items-center justify-center py-8">
                            <i class="fas fa-search-minus text-gray-300 dark:text-gray-600 text-5xl mb-4"></i>
                            <p class="text-gray-500 dark:text-gray-400 text-lg">Nenhum equipamento encontrado com esses filtros.</p>
                        </div>
                    `;
                    return;
                }
                
                // Atualizar contador
                document.getElementById('real-equipment-count').textContent = `${allEquipment.length} equipamentos`;
                
                let html = '<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">';
                
                allEquipment.forEach(equipment => {
                    // Determinar classe de status
                    let statusClass = '';
                    let statusBgClass = '';
                    
                    switch(equipment.status) {
                        case 'Operacional':
                            statusClass = 'text-green-500 dark:text-green-400';
                            statusBgClass = 'bg-green-100 dark:bg-green-900';
                            break;
                        case 'Em manutenção':
                            statusClass = 'text-yellow-500 dark:text-yellow-400';
                            statusBgClass = 'bg-yellow-100 dark:bg-yellow-900';
                            break;
                        case 'Em reforma':
                        case 'Aguardando reforma':
                        case 'Inoperante':
                            statusClass = 'text-red-500 dark:text-red-400';
                            statusBgClass = 'bg-red-100 dark:bg-red-900';
                            break;
                        case 'Emprestado':
                            statusClass = 'text-purple-500 dark:text-purple-400';
                            statusBgClass = 'bg-purple-100 dark:bg-purple-900';
                            break;
                        default:
                            statusClass = 'text-blue-500 dark:text-blue-400';
                            statusBgClass = 'bg-blue-100 dark:bg-blue-900';
                    }
                    
                    // Gerar card para o equipamento
                    html += `
                        <div class="equipment-card bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-all p-4 border border-gray-200 dark:border-gray-700">
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex items-center">
                                    <div class="h-12 w-12 rounded-full ${statusBgClass} flex items-center justify-center ${statusClass} mr-3">
                                        <i class="${equipment.icon} text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-medium">${equipment.type}</h3>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">#${equipment.id}</p>
                                    </div>
                                </div>
                                <span class="px-2 py-1 text-xs rounded-full ${statusClass} ${statusBgClass}">${equipment.status}</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">${equipment.details}</p>
                            <div class="flex justify-between items-center pt-2 border-t border-gray-200 dark:border-gray-700 mt-2">
                                <div class="flex">
                                    <button class="text-primary hover:text-primary-dark p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 mr-1" 
                                        data-id="${equipment.id}" data-type="${equipment.type}" 
                                        onclick="APP.viewEquipmentHistory('${equipment.type}', '${equipment.id}')" title="Ver histórico">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="text-primary hover:text-primary-dark p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700" 
                                        data-id="${equipment.id}" data-type="${equipment.type}" 
                                        onclick="APP.editEquipment('${equipment.type}', '${equipment.id}')" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                                <button class="text-primary hover:text-primary-dark text-sm bg-primary bg-opacity-10 px-2 py-1 rounded-md hover:bg-opacity-20" 
                                    data-id="${equipment.id}" data-type="${equipment.type}" 
                                    onclick="APP.scheduleEquipmentMaintenance('${equipment.type}', '${equipment.id}')">
                                    <i class="fas fa-tools mr-1"></i> Manutenção
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                container.innerHTML = html;
            },
            
            // Filtrar visualização real de equipamentos
            filterRealEquipment(filter) {
                this.renderRealEquipmentView(filter);
            },
            
            // Mostrar notificação
            showNotification(type, title, message) {
                const container = document.getElementById('notification-container');
                
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = `notification p-4 max-w-md bg-white dark:bg-gray-800 rounded-lg shadow-lg border-l-4 ${this.getNotificationBorderClass(type)} relative overflow-hidden`;
                
                // Adicionar ícone com base no tipo
                const icon = this.getNotificationIcon(type);
                
                notification.innerHTML = `
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="${icon} ${this.getNotificationIconClass(type)} text-lg"></i>
                        </div>
                        <div class="ml-3 flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">${title}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">${message}</p>
                        </div>
                        <button class="close-notification ml-4 text-gray-400 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                // Adicionar ao container
                container.appendChild(notification);
                
                // Remover após 5 segundos
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            },
            
            // Obter classe de borda para notificação
            getNotificationBorderClass(type) {
                switch(type) {
                    case 'success': return 'border-green-500';
                    case 'error': return 'border-red-500';
                    case 'warning': return 'border-yellow-500';
                    case 'info': return 'border-blue-500';
                    default: return 'border-gray-500';
                }
            },
            
            // Obter ícone para notificação
            getNotificationIcon(type) {
                switch(type) {
                    case 'success': return 'fas fa-check-circle';
                    case 'error': return 'fas fa-exclamation-circle';
                    case 'warning': return 'fas fa-exclamation-triangle';
                    case 'info': return 'fas fa-info-circle';
                    default: return 'fas fa-bell';
                }
            },
            
            // Obter classe de ícone para notificação
            getNotificationIconClass(type) {
                switch(type) {
                    case 'success': return 'text-green-500 dark:text-green-400';
                    case 'error': return 'text-red-500 dark:text-red-400';
                    case 'warning': return 'text-yellow-500 dark:text-yellow-400';
                    case 'info': return 'text-blue-500 dark:text-blue-400';
                    default: return 'text-gray-500 dark:text-gray-400';
                }
            },
            
            // Inicializar todos os gráficos
            initializeCharts() {
                Chart.defaults.color = document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = document.documentElement.classList.contains('dark') ? '#4B5563' : '#E5E7EB';
                
                // Gráficos do dashboard principal
                this.initializeStatusCategoryChart();
                this.initializeAvailabilityChart();
                
                // Inicializar gráficos específicos por categoria
                this.initializeReboquesCharts();
            },
            
            // Inicializar gráfico de status por categoria
            initializeStatusCategoryChart() {
                // Calcular dados para o gráfico
                const data = {
                    reboques: {
                        operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                        maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                        reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                        other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                    },
                    caminhoesProprios: {
                        operational: this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    caminhoesTerceiros: {
                        operational: this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001: {
                        operational: this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length + this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length + 
                                this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length + 
                              this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    },
                    frente4002: {
                        operational: this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length + this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length + 
                                this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length + 
                              this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    }
                };
                
                // Verificar se há dados
                const hasData = Object.values(data).some(category => 
                    category.operational > 0 || category.maintenance > 0 || category.reform > 0 || category.other > 0
                );
                
                if (!hasData) {
                    document.getElementById('status-category-no-data').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('status-category-no-data').classList.add('hidden');
                }
                
                // Preparar dados para o gráfico
                const chartData = {
                    labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Frente 4001', 'Frente 4002'],
                    datasets: [
                        {
                            label: 'Operacional',
                            data: [
                                data.reboques.operational,
                                data.caminhoesProprios.operational,
                                data.caminhoesTerceiros.operational,
                                data.frente4001.operational,
                                data.frente4002.operational
                            ],
                            backgroundColor: '#10B981' // verde
                        },
                        {
                            label: 'Em Manutenção',
                            data: [
                                data.reboques.maintenance,
                                data.caminhoesProprios.maintenance,
                                data.caminhoesTerceiros.maintenance,
                                data.frente4001.maintenance,
                                data.frente4002.maintenance
                            ],
                            backgroundColor: '#F59E0B' // amarelo
                        },
                        {
                            label: 'Em Reforma/Inoperante',
                            data: [
                                data.reboques.reform,
                                data.caminhoesProprios.reform,
                                data.caminhoesTerceiros.reform,
                                data.frente4001.reform,
                                data.frente4002.reform
                            ],
                            backgroundColor: '#EF4444' // vermelho
                        },
                        {
                            label: 'Outros',
                            data: [
                                data.reboques.other,
                                data.caminhoesProprios.other,
                                data.caminhoesTerceiros.other,
                                data.frente4001.other,
                                data.frente4002.other
                            ],
                            backgroundColor: '#3B82F6' // azul
                        }
                    ]
                };
                
                // Criar o gráfico
                const ctx = document.getElementById('status-by-category-chart').getContext('2d');
                this.data.charts.statusByCategoryChart = new Chart(ctx, {
                    type: 'bar',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                }
                            }
                        },
                        scales: {
                            x: {
                                stacked: true
                            },
                            y: {
                                stacked: true,
                                beginAtZero: true
                            }
                        },
                        interaction: {
                            mode: 'index',
                            intersect: false
                        }
                    }
                });
            },
            
            // Inicializar gráfico de disponibilidade
            initializeAvailabilityChart() {
                // Calcular dados para o gráfico
                const totalReboques = this.data.reboques.length;
                const totalCP = this.data.caminhoesProps.length;
                const totalCT = this.data.caminhoesTerc.length;
                const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                
                const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const opCP = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const opCT = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const opF4001 = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const opF4002 = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const availReboques = totalReboques > 0 ? Math.round((opReboques / totalReboques) * 100) : 0;
                const availCP = totalCP > 0 ? Math.round((opCP / totalCP) * 100) : 0;
                const availCT = totalCT > 0 ? Math.round((opCT / totalCT) * 100) : 0;
                const availF4001 = totalF4001 > 0 ? Math.round((opF4001 / totalF4001) * 100) : 0;
                const availF4002 = totalF4002 > 0 ? Math.round((opF4002 / totalF4002) * 100) : 0;
                
                // Verificar se há dados
                const hasData = totalReboques > 0 || totalCP > 0 || totalCT > 0 || totalF4001 > 0 || totalF4002 > 0;
                
                if (!hasData) {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('availability-no-data').classList.add('hidden');
                }
                
                // Preparar dados para o gráfico
                const chartData = {
                    labels: ['Reboques', 'Caminhões Próprios', 'Caminhões Terceiros', 'Frente 4001', 'Frente 4002'],
                    datasets: [{
                        label: 'Disponibilidade (%)',
                        data: [availReboques, availCP, availCT, availF4001, availF4002],
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.8)',  // Verde
                            'rgba(59, 130, 246, 0.8)',  // Azul
                            'rgba(245, 158, 11, 0.8)',  // Amarelo
                            'rgba(139, 92, 246, 0.8)',  // Roxo
                            'rgba(239, 68, 68, 0.8)'    // Vermelho
                        ],
                        borderColor: [
                            'rgb(16, 185, 129)',
                            'rgb(59, 130, 246)',
                            'rgb(245, 158, 11)',
                            'rgb(139, 92, 246)',
                            'rgb(239, 68, 68)'
                        ],
                        borderWidth: 1
                    }]
                };
                
                // Criar o gráfico
                const ctx = document.getElementById('availability-chart').getContext('2d');
                this.data.charts.availabilityChart = new Chart(ctx, {
                    type: 'bar',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `Disponibilidade: ${context.raw}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                min: 0,
                                max: 100,
                                grid: {
                                    display: true,
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(229, 231, 235, 0.1)' : 'rgba(107, 114, 128, 0.1)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            y: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            },
            
            // Inicializar gráficos dos reboques
            initializeReboquesCharts() {
                // Dados para gráfico de status dos reboques
                const statusData = {
                    operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                    maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                    reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                    other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                };
                
                // Sempre mostrar dados no gráfico, mesmo que todos os equipamentos estejam operacionais
                const hasData = this.data.reboques.length > 0;
                if (!hasData) {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                    
                    const statusCtx = document.getElementById('reboques-status-chart').getContext('2d');
                    this.data.charts.reboquesStatusChart = new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Operacional', 'Em manutenção', 'Em reforma/Inoperante', 'Outros'],
                            datasets: [{
                                data: [statusData.operational, statusData.maintenance, statusData.reform, statusData.other],
                                backgroundColor: [
                                    '#10B981', // Verde
                                    '#F59E0B', // Amarelo
                                    '#EF4444', // Vermelho
                                    '#3B82F6'  // Azul
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937',
                                        padding: 20,
                                        usePointStyle: true,
                                        pointStyle: 'circle'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                                            return `${label}: ${value} (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Verificar se existem dados para tendência
                document.getElementById('reboques-trend-no-data').classList.remove('hidden');
                
                // Tendência de manutenção: deixando apenas a estrutura sem dados simulados
                // Estes dados serão preenchidos quando houver histórico real
                const trendsCtx = document.getElementById('reboques-maintenance-trend-chart').getContext('2d');
                
                const emptyMaintenanceData = {
                    labels: [],
                    datasets: [{
                        label: 'Manutenções',
                        data: [],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Tempo médio (dias)',
                        data: [],
                        borderColor: '#3B82F6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true,
                        yAxisID: 'y1'
                    }]
                };
                
                this.data.charts.reboquesMaintenanceTrendChart = new Chart(trendsCtx, {
                    type: 'line',
                    data: emptyMaintenanceData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                }
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Quantidade',
                                    color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                },
                                grid: {
                                    display: true,
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(229, 231, 235, 0.1)' : 'rgba(107, 114, 128, 0.1)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Dias',
                                    color: document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937'
                                },
                                grid: {
                                    display: false
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            },
            
            // Atualizar todos os gráficos
            updateAllCharts() {
                // Verificar se o tema mudou e atualizar os padrões
                const isDark = document.documentElement.classList.contains('dark');
                Chart.defaults.color = isDark ? '#E5E7EB' : '#1F2937';
                Chart.defaults.borderColor = isDark ? '#4B5563' : '#E5E7EB';
                
                // Atualizar gráficos do dashboard principal
                this.updateStatusCategoryChart();
                this.updateAvailabilityChart();
                
                // Atualizar gráficos específicos por categoria
                this.updateReboquesCharts();
            },
            
            // Atualizar gráfico de status por categoria
            updateStatusCategoryChart() {
                if (!this.data.charts.statusByCategoryChart) return;
                
                // Calcular dados para o gráfico
                const data = {
                    reboques: {
                        operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                        maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                        reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                        other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                    },
                    caminhoesProprios: {
                        operational: this.data.caminhoesProps.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesProps.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    caminhoesTerceiros: {
                        operational: this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length,
                        maintenance: this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length,
                        reform: this.data.caminhoesTerc.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length,
                        other: this.data.caminhoesTerc.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length
                    },
                    frente4001: {
                        operational: this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length + this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4001Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length + 
                                this.data.frente4001Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4001Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length + 
                              this.data.frente4001Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    },
                    frente4002: {
                        operational: this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length,
                        maintenance: this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length + this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length,
                        reform: this.data.frente4002Colhedoras.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length + 
                                this.data.frente4002Tracoes.filter(t => t.status === 'Em reforma' || t.status === 'Aguardando reforma' || t.status === 'Inoperante').length,
                        other: this.data.frente4002Colhedoras.filter(c => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(c.status)).length + 
                              this.data.frente4002Tracoes.filter(t => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(t.status)).length
                    }
                };
                
                // Verificar se há dados
                const hasData = Object.values(data).some(category => 
                    category.operational > 0 || category.maintenance > 0 || category.reform > 0 || category.other > 0
                );
                
                if (!hasData) {
                    document.getElementById('status-category-no-data').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('status-category-no-data').classList.add('hidden');
                }
                
                // Atualizar dados do gráfico
                this.data.charts.statusByCategoryChart.data.datasets[0].data = [
                    data.reboques.operational,
                    data.caminhoesProprios.operational,
                    data.caminhoesTerceiros.operational,
                    data.frente4001.operational,
                    data.frente4002.operational
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[1].data = [
                    data.reboques.maintenance,
                    data.caminhoesProprios.maintenance,
                    data.caminhoesTerceiros.maintenance,
                    data.frente4001.maintenance,
                    data.frente4002.maintenance
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[2].data = [
                    data.reboques.reform,
                    data.caminhoesProprios.reform,
                    data.caminhoesTerceiros.reform,
                    data.frente4001.reform,
                    data.frente4002.reform
                ];
                
                this.data.charts.statusByCategoryChart.data.datasets[3].data = [
                    data.reboques.other,
                    data.caminhoesProprios.other,
                    data.caminhoesTerceiros.other,
                    data.frente4001.other,
                    data.frente4002.other
                ];
                
                // Atualizar opções para refletir o tema atual
                this.data.charts.statusByCategoryChart.options.plugins.legend.labels.color = 
                    document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937';
                
                this.data.charts.statusByCategoryChart.update();
            },
            
            // Atualizar gráfico de disponibilidade
            updateAvailabilityChart() {
                if (!this.data.charts.availabilityChart) return;
                
                // Calcular dados para o gráfico
                const totalReboques = this.data.reboques.length;
                const totalCP = this.data.caminhoesProps.length;
                const totalCT = this.data.caminhoesTerc.length;
                const totalF4001 = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const totalF4002 = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                
                const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const opCP = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const opCT = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const opF4001 = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length +
                                this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const opF4002 = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length +
                                this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const availReboques = totalReboques > 0 ? Math.round((opReboques / totalReboques) * 100) : 0;
                const availCP = totalCP > 0 ? Math.round((opCP / totalCP) * 100) : 0;
                const availCT = totalCT > 0 ? Math.round((opCT / totalCT) * 100) : 0;
                const availF4001 = totalF4001 > 0 ? Math.round((opF4001 / totalF4001) * 100) : 0;
                const availF4002 = totalF4002 > 0 ? Math.round((opF4002 / totalF4002) * 100) : 0;
                
                // Verificar se há dados
                const hasData = totalReboques > 0 || totalCP > 0 || totalCT > 0 || totalF4001 > 0 || totalF4002 > 0;
                
                if (!hasData) {
                    document.getElementById('availability-no-data').classList.remove('hidden');
                    return;
                } else {
                    document.getElementById('availability-no-data').classList.add('hidden');
                }
                
                // Atualizar dados do gráfico
                this.data.charts.availabilityChart.data.datasets[0].data = [
                    availReboques, availCP, availCT, availF4001, availF4002
                ];
                
                // Atualizar opções para refletir o tema atual
                const isDark = document.documentElement.classList.contains('dark');
                
                this.data.charts.availabilityChart.options.scales.x.grid.color = 
                    isDark ? 'rgba(229, 231, 235, 0.1)' : 'rgba(107, 114, 128, 0.1)';
                
                this.data.charts.availabilityChart.update();
            },
            
            // Atualizar gráficos dos reboques
            updateReboquesCharts() {
                if (!this.data.charts.reboquesStatusChart) return;
                
                // Dados para gráfico de status dos reboques
                const statusData = {
                    operational: this.data.reboques.filter(r => r.status === 'Operacional').length,
                    maintenance: this.data.reboques.filter(r => r.status === 'Em manutenção').length,
                    reform: this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length,
                    other: this.data.reboques.filter(r => !['Operacional', 'Em manutenção', 'Em reforma', 'Aguardando reforma', 'Inoperante'].includes(r.status)).length
                };
                
                // Verificar se existem dados
                const hasData = this.data.reboques.length > 0;
                if (!hasData) {
                    document.getElementById('reboques-status-no-data').classList.remove('hidden');
                } else {
                    document.getElementById('reboques-status-no-data').classList.add('hidden');
                    
                    // Atualizar dados
                    this.data.charts.reboquesStatusChart.data.datasets[0].data = [
                        statusData.operational,
                        statusData.maintenance,
                        statusData.reform,
                        statusData.other
                    ];
                    
                    // Atualizar opções para refletir o tema atual
                    this.data.charts.reboquesStatusChart.options.plugins.legend.labels.color = 
                        document.documentElement.classList.contains('dark') ? '#E5E7EB' : '#1F2937';
                    
                    this.data.charts.reboquesStatusChart.update();
                }
                
                // O gráfico de tendência permanece com a mensagem de "não há dados" 
                // até que hajam dados históricos reais
            },
            
            // Funções para impressão e exportação
            printActiveTable() {
                const activeTab = document.querySelector('.tab-content.active');
                if (!activeTab) return;
                
                // Obter o título da tabela
                let title = '';
                switch(activeTab.id) {
                    case 'reboques':
                        title = 'Relatório de Reboques';
                        break;
                    case 'caminhoes-proprios':
                        title = 'Relatório de Caminhões Próprios';
                        break;
                    case 'caminhoes-terceiros':
                        title = 'Relatório de Caminhões Terceiros';
                        break;
                    case 'frente-4001':
                        title = 'Relatório de Equipamentos - Frente 4001';
                        break;
                    case 'frente-4002':
                        title = 'Relatório de Equipamentos - Frente 4002';
                        break;
                    default:
                        title = 'Relatório';
                        break;
                }
                
                // Configurar área de impressão
                document.getElementById('print-title').textContent = title;
                document.getElementById('print-date').textContent = `Gerado em: ${new Date().toLocaleDateString('pt-BR')}`;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                // Obter a tabela da tab ativa
                const tableContent = activeTab.querySelector('table').cloneNode(true);
                
                // Remover a coluna de ações
                const headerRow = tableContent.querySelector('thead tr');
                const actionHeader = headerRow.querySelector('th:last-child');
                if (actionHeader) actionHeader.remove();
                
                const rows = tableContent.querySelectorAll('tbody tr');
                rows.forEach(row => {
                    const actionCell = row.querySelector('td:last-child');
                    if (actionCell) actionCell.remove();
                });
                
                // Adicionar classe de impressão
                tableContent.classList.add('border-collapse', 'w-full', 'border', 'border-gray-300');
                
                // Estilizar cabeçalho para impressão
                const headerCells = tableContent.querySelectorAll('thead th');
                headerCells.forEach(cell => {
                    cell.style.backgroundColor = '#f3f4f6';
                    cell.style.padding = '10px';
                    cell.style.borderBottom = '1px solid #d1d5db';
                    cell.style.textAlign = 'left';
                    cell.style.fontWeight = 'bold';
                    
                    // Remover elementos de sorting
                    const sortIcon = cell.querySelector('i.fa-sort');
                    if (sortIcon) sortIcon.remove();
                });
                
                // Estilizar células do corpo para impressão
                const bodyCells = tableContent.querySelectorAll('tbody td');
                bodyCells.forEach(cell => {
                    cell.style.padding = '8px';
                    cell.style.borderBottom = '1px solid #e5e7eb';
                });
                
                // Ajustar status badges
                const statusBadges = tableContent.querySelectorAll('.status-badge');
                statusBadges.forEach(badge => {
                    badge.style.display = 'inline-block';
                    badge.style.padding = '2px 6px';
                    badge.style.borderRadius = '9999px';
                    badge.style.fontSize = '0.75rem';
                    
                    if (badge.classList.contains('status-badge-operational')) {
                        badge.style.backgroundColor = 'rgba(16, 185, 129, 0.1)';
                        badge.style.color = '#10B981';
                    } else if (badge.classList.contains('status-badge-maintenance')) {
                        badge.style.backgroundColor = 'rgba(245, 158, 11, 0.1)';
                        badge.style.color = '#F59E0B';
                    } else if (badge.classList.contains('status-badge-reform')) {
                        badge.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
                        badge.style.color = '#EF4444';
                    } else {
                        badge.style.backgroundColor = 'rgba(107, 114, 128, 0.1)';
                        badge.style.color = '#6B7280';
                    }
                });
                
                // Adicionar resumo
                let summary = document.createElement('div');
                summary.style.marginBottom = '15px';
                
                // Adicionar dados do resumo conforme a tab ativa
                let summaryData = '';
                switch(activeTab.id) {
                    case 'reboques':
                        const totalReboques = this.data.reboques.length;
                        const opReboques = this.data.reboques.filter(r => r.status === 'Operacional').length;
                        const mainReboques = this.data.reboques.filter(r => r.status === 'Em manutenção').length;
                        const reformReboques = this.data.reboques.filter(r => r.status === 'Em reforma' || r.status === 'Aguardando reforma' || r.status === 'Inoperante').length;
                        const availReboques = totalReboques > 0 ? Math.round((opReboques / totalReboques) * 100) : 0;
                        
                        summaryData = `
                            <p class="mb-2">Resumo da frota de reboques:</p>
                            <ul class="list-disc list-inside mb-3 pl-3">
                                <li>Total de reboques: <strong>${totalReboques}</strong></li>
                                <li>Reboques operacionais: <strong>${opReboques}</strong> (${availReboques}%)</li>
                                <li>Reboques em manutenção: <strong>${mainReboques}</strong></li>
                                <li>Reboques em reforma/inoperantes: <strong>${reformReboques}</strong></li>
                            </ul>
                        `;
                        break;
                    case 'caminhoes-proprios':
                        const totalCP = this.data.caminhoesProps.length;
                        const opCP = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                        const mainCP = this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length;
                        const reformCP = this.data.caminhoesProps.filter(c => c.status === 'Em reforma' || c.status === 'Aguardando reforma' || c.status === 'Inoperante').length;
                        const availCP = totalCP > 0 ? Math.round((opCP / totalCP) * 100) : 0;
                        
                        summaryData = `
                            <p class="mb-2">Resumo da frota de caminhões próprios:</p>
                            <ul class="list-disc list-inside mb-3 pl-3">
                                <li>Total de caminhões: <strong>${totalCP}</strong></li>
                                <li>Caminhões operacionais: <strong>${opCP}</strong> (${availCP}%)</li>
                                <li>Caminhões em manutenção: <strong>${mainCP}</strong></li>
                                <li>Caminhões em reforma/inoperantes: <strong>${reformCP}</strong></li>
                            </ul>
                        `;
                        break;
                    // Adicionar outros casos conforme necessário
                }
                
                summary.innerHTML = summaryData;
                
                // Criar área de conteúdo para impressão
                const printContent = document.getElementById('print-content');
                printContent.innerHTML = '';
                printContent.appendChild(summary);
                printContent.appendChild(tableContent);
                
                // Abrir janela de impressão
                window.print();
            },
            
            // Imprimir dashboard
            printDashboard() {
                // Configurar área de impressão
                document.getElementById('print-title').textContent = 'Dashboard - Sistema de Gestão de Frota';
                document.getElementById('print-date').textContent = `Gerado em: ${new Date().toLocaleDateString('pt-BR')}`;
                document.getElementById('print-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                const printContent = document.getElementById('print-content');
                printContent.innerHTML = '';
                
                // Adicionar resumo geral
                const summaryDiv = document.createElement('div');
                summaryDiv.style.marginBottom = '20px';
                
                // Contar status em todos os equipamentos
                const statusCounts = {
                    operational: 0,
                    maintenance: 0,
                    reform: 0,
                    borrowed: 0,
                    other: 0,
                    total: 0
                };
                
                // Função para contar status em uma lista
                const countStatus = (list) => {
                    list.forEach(item => {
                        statusCounts.total++;
                        
                        if (item.status === 'Operacional') {
                            statusCounts.operational++;
                        } else if (item.status === 'Em manutenção') {
                            statusCounts.maintenance++;
                        } else if (item.status === 'Em reforma' || item.status === 'Aguardando reforma' || item.status === 'Inoperante') {
                            statusCounts.reform++;
                        } else if (item.status === 'Emprestado') {
                            statusCounts.borrowed++;
                        } else {
                            statusCounts.other++;
                        }
                    });
                };
                
                // Contar status em todas as listas
                countStatus(this.data.reboques);
                countStatus(this.data.caminhoesProps);
                countStatus(this.data.caminhoesTerc);
                countStatus(this.data.frente4001Colhedoras);
                countStatus(this.data.frente4001Tracoes);
                countStatus(this.data.frente4002Colhedoras);
                countStatus(this.data.frente4002Tracoes);
                
                // Calcular porcentagens
                const operationalPercent = statusCounts.total > 0 ? Math.round((statusCounts.operational / statusCounts.total) * 100) : 0;
                const maintenancePercent = statusCounts.total > 0 ? Math.round((statusCounts.maintenance / statusCounts.total) * 100) : 0;
                const reformPercent = statusCounts.total > 0 ? Math.round((statusCounts.reform / statusCounts.total) * 100) : 0;
                const borrowedPercent = statusCounts.total > 0 ? Math.round((statusCounts.borrowed / statusCounts.total) * 100) : 0;
                const otherPercent = statusCounts.total > 0 ? Math.round((statusCounts.other / statusCounts.total) * 100) : 0;
                
                summaryDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Resumo da Frota</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        <p>Total de Equipamentos: <strong>${statusCounts.total}</strong></p>
                        <p>Disponibilidade Geral: <strong>${operationalPercent}%</strong></p>
                        
                        <div style="margin-top: 10px;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Status</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Quantidade</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Porcentagem</th>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Operacional</td>
                                    <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${statusCounts.operational}</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">${operationalPercent}%</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Em Manutenção</td>
                                    <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${statusCounts.maintenance}</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">${maintenancePercent}%</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Em Reforma/Inoperante</td>
                                    <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${statusCounts.reform}</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">${reformPercent}%</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Emprestado</td>
                                    <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${statusCounts.borrowed}</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">${borrowedPercent}%</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Outros</td>
                                    <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${statusCounts.other}</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">${otherPercent}%</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                `;
                
                printContent.appendChild(summaryDiv);
                
                // Adicionar resumo por categoria
                const categoriesDiv = document.createElement('div');
                categoriesDiv.style.marginBottom = '20px';
                
                // Reboques
                const reboquesTotal = this.data.reboques.length;
                const reboquesOp = this.data.reboques.filter(r => r.status === 'Operacional').length;
                const reboquesPercent = reboquesTotal > 0 ? Math.round((reboquesOp / reboquesTotal) * 100) : 0;
                
                // CP
                const cpTotal = this.data.caminhoesProps.length;
                const cpOp = this.data.caminhoesProps.filter(c => c.status === 'Operacional').length;
                const cpPercent = cpTotal > 0 ? Math.round((cpOp / cpTotal) * 100) : 0;
                
                // CT
                const ctTotal = this.data.caminhoesTerc.length;
                const ctOp = this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length;
                const ctPercent = ctTotal > 0 ? Math.round((ctOp / ctTotal) * 100) : 0;
                
                // F4001
                const f4001Total = this.data.frente4001Colhedoras.length + this.data.frente4001Tracoes.length;
                const f4001Op = this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                               this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length;
                const f4001Percent = f4001Total > 0 ? Math.round((f4001Op / f4001Total) * 100) : 0;
                
                // F4002
                const f4002Total = this.data.frente4002Colhedoras.length + this.data.frente4002Tracoes.length;
                const f4002Op = this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                               this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                const f4002Percent = f4002Total > 0 ? Math.round((f4002Op / f4002Total) * 100) : 0;
                
                categoriesDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Resumo por Categoria</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Categoria</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Total</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Operacionais</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Disponibilidade</th>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Reboques</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${reboquesTotal}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${reboquesOp}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${reboquesPercent}%</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Caminhões Próprios</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${cpTotal}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${cpOp}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${cpPercent}%</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Caminhões Terceiros</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${ctTotal}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${ctOp}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${ctPercent}%</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Frente 4001</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${f4001Total}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${f4001Op}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${f4001Percent}%</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Frente 4002</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${f4002Total}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${f4002Op}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${f4002Percent}%</td>
                            </tr>
                        </table>
                    </div>
                `;
                
                printContent.appendChild(categoriesDiv);
                
                // Adicionar manutenções agendadas
                const maintenanceDiv = document.createElement('div');
                maintenanceDiv.style.marginBottom = '20px';
                
                // Obter manutenções agendadas futuras
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const upcomingSchedules = this.data.schedules
                    .filter(schedule => {
                        const scheduleDate = new Date(schedule.date);
                        scheduleDate.setHours(0, 0, 0, 0);
                        return scheduleDate >= today;
                    })
                    .sort((a, b) => {
                        const dateA = new Date(`${a.date}T${a.time}`);
                        const dateB = new Date(`${b.date}T${b.time}`);
                        return dateA - dateB;
                    });
                
                let schedulesHTML = '';
                
                if (upcomingSchedules.length === 0) {
                    schedulesHTML = '<p>Nenhuma manutenção agendada.</p>';
                } else {
                    schedulesHTML = `
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Equipamento</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Data</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Hora</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Tipo</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Responsável</th>
                            </tr>
                    `;
                    
                    upcomingSchedules.slice(0, 10).forEach(schedule => {
                        // Formatar data
                        const date = new Date(schedule.date);
                        const formattedDate = date.toLocaleDateString('pt-BR');
                        
                        schedulesHTML += `
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">${schedule.equipmentType} #${schedule.equipment}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${formattedDate}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${schedule.time}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${this.getMaintenanceTypeName(schedule.type)}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${schedule.responsible}</td>
                            </tr>
                        `;
                    });
                    
                    schedulesHTML += '</table>';
                }
                
                maintenanceDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Próximas Manutenções Agendadas</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        ${schedulesHTML}
                    </div>
                `;
                
                printContent.appendChild(maintenanceDiv);
                
                // Adicionar quebra de página
                const pageBreak = document.createElement('div');
                pageBreak.className = 'pdf-page-break';
                printContent.appendChild(pageBreak);
                
                // Adicionar lista de equipamentos em manutenção
                const inMaintenanceDiv = document.createElement('div');
                inMaintenanceDiv.style.marginBottom = '20px';
                
                // Obter equipamentos em manutenção
                const equipmentsInMaintenance = [];
                
                this.data.reboques.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.frota || item.acoplado,
                            type: 'Reboque',
                            status: item.status,
                            date: item.dataParada,
                            motivo: item.motivo
                        });
                    }
                });
                
                this.data.caminhoesProps.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.caminhao,
                            type: 'Caminhão Próprio',
                            status: item.status,
                            date: item.data,
                            motivo: item.motivo
                        });
                    }
                });
                
                this.data.caminhoesTerc.forEach(item => {
                    if (item.status === 'Em manutenção') {
                        equipmentsInMaintenance.push({
                            id: item.caminhao,
                            type: 'Caminhão Terceiro',
                            status: item.status,
                            date: null,
                            motivo: item.motivo
                        });
                    }
                });
                
                // Adicionar equipamentos das frentes
                const addFrenteItems = (items, type, frente) => {
                    items.forEach(item => {
                        if (item.status === 'Em manutenção') {
                            equipmentsInMaintenance.push({
                                id: item.codigo,
                                type: `${type} Frente ${frente}`,
                                status: item.status,
                                date: item.data,
                                motivo: item.motivo
                            });
                        }
                    });
                };
                
                addFrenteItems(this.data.frente4001Colhedoras, 'Colhedora', '4001');
                addFrenteItems(this.data.frente4001Tracoes, 'Tração', '4001');
                addFrenteItems(this.data.frente4002Colhedoras, 'Colhedora', '4002');
                addFrenteItems(this.data.frente4002Tracoes, 'Tração', '4002');
                
                // Ordenar por data, mais recentes primeiro
                equipmentsInMaintenance.sort((a, b) => {
                    if (!a.date) return 1;
                    if (!b.date) return -1;
                    
                    const dateA = new Date(a.date);
                    const dateB = new Date(b.date);
                    return dateB - dateA;
                });
                
                let maintenanceHTML = '';
                
                if (equipmentsInMaintenance.length === 0) {
                    maintenanceHTML = '<p>Nenhum equipamento em manutenção no momento.</p>';
                } else {
                    maintenanceHTML = `
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Equipamento</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Data de Parada</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Motivo</th>
                            </tr>
                    `;
                    
                    equipmentsInMaintenance.forEach(item => {
                        // Formatar data
                        let dateStr = '';
                        if (item.date) {
                            const date = new Date(item.date);
                            dateStr = date.toLocaleDateString('pt-BR');
                        }
                        
                        maintenanceHTML += `
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">${item.type} #${item.id}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${dateStr || '-'}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${item.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                    
                    maintenanceHTML += '</table>';
                }
                
                inMaintenanceDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Equipamentos em Manutenção</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        ${maintenanceHTML}
                    </div>
                `;
                
                printContent.appendChild(inMaintenanceDiv);
                
                // Abrir janela de impressão
                window.print();
            },
            
            // Gerar relatório em PDF
            generatePDFReport() {
                // Configurar área de impressão para PDF
                document.getElementById('pdf-report-title').textContent = 'Relatório Completo da Frota';
                document.getElementById('pdf-report-date').textContent = `Gerado em: ${new Date().toLocaleDateString('pt-BR')}`;
                document.getElementById('pdf-timestamp').textContent = new Date().toLocaleString('pt-BR');
                
                const pdfContent = document.getElementById('pdf-report-content');
                pdfContent.innerHTML = '';
                
                // Adicionar resumo executivo
                const executiveDiv = document.createElement('div');
                executiveDiv.style.marginBottom = '20px';
                
                const totalEquipment = this.data.reboques.length + this.data.caminhoesProps.length + 
                                     this.data.caminhoesTerc.length + this.data.frente4001Colhedoras.length + 
                                     this.data.frente4001Tracoes.length + this.data.frente4002Colhedoras.length + 
                                     this.data.frente4002Tracoes.length;
                
                const operationalEquipment = this.data.reboques.filter(r => r.status === 'Operacional').length + 
                                           this.data.caminhoesProps.filter(c => c.status === 'Operacional').length + 
                                           this.data.caminhoesTerc.filter(c => c.status === 'Operacional').length + 
                                           this.data.frente4001Colhedoras.filter(c => c.status === 'Operacional').length + 
                                           this.data.frente4001Tracoes.filter(t => t.status === 'Operacional').length + 
                                           this.data.frente4002Colhedoras.filter(c => c.status === 'Operacional').length + 
                                           this.data.frente4002Tracoes.filter(t => t.status === 'Operacional').length;
                
                const availabilityPercent = totalEquipment > 0 ? Math.round((operationalEquipment / totalEquipment) * 100) : 0;
                
                executiveDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Resumo Executivo</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        <p>Este relatório apresenta o status atual da frota completa, com foco na disponibilidade e manutenção dos equipamentos.</p>
                        
                        <h3 style="font-size: 16px; font-weight: bold; margin: 10px 0;">Métricas Principais:</h3>
                        <ul style="list-style-type: disc; margin-left: 20px; margin-bottom: 10px;">
                            <li>Total de equipamentos: <strong>${totalEquipment}</strong></li>
                            <li>Equipamentos operacionais: <strong>${operationalEquipment}</strong></li>
                            <li>Disponibilidade geral: <strong>${availabilityPercent}%</strong></li>
                            <li>Equipamentos em manutenção: <strong>${this.data.reboques.filter(r => r.status === 'Em manutenção').length + 
                                                                 this.data.caminhoesProps.filter(c => c.status === 'Em manutenção').length + 
                                                                 this.data.caminhoesTerc.filter(c => c.status === 'Em manutenção').length + 
                                                                 this.data.frente4001Colhedoras.filter(c => c.status === 'Em manutenção').length + 
                                                                 this.data.frente4001Tracoes.filter(t => t.status === 'Em manutenção').length + 
                                                                 this.data.frente4002Colhedoras.filter(c => c.status === 'Em manutenção').length + 
                                                                 this.data.frente4002Tracoes.filter(t => t.status === 'Em manutenção').length}</strong></li>
                        </ul>
                        
                        <p>Data do relatório: <strong>${new Date().toLocaleString('pt-BR')}</strong></p>
                    </div>
                `;
                
                pdfContent.appendChild(executiveDiv);
                
                // Adicionar tabelas de resumo de cada categoria
                
                // Reboques
                this.addPDFCategorySection(pdfContent, 'Reboques', this.data.reboques, 'frota', 'acoplado');
                
                // Adicionar quebra de página após cada categoria
                pdfContent.appendChild(document.createElement('div')).className = 'pdf-page-break';
                
                // Caminhões Próprios
                this.addPDFCategorySection(pdfContent, 'Caminhões Próprios', this.data.caminhoesProps, 'caminhao');
                
                pdfContent.appendChild(document.createElement('div')).className = 'pdf-page-break';
                
                // Caminhões Terceiros
                this.addPDFCategorySection(pdfContent, 'Caminhões Terceiros', this.data.caminhoesTerc, 'caminhao', 'proprietario');
                
                pdfContent.appendChild(document.createElement('div')).className = 'pdf-page-break';
                
                // Frente 4001
                const frente4001 = [
                    ...this.data.frente4001Colhedoras.map(item => ({...item, equipment_type: 'Colhedora'})),
                    ...this.data.frente4001Tracoes.map(item => ({...item, equipment_type: 'Tração'}))
                ];
                this.addPDFCategorySection(pdfContent, 'Frente 4001', frente4001, 'codigo', 'equipment_type');
                
                pdfContent.appendChild(document.createElement('div')).className = 'pdf-page-break';
                
                // Frente 4002
                const frente4002 = [
                    ...this.data.frente4002Colhedoras.map(item => ({...item, equipment_type: 'Colhedora'})),
                    ...this.data.frente4002Tracoes.map(item => ({...item, equipment_type: 'Tração'}))
                ];
                this.addPDFCategorySection(pdfContent, 'Frente 4002', frente4002, 'codigo', 'equipment_type');
                
                // Abrir janela de impressão para PDF
                setTimeout(() => {
                    // Atraso para garantir que os elementos estejam renderizados
                    window.print();
                }, 200);
            },
            
            // Adicionar seção de categoria ao relatório PDF
            addPDFCategorySection(container, title, data, idField, secondaryField = null) {
                const sectionDiv = document.createElement('div');
                sectionDiv.style.marginBottom = '20px';
                
                // Contar por status
                const operational = data.filter(item => item.status === 'Operacional').length;
                const maintenance = data.filter(item => item.status === 'Em manutenção').length;
                const reform = data.filter(item => item.status === 'Em reforma' || 
                                               item.status === 'Aguardando reforma' || 
                                               item.status === 'Inoperante').length;
                const other = data.filter(item => !['Operacional', 'Em manutenção', 'Em reforma', 
                                               'Aguardando reforma', 'Inoperante'].includes(item.status)).length;
                
                const total = data.length;
                const availabilityPercent = total > 0 ? Math.round((operational / total) * 100) : 0;
                
                sectionDiv.innerHTML = `
                    <h2 style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">${title}</h2>
                    <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <div>
                                <p>Total: <strong>${total}</strong></p>
                                <p>Disponibilidade: <strong>${availabilityPercent}%</strong></p>
                            </div>
                            <div>
                                <p>Operacionais: <strong>${operational}</strong></p>
                                <p>Em Manutenção: <strong>${maintenance}</strong></p>
                                <p>Em Reforma/Inoperantes: <strong>${reform}</strong></p>
                                <p>Outros: <strong>${other}</strong></p>
                            </div>
                        </div>
                `;
                
                // Adicionar tabela de equipamentos se houver dados
                if (data.length > 0) {
                    // Ordenar por status, colocando não operacionais primeiro
                    const sortedData = [...data].sort((a, b) => {
                        if (a.status === 'Operacional' && b.status !== 'Operacional') return 1;
                        if (a.status !== 'Operacional' && b.status === 'Operacional') return -1;
                        return 0;
                    });
                    
                    let tableHTML = `
                        <h3 style="font-size: 16px; font-weight: bold; margin: 10px 0;">Lista de Equipamentos</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">ID</th>
                    `;
                    
                    if (secondaryField) {
                        tableHTML += `<th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">${secondaryField === 'equipment_type' ? 'Tipo' : secondaryField.charAt(0).toUpperCase() + secondaryField.slice(1)}</th>`;
                    }
                    
                    tableHTML += `
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Status</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Data</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f3f4f6;">Motivo</th>
                            </tr>
                    `;
                    
                    sortedData.forEach(item => {
                        // Determinar estilo com base no status
                        let statusStyle = '';
                        if (item.status === 'Operacional') {
                            statusStyle = 'color: #10B981;'; // verde
                        } else if (item.status === 'Em manutenção') {
                            statusStyle = 'color: #F59E0B;'; // amarelo
                        } else if (['Em reforma', 'Aguardando reforma', 'Inoperante'].includes(item.status)) {
                            statusStyle = 'color: #EF4444;'; // vermelho
                        }
                        
                        // Formatar data
                        let dateStr = '';
                        if (title === 'Reboques' && item.dataParada) {
                            dateStr = new Date(item.dataParada).toLocaleDateString('pt-BR');
                        } else if (item.data) {
                            dateStr = new Date(item.data).toLocaleDateString('pt-BR');
                        }
                        
                        tableHTML += `
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">${item[idField] || '-'}</td>
                        `;
                        
                        if (secondaryField) {
                            tableHTML += `<td style="border: 1px solid #ddd; padding: 8px;">${item[secondaryField] || '-'}</td>`;
                        }
                        
                        tableHTML += `
                                <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold; ${statusStyle}">${item.status}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${dateStr || '-'}</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">${item.motivo || '-'}</td>
                            </tr>
                        `;
                    });
                    
                    tableHTML += '</table>';
                    sectionDiv.innerHTML += tableHTML;
                } else {
                    sectionDiv.innerHTML += '<p>Nenhum equipamento cadastrado nesta categoria.</p>';
                }
                
                sectionDiv.innerHTML += '</div>';
                container.appendChild(sectionDiv);
            }
        };

        // Inicialização do sistema
        document.addEventListener('DOMContentLoaded', () => {
            // Verificar se estamos em ambiente de desenvolvimento ou teste
            const isDev = false;
            
            if (isDev) {
                // Código para ambiente de desenvolvimento
                console.log('Iniciando em modo de desenvolvimento...');
            }
            
            // Inicializar aplicação
            APP.init();
            
            // Detectar tema do sistema operacional
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                
                // Atualizar gráficos quando o tema mudar
                APP.updateAllCharts();
            });
        });
    </script>
</body>
</html>
